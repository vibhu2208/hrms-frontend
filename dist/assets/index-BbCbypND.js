const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/billing-DDm9nhee.js","assets/vendor-Q3K9tvtn.js","assets/router-s1y5QMC8.js","assets/ui-NBg_e1tT.js"])))=>i.map(i=>d[i]);
import{r as v,a as e0,b as Hs,c as t0,g as s0}from"./vendor-Q3K9tvtn.js";import{N as Ys,u as ya,L as Ut,a as Ke,O as ui,b as $a,c as a0,B as r0,R as n0,d as pe}from"./router-s1y5QMC8.js";import{X as Ee,L as io,B as at,C as Fe,U as Re,a as Te,D as tt,b as qs,c as ls,d as pi,e as Zs,S as bt,P as Tt,F as Ue,f as Rs,g as fi,h as jr,M as _a,i as i0,j as l0,k as c0,l as o0,m as Ps,n as ft,o as gi,H as zn,p as we,q as lo,r as rt,T as Ss,s as d0,t as Ba,u as ha,A as Ct,v as Ra,w as mn,x as ut,y as vr,E as hn,z as Rt,G as E,I as Hn,J as wt,K as cs,N as Ds,O as es,Q as yi,R as aa,V as ea,W as st,Y as ze,Z as An,_ as Pe,$ as Is,a0 as ct,a1 as qn,a2 as Jr,a3 as co,a4 as _t,a5 as ts,a6 as oo,a7 as bi,a8 as ds,a9 as Nr,aa as un,ab as xo,ac as x0,ad as Pa,ae as ji,af as xs,ag as mo,ah as m0,ai as la,aj as h0,ak as vi,al as u0,am as Lt,an as ho,ao as fs,ap as p0,aq as Wn,ar as Vn,as as ll,at as Ni,au as f0,av as g0,aw as y0,ax as Vr,ay as Pr,az as Qr,aA as La,aB as wi,aC as b0,aD as j0,aE as v0,aF as N0,aG as uo,aH as w0,aI as Gn,aJ as cl,aK as ol,aL as k0,aM as S0,aN as dl,aO as po,aP as C0,aQ as A0,aR as E0,aS as fo,aT as F0}from"./ui-NBg_e1tT.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();var go={exports:{}},pn={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T0=v,D0=Symbol.for("react.element"),_0=Symbol.for("react.fragment"),R0=Object.prototype.hasOwnProperty,P0=T0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,L0={key:!0,ref:!0,__self:!0,__source:!0};function yo(t,a,s){var n,r={},i=null,l=null;s!==void 0&&(i=""+s),a.key!==void 0&&(i=""+a.key),a.ref!==void 0&&(l=a.ref);for(n in a)R0.call(a,n)&&!L0.hasOwnProperty(n)&&(r[n]=a[n]);if(t&&t.defaultProps)for(n in a=t.defaultProps,a)r[n]===void 0&&(r[n]=a[n]);return{$$typeof:D0,type:t,key:i,ref:l,props:r,_owner:P0.current}}pn.Fragment=_0;pn.jsx=yo;pn.jsxs=yo;go.exports=pn;var e=go.exports,Yn={},xl=e0;Yn.createRoot=xl.createRoot,Yn.hydrateRoot=xl.hydrateRoot;function bo(t,a){return function(){return t.apply(a,arguments)}}const{toString:I0}=Object.prototype,{getPrototypeOf:ki}=Object,{iterator:fn,toStringTag:jo}=Symbol,gn=(t=>a=>{const s=I0.call(a);return t[s]||(t[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),Cs=t=>(t=t.toLowerCase(),a=>gn(a)===t),yn=t=>a=>typeof a===t,{isArray:Ua}=Array,Ia=yn("undefined");function wr(t){return t!==null&&!Ia(t)&&t.constructor!==null&&!Ia(t.constructor)&&ss(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const vo=Cs("ArrayBuffer");function O0(t){let a;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?a=ArrayBuffer.isView(t):a=t&&t.buffer&&vo(t.buffer),a}const M0=yn("string"),ss=yn("function"),No=yn("number"),kr=t=>t!==null&&typeof t=="object",$0=t=>t===!0||t===!1,Gr=t=>{if(gn(t)!=="object")return!1;const a=ki(t);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(jo in t)&&!(fn in t)},B0=t=>{if(!kr(t)||wr(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},U0=Cs("Date"),z0=Cs("File"),H0=Cs("Blob"),q0=Cs("FileList"),W0=t=>kr(t)&&ss(t.pipe),V0=t=>{let a;return t&&(typeof FormData=="function"&&t instanceof FormData||ss(t.append)&&((a=gn(t))==="formdata"||a==="object"&&ss(t.toString)&&t.toString()==="[object FormData]"))},G0=Cs("URLSearchParams"),[Y0,X0,K0,J0]=["ReadableStream","Request","Response","Headers"].map(Cs),Q0=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Sr(t,a,{allOwnKeys:s=!1}={}){if(t===null||typeof t>"u")return;let n,r;if(typeof t!="object"&&(t=[t]),Ua(t))for(n=0,r=t.length;n<r;n++)a.call(null,t[n],n,t);else{if(wr(t))return;const i=s?Object.getOwnPropertyNames(t):Object.keys(t),l=i.length;let c;for(n=0;n<l;n++)c=i[n],a.call(null,t[c],c,t)}}function wo(t,a){if(wr(t))return null;a=a.toLowerCase();const s=Object.keys(t);let n=s.length,r;for(;n-- >0;)if(r=s[n],a===r.toLowerCase())return r;return null}const ca=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ko=t=>!Ia(t)&&t!==ca;function Xn(){const{caseless:t,skipUndefined:a}=ko(this)&&this||{},s={},n=(r,i)=>{const l=t&&wo(s,i)||i;Gr(s[l])&&Gr(r)?s[l]=Xn(s[l],r):Gr(r)?s[l]=Xn({},r):Ua(r)?s[l]=r.slice():(!a||!Ia(r))&&(s[l]=r)};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Sr(arguments[r],n);return s}const Z0=(t,a,s,{allOwnKeys:n}={})=>(Sr(a,(r,i)=>{s&&ss(r)?t[i]=bo(r,s):t[i]=r},{allOwnKeys:n}),t),em=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),tm=(t,a,s,n)=>{t.prototype=Object.create(a.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:a.prototype}),s&&Object.assign(t.prototype,s)},sm=(t,a,s,n)=>{let r,i,l;const c={};if(a=a||{},t==null)return a;do{for(r=Object.getOwnPropertyNames(t),i=r.length;i-- >0;)l=r[i],(!n||n(l,t,a))&&!c[l]&&(a[l]=t[l],c[l]=!0);t=s!==!1&&ki(t)}while(t&&(!s||s(t,a))&&t!==Object.prototype);return a},am=(t,a,s)=>{t=String(t),(s===void 0||s>t.length)&&(s=t.length),s-=a.length;const n=t.indexOf(a,s);return n!==-1&&n===s},rm=t=>{if(!t)return null;if(Ua(t))return t;let a=t.length;if(!No(a))return null;const s=new Array(a);for(;a-- >0;)s[a]=t[a];return s},nm=(t=>a=>t&&a instanceof t)(typeof Uint8Array<"u"&&ki(Uint8Array)),im=(t,a)=>{const n=(t&&t[fn]).call(t);let r;for(;(r=n.next())&&!r.done;){const i=r.value;a.call(t,i[0],i[1])}},lm=(t,a)=>{let s;const n=[];for(;(s=t.exec(a))!==null;)n.push(s);return n},cm=Cs("HTMLFormElement"),om=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,n,r){return n.toUpperCase()+r}),ml=(({hasOwnProperty:t})=>(a,s)=>t.call(a,s))(Object.prototype),dm=Cs("RegExp"),So=(t,a)=>{const s=Object.getOwnPropertyDescriptors(t),n={};Sr(s,(r,i)=>{let l;(l=a(r,i,t))!==!1&&(n[i]=l||r)}),Object.defineProperties(t,n)},xm=t=>{So(t,(a,s)=>{if(ss(t)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const n=t[s];if(ss(n)){if(a.enumerable=!1,"writable"in a){a.writable=!1;return}a.set||(a.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},mm=(t,a)=>{const s={},n=r=>{r.forEach(i=>{s[i]=!0})};return Ua(t)?n(t):n(String(t).split(a)),s},hm=()=>{},um=(t,a)=>t!=null&&Number.isFinite(t=+t)?t:a;function pm(t){return!!(t&&ss(t.append)&&t[jo]==="FormData"&&t[fn])}const fm=t=>{const a=new Array(10),s=(n,r)=>{if(kr(n)){if(a.indexOf(n)>=0)return;if(wr(n))return n;if(!("toJSON"in n)){a[r]=n;const i=Ua(n)?[]:{};return Sr(n,(l,c)=>{const o=s(l,r+1);!Ia(o)&&(i[c]=o)}),a[r]=void 0,i}}return n};return s(t,0)},gm=Cs("AsyncFunction"),ym=t=>t&&(kr(t)||ss(t))&&ss(t.then)&&ss(t.catch),Co=((t,a)=>t?setImmediate:a?((s,n)=>(ca.addEventListener("message",({source:r,data:i})=>{r===ca&&i===s&&n.length&&n.shift()()},!1),r=>{n.push(r),ca.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",ss(ca.postMessage)),bm=typeof queueMicrotask<"u"?queueMicrotask.bind(ca):typeof process<"u"&&process.nextTick||Co,jm=t=>t!=null&&ss(t[fn]),he={isArray:Ua,isArrayBuffer:vo,isBuffer:wr,isFormData:V0,isArrayBufferView:O0,isString:M0,isNumber:No,isBoolean:$0,isObject:kr,isPlainObject:Gr,isEmptyObject:B0,isReadableStream:Y0,isRequest:X0,isResponse:K0,isHeaders:J0,isUndefined:Ia,isDate:U0,isFile:z0,isBlob:H0,isRegExp:dm,isFunction:ss,isStream:W0,isURLSearchParams:G0,isTypedArray:nm,isFileList:q0,forEach:Sr,merge:Xn,extend:Z0,trim:Q0,stripBOM:em,inherits:tm,toFlatObject:sm,kindOf:gn,kindOfTest:Cs,endsWith:am,toArray:rm,forEachEntry:im,matchAll:lm,isHTMLForm:cm,hasOwnProperty:ml,hasOwnProp:ml,reduceDescriptors:So,freezeMethods:xm,toObjectSet:mm,toCamelCase:om,noop:hm,toFiniteNumber:um,findKey:wo,global:ca,isContextDefined:ko,isSpecCompliantForm:pm,toJSONObject:fm,isAsyncFn:gm,isThenable:ym,setImmediate:Co,asap:bm,isIterable:jm};function $e(t,a,s,n,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",a&&(this.code=a),s&&(this.config=s),n&&(this.request=n),r&&(this.response=r,this.status=r.status?r.status:null)}he.inherits($e,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:he.toJSONObject(this.config),code:this.code,status:this.status}}});const Ao=$e.prototype,Eo={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Eo[t]={value:t}});Object.defineProperties($e,Eo);Object.defineProperty(Ao,"isAxiosError",{value:!0});$e.from=(t,a,s,n,r,i)=>{const l=Object.create(Ao);he.toFlatObject(t,l,function(x){return x!==Error.prototype},d=>d!=="isAxiosError");const c=t&&t.message?t.message:"Error",o=a==null&&t?t.code:a;return $e.call(l,c,o,s,n,r),t&&l.cause==null&&Object.defineProperty(l,"cause",{value:t,configurable:!0}),l.name=t&&t.name||"Error",i&&Object.assign(l,i),l};const vm=null;function Kn(t){return he.isPlainObject(t)||he.isArray(t)}function Fo(t){return he.endsWith(t,"[]")?t.slice(0,-2):t}function hl(t,a,s){return t?t.concat(a).map(function(r,i){return r=Fo(r),!s&&i?"["+r+"]":r}).join(s?".":""):a}function Nm(t){return he.isArray(t)&&!t.some(Kn)}const wm=he.toFlatObject(he,{},null,function(a){return/^is[A-Z]/.test(a)});function bn(t,a,s){if(!he.isObject(t))throw new TypeError("target must be an object");a=a||new FormData,s=he.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(p,u){return!he.isUndefined(u[p])});const n=s.metaTokens,r=s.visitor||x,i=s.dots,l=s.indexes,o=(s.Blob||typeof Blob<"u"&&Blob)&&he.isSpecCompliantForm(a);if(!he.isFunction(r))throw new TypeError("visitor must be a function");function d(g){if(g===null)return"";if(he.isDate(g))return g.toISOString();if(he.isBoolean(g))return g.toString();if(!o&&he.isBlob(g))throw new $e("Blob is not supported. Use a Buffer instead.");return he.isArrayBuffer(g)||he.isTypedArray(g)?o&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function x(g,p,u){let j=g;if(g&&!u&&typeof g=="object"){if(he.endsWith(p,"{}"))p=n?p:p.slice(0,-2),g=JSON.stringify(g);else if(he.isArray(g)&&Nm(g)||(he.isFileList(g)||he.endsWith(p,"[]"))&&(j=he.toArray(g)))return p=Fo(p),j.forEach(function(N,w){!(he.isUndefined(N)||N===null)&&a.append(l===!0?hl([p],w,i):l===null?p:p+"[]",d(N))}),!1}return Kn(g)?!0:(a.append(hl(u,p,i),d(g)),!1)}const m=[],h=Object.assign(wm,{defaultVisitor:x,convertValue:d,isVisitable:Kn});function f(g,p){if(!he.isUndefined(g)){if(m.indexOf(g)!==-1)throw Error("Circular reference detected in "+p.join("."));m.push(g),he.forEach(g,function(j,y){(!(he.isUndefined(j)||j===null)&&r.call(a,j,he.isString(y)?y.trim():y,p,h))===!0&&f(j,p?p.concat(y):[y])}),m.pop()}}if(!he.isObject(t))throw new TypeError("data must be an object");return f(t),a}function ul(t){const a={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return a[n]})}function Si(t,a){this._pairs=[],t&&bn(t,this,a)}const To=Si.prototype;To.append=function(a,s){this._pairs.push([a,s])};To.toString=function(a){const s=a?function(n){return a.call(this,n,ul)}:ul;return this._pairs.map(function(r){return s(r[0])+"="+s(r[1])},"").join("&")};function km(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Do(t,a,s){if(!a)return t;const n=s&&s.encode||km;he.isFunction(s)&&(s={serialize:s});const r=s&&s.serialize;let i;if(r?i=r(a,s):i=he.isURLSearchParams(a)?a.toString():new Si(a,s).toString(n),i){const l=t.indexOf("#");l!==-1&&(t=t.slice(0,l)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class pl{constructor(){this.handlers=[]}use(a,s,n){return this.handlers.push({fulfilled:a,rejected:s,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(a){this.handlers[a]&&(this.handlers[a]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(a){he.forEach(this.handlers,function(n){n!==null&&a(n)})}}const _o={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Sm=typeof URLSearchParams<"u"?URLSearchParams:Si,Cm=typeof FormData<"u"?FormData:null,Am=typeof Blob<"u"?Blob:null,Em={isBrowser:!0,classes:{URLSearchParams:Sm,FormData:Cm,Blob:Am},protocols:["http","https","file","blob","url","data"]},Ci=typeof window<"u"&&typeof document<"u",Jn=typeof navigator=="object"&&navigator||void 0,Fm=Ci&&(!Jn||["ReactNative","NativeScript","NS"].indexOf(Jn.product)<0),Tm=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Dm=Ci&&window.location.href||"http://localhost",_m=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ci,hasStandardBrowserEnv:Fm,hasStandardBrowserWebWorkerEnv:Tm,navigator:Jn,origin:Dm},Symbol.toStringTag,{value:"Module"})),zt={..._m,...Em};function Rm(t,a){return bn(t,new zt.classes.URLSearchParams,{visitor:function(s,n,r,i){return zt.isNode&&he.isBuffer(s)?(this.append(n,s.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...a})}function Pm(t){return he.matchAll(/\w+|\[(\w*)]/g,t).map(a=>a[0]==="[]"?"":a[1]||a[0])}function Lm(t){const a={},s=Object.keys(t);let n;const r=s.length;let i;for(n=0;n<r;n++)i=s[n],a[i]=t[i];return a}function Ro(t){function a(s,n,r,i){let l=s[i++];if(l==="__proto__")return!0;const c=Number.isFinite(+l),o=i>=s.length;return l=!l&&he.isArray(r)?r.length:l,o?(he.hasOwnProp(r,l)?r[l]=[r[l],n]:r[l]=n,!c):((!r[l]||!he.isObject(r[l]))&&(r[l]=[]),a(s,n,r[l],i)&&he.isArray(r[l])&&(r[l]=Lm(r[l])),!c)}if(he.isFormData(t)&&he.isFunction(t.entries)){const s={};return he.forEachEntry(t,(n,r)=>{a(Pm(n),r,s,0)}),s}return null}function Im(t,a,s){if(he.isString(t))try{return(a||JSON.parse)(t),he.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(s||JSON.stringify)(t)}const Cr={transitional:_o,adapter:["xhr","http","fetch"],transformRequest:[function(a,s){const n=s.getContentType()||"",r=n.indexOf("application/json")>-1,i=he.isObject(a);if(i&&he.isHTMLForm(a)&&(a=new FormData(a)),he.isFormData(a))return r?JSON.stringify(Ro(a)):a;if(he.isArrayBuffer(a)||he.isBuffer(a)||he.isStream(a)||he.isFile(a)||he.isBlob(a)||he.isReadableStream(a))return a;if(he.isArrayBufferView(a))return a.buffer;if(he.isURLSearchParams(a))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),a.toString();let c;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Rm(a,this.formSerializer).toString();if((c=he.isFileList(a))||n.indexOf("multipart/form-data")>-1){const o=this.env&&this.env.FormData;return bn(c?{"files[]":a}:a,o&&new o,this.formSerializer)}}return i||r?(s.setContentType("application/json",!1),Im(a)):a}],transformResponse:[function(a){const s=this.transitional||Cr.transitional,n=s&&s.forcedJSONParsing,r=this.responseType==="json";if(he.isResponse(a)||he.isReadableStream(a))return a;if(a&&he.isString(a)&&(n&&!this.responseType||r)){const l=!(s&&s.silentJSONParsing)&&r;try{return JSON.parse(a,this.parseReviver)}catch(c){if(l)throw c.name==="SyntaxError"?$e.from(c,$e.ERR_BAD_RESPONSE,this,null,this.response):c}}return a}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:zt.classes.FormData,Blob:zt.classes.Blob},validateStatus:function(a){return a>=200&&a<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};he.forEach(["delete","get","head","post","put","patch"],t=>{Cr.headers[t]={}});const Om=he.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Mm=t=>{const a={};let s,n,r;return t&&t.split(`
`).forEach(function(l){r=l.indexOf(":"),s=l.substring(0,r).trim().toLowerCase(),n=l.substring(r+1).trim(),!(!s||a[s]&&Om[s])&&(s==="set-cookie"?a[s]?a[s].push(n):a[s]=[n]:a[s]=a[s]?a[s]+", "+n:n)}),a},fl=Symbol("internals");function Xa(t){return t&&String(t).trim().toLowerCase()}function Yr(t){return t===!1||t==null?t:he.isArray(t)?t.map(Yr):String(t)}function $m(t){const a=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=s.exec(t);)a[n[1]]=n[2];return a}const Bm=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function En(t,a,s,n,r){if(he.isFunction(n))return n.call(this,a,s);if(r&&(a=s),!!he.isString(a)){if(he.isString(n))return a.indexOf(n)!==-1;if(he.isRegExp(n))return n.test(a)}}function Um(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(a,s,n)=>s.toUpperCase()+n)}function zm(t,a){const s=he.toCamelCase(" "+a);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+s,{value:function(r,i,l){return this[n].call(this,a,r,i,l)},configurable:!0})})}let as=class{constructor(a){a&&this.set(a)}set(a,s,n){const r=this;function i(c,o,d){const x=Xa(o);if(!x)throw new Error("header name must be a non-empty string");const m=he.findKey(r,x);(!m||r[m]===void 0||d===!0||d===void 0&&r[m]!==!1)&&(r[m||o]=Yr(c))}const l=(c,o)=>he.forEach(c,(d,x)=>i(d,x,o));if(he.isPlainObject(a)||a instanceof this.constructor)l(a,s);else if(he.isString(a)&&(a=a.trim())&&!Bm(a))l(Mm(a),s);else if(he.isObject(a)&&he.isIterable(a)){let c={},o,d;for(const x of a){if(!he.isArray(x))throw TypeError("Object iterator must return a key-value pair");c[d=x[0]]=(o=c[d])?he.isArray(o)?[...o,x[1]]:[o,x[1]]:x[1]}l(c,s)}else a!=null&&i(s,a,n);return this}get(a,s){if(a=Xa(a),a){const n=he.findKey(this,a);if(n){const r=this[n];if(!s)return r;if(s===!0)return $m(r);if(he.isFunction(s))return s.call(this,r,n);if(he.isRegExp(s))return s.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(a,s){if(a=Xa(a),a){const n=he.findKey(this,a);return!!(n&&this[n]!==void 0&&(!s||En(this,this[n],n,s)))}return!1}delete(a,s){const n=this;let r=!1;function i(l){if(l=Xa(l),l){const c=he.findKey(n,l);c&&(!s||En(n,n[c],c,s))&&(delete n[c],r=!0)}}return he.isArray(a)?a.forEach(i):i(a),r}clear(a){const s=Object.keys(this);let n=s.length,r=!1;for(;n--;){const i=s[n];(!a||En(this,this[i],i,a,!0))&&(delete this[i],r=!0)}return r}normalize(a){const s=this,n={};return he.forEach(this,(r,i)=>{const l=he.findKey(n,i);if(l){s[l]=Yr(r),delete s[i];return}const c=a?Um(i):String(i).trim();c!==i&&delete s[i],s[c]=Yr(r),n[c]=!0}),this}concat(...a){return this.constructor.concat(this,...a)}toJSON(a){const s=Object.create(null);return he.forEach(this,(n,r)=>{n!=null&&n!==!1&&(s[r]=a&&he.isArray(n)?n.join(", "):n)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([a,s])=>a+": "+s).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(a){return a instanceof this?a:new this(a)}static concat(a,...s){const n=new this(a);return s.forEach(r=>n.set(r)),n}static accessor(a){const n=(this[fl]=this[fl]={accessors:{}}).accessors,r=this.prototype;function i(l){const c=Xa(l);n[c]||(zm(r,l),n[c]=!0)}return he.isArray(a)?a.forEach(i):i(a),this}};as.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);he.reduceDescriptors(as.prototype,({value:t},a)=>{let s=a[0].toUpperCase()+a.slice(1);return{get:()=>t,set(n){this[s]=n}}});he.freezeMethods(as);function Fn(t,a){const s=this||Cr,n=a||s,r=as.from(n.headers);let i=n.data;return he.forEach(t,function(c){i=c.call(s,i,r.normalize(),a?a.status:void 0)}),r.normalize(),i}function Po(t){return!!(t&&t.__CANCEL__)}function za(t,a,s){$e.call(this,t??"canceled",$e.ERR_CANCELED,a,s),this.name="CanceledError"}he.inherits(za,$e,{__CANCEL__:!0});function Lo(t,a,s){const n=s.config.validateStatus;!s.status||!n||n(s.status)?t(s):a(new $e("Request failed with status code "+s.status,[$e.ERR_BAD_REQUEST,$e.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function Hm(t){const a=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return a&&a[1]||""}function qm(t,a){t=t||10;const s=new Array(t),n=new Array(t);let r=0,i=0,l;return a=a!==void 0?a:1e3,function(o){const d=Date.now(),x=n[i];l||(l=d),s[r]=o,n[r]=d;let m=i,h=0;for(;m!==r;)h+=s[m++],m=m%t;if(r=(r+1)%t,r===i&&(i=(i+1)%t),d-l<a)return;const f=x&&d-x;return f?Math.round(h*1e3/f):void 0}}function Wm(t,a){let s=0,n=1e3/a,r,i;const l=(d,x=Date.now())=>{s=x,r=null,i&&(clearTimeout(i),i=null),t(...d)};return[(...d)=>{const x=Date.now(),m=x-s;m>=n?l(d,x):(r=d,i||(i=setTimeout(()=>{i=null,l(r)},n-m)))},()=>r&&l(r)]}const Zr=(t,a,s=3)=>{let n=0;const r=qm(50,250);return Wm(i=>{const l=i.loaded,c=i.lengthComputable?i.total:void 0,o=l-n,d=r(o),x=l<=c;n=l;const m={loaded:l,total:c,progress:c?l/c:void 0,bytes:o,rate:d||void 0,estimated:d&&c&&x?(c-l)/d:void 0,event:i,lengthComputable:c!=null,[a?"download":"upload"]:!0};t(m)},s)},gl=(t,a)=>{const s=t!=null;return[n=>a[0]({lengthComputable:s,total:t,loaded:n}),a[1]]},yl=t=>(...a)=>he.asap(()=>t(...a)),Vm=zt.hasStandardBrowserEnv?((t,a)=>s=>(s=new URL(s,zt.origin),t.protocol===s.protocol&&t.host===s.host&&(a||t.port===s.port)))(new URL(zt.origin),zt.navigator&&/(msie|trident)/i.test(zt.navigator.userAgent)):()=>!0,Gm=zt.hasStandardBrowserEnv?{write(t,a,s,n,r,i){const l=[t+"="+encodeURIComponent(a)];he.isNumber(s)&&l.push("expires="+new Date(s).toGMTString()),he.isString(n)&&l.push("path="+n),he.isString(r)&&l.push("domain="+r),i===!0&&l.push("secure"),document.cookie=l.join("; ")},read(t){const a=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return a?decodeURIComponent(a[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Ym(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Xm(t,a){return a?t.replace(/\/?\/$/,"")+"/"+a.replace(/^\/+/,""):t}function Io(t,a,s){let n=!Ym(a);return t&&(n||s==!1)?Xm(t,a):a}const bl=t=>t instanceof as?{...t}:t;function ua(t,a){a=a||{};const s={};function n(d,x,m,h){return he.isPlainObject(d)&&he.isPlainObject(x)?he.merge.call({caseless:h},d,x):he.isPlainObject(x)?he.merge({},x):he.isArray(x)?x.slice():x}function r(d,x,m,h){if(he.isUndefined(x)){if(!he.isUndefined(d))return n(void 0,d,m,h)}else return n(d,x,m,h)}function i(d,x){if(!he.isUndefined(x))return n(void 0,x)}function l(d,x){if(he.isUndefined(x)){if(!he.isUndefined(d))return n(void 0,d)}else return n(void 0,x)}function c(d,x,m){if(m in a)return n(d,x);if(m in t)return n(void 0,d)}const o={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:c,headers:(d,x,m)=>r(bl(d),bl(x),m,!0)};return he.forEach(Object.keys({...t,...a}),function(x){const m=o[x]||r,h=m(t[x],a[x],x);he.isUndefined(h)&&m!==c||(s[x]=h)}),s}const Oo=t=>{const a=ua({},t);let{data:s,withXSRFToken:n,xsrfHeaderName:r,xsrfCookieName:i,headers:l,auth:c}=a;if(a.headers=l=as.from(l),a.url=Do(Io(a.baseURL,a.url,a.allowAbsoluteUrls),t.params,t.paramsSerializer),c&&l.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):""))),he.isFormData(s)){if(zt.hasStandardBrowserEnv||zt.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(he.isFunction(s.getHeaders)){const o=s.getHeaders(),d=["content-type","content-length"];Object.entries(o).forEach(([x,m])=>{d.includes(x.toLowerCase())&&l.set(x,m)})}}if(zt.hasStandardBrowserEnv&&(n&&he.isFunction(n)&&(n=n(a)),n||n!==!1&&Vm(a.url))){const o=r&&i&&Gm.read(i);o&&l.set(r,o)}return a},Km=typeof XMLHttpRequest<"u",Jm=Km&&function(t){return new Promise(function(s,n){const r=Oo(t);let i=r.data;const l=as.from(r.headers).normalize();let{responseType:c,onUploadProgress:o,onDownloadProgress:d}=r,x,m,h,f,g;function p(){f&&f(),g&&g(),r.cancelToken&&r.cancelToken.unsubscribe(x),r.signal&&r.signal.removeEventListener("abort",x)}let u=new XMLHttpRequest;u.open(r.method.toUpperCase(),r.url,!0),u.timeout=r.timeout;function j(){if(!u)return;const N=as.from("getAllResponseHeaders"in u&&u.getAllResponseHeaders()),D={data:!c||c==="text"||c==="json"?u.responseText:u.response,status:u.status,statusText:u.statusText,headers:N,config:t,request:u};Lo(function(C){s(C),p()},function(C){n(C),p()},D),u=null}"onloadend"in u?u.onloadend=j:u.onreadystatechange=function(){!u||u.readyState!==4||u.status===0&&!(u.responseURL&&u.responseURL.indexOf("file:")===0)||setTimeout(j)},u.onabort=function(){u&&(n(new $e("Request aborted",$e.ECONNABORTED,t,u)),u=null)},u.onerror=function(w){const D=w&&w.message?w.message:"Network Error",b=new $e(D,$e.ERR_NETWORK,t,u);b.event=w||null,n(b),u=null},u.ontimeout=function(){let w=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const D=r.transitional||_o;r.timeoutErrorMessage&&(w=r.timeoutErrorMessage),n(new $e(w,D.clarifyTimeoutError?$e.ETIMEDOUT:$e.ECONNABORTED,t,u)),u=null},i===void 0&&l.setContentType(null),"setRequestHeader"in u&&he.forEach(l.toJSON(),function(w,D){u.setRequestHeader(D,w)}),he.isUndefined(r.withCredentials)||(u.withCredentials=!!r.withCredentials),c&&c!=="json"&&(u.responseType=r.responseType),d&&([h,g]=Zr(d,!0),u.addEventListener("progress",h)),o&&u.upload&&([m,f]=Zr(o),u.upload.addEventListener("progress",m),u.upload.addEventListener("loadend",f)),(r.cancelToken||r.signal)&&(x=N=>{u&&(n(!N||N.type?new za(null,t,u):N),u.abort(),u=null)},r.cancelToken&&r.cancelToken.subscribe(x),r.signal&&(r.signal.aborted?x():r.signal.addEventListener("abort",x)));const y=Hm(r.url);if(y&&zt.protocols.indexOf(y)===-1){n(new $e("Unsupported protocol "+y+":",$e.ERR_BAD_REQUEST,t));return}u.send(i||null)})},Qm=(t,a)=>{const{length:s}=t=t?t.filter(Boolean):[];if(a||s){let n=new AbortController,r;const i=function(d){if(!r){r=!0,c();const x=d instanceof Error?d:this.reason;n.abort(x instanceof $e?x:new za(x instanceof Error?x.message:x))}};let l=a&&setTimeout(()=>{l=null,i(new $e(`timeout ${a} of ms exceeded`,$e.ETIMEDOUT))},a);const c=()=>{t&&(l&&clearTimeout(l),l=null,t.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),t=null)};t.forEach(d=>d.addEventListener("abort",i));const{signal:o}=n;return o.unsubscribe=()=>he.asap(c),o}},Zm=function*(t,a){let s=t.byteLength;if(s<a){yield t;return}let n=0,r;for(;n<s;)r=n+a,yield t.slice(n,r),n=r},eh=async function*(t,a){for await(const s of th(t))yield*Zm(s,a)},th=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const a=t.getReader();try{for(;;){const{done:s,value:n}=await a.read();if(s)break;yield n}}finally{await a.cancel()}},jl=(t,a,s,n)=>{const r=eh(t,a);let i=0,l,c=o=>{l||(l=!0,n&&n(o))};return new ReadableStream({async pull(o){try{const{done:d,value:x}=await r.next();if(d){c(),o.close();return}let m=x.byteLength;if(s){let h=i+=m;s(h)}o.enqueue(new Uint8Array(x))}catch(d){throw c(d),d}},cancel(o){return c(o),r.return()}},{highWaterMark:2})},vl=64*1024,{isFunction:Lr}=he,sh=(({Request:t,Response:a})=>({Request:t,Response:a}))(he.global),{ReadableStream:Nl,TextEncoder:wl}=he.global,kl=(t,...a)=>{try{return!!t(...a)}catch{return!1}},ah=t=>{t=he.merge.call({skipUndefined:!0},sh,t);const{fetch:a,Request:s,Response:n}=t,r=a?Lr(a):typeof fetch=="function",i=Lr(s),l=Lr(n);if(!r)return!1;const c=r&&Lr(Nl),o=r&&(typeof wl=="function"?(g=>p=>g.encode(p))(new wl):async g=>new Uint8Array(await new s(g).arrayBuffer())),d=i&&c&&kl(()=>{let g=!1;const p=new s(zt.origin,{body:new Nl,method:"POST",get duplex(){return g=!0,"half"}}).headers.has("Content-Type");return g&&!p}),x=l&&c&&kl(()=>he.isReadableStream(new n("").body)),m={stream:x&&(g=>g.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(g=>{!m[g]&&(m[g]=(p,u)=>{let j=p&&p[g];if(j)return j.call(p);throw new $e(`Response type '${g}' is not supported`,$e.ERR_NOT_SUPPORT,u)})});const h=async g=>{if(g==null)return 0;if(he.isBlob(g))return g.size;if(he.isSpecCompliantForm(g))return(await new s(zt.origin,{method:"POST",body:g}).arrayBuffer()).byteLength;if(he.isArrayBufferView(g)||he.isArrayBuffer(g))return g.byteLength;if(he.isURLSearchParams(g)&&(g=g+""),he.isString(g))return(await o(g)).byteLength},f=async(g,p)=>{const u=he.toFiniteNumber(g.getContentLength());return u??h(p)};return async g=>{let{url:p,method:u,data:j,signal:y,cancelToken:N,timeout:w,onDownloadProgress:D,onUploadProgress:b,responseType:C,headers:S,withCredentials:k="same-origin",fetchOptions:F}=Oo(g),R=a||fetch;C=C?(C+"").toLowerCase():"text";let T=Qm([y,N&&N.toAbortSignal()],w),M=null;const X=T&&T.unsubscribe&&(()=>{T.unsubscribe()});let q;try{if(b&&d&&u!=="get"&&u!=="head"&&(q=await f(S,j))!==0){let ie=new s(p,{method:"POST",body:j,duplex:"half"}),A;if(he.isFormData(j)&&(A=ie.headers.get("content-type"))&&S.setContentType(A),ie.body){const[P,O]=gl(q,Zr(yl(b)));j=jl(ie.body,vl,P,O)}}he.isString(k)||(k=k?"include":"omit");const B=i&&"credentials"in s.prototype,K={...F,signal:T,method:u.toUpperCase(),headers:S.normalize().toJSON(),body:j,duplex:"half",credentials:B?k:void 0};M=i&&new s(p,K);let Q=await(i?R(M,F):R(p,K));const _=x&&(C==="stream"||C==="response");if(x&&(D||_&&X)){const ie={};["status","statusText","headers"].forEach(I=>{ie[I]=Q[I]});const A=he.toFiniteNumber(Q.headers.get("content-length")),[P,O]=D&&gl(A,Zr(yl(D),!0))||[];Q=new n(jl(Q.body,vl,P,()=>{O&&O(),X&&X()}),ie)}C=C||"text";let ne=await m[he.findKey(m,C)||"text"](Q,g);return!_&&X&&X(),await new Promise((ie,A)=>{Lo(ie,A,{data:ne,headers:as.from(Q.headers),status:Q.status,statusText:Q.statusText,config:g,request:M})})}catch(B){throw X&&X(),B&&B.name==="TypeError"&&/Load failed|fetch/i.test(B.message)?Object.assign(new $e("Network Error",$e.ERR_NETWORK,g,M),{cause:B.cause||B}):$e.from(B,B&&B.code,g,M)}}},rh=new Map,Mo=t=>{let a=t?t.env:{};const{fetch:s,Request:n,Response:r}=a,i=[n,r,s];let l=i.length,c=l,o,d,x=rh;for(;c--;)o=i[c],d=x.get(o),d===void 0&&x.set(o,d=c?new Map:ah(a)),x=d;return d};Mo();const Qn={http:vm,xhr:Jm,fetch:{get:Mo}};he.forEach(Qn,(t,a)=>{if(t){try{Object.defineProperty(t,"name",{value:a})}catch{}Object.defineProperty(t,"adapterName",{value:a})}});const Sl=t=>`- ${t}`,nh=t=>he.isFunction(t)||t===null||t===!1,$o={getAdapter:(t,a)=>{t=he.isArray(t)?t:[t];const{length:s}=t;let n,r;const i={};for(let l=0;l<s;l++){n=t[l];let c;if(r=n,!nh(n)&&(r=Qn[(c=String(n)).toLowerCase()],r===void 0))throw new $e(`Unknown adapter '${c}'`);if(r&&(he.isFunction(r)||(r=r.get(a))))break;i[c||"#"+l]=r}if(!r){const l=Object.entries(i).map(([o,d])=>`adapter ${o} `+(d===!1?"is not supported by the environment":"is not available in the build"));let c=s?l.length>1?`since :
`+l.map(Sl).join(`
`):" "+Sl(l[0]):"as no adapter specified";throw new $e("There is no suitable adapter to dispatch the request "+c,"ERR_NOT_SUPPORT")}return r},adapters:Qn};function Tn(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new za(null,t)}function Cl(t){return Tn(t),t.headers=as.from(t.headers),t.data=Fn.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),$o.getAdapter(t.adapter||Cr.adapter,t)(t).then(function(n){return Tn(t),n.data=Fn.call(t,t.transformResponse,n),n.headers=as.from(n.headers),n},function(n){return Po(n)||(Tn(t),n&&n.response&&(n.response.data=Fn.call(t,t.transformResponse,n.response),n.response.headers=as.from(n.response.headers))),Promise.reject(n)})}const Bo="1.12.2",jn={};["object","boolean","number","function","string","symbol"].forEach((t,a)=>{jn[t]=function(n){return typeof n===t||"a"+(a<1?"n ":" ")+t}});const Al={};jn.transitional=function(a,s,n){function r(i,l){return"[Axios v"+Bo+"] Transitional option '"+i+"'"+l+(n?". "+n:"")}return(i,l,c)=>{if(a===!1)throw new $e(r(l," has been removed"+(s?" in "+s:"")),$e.ERR_DEPRECATED);return s&&!Al[l]&&(Al[l]=!0,console.warn(r(l," has been deprecated since v"+s+" and will be removed in the near future"))),a?a(i,l,c):!0}};jn.spelling=function(a){return(s,n)=>(console.warn(`${n} is likely a misspelling of ${a}`),!0)};function ih(t,a,s){if(typeof t!="object")throw new $e("options must be an object",$e.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let r=n.length;for(;r-- >0;){const i=n[r],l=a[i];if(l){const c=t[i],o=c===void 0||l(c,i,t);if(o!==!0)throw new $e("option "+i+" must be "+o,$e.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new $e("Unknown option "+i,$e.ERR_BAD_OPTION)}}const Xr={assertOptions:ih,validators:jn},Es=Xr.validators;let da=class{constructor(a){this.defaults=a||{},this.interceptors={request:new pl,response:new pl}}async request(a,s){try{return await this._request(a,s)}catch(n){if(n instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const i=r.stack?r.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(a,s){typeof a=="string"?(s=s||{},s.url=a):s=a||{},s=ua(this.defaults,s);const{transitional:n,paramsSerializer:r,headers:i}=s;n!==void 0&&Xr.assertOptions(n,{silentJSONParsing:Es.transitional(Es.boolean),forcedJSONParsing:Es.transitional(Es.boolean),clarifyTimeoutError:Es.transitional(Es.boolean)},!1),r!=null&&(he.isFunction(r)?s.paramsSerializer={serialize:r}:Xr.assertOptions(r,{encode:Es.function,serialize:Es.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),Xr.assertOptions(s,{baseUrl:Es.spelling("baseURL"),withXsrfToken:Es.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let l=i&&he.merge(i.common,i[s.method]);i&&he.forEach(["delete","get","head","post","put","patch","common"],g=>{delete i[g]}),s.headers=as.concat(l,i);const c=[];let o=!0;this.interceptors.request.forEach(function(p){typeof p.runWhen=="function"&&p.runWhen(s)===!1||(o=o&&p.synchronous,c.unshift(p.fulfilled,p.rejected))});const d=[];this.interceptors.response.forEach(function(p){d.push(p.fulfilled,p.rejected)});let x,m=0,h;if(!o){const g=[Cl.bind(this),void 0];for(g.unshift(...c),g.push(...d),h=g.length,x=Promise.resolve(s);m<h;)x=x.then(g[m++],g[m++]);return x}h=c.length;let f=s;for(;m<h;){const g=c[m++],p=c[m++];try{f=g(f)}catch(u){p.call(this,u);break}}try{x=Cl.call(this,f)}catch(g){return Promise.reject(g)}for(m=0,h=d.length;m<h;)x=x.then(d[m++],d[m++]);return x}getUri(a){a=ua(this.defaults,a);const s=Io(a.baseURL,a.url,a.allowAbsoluteUrls);return Do(s,a.params,a.paramsSerializer)}};he.forEach(["delete","get","head","options"],function(a){da.prototype[a]=function(s,n){return this.request(ua(n||{},{method:a,url:s,data:(n||{}).data}))}});he.forEach(["post","put","patch"],function(a){function s(n){return function(i,l,c){return this.request(ua(c||{},{method:a,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}da.prototype[a]=s(),da.prototype[a+"Form"]=s(!0)});let lh=class Uo{constructor(a){if(typeof a!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(i){s=i});const n=this;this.promise.then(r=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](r);n._listeners=null}),this.promise.then=r=>{let i;const l=new Promise(c=>{n.subscribe(c),i=c}).then(r);return l.cancel=function(){n.unsubscribe(i)},l},a(function(i,l,c){n.reason||(n.reason=new za(i,l,c),s(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(a){if(this.reason){a(this.reason);return}this._listeners?this._listeners.push(a):this._listeners=[a]}unsubscribe(a){if(!this._listeners)return;const s=this._listeners.indexOf(a);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const a=new AbortController,s=n=>{a.abort(n)};return this.subscribe(s),a.signal.unsubscribe=()=>this.unsubscribe(s),a.signal}static source(){let a;return{token:new Uo(function(r){a=r}),cancel:a}}};function ch(t){return function(s){return t.apply(null,s)}}function oh(t){return he.isObject(t)&&t.isAxiosError===!0}const Zn={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Zn).forEach(([t,a])=>{Zn[a]=t});function zo(t){const a=new da(t),s=bo(da.prototype.request,a);return he.extend(s,da.prototype,a,{allOwnKeys:!0}),he.extend(s,a,null,{allOwnKeys:!0}),s.create=function(r){return zo(ua(t,r))},s}const Ze=zo(Cr);Ze.Axios=da;Ze.CanceledError=za;Ze.CancelToken=lh;Ze.isCancel=Po;Ze.VERSION=Bo;Ze.toFormData=bn;Ze.AxiosError=$e;Ze.Cancel=Ze.CanceledError;Ze.all=function(a){return Promise.all(a)};Ze.spread=ch;Ze.isAxiosError=oh;Ze.mergeConfig=ua;Ze.AxiosHeaders=as;Ze.formToJSON=t=>Ro(he.isHTMLForm(t)?new FormData(t):t);Ze.getAdapter=$o.getAdapter;Ze.HttpStatusCode=Zn;Ze.default=Ze;const{Axios:$2,AxiosError:B2,CanceledError:U2,isCancel:z2,CancelToken:H2,VERSION:q2,all:W2,Cancel:V2,isAxiosError:G2,spread:Y2,toFormData:X2,AxiosHeaders:K2,HttpStatusCode:J2,formToJSON:Q2,getAdapter:Z2,mergeConfig:e4}=Ze,_s={DEVELOPMENT:"development",PRODUCTION:"production",STAGING:"staging"},dh=()=>_s.PRODUCTION,xh=t=>{switch(t){case _s.DEVELOPMENT:return"/api";case _s.STAGING:return"https://hrms-backend-staging.onrender.com/api";case _s.PRODUCTION:default:return"https://hrms-backend-xbz8.onrender.com/api"}},mh=t=>{switch(t){case _s.DEVELOPMENT:return"http://localhost:5173";case _s.STAGING:return"https://hrms-staging.vercel.app";case _s.PRODUCTION:default:return"https://hrms-frontend-blush.vercel.app"}},Sa=dh(),is={env:Sa,isDevelopment:Sa===_s.DEVELOPMENT,isProduction:Sa===_s.PRODUCTION,isStaging:Sa===_s.STAGING,apiBaseUrl:xh(Sa),frontendUrl:mh(Sa),apiTimeout:3e4,features:{aiAnalysis:!0,notifications:!0}};is.isDevelopment&&console.log("ðŸ”§ API Configuration:",{environment:is.env,apiBaseUrl:is.apiBaseUrl,frontendUrl:is.frontendUrl,note:"Using Vite proxy - requests to /api are forwarded to http://localhost:5001"});const hh=Object.freeze(Object.defineProperty({__proto__:null,config:is,default:is},Symbol.toStringTag,{value:"Module"})),Y=Ze.create({baseURL:is.apiBaseUrl,timeout:is.apiTimeout,headers:{"Content-Type":"application/json"}});Y.interceptors.request.use(t=>{const a=localStorage.getItem("token");return a&&(t.headers.Authorization=`Bearer ${a}`),t},t=>Promise.reject(t));Y.interceptors.response.use(t=>t,t=>{var a;return((a=t.response)==null?void 0:a.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(t)});const Ho=v.createContext(null),kt=()=>{const t=v.useContext(Ho);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},uh=({children:t})=>{const[a,s]=v.useState(null),[n,r]=v.useState(!0),[i,l]=v.useState(localStorage.getItem("token"));v.useEffect(()=>{(async()=>{const g=localStorage.getItem("token"),p=localStorage.getItem("user");g&&p&&(l(g),s(JSON.parse(p))),r(!1)})()},[]);const h={user:a,token:i,loading:n,login:async(f,g,p=null)=>{var u,j;try{const y=await Y.post("/auth/login",{email:f,password:g,companyId:p}),{token:N,user:w}=y.data.data;return localStorage.setItem("token",N),localStorage.setItem("user",JSON.stringify(w)),w.themePreference&&localStorage.setItem("theme",w.themePreference),l(N),s(w),{success:!0}}catch(y){return{success:!1,message:((j=(u=y.response)==null?void 0:u.data)==null?void 0:j.message)||"Login failed"}}},googleLogin:async f=>{var g,p;try{const u=await Y.post("/auth/google",{credential:f}),{token:j,user:y}=u.data.data;return localStorage.setItem("token",j),localStorage.setItem("user",JSON.stringify(y)),y.themePreference&&localStorage.setItem("theme",y.themePreference),l(j),s(y),{success:!0}}catch(u){return{success:!1,message:((p=(g=u.response)==null?void 0:g.data)==null?void 0:p.message)||"Google login failed"}}},register:async f=>{var g,p;try{const u=await Y.post("/auth/register",f),{token:j,user:y}=u.data.data;return localStorage.setItem("token",j),localStorage.setItem("user",JSON.stringify(y)),l(j),s(y),{success:!0}}catch(u){return{success:!1,message:((p=(g=u.response)==null?void 0:g.data)==null?void 0:p.message)||"Registration failed"}}},logout:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),l(null),s(null)},updateUser:f=>{s(f),localStorage.setItem("user",JSON.stringify(f))},isAuthenticated:!!i};return e.jsx(Ho.Provider,{value:h,children:t})},Kr={light:{name:"Light",description:"Clean and bright",colors:{primary:"#3b82f6",primaryHover:"#2563eb",background:"#ffffff",surface:"#f8fafc",surfaceHover:"#f1f5f9",text:"#1e293b",textSecondary:"#64748b",border:"#e2e8f0",accent:"#3b82f6"},preview:"bg-gradient-to-br from-blue-50 to-slate-100"},dark:{name:"Dark",description:"Easy on the eyes",colors:{primary:"#3b82f6",primaryHover:"#2563eb",background:"#0f172a",surface:"#1e293b",surfaceHover:"#334155",text:"#f8fafc",textSecondary:"#94a3b8",border:"#334155",accent:"#3b82f6"},preview:"bg-gradient-to-br from-slate-900 to-slate-800"},blue:{name:"Ocean Blue",description:"Professional and calm",colors:{primary:"#0ea5e9",primaryHover:"#0284c7",background:"#051923",surface:"#0a2540",surfaceHover:"#0f3554",text:"#e0f2fe",textSecondary:"#7dd3fc",border:"#1e3a5f",accent:"#38bdf8"},preview:"bg-gradient-to-br from-blue-900 to-cyan-900"},green:{name:"Forest Green",description:"Natural and refreshing",colors:{primary:"#10b981",primaryHover:"#059669",background:"#041a0f",surface:"#0d2818",surfaceHover:"#1a3d28",text:"#d1fae5",textSecondary:"#6ee7b7",border:"#1e4d2b",accent:"#34d399"},preview:"bg-gradient-to-br from-green-900 to-emerald-900"},purple:{name:"Royal Purple",description:"Creative and elegant",colors:{primary:"#a855f7",primaryHover:"#9333ea",background:"#0f0520",surface:"#1e0f3d",surfaceHover:"#2d1b5a",text:"#f3e8ff",textSecondary:"#d8b4fe",border:"#4c1d95",accent:"#c084fc"},preview:"bg-gradient-to-br from-purple-900 to-violet-900"},orange:{name:"Sunset Orange",description:"Warm and energetic",colors:{primary:"#f97316",primaryHover:"#ea580c",background:"#1a0a03",surface:"#331508",surfaceHover:"#4d2410",text:"#fed7aa",textSecondary:"#fdba74",border:"#7c2d12",accent:"#fb923c"},preview:"bg-gradient-to-br from-orange-900 to-amber-900"},red:{name:"Ruby Red",description:"Bold and powerful",colors:{primary:"#ef4444",primaryHover:"#dc2626",background:"#1a0404",surface:"#330a0a",surfaceHover:"#4d1010",text:"#fee2e2",textSecondary:"#fca5a5",border:"#7f1d1d",accent:"#f87171"},preview:"bg-gradient-to-br from-red-900 to-rose-900"},teal:{name:"Teal Wave",description:"Modern and balanced",colors:{primary:"#14b8a6",primaryHover:"#0d9488",background:"#041614",surface:"#0a2826",surfaceHover:"#103d38",text:"#ccfbf1",textSecondary:"#5eead4",border:"#134e4a",accent:"#2dd4bf"},preview:"bg-gradient-to-br from-teal-900 to-cyan-900"},grey:{name:"Monochrome",description:"Minimalist and focused",colors:{primary:"#6b7280",primaryHover:"#4b5563",background:"#111827",surface:"#1f2937",surfaceHover:"#374151",text:"#f9fafb",textSecondary:"#d1d5db",border:"#374151",accent:"#9ca3af"},preview:"bg-gradient-to-br from-gray-900 to-slate-800"},custom:{name:"Custom",description:"Your personalized theme",colors:{primary:"#8b5cf6",primaryHover:"#7c3aed",background:"#0f0a1f",surface:"#1a1333",surfaceHover:"#251c47",text:"#ede9fe",textSecondary:"#c4b5fd",border:"#2e1f5a",accent:"#a78bfa"},preview:"bg-gradient-to-br from-indigo-900 to-purple-900"}},qo=t=>{if(t==="custom"){const a=localStorage.getItem("customThemeColors");if(a)try{const s=JSON.parse(a);return{...Kr.custom,colors:s}}catch(s){console.error("Failed to parse custom theme colors",s)}}return Kr[t]||Kr.dark},ei=t=>{const a=qo(t),s=document.documentElement,n=document.body;Object.entries(a.colors).forEach(([r,i])=>{s.style.setProperty(`--color-${r}`,i)}),s.setAttribute("data-theme",t),n.style.backgroundColor=a.colors.background,n.style.color=a.colors.text,t==="light"?(s.classList.remove("dark"),n.classList.remove("dark")):(s.classList.add("dark"),n.classList.add("dark"))},ph=()=>Object.entries(Kr).map(([t,a])=>({id:t,name:a.name,description:a.description,preview:a.preview})),fh=async t=>(await Y.put("/user/theme",{themePreference:t})).data,Wo=v.createContext({theme:"dark",themeConfig:null,setTheme:()=>{},toggleTheme:()=>{},isChanging:!1}),gh=({children:t})=>{const[a,s]=v.useState(()=>localStorage.getItem("theme")||"dark"),[n,r]=v.useState(!1);v.useEffect(()=>{ei(a),localStorage.setItem("theme",a)},[a]);const i=async(d,x=!1)=>{if(!(d===a&&d!=="custom")){if(r(!0),ei(d),s(d),!x)try{if(localStorage.getItem("token")){await fh(d);const h=localStorage.getItem("user");if(h){const f=JSON.parse(h);f.themePreference=d,localStorage.setItem("user",JSON.stringify(f))}}}catch(m){console.error("Failed to sync theme preference:",m)}setTimeout(()=>r(!1),300)}},l=()=>{i(a==="dark"?"light":"dark")},c=qo(a),o={theme:a,themeConfig:c,setTheme:i,toggleTheme:l,isChanging:n};return e.jsx(Wo.Provider,{value:o,children:t})},ot=()=>{const t=v.useContext(Wo);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t},yh=()=>{const{user:t}=kt();return t?t.role==="superadmin"?e.jsx(Ys,{to:"/super-admin/dashboard",replace:!0}):t.role==="employee"||t.role==="manager"||t.role==="hr"?e.jsx(Ys,{to:"/employee/dashboard",replace:!0}):t.role==="company_admin"||t.role==="admin"?e.jsx(Ys,{to:"/dashboard",replace:!0}):e.jsx(Ys,{to:"/dashboard",replace:!0}):e.jsx(Ys,{to:"/login",replace:!0})},Dn=({children:t,roles:a=[]})=>{const{isAuthenticated:s,user:n,loading:r}=kt();return r?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-dark-950",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-primary-600 border-t-transparent rounded-full animate-spin mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-400",children:"Loading..."})]})}):s?a.length>0&&!a.includes(n==null?void 0:n.role)?e.jsx(Ys,{to:"/unauthorized",replace:!0}):t:e.jsx(Ys,{to:"/login",replace:!0})},bh=({isOpen:t,setIsOpen:a})=>{const s=ya(),{user:n}=kt(),[r,i]=v.useState({}),l=(n==null?void 0:n.role)==="admin"||(n==null?void 0:n.role)==="company_admin",c=(n==null?void 0:n.role)==="hr",o=(n==null?void 0:n.role)==="manager",d=f=>{i(g=>{const p={};return g[f]||(p[f]=!0),p})},x=f=>s.pathname===f,m=f=>f.some(g=>s.pathname.startsWith(g)),h=[{key:"dashboard",label:"Dashboard",icon:io,path:"/dashboard"},{key:"jobdesk",label:"Job Desk",icon:at,path:"/job-desk"},{key:"leave",label:"Leave",icon:Fe,submenu:[...l||c?[{label:"Leave Calendar",path:"/leave/calendar"}]:[{label:"All Leaves",path:"/leave"}],...!l&&!c&&!o?[{label:"Apply Leave",path:"/leave/apply"},{label:"Leave Balance",path:"/leave/balance"}]:[],...l||c?[{label:"Leave Encashment Rules",path:"/leave-encashment/rules"},{label:"Leave Accrual Policies",path:"/leave-accrual/policies"},{label:"Manual Accrual",path:"/leave-accrual/manual"}]:[{label:"Leave Encashment",path:"/leave-encashment/requests"},{label:"Encashment History",path:"/leave-encashment/history"}]]},{key:"employees",label:"Employees",icon:Re,roles:["admin","company_admin","hr"],submenu:[{label:"All Employees",path:"/employees"},{label:"Add Employee",path:"/employees/add"},{label:"Onboarding",path:"/employees/onboarding"},{label:"Offboarding",path:"/employees/offboarding"}]},{key:"attendance",label:"Attendance",icon:Te,submenu:[{label:"View Attendance",path:"/attendance"},{label:"Mark Attendance",path:"/attendance/mark"},{label:"Reports",path:"/attendance/reports"}]},{key:"work-schedule",label:"Work Schedule",icon:Fe,submenu:[{label:"Shift Templates",path:"/work-schedule/shift-templates"},{label:"Roster Management",path:"/work-schedule/rosters"},{label:"Roster Calendar",path:"/work-schedule/roster-calendar"},{label:"Change Requests",path:"/work-schedule/roster-change-requests"}]},{key:"payroll",label:"Payroll",icon:tt,submenu:[{label:"All Payroll",path:"/payroll"},{label:"Generate Payroll",path:"/payroll/generate"},{label:"Salary Slips",path:"/payroll/slips"}]},{key:"clients",label:"Clients & Projects",icon:qs,submenu:[{label:"All Clients",path:"/clients"},{label:"All Projects",path:"/projects"},{label:"Timesheets",path:"/timesheets"}]},{key:"recruitment",label:"Recruitment",icon:ls,roles:["admin","company_admin"],submenu:[{label:"Candidates",path:"/candidates"},{label:"Job Postings",path:"/job-desk"}]},{key:"compliance",label:"Compliance",icon:pi,submenu:[{label:"Documents",path:"/documents"},{label:"Compliance Tracker",path:"/compliance"}]},{key:"performance",label:"Performance",icon:Zs,submenu:[{label:"Feedback",path:"/feedback"},{label:"Exit Process",path:"/exit-process"}]},{key:"administration",label:"Administration",icon:bt,roles:["admin","company_admin","hr"],submenu:[...l?[{label:"Departments",path:"/administration/departments"},{label:"Roles & Permissions",path:"/administration/roles"},{label:"Policies",path:"/administration/policies"},{label:"User Management",path:"/administration/users"},{label:"Leave Management",path:"/administration/leave-management"}]:[],{label:"Approval Workflows",path:"/approval-workflow/workflows"},{label:"Approval Matrix",path:"/approval-workflow/matrix"},{label:"Delegations",path:"/approval-workflow/delegations"},{label:"Pending Approvals",path:"/approval-workflow/pending"},{label:"SLA Monitoring",path:"/approval-workflow/sla"},...l?[{label:"Biometric Devices",path:"/biometric/devices"},{label:"Biometric Employee Sync",path:"/biometric/employee-sync"},{label:"Biometric Attendance Pull",path:"/biometric/attendance-pull"},{label:"Biometric Sync Logs",path:"/biometric/sync-logs"},{label:"SAP Connections",path:"/sap/connections"},{label:"SAP Employee Sync",path:"/sap/employee-sync"},{label:"SAP Leave Sync",path:"/sap/leave-sync"},{label:"SAP Attendance Sync",path:"/sap/attendance-sync"},{label:"SAP Sync Logs",path:"/sap/sync-logs"}]:[]]},{key:"assets",label:"Assets",icon:Tt,path:"/assets"},{key:"reports",label:"Reports",icon:Ue,roles:["admin","company_admin","hr","manager"],submenu:[{label:"Export Data",path:"/reports/export"},{label:"Compliance Report",path:"/reports/compliance"},...l||c?[{label:"Leave Reports",path:"/reports/leave"},{label:"Attendance Reports",path:"/reports/attendance"},{label:"Compliance Reports",path:"/reports/compliance-reports"},{label:"Scheduled Reports",path:"/reports/scheduled"},{label:"Analytics Dashboard",path:"/reports/analytics"}]:[]]},{key:"settings",label:"Settings",icon:Rs,submenu:[{label:"Profile",path:"/settings/profile"},{label:"Security",path:"/settings/security"},{label:"Theme",path:"/settings/theme"},{label:"Preferences",path:"/settings/preferences"}]}];return e.jsxs(e.Fragment,{children:[t&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>a(!1)}),e.jsxs("aside",{className:`fixed top-0 left-0 h-screen theme-surface border-r theme-border z-50 transition-transform duration-300 overflow-y-auto overflow-x-hidden ${t?"translate-x-0":"-translate-x-full"} lg:translate-x-0 w-64`,style:{backgroundColor:"var(--color-surface)",borderColor:"var(--color-border)"},children:[e.jsxs("div",{className:"sticky top-0 z-10 flex items-center justify-between h-16 px-4 border-b theme-border theme-surface",style:{backgroundColor:"var(--color-surface)",borderColor:"var(--color-border)"},children:[e.jsx("div",{className:"flex items-center justify-center w-full py-2",children:e.jsx("span",{className:"text-4xl font-black font-sans bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent tracking-wider",children:"HRMS"})}),e.jsx("button",{onClick:()=>a(!1),className:"lg:hidden text-gray-400 hover:text-white",children:e.jsx(Ee,{size:20})})]}),e.jsx("nav",{className:"flex-1 py-4 px-3",children:h.filter(f=>!(f.roles&&!f.roles.includes(n==null?void 0:n.role))).map(f=>e.jsx("div",{className:"mb-1",children:f.submenu?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>d(f.key),className:`w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${m(f.submenu.map(g=>g.path))?"sidebar-menu-item active":"sidebar-menu-item"}`,onMouseEnter:g=>g.currentTarget.classList.add("hover:bg-gray-800","hover:text-white"),onMouseLeave:g=>g.currentTarget.classList.remove("hover:bg-gray-800","hover:text-white"),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(f.icon,{size:20}),e.jsx("span",{children:f.label})]}),r[f.key]?e.jsx(fi,{size:16}):e.jsx(jr,{size:16})]}),r[f.key]&&e.jsx("div",{className:"ml-4 mt-1 space-y-1",children:f.submenu.map(g=>e.jsx(Ut,{to:g.path,className:`block px-3 py-2 rounded-lg text-sm transition-colors ${x(g.path)?"sidebar-submenu-item active":"sidebar-submenu-item"}`,onMouseEnter:p=>p.currentTarget.classList.add("hover:bg-gray-800","hover:text-white"),onMouseLeave:p=>p.currentTarget.classList.remove("hover:bg-gray-800","hover:text-white"),children:g.label},g.path))})]}):e.jsxs(Ut,{to:f.path,className:`flex items-center space-x-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${x(f.path)?"sidebar-menu-item active":"sidebar-menu-item"}`,onMouseEnter:g=>g.currentTarget.classList.add("hover:bg-gray-800","hover:text-white"),onMouseLeave:g=>g.currentTarget.classList.remove("hover:bg-gray-800","hover:text-white"),children:[e.jsx(f.icon,{size:20}),e.jsx("span",{children:f.label})]})},f.key))})]})]})},jh=({toggleSidebar:t})=>{var u,j;const a=Ke(),{user:s,logout:n}=kt(),{theme:r,toggleTheme:i}=ot(),[l,c]=v.useState(!1),[o,d]=v.useState(!1),x=(s==null?void 0:s.role)==="admin"||(s==null?void 0:s.role)==="company_admin",m=(s==null?void 0:s.role)==="hr",h=(s==null?void 0:s.role)==="manager",f=m||h,g=()=>{n(),a("/login")},p=()=>{document.fullscreenElement?(document.exitFullscreen(),d(!1)):(document.documentElement.requestFullscreen(),d(!0))};return e.jsxs("header",{className:"h-16 theme-surface border-b theme-border flex items-center justify-between px-6",style:{backgroundColor:"var(--color-surface)",borderColor:"var(--color-border)"},children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:t,className:"lg:hidden theme-text-secondary",style:{color:"var(--color-textSecondary)"},children:e.jsx(_a,{size:24})}),e.jsxs("div",{className:"hidden lg:block",children:[e.jsx("h1",{className:"text-xl font-semibold theme-text",style:{color:"var(--color-text)"},children:"Welcome to HRMS"}),e.jsx("p",{className:"text-sm theme-text-secondary",style:{color:"var(--color-textSecondary)"},children:new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:i,className:"p-2 theme-text-secondary rounded-lg transition-colors",style:{color:"var(--color-textSecondary)"},onMouseEnter:y=>y.currentTarget.style.backgroundColor="var(--color-surfaceHover)",onMouseLeave:y=>y.currentTarget.style.backgroundColor="transparent",title:r==="dark"?"Switch to Light Mode":"Switch to Dark Mode",children:r==="dark"?e.jsx(i0,{size:20}):e.jsx(l0,{size:20})}),e.jsx("button",{onClick:p,className:"p-2 theme-text-secondary rounded-lg transition-colors",style:{color:"var(--color-textSecondary)"},onMouseEnter:y=>y.currentTarget.style.backgroundColor="var(--color-surfaceHover)",onMouseLeave:y=>y.currentTarget.style.backgroundColor="transparent",title:o?"Exit Fullscreen":"Enter Fullscreen",children:o?e.jsx(c0,{size:20}):e.jsx(o0,{size:20})}),e.jsxs("button",{className:"relative p-2 theme-text-secondary rounded-lg transition-colors",style:{color:"var(--color-textSecondary)"},onMouseEnter:y=>y.currentTarget.style.backgroundColor="var(--color-surfaceHover)",onMouseLeave:y=>y.currentTarget.style.backgroundColor="transparent",children:[e.jsx(Ps,{size:20}),e.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>c(!l),className:"flex items-center space-x-3 p-2 rounded-lg transition-colors",onMouseEnter:y=>y.currentTarget.style.backgroundColor="var(--color-surfaceHover)",onMouseLeave:y=>y.currentTarget.style.backgroundColor="transparent",children:[e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",style:{backgroundColor:"var(--color-primary)"},children:e.jsx(ft,{size:18,className:"text-white"})}),e.jsxs("div",{className:"hidden md:block text-left",children:[e.jsxs("p",{className:"text-sm font-medium theme-text",style:{color:"var(--color-text)"},children:[(u=s==null?void 0:s.employee)==null?void 0:u.firstName," ",(j=s==null?void 0:s.employee)==null?void 0:j.lastName]}),e.jsx("p",{className:"text-xs theme-text-secondary capitalize",style:{color:"var(--color-textSecondary)"},children:s==null?void 0:s.role})]})]}),l&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>c(!1)}),e.jsx("div",{className:"absolute right-0 mt-2 w-56 theme-surface theme-border rounded-lg shadow-lg z-20",style:{backgroundColor:"var(--color-surface)",borderColor:"var(--color-border)",borderWidth:"1px",borderStyle:"solid"},children:e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:()=>{a("/settings/profile"),c(!1)},className:"w-full flex items-center space-x-2 px-4 py-2 text-sm theme-text",style:{color:"var(--color-text)"},onMouseEnter:y=>y.currentTarget.style.backgroundColor="var(--color-surfaceHover)",onMouseLeave:y=>y.currentTarget.style.backgroundColor="transparent",children:[e.jsx(ft,{size:16}),e.jsx("span",{children:"Profile"})]}),e.jsxs("button",{onClick:()=>{a("/settings/security"),c(!1)},className:"w-full flex items-center space-x-2 px-4 py-2 text-sm theme-text",style:{color:"var(--color-text)"},onMouseEnter:y=>y.currentTarget.style.backgroundColor="var(--color-surfaceHover)",onMouseLeave:y=>y.currentTarget.style.backgroundColor="transparent",children:[e.jsx(Rs,{size:16}),e.jsx("span",{children:"Settings"})]}),f&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"my-1 theme-border",style:{borderColor:"var(--color-border)"}}),!x&&e.jsxs("button",{onClick:()=>{a("/leave/apply"),c(!1)},className:"w-full flex items-center space-x-2 px-4 py-2 text-sm theme-text",style:{color:"var(--color-text)"},onMouseEnter:y=>y.currentTarget.style.backgroundColor="var(--color-surfaceHover)",onMouseLeave:y=>y.currentTarget.style.backgroundColor="transparent",children:[e.jsx(Fe,{size:16}),e.jsx("span",{children:"Apply Leave"})]}),e.jsxs("button",{onClick:()=>{a("/leave/balance"),c(!1)},className:"w-full flex items-center space-x-2 px-4 py-2 text-sm theme-text",style:{color:"var(--color-text)"},onMouseEnter:y=>y.currentTarget.style.backgroundColor="var(--color-surfaceHover)",onMouseLeave:y=>y.currentTarget.style.backgroundColor="transparent",children:[e.jsx(Fe,{size:16}),e.jsx("span",{children:"Leave Balance"})]}),e.jsxs("button",{onClick:()=>{a("/attendance"),c(!1)},className:"w-full flex items-center space-x-2 px-4 py-2 text-sm theme-text",style:{color:"var(--color-text)"},onMouseEnter:y=>y.currentTarget.style.backgroundColor="var(--color-surfaceHover)",onMouseLeave:y=>y.currentTarget.style.backgroundColor="transparent",children:[e.jsx(Te,{size:16}),e.jsx("span",{children:"Attendance"})]}),e.jsxs("button",{onClick:()=>{a("/payroll/slips"),c(!1)},className:"w-full flex items-center space-x-2 px-4 py-2 text-sm theme-text",style:{color:"var(--color-text)"},onMouseEnter:y=>y.currentTarget.style.backgroundColor="var(--color-surfaceHover)",onMouseLeave:y=>y.currentTarget.style.backgroundColor="transparent",children:[e.jsx(tt,{size:16}),e.jsx("span",{children:"Payslips"})]}),!(x||m)&&e.jsxs("button",{onClick:()=>{a("/leave-encashment/requests"),c(!1)},className:"w-full flex items-center space-x-2 px-4 py-2 text-sm theme-text",style:{color:"var(--color-text)"},onMouseEnter:y=>y.currentTarget.style.backgroundColor="var(--color-surfaceHover)",onMouseLeave:y=>y.currentTarget.style.backgroundColor="transparent",children:[e.jsx(tt,{size:16}),e.jsx("span",{children:"Leave Encashment"})]}),(x||m)&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"my-1 theme-border",style:{borderColor:"var(--color-border)"}}),e.jsxs("button",{onClick:()=>{a("/employees"),c(!1)},className:"w-full flex items-center space-x-2 px-4 py-2 text-sm theme-text",style:{color:"var(--color-text)"},onMouseEnter:y=>y.currentTarget.style.backgroundColor="var(--color-surfaceHover)",onMouseLeave:y=>y.currentTarget.style.backgroundColor="transparent",children:[e.jsx(Re,{size:16}),e.jsx("span",{children:"All Employees"})]}),e.jsxs("button",{onClick:()=>{a("/employees/add"),c(!1)},className:"w-full flex items-center space-x-2 px-4 py-2 text-sm theme-text",style:{color:"var(--color-text)"},onMouseEnter:y=>y.currentTarget.style.backgroundColor="var(--color-surfaceHover)",onMouseLeave:y=>y.currentTarget.style.backgroundColor="transparent",children:[e.jsx(ls,{size:16}),e.jsx("span",{children:"Add Employee"})]}),e.jsxs("button",{onClick:()=>{a("/employees/onboarding"),c(!1)},className:"w-full flex items-center space-x-2 px-4 py-2 text-sm theme-text",style:{color:"var(--color-text)"},onMouseEnter:y=>y.currentTarget.style.backgroundColor="var(--color-surfaceHover)",onMouseLeave:y=>y.currentTarget.style.backgroundColor="transparent",children:[e.jsx(ls,{size:16}),e.jsx("span",{children:"Onboarding"})]}),e.jsxs("button",{onClick:()=>{a("/employees/offboarding"),c(!1)},className:"w-full flex items-center space-x-2 px-4 py-2 text-sm theme-text",style:{color:"var(--color-text)"},onMouseEnter:y=>y.currentTarget.style.backgroundColor="var(--color-surfaceHover)",onMouseLeave:y=>y.currentTarget.style.backgroundColor="transparent",children:[e.jsx(Re,{size:16}),e.jsx("span",{children:"Offboarding"})]})]})]}),e.jsx("hr",{className:"my-1 theme-border",style:{borderColor:"var(--color-border)"}}),e.jsxs("button",{onClick:g,className:"w-full flex items-center space-x-2 px-4 py-2 text-sm text-red-600",onMouseEnter:y=>y.currentTarget.style.backgroundColor="var(--color-surfaceHover)",onMouseLeave:y=>y.currentTarget.style.backgroundColor="transparent",children:[e.jsx(gi,{size:16}),e.jsx("span",{children:"Logout"})]})]})})]})]})]})]})},vh=()=>{const[t,a]=v.useState(!1),s=()=>{a(!t)};return e.jsxs("div",{className:"min-h-screen theme-bg",style:{backgroundColor:"var(--color-background)"},children:[e.jsx(bh,{isOpen:t,setIsOpen:a}),e.jsxs("div",{className:"lg:pl-64",children:[e.jsx(jh,{toggleSidebar:s}),e.jsx("main",{className:"p-6",children:e.jsx(ui,{})})]})]})},Nh=()=>{var N;const{user:t,logout:a}=kt(),{theme:s,toggleTheme:n}=ot(),r=ya(),i=Ke(),[l,c]=v.useState(!1),[o,d]=v.useState(!1),x=(t==null?void 0:t.role)==="manager",m=(t==null?void 0:t.role)==="hr",h=(t==null?void 0:t.role)==="admin",f=[{name:"Dashboard",href:"/employee/dashboard",icon:zn},{name:"Leave",href:"/employee/leave",icon:Fe},{name:"Leave Encashment",href:"/employee/leave-encashment/requests",icon:tt},{name:"Attendance",href:"/employee/attendance",icon:Te},{name:"Work Schedule",href:"/employee/work-schedule/roster-calendar",icon:Fe},{name:"Payslips",href:"/employee/payslips",icon:tt},{name:"Projects",href:"/employee/projects",icon:at},{name:"Requests",href:"/employee/requests",icon:Ue},{name:"Profile",href:"/employee/profile",icon:ft}],g=[{name:"Manager Home",href:"/employee/manager/home",icon:bt},{name:"Leave Approvals",href:"/employee/manager/leave-approvals",icon:we},{name:"Team Reports",href:"/reports/analytics",icon:Ue},{name:"Assign Project",href:"/employee/manager/assign-project",icon:ls},{name:"Schedule Meeting",href:"/employee/manager/schedule-meeting",icon:d0},{name:"Announcements",href:"/employee/manager/announcements",icon:Ba}],p=[{name:"HR Dashboard",href:"/employee/hr/dashboard",icon:lo},{name:"Employee Management",href:"/employee/hr/employees",icon:Re},{name:"Leave Encashment Rules",href:"/employee/hr/leave-encashment-rules",icon:tt},{name:"Leave Accrual Policies",href:"/employee/hr/leave-accrual-policies",icon:Fe},{name:"Approval Workflows",href:"/employee/hr/approval-workflows",icon:we},{name:"Pending Approvals",href:"/employee/hr/pending-approvals",icon:we},{name:"Reports & Analytics",href:"/employee/hr/reports-analytics",icon:Ue},{name:"Attendance Reports",href:"/employee/hr/attendance-reports",icon:Te},{name:"Payroll Management",href:"/employee/hr/payroll",icon:tt},{name:"Recruitment",href:"/employee/hr/recruitment",icon:ls},{name:"Candidate Pool",href:"/employee/hr/candidate-pool",icon:Re},{name:"Resume Search",href:"/employee/hr/resume-search",icon:rt},{name:"Performance",href:"/employee/hr/performance",icon:Ss}],u=[{name:"Admin Dashboard",href:"/dashboard",icon:bt},{name:"Employee Management",href:"/employees",icon:Re},{name:"Leave Management",href:"/leave",icon:Fe},{name:"Leave Encashment Rules",href:"/leave-encashment/rules",icon:tt},{name:"Leave Accrual Policies",href:"/leave-accrual/policies",icon:Fe},{name:"Manual Accrual",href:"/leave-accrual/manual",icon:Fe},{name:"Approval Workflows",href:"/approval-workflow/workflows",icon:we},{name:"Approval Matrix",href:"/approval-workflow/matrix",icon:we},{name:"Delegations",href:"/approval-workflow/delegations",icon:we},{name:"SLA Monitoring",href:"/approval-workflow/sla",icon:Te},{name:"Work Schedule",href:"/work-schedule/shift-templates",icon:Fe},{name:"Biometric Devices",href:"/biometric/devices",icon:Te},{name:"SAP Connections",href:"/sap/connections",icon:bt},{name:"Reports & Analytics",href:"/reports/analytics",icon:Ue},{name:"Scheduled Reports",href:"/reports/scheduled",icon:Ue},{name:"Departments",href:"/administration/departments",icon:Re},{name:"Roles & Permissions",href:"/administration/roles",icon:bt},{name:"Policies",href:"/administration/policies",icon:Ue},{name:"User Management",href:"/administration/users",icon:Re},{name:"Leave Management",href:"/administration/leave-management",icon:Fe}];h?[...f,...u]:m?[...f,...p]:x&&[...f,...g];const j=()=>{a(),i("/login")},y=w=>r.pathname===w||r.pathname.startsWith(w+"/");return e.jsxs("div",{className:"min-h-screen bg-[#1E1E2A]",children:[e.jsx("aside",{className:`fixed top-0 left-0 z-40 h-screen transition-transform bg-[#2A2A3A] border-r border-gray-800 ${l?"translate-x-0":"-translate-x-full"} md:translate-x-0`,style:{width:"260px"},children:e.jsxs("div",{className:"h-full px-3 py-4 overflow-y-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-6 px-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] rounded-xl flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:"H"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-lg font-bold text-white",children:"HRMS Portal"})})]})}),e.jsxs("nav",{className:"space-y-1",children:[f.map(w=>{const D=w.icon,b=y(w.href);return e.jsxs(Ut,{to:w.href,className:`flex items-center px-3 py-2.5 text-sm font-medium rounded-xl transition-all ${b?"bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] text-white shadow-lg":"text-gray-400 hover:bg-[#1E1E2A] hover:text-white"}`,children:[e.jsx(D,{className:"w-5 h-5 mr-3"}),w.name]},w.name)}),h&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pt-4 pb-2",children:e.jsxs("div",{className:"flex items-center space-x-2 px-3",children:[e.jsx("div",{className:"flex-1 h-px bg-gray-700"}),e.jsx("span",{className:"text-xs text-gray-500 font-semibold",children:"ADMINISTRATION"}),e.jsx("div",{className:"flex-1 h-px bg-gray-700"})]})}),u.map(w=>{const D=w.icon,b=y(w.href);return e.jsxs(Ut,{to:w.href,className:`flex items-center px-3 py-2.5 text-sm font-medium rounded-xl transition-all ${b?"bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] text-white shadow-lg":"text-gray-400 hover:bg-[#1E1E2A] hover:text-white"}`,children:[e.jsx(D,{className:"w-5 h-5 mr-3"}),w.name]},w.name)})]}),x&&!h&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pt-4 pb-2",children:e.jsxs("div",{className:"flex items-center space-x-2 px-3",children:[e.jsx("div",{className:"flex-1 h-px bg-gray-700"}),e.jsx("span",{className:"text-xs text-gray-500 font-semibold",children:"MANAGER"}),e.jsx("div",{className:"flex-1 h-px bg-gray-700"})]})}),g.map(w=>{const D=w.icon,b=y(w.href);return e.jsxs(Ut,{to:w.href,className:`flex items-center px-3 py-2.5 text-sm font-medium rounded-xl transition-all ${b?"bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] text-white shadow-lg":"text-gray-400 hover:bg-[#1E1E2A] hover:text-white"}`,children:[e.jsx(D,{className:"w-5 h-5 mr-3"}),w.name]},w.name)})]}),m&&!h&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"pt-4 pb-2",children:e.jsxs("div",{className:"flex items-center space-x-2 px-3",children:[e.jsx("div",{className:"flex-1 h-px bg-gray-700"}),e.jsx("span",{className:"text-xs text-gray-500 font-semibold",children:"HR MANAGEMENT"}),e.jsx("div",{className:"flex-1 h-px bg-gray-700"})]})}),p.map(w=>{const D=w.icon,b=y(w.href);return e.jsxs(Ut,{to:w.href,className:`flex items-center px-3 py-2.5 text-sm font-medium rounded-xl transition-all ${b?"bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] text-white shadow-lg":"text-gray-400 hover:bg-[#1E1E2A] hover:text-white"}`,children:[e.jsx(D,{className:"w-5 h-5 mr-3"}),w.name]},w.name)})]})]})]})}),e.jsxs("div",{className:"md:ml-[260px] transition-all duration-300",children:[e.jsx("header",{className:"sticky top-0 z-30 bg-[#2A2A3A] border-b border-gray-800",children:e.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("button",{onClick:()=>c(!l),className:"p-2 rounded-xl text-gray-400 hover:bg-[#1E1E2A] hover:text-white transition-colors",children:l?e.jsx(Ee,{className:"w-5 h-5"}):e.jsx(_a,{className:"w-5 h-5"})})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{className:"p-2 rounded-xl text-gray-400 hover:bg-[#1E1E2A] hover:text-white transition-colors relative",children:[e.jsx(Ps,{className:"w-5 h-5"}),e.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-[#A88BFF] rounded-full"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>d(!o),className:"flex items-center space-x-3 px-3 py-2 rounded-xl text-gray-300 hover:bg-[#1E1E2A] transition-colors",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-medium",children:(N=t==null?void 0:t.email)==null?void 0:N.charAt(0).toUpperCase()})}),e.jsx(fi,{className:"w-4 h-4"})]}),o&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 rounded-xl shadow-lg bg-[#2A2A3A] border border-gray-700",children:e.jsxs("div",{className:"py-1",children:[e.jsxs(Ut,{to:"/employee/profile",className:"block px-4 py-2 text-sm text-gray-300 hover:bg-[#1E1E2A] rounded-lg transition-colors",onClick:()=>d(!1),children:[e.jsx(ft,{className:"w-4 h-4 inline mr-2"}),"My Profile"]}),e.jsx("hr",{className:"my-1 border-gray-700"}),e.jsxs("button",{onClick:j,className:"block w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-[#1E1E2A] rounded-lg transition-colors",children:[e.jsx(gi,{className:"w-4 h-4 inline mr-2"}),"Logout"]})]})})]})]})]})})}),e.jsx("main",{className:"p-4 sm:p-6 lg:p-8",children:e.jsx(ui,{})})]}),l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30 md:hidden",onClick:()=>c(!1)})]})},wh=()=>Y.get("/super-admin/dashboard/stats"),Vo=(t={})=>Y.get("/super-admin/clients",{params:t}),kh=t=>Y.post("/super-admin/clients",t),Sh=(t,a)=>Y.put(`/super-admin/clients/${t}`,a),Ch=(t,a)=>Y.patch(`/super-admin/clients/${t}/status`,{status:a}),Ah=t=>Y.delete(`/super-admin/clients/${t}`),Ai=(t={})=>Y.get("/super-admin/packages",{params:t}),Eh=t=>Y.post("/super-admin/packages",t),Fh=(t,a)=>Y.put(`/super-admin/packages/${t}`,a),Th=t=>Y.patch(`/super-admin/packages/${t}/toggle-status`),Dh=t=>Y.delete(`/super-admin/packages/${t}`),_h=()=>Y.get("/super-admin/roles/definitions"),Rh=(t={})=>Y.get("/super-admin/roles/users",{params:t}),Ph=()=>Y.get("/super-admin/roles/stats"),Lh=()=>Y.get("/super-admin/roles/my-permissions"),Ih=t=>Y.post("/super-admin/roles/users",t),Oh=(t,a)=>Y.put(`/super-admin/roles/users/${t}`,a),Mh=t=>Y.patch(`/super-admin/roles/users/${t}/deactivate`),Go=t=>Y.post("/super-admin/packages/assign",t),Yo=(t,a={})=>Y.get(`/super-admin/clients/${t}/packages`,{params:a}),$h=(t,a)=>Y.patch(`/super-admin/client-packages/${t}/cancel`,a),Bh=()=>{var u,j;const[t,a]=v.useState(!1),[s,n]=v.useState(!1),[r,i]=v.useState(null),{user:l,logout:c}=kt(),{theme:o}=ot(),d=Ke(),x=ya();v.useEffect(()=>{m()},[]);const m=async()=>{var y;try{const N=await Lh();console.log("ðŸ” Raw API response:",N);const w=((y=N.data)==null?void 0:y.data)||N.data;if(console.log("ðŸ“Š Processed user data:",w),w&&w.modules&&w.internalRole)i(w),console.log("âœ… User permissions loaded successfully:",w.internalRole),console.log("ðŸ“‹ Available modules:",w.modules);else throw console.warn("âš ï¸ Invalid API response structure:",w),new Error("Invalid API response structure - missing modules or internalRole")}catch(N){if(console.error("âŒ Error fetching user permissions:",N),(l==null?void 0:l.role)==="superadmin"){console.warn("âš ï¸ Using emergency fallback for super admin");const w={internalRole:"super_admin",roleDefinition:{name:"Super Admin (Owner)"},permissions:{},modules:["analytics_monitoring","client_management","package_management","subscription_billing","role_management","audit_logs","system_config","data_management"]};i(w),console.log("ðŸ”„ Fallback permissions set:",w)}else console.error("âŒ Non-super admin user with permission error, denying access")}},f=[{title:"Dashboard",icon:io,path:"/super-admin/dashboard",description:"System overview and metrics",requiredModule:"analytics_monitoring"},{title:"Client Management",icon:Re,path:"/super-admin/clients",description:"Manage client accounts and subscriptions",requiredModule:"client_management"},{title:"Package Management",icon:Tt,path:"/super-admin/packages",description:"Create and manage subscription packages",requiredModule:"package_management"},{title:"Subscription & Billing",icon:tt,path:"/super-admin/subscriptions",description:"Manage subscriptions and billing",requiredModule:"subscription_billing"},{title:"Invoice Center",icon:ha,path:"/super-admin/invoices",description:"Manage invoices and payments",requiredModule:"subscription_billing"},{title:"Revenue Dashboard",icon:Ss,path:"/super-admin/revenue",description:"Revenue analytics and insights",requiredModule:"subscription_billing"},{title:"Billing Alerts",icon:Ct,path:"/super-admin/billing-alerts",description:"Renewal and payment alerts",requiredModule:"subscription_billing"},{title:"User Management",icon:Ra,path:"/super-admin/roles",description:"Manage all system users and permissions",requiredModule:"role_management"},{title:"Audit Logs",icon:Ue,path:"/super-admin/audit",description:"View audit trails and security logs",requiredModule:"audit_logs"},{title:"Analytics & Reports",icon:Zs,path:"/super-admin/analytics",description:"System analytics and reporting",requiredModule:"analytics_monitoring"},{title:"System Configuration",icon:Rs,path:"/super-admin/config",description:"System-wide settings and configuration",requiredModule:"system_config"},{title:"Data Management",icon:mn,path:"/super-admin/data",description:"Data backups and management",requiredModule:"data_management"}].filter(y=>{if(!r||!r.modules)return console.log("ðŸš« No user permissions or modules available for filtering"),!1;const N=r.modules.includes(y.requiredModule);return console.log(`ðŸ” Menu item "${y.title}" (${y.requiredModule}): ${N?"âœ… ALLOWED":"âŒ DENIED"}`),N});console.log("ðŸ“‹ Final menu items:",f.map(y=>y.title));const g=()=>{c(),d("/login")},p=y=>x.pathname.startsWith(y);return e.jsxs("div",{className:`min-h-screen ${o==="dark"?"bg-gray-900":"bg-gray-50"}`,children:[t&&e.jsx("div",{className:"fixed inset-0 z-40 lg:hidden",onClick:()=>a(!1),children:e.jsx("div",{className:"absolute inset-0 bg-gray-600 opacity-75"})}),e.jsxs("div",{className:`fixed inset-y-0 left-0 z-50 transform transition-all duration-300 ease-in-out lg:translate-x-0 ${t?"translate-x-0":"-translate-x-full"} ${s?"w-16":"w-64"} ${o==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border-r flex flex-col`,children:[e.jsxs("div",{className:`flex items-center justify-between p-4 border-b ${o==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:e.jsx(bt,{className:"w-5 h-5 text-white"})}),!s&&e.jsxs("div",{children:[e.jsx("h1",{className:`text-lg font-bold ${o==="dark"?"text-white":"text-gray-900"}`,children:"Super Admin"}),e.jsx("p",{className:`text-xs ${o==="dark"?"text-gray-400":"text-gray-500"}`,children:"System Control Panel"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>n(!s),className:"hidden lg:block p-1 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700",title:s?"Expand sidebar":"Collapse sidebar",children:e.jsx(_a,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>a(!1),className:"lg:hidden p-1 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx(Ee,{className:"w-5 h-5"})})]})]}),e.jsx("nav",{className:"flex-1 px-4 py-6 space-y-2 overflow-y-auto sidebar-scroll",children:f.map(y=>{const N=y.icon,w=p(y.path);return e.jsxs("button",{onClick:()=>{d(y.path),a(!1)},className:`w-full flex items-center ${s?"justify-center px-2 py-3":"px-3 py-3"} text-left rounded-lg transition-colors duration-200 group relative ${w?"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 border border-blue-200 dark:border-blue-800":`${o==="dark"?"text-gray-300 hover:bg-gray-700":"text-gray-700 hover:bg-gray-100"}`}`,title:s?y.title:"",children:[e.jsx(N,{className:`w-5 h-5 ${s?"":"mr-3"} ${w?"text-blue-600 dark:text-blue-400":"text-gray-400 group-hover:text-gray-600 dark:group-hover:text-gray-300"}`}),!s&&e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`font-medium ${w?"text-blue-600 dark:text-blue-400":""}`,children:y.title}),e.jsx("div",{className:`text-xs ${w?"text-blue-500 dark:text-blue-500":"text-gray-500 dark:text-gray-400"}`,children:y.description})]}),s&&e.jsx("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 text-white text-sm rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50",children:y.title})]},y.path)})}),e.jsxs("div",{className:`p-4 border-t ${o==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsxs("div",{className:`flex items-center ${s?"justify-center":"space-x-3"} p-3 rounded-lg ${o==="dark"?"bg-gray-700":"bg-gray-50"} relative group`,children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-medium",children:(u=l==null?void 0:l.email)==null?void 0:u.charAt(0).toUpperCase()})}),!s&&e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-sm font-medium truncate ${o==="dark"?"text-white":"text-gray-900"}`,children:l==null?void 0:l.email}),e.jsx("p",{className:`text-xs ${o==="dark"?"text-gray-400":"text-gray-500"}`,children:((j=r==null?void 0:r.roleDefinition)==null?void 0:j.name)||"Super Administrator"})]}),s&&e.jsx("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 text-white text-sm rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50",children:l==null?void 0:l.email})]}),e.jsxs("button",{onClick:g,className:`w-full mt-3 flex items-center ${s?"justify-center px-2":"px-3"} py-2 text-sm rounded-lg transition-colors duration-200 group relative ${o==="dark"?"text-gray-300 hover:bg-gray-700 hover:text-white":"text-gray-700 hover:bg-gray-100"}`,title:s?"Sign Out":"",children:[e.jsx(gi,{className:`w-4 h-4 ${s?"":"mr-2"}`}),!s&&"Sign Out",s&&e.jsx("div",{className:"absolute left-full ml-2 px-2 py-1 bg-gray-900 text-white text-sm rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50",children:"Sign Out"})]})]})]}),e.jsxs("div",{className:`transition-all duration-300 ease-in-out ${s?"lg:pl-16":"lg:pl-64"}`,children:[e.jsx("header",{className:`${o==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border-b px-4 py-3`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>a(!0),className:"lg:hidden p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx(_a,{className:"w-5 h-5"})}),e.jsx("div",{className:"hidden md:flex items-center space-x-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(rt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search clients, packages...",className:`pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${o==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"}`})]})})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{className:`p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 relative ${o==="dark"?"text-gray-300":"text-gray-600"}`,children:[e.jsx(Ps,{className:"w-5 h-5"}),e.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full"})]}),e.jsxs("div",{className:`text-right hidden sm:block ${o==="dark"?"text-gray-300":"text-gray-700"}`,children:[e.jsx("p",{className:"text-sm font-medium",children:"System Status"}),e.jsx("p",{className:"text-xs text-green-500",children:"All Systems Operational"})]})]})]})}),e.jsx("main",{className:"p-6",children:e.jsx(ui,{})})]})]})};function Uh(t={}){const{nonce:a,onScriptLoadSuccess:s,onScriptLoadError:n}=t,[r,i]=v.useState(!1),l=v.useRef(s);l.current=s;const c=v.useRef(n);return c.current=n,v.useEffect(()=>{const o=document.createElement("script");return o.src="https://accounts.google.com/gsi/client",o.async=!0,o.defer=!0,o.nonce=a,o.onload=()=>{var d;i(!0),(d=l.current)===null||d===void 0||d.call(l)},o.onerror=()=>{var d;i(!1),(d=c.current)===null||d===void 0||d.call(c)},document.body.appendChild(o),()=>{document.body.removeChild(o)}},[a]),r}const Xo=v.createContext(null);function Ko({clientId:t,nonce:a,onScriptLoadSuccess:s,onScriptLoadError:n,children:r}){const i=Uh({nonce:a,onScriptLoadSuccess:s,onScriptLoadError:n}),l=v.useMemo(()=>({clientId:t,scriptLoadedSuccessfully:i}),[t,i]);return Hs.createElement(Xo.Provider,{value:l},r)}function zh(){const t=v.useContext(Xo);if(!t)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return t}function Hh(t){var a;return(a=t==null?void 0:t.clientId)!==null&&a!==void 0?a:t==null?void 0:t.client_id}const qh={large:40,medium:32,small:20};function Jo({onSuccess:t,onError:a,useOneTap:s,promptMomentNotification:n,type:r="standard",theme:i="outline",size:l="large",text:c,shape:o,logo_alignment:d,width:x,locale:m,click_listener:h,containerProps:f,...g}){const p=v.useRef(null),{clientId:u,scriptLoadedSuccessfully:j}=zh(),y=v.useRef(t);y.current=t;const N=v.useRef(a);N.current=a;const w=v.useRef(n);return w.current=n,v.useEffect(()=>{var D,b,C,S,k,F,R,T,M;if(j)return(C=(b=(D=window==null?void 0:window.google)===null||D===void 0?void 0:D.accounts)===null||b===void 0?void 0:b.id)===null||C===void 0||C.initialize({client_id:u,callback:X=>{var q;if(!(X!=null&&X.credential))return(q=N.current)===null||q===void 0?void 0:q.call(N);const{credential:B,select_by:K}=X;y.current({credential:B,clientId:Hh(X),select_by:K})},...g}),(F=(k=(S=window==null?void 0:window.google)===null||S===void 0?void 0:S.accounts)===null||k===void 0?void 0:k.id)===null||F===void 0||F.renderButton(p.current,{type:r,theme:i,size:l,text:c,shape:o,logo_alignment:d,width:x,locale:m,click_listener:h}),s&&((M=(T=(R=window==null?void 0:window.google)===null||R===void 0?void 0:R.accounts)===null||T===void 0?void 0:T.id)===null||M===void 0||M.prompt(w.current)),()=>{var X,q,B;s&&((B=(q=(X=window==null?void 0:window.google)===null||X===void 0?void 0:X.accounts)===null||q===void 0?void 0:q.id)===null||B===void 0||B.cancel())}},[u,j,s,r,i,l,c,o,d,x,m]),Hs.createElement("div",{...f,ref:p,style:{height:qh[l],...f==null?void 0:f.style}})}const Wh=()=>{const t=Ke(),{login:a,googleLogin:s}=kt(),[n,r]=v.useState([]),[i,l]=v.useState(!0),[c,o]=v.useState({email:"",password:"",companyId:""}),[d,x]=v.useState(!1),[m,h]=v.useState(!1),f=j=>{o({...c,[j.target.name]:j.target.value})};v.useEffect(()=>{(async()=>{try{const N=await(await fetch("undefined/api/auth/companies")).json();N.success&&Array.isArray(N.data)&&(r(N.data),N.data.length>0&&o(w=>({...w,companyId:N.data[0].companyId})))}catch(y){console.error("Error fetching companies:",y),E.error("Unable to load companies. Please refresh and try again.")}finally{l(!1)}})()},[]);const g=async j=>{if(j.preventDefault(),!c.companyId){E.error("Please select a company");return}h(!0);const y=await a(c.email,c.password,c.companyId);if(y.success){E.success("Login successful!");const N=JSON.parse(localStorage.getItem("user"));(N==null?void 0:N.role)==="superadmin"?t("/super-admin/dashboard"):(N==null?void 0:N.role)==="employee"?t("/employee/dashboard"):t("/dashboard")}else E.error(y.message);h(!1)},p=async j=>{h(!0);const y=await s(j.credential);if(y.success){E.success("Login successful!");const N=JSON.parse(localStorage.getItem("user"));(N==null?void 0:N.role)==="superadmin"?t("/super-admin/dashboard"):(N==null?void 0:N.role)==="employee"?t("/employee/dashboard"):t("/dashboard")}else E.error(y.message);h(!1)},u=()=>{E.error("Google login failed. Please try again.")};return e.jsx(Ko,{clientId:"41978102639-uu9ual6benq49osi0hkotdmmoc1b51hn.apps.googleusercontent.com",children:e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-dark-950 px-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("img",{src:"/logo2.png",alt:"Company Logo",className:"h-16 w-auto rounded-2xl shadow-md border-2 border-white/10"})}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Welcome Back"}),e.jsx("p",{className:"text-gray-400",children:"Sign in to your HRMS account"})]}),e.jsxs("div",{className:"card",children:[e.jsxs("form",{onSubmit:g,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ut,{size:20,className:"text-gray-500"})}),e.jsx("input",{type:"email",name:"email",value:c.email,onChange:f,className:"input-field pl-10",placeholder:"you@example.com",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Company"}),e.jsx("div",{className:"relative",children:e.jsxs("select",{name:"companyId",value:c.companyId,onChange:f,className:"input-field appearance-none",disabled:i,required:!0,children:[i&&e.jsx("option",{children:"Loading companies..."}),!i&&n.length===0&&e.jsx("option",{value:"",children:"No companies available"}),n.map(j=>e.jsx("option",{value:j.companyId,children:j.companyName||j.companyCode},j.companyId))]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(vr,{size:20,className:"text-gray-500"})}),e.jsx("input",{type:d?"text":"password",name:"password",value:c.password,onChange:f,className:"input-field pl-10 pr-10",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",required:!0}),e.jsx("button",{type:"button",onClick:()=>x(!d),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-300",children:d?e.jsx(hn,{size:20}):e.jsx(Rt,{size:20})})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 text-primary-600 bg-dark-800 border-dark-700 rounded focus:ring-primary-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-400",children:"Remember me"})]}),e.jsx(Ut,{to:"/forgot-password",className:"text-sm text-primary-500 hover:text-primary-400",children:"Forgot password?"})]}),e.jsx("button",{type:"submit",disabled:m,className:"w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:m?"Signing in...":"Sign In"})]}),e.jsxs("div",{className:"relative my-6",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-dark-700"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-dark-900 text-gray-400",children:"Or continue with"})})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Jo,{onSuccess:p,onError:u,theme:"filled_black",size:"large",width:"100%",text:"signin_with"})})]}),e.jsxs("p",{className:"text-center text-sm text-gray-400 mt-6",children:["Don't have an account?"," ",e.jsx(Ut,{to:"/register",className:"text-primary-500 hover:text-primary-400",children:"Contact Admin"})]})]})})})},Vh=()=>{const t=Ke();return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-dark-950 px-4",children:e.jsxs("div",{className:"w-full max-w-5xl",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("img",{src:"/logo2.png",alt:"Company Logo",className:"h-20 w-auto rounded-2xl shadow-md border-2 border-white/10"})}),e.jsx("h1",{className:"text-4xl font-bold text-white mb-3",children:"Welcome to HRMS"}),e.jsx("p",{className:"text-gray-400 text-lg",children:"Choose how you want to sign in"})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 max-w-4xl mx-auto",children:[e.jsx("div",{onClick:()=>t("/login/company-select"),className:"card hover:border-primary-500 transition-all duration-300 cursor-pointer group",children:e.jsxs("div",{className:"text-center p-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-primary-500/10 mb-6 group-hover:bg-primary-500/20 transition-colors",children:e.jsx(qs,{size:40,className:"text-primary-500"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-3",children:"Company Login"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Sign in to your company's HRMS portal. Access employee management, payroll, attendance, and more."}),e.jsxs("div",{className:"flex items-center justify-center text-primary-500 group-hover:text-primary-400 font-medium",children:["Continue to Company Login",e.jsx(Hn,{size:20,className:"ml-2 group-hover:translate-x-1 transition-transform"})]})]})}),e.jsx("div",{onClick:()=>t("/login/super-admin"),className:"card hover:border-purple-500 transition-all duration-300 cursor-pointer group",children:e.jsxs("div",{className:"text-center p-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 rounded-full bg-purple-500/10 mb-6 group-hover:bg-purple-500/20 transition-colors",children:e.jsx(bt,{size:40,className:"text-purple-500"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-3",children:"Super Admin"}),e.jsx("p",{className:"text-gray-400 mb-6",children:"System administrators only. Manage all companies, subscriptions, packages, and system configuration."}),e.jsxs("div",{className:"flex items-center justify-center text-purple-500 group-hover:text-purple-400 font-medium",children:["Continue to Admin Login",e.jsx(Hn,{size:20,className:"ml-2 group-hover:translate-x-1 transition-transform"})]})]})})]}),e.jsx("div",{className:"text-center mt-12",children:e.jsx("p",{className:"text-gray-500 text-sm",children:"Need help? Contact your system administrator"})})]})})},Gh=()=>{const t=Ke(),[a,s]=v.useState([]),[n,r]=v.useState([]),[i,l]=v.useState(""),[c,o]=v.useState(!0);v.useEffect(()=>{d()},[]),v.useEffect(()=>{if(i.trim()==="")r(a);else{const m=a.filter(h=>h.companyName.toLowerCase().includes(i.toLowerCase())||h.companyCode.toLowerCase().includes(i.toLowerCase()));r(m)}},[i,a]);const d=async()=>{try{console.log("Fetching companies from:",`${is.apiBaseUrl}/auth/companies`);const m=await Ze.get(`${is.apiBaseUrl}/auth/companies`);console.log("Companies response:",m.data),m.data.success&&(s(m.data.data),r(m.data.data))}catch(m){E.error("Failed to load companies"),console.error("Error fetching companies:",m)}finally{o(!1)}},x=m=>{const h={id:m.companyId||m._id,name:m.companyName,code:m.companyCode,databaseName:m.tenantDatabaseName||m.databaseName};localStorage.setItem("selectedCompany",JSON.stringify(h));const f=m.companyName.toLowerCase().replace(/\s+/g,"-");t(`/login/${f}`,{state:{company:h}})};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-dark-950 px-4 py-8",children:e.jsxs("div",{className:"w-full max-w-4xl",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("img",{src:"/logo2.png",alt:"Company Logo",className:"h-16 w-auto rounded-2xl shadow-md border-2 border-white/10"})}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Select Your Company"}),e.jsx("p",{className:"text-gray-400",children:"Choose your organization to continue"})]}),e.jsxs("button",{onClick:()=>t("/login"),className:"flex items-center text-gray-400 hover:text-white mb-6 transition-colors",children:[e.jsx(wt,{size:20,className:"mr-2"}),"Back to login options"]}),e.jsx("div",{className:"card mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(rt,{size:20,className:"text-gray-500"})}),e.jsx("input",{type:"text",value:i,onChange:m=>l(m.target.value),className:"input-field pl-10",placeholder:"Search by company name or code..."})]})}),e.jsx("div",{className:"card",children:c?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(cs,{size:40,className:"text-primary-500 animate-spin"})}):n.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(qs,{size:48,className:"text-gray-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:i?"No companies found matching your search":"No companies available"})]}):e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:e.jsx("div",{className:"grid gap-3",children:n.map(m=>{var h;return e.jsxs("button",{onClick:()=>x(m),className:"flex items-center p-4 rounded-lg bg-dark-800 hover:bg-dark-700 border border-dark-700 hover:border-primary-500 transition-all text-left group",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-lg bg-primary-500/10 group-hover:bg-primary-500/20 transition-colors mr-4",children:e.jsx(qs,{size:24,className:"text-primary-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-white font-semibold mb-1",children:m.companyName}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-400",children:[e.jsxs("span",{children:["Code: ",m.companyCode]}),((h=m.subscription)==null?void 0:h.plan)&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-primary-500/20 text-primary-400 text-xs",children:m.subscription.plan}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs ${m.status==="active"?"bg-green-500/20 text-green-400":"bg-yellow-500/20 text-yellow-400"}`,children:m.status})]})]})]},m._id)})})})}),e.jsx("p",{className:"text-center text-sm text-gray-500 mt-6",children:"Can't find your company? Contact your system administrator"})]})})},Yh=()=>{const t=Ke();ya();const{companySlug:a}=$a(),{login:s,googleLogin:n}=kt(),[r,i]=v.useState(null),[l,c]=v.useState({email:"",password:""}),[o,d]=v.useState(!1),[x,m]=v.useState(!1),[h,f]=v.useState(!0);v.useEffect(()=>{a?(async()=>{try{const w=JSON.parse(localStorage.getItem("selectedCompany")||"null");if(w&&w.name.toLowerCase().replace(/\s+/g,"-")===a){i(w),f(!1);return}const D=await Ze.get("undefined/api/auth/companies");if(D.data.success){const b=D.data.data.find(C=>C.companyName.toLowerCase().replace(/\s+/g,"-")===a);if(b){const C={id:b.companyId||b._id,name:b.companyName,code:b.companyCode,databaseName:b.tenantDatabaseName||b.databaseName};i(C),localStorage.setItem("selectedCompany",JSON.stringify(C))}else E.error("Company not found"),t("/login/company-select")}}catch(w){console.error("Error fetching company:",w),E.error("Failed to load company"),t("/login/company-select")}finally{f(!1)}})():(E.error("Please select a company first"),t("/login/company-select"))},[a,t]);const g=N=>{c({...l,[N.target.name]:N.target.value})},p=async N=>{N.preventDefault(),m(!0),console.log("ðŸ” Login attempt:",{email:l.email,companyId:r==null?void 0:r.id,companyName:r==null?void 0:r.name});const w=await s(l.email,l.password,r==null?void 0:r.id);if(console.log("ðŸ“Š Login result:",w),w.success){E.success("Login successful!");const D=JSON.parse(localStorage.getItem("user"));(D==null?void 0:D.role)==="employee"||(D==null?void 0:D.role)==="manager"||(D==null?void 0:D.role)==="hr"?t("/employee/dashboard"):((D==null?void 0:D.role)==="company_admin"||(D==null||D.role),t("/dashboard"))}else E.error(w.message||"Invalid credentials");m(!1)},u=async N=>{m(!0);const w=await n(N.credential,r==null?void 0:r.databaseName);if(w.success){E.success("Login successful!");const D=JSON.parse(localStorage.getItem("user"));(D==null?void 0:D.role)==="employee"?t("/employee/dashboard"):t("/dashboard")}else E.error(w.message||"Google login failed");m(!1)},j=()=>{E.error("Google login failed. Please try again.")},y=()=>{localStorage.removeItem("selectedCompany"),t("/login/company-select")};return h?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-dark-950",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Loading company..."})]})}):r?e.jsx(Ko,{clientId:"41978102639-uu9ual6benq49osi0hkotdmmoc1b51hn.apps.googleusercontent.com",children:e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-dark-950 px-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("button",{onClick:y,className:"flex items-center text-gray-400 hover:text-white mb-6 transition-colors",children:[e.jsx(wt,{size:20,className:"mr-2"}),"Change company"]}),e.jsx("div",{className:"card mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-lg bg-primary-500/10 mr-4",children:e.jsx(qs,{size:24,className:"text-primary-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold",children:r.name}),e.jsxs("p",{className:"text-sm text-gray-400",children:["Code: ",r.code]})]})]})}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("img",{src:"/logo2.png",alt:"Company Logo",className:"h-16 w-auto rounded-2xl shadow-md border-2 border-white/10"})}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Welcome Back"}),e.jsx("p",{className:"text-gray-400",children:"Sign in to your account"})]}),e.jsxs("div",{className:"card",children:[e.jsxs("form",{onSubmit:p,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ut,{size:20,className:"text-gray-500"})}),e.jsx("input",{type:"email",name:"email",value:l.email,onChange:g,className:"input-field pl-10",placeholder:"you@example.com",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(vr,{size:20,className:"text-gray-500"})}),e.jsx("input",{type:o?"text":"password",name:"password",value:l.password,onChange:g,className:"input-field pl-10 pr-10",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",required:!0}),e.jsx("button",{type:"button",onClick:()=>d(!o),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-300",children:o?e.jsx(hn,{size:20}):e.jsx(Rt,{size:20})})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 text-primary-600 bg-dark-800 border-dark-700 rounded focus:ring-primary-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-400",children:"Remember me"})]}),e.jsx("button",{type:"button",className:"text-sm text-primary-500 hover:text-primary-400",children:"Forgot password?"})]}),e.jsx("button",{type:"submit",disabled:x,className:"w-full btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:x?"Signing in...":"Sign In"})]}),e.jsxs("div",{className:"relative my-6",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-dark-700"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-dark-900 text-gray-400",children:"Or continue with"})})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Jo,{onSuccess:u,onError:j,theme:"filled_black",size:"large",width:"100%",text:"signin_with"})})]}),e.jsxs("p",{className:"text-center text-sm text-gray-400 mt-6",children:["Need help?"," ",e.jsx("button",{className:"text-primary-500 hover:text-primary-400",children:"Contact your HR department"})]})]})})}):null},Xh=()=>{const t=Ke(),{login:a}=kt(),[s,n]=v.useState({email:"",password:""}),[r,i]=v.useState(!1),[l,c]=v.useState(!1),o=x=>{n({...s,[x.target.name]:x.target.value})},d=async x=>{x.preventDefault(),c(!0);const m=await a(s.email,s.password);if(m.success){const h=JSON.parse(localStorage.getItem("user"));(h==null?void 0:h.role)==="superadmin"?(E.success("Welcome back, Super Admin!"),t("/super-admin/dashboard")):(E.error("Access denied. Super Admin credentials required."),localStorage.removeItem("token"),localStorage.removeItem("user"))}else E.error(m.message||"Invalid credentials");c(!1)};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-dark-950 px-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("button",{onClick:()=>t("/login"),className:"flex items-center text-gray-400 hover:text-white mb-6 transition-colors",children:[e.jsx(wt,{size:20,className:"mr-2"}),"Back to login options"]}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-purple-500/10 border-2 border-purple-500/20",children:e.jsx(bt,{size:32,className:"text-purple-500"})})}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Super Admin Login"}),e.jsx("p",{className:"text-gray-400",children:"System administrators only"})]}),e.jsx("div",{className:"card",children:e.jsxs("form",{onSubmit:d,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ut,{size:20,className:"text-gray-500"})}),e.jsx("input",{type:"email",name:"email",value:s.email,onChange:o,className:"input-field pl-10",placeholder:"admin@system.com",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(vr,{size:20,className:"text-gray-500"})}),e.jsx("input",{type:r?"text":"password",name:"password",value:s.password,onChange:o,className:"input-field pl-10 pr-10",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",required:!0}),e.jsx("button",{type:"button",onClick:()=>i(!r),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-300",children:r?e.jsx(hn,{size:20}):e.jsx(Rt,{size:20})})]})]}),e.jsx("button",{type:"submit",disabled:l,className:"w-full bg-purple-600 hover:bg-purple-700 text-white font-medium py-3 px-4 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Signing in...":"Sign In as Super Admin"})]})}),e.jsx("div",{className:"mt-6 p-4 bg-purple-500/10 border border-purple-500/20 rounded-lg",children:e.jsxs("p",{className:"text-sm text-purple-300 text-center",children:[e.jsx(bt,{size:16,className:"inline mr-2"}),"This is a restricted area. All activities are logged and monitored."]})})]})})},Kh=({job:t,onClose:a,onSubmit:s})=>{var S;const[n,r]=v.useState(!1),[i,l]=v.useState({firstName:"",lastName:"",email:"",phone:"",alternatePhone:"",currentLocation:"",preferredLocation:[],experience:{years:"",months:""},professionalExperience:[{company:"",designation:"",startDate:"",endDate:"",currentlyWorking:!1,responsibilities:"",achievements:"",technologies:[],ctc:"",reasonForLeaving:""}],currentCompany:"",currentDesignation:"",currentCTC:"",expectedCTC:"",noticePeriod:"",skills:[],education:[{degree:"",specialization:"",institution:"",passingYear:"",percentage:""}],resume:null}),[c,o]=v.useState(""),[d,x]=v.useState(""),m=k=>{const{name:F,value:R}=k.target;if(F.includes(".")){const[T,M]=F.split(".");l(X=>({...X,[T]:{...X[T],[M]:R}}))}else l(T=>({...T,[F]:R}))},h=(k,F,R)=>{const T=[...i.education];T[k][F]=R,l(M=>({...M,education:T}))},f=()=>{l(k=>({...k,education:[...k.education,{degree:"",specialization:"",institution:"",passingYear:"",percentage:""}]}))},g=k=>{i.education.length>1&&l(F=>({...F,education:F.education.filter((R,T)=>T!==k)}))},p=()=>{c.trim()&&!i.skills.includes(c.trim())&&(l(k=>({...k,skills:[...k.skills,c.trim()]})),o(""))},u=k=>{l(F=>({...F,skills:F.skills.filter(R=>R!==k)}))},j=()=>{d.trim()&&!i.preferredLocation.includes(d.trim())&&(l(k=>({...k,preferredLocation:[...k.preferredLocation,d.trim()]})),x(""))},y=k=>{l(F=>({...F,preferredLocation:F.preferredLocation.filter(R=>R!==k)}))},N=()=>{l(k=>({...k,professionalExperience:[...k.professionalExperience,{company:"",designation:"",startDate:"",endDate:"",currentlyWorking:!1,responsibilities:"",achievements:"",technologies:[],ctc:"",reasonForLeaving:""}]}))},w=k=>{l(F=>({...F,professionalExperience:F.professionalExperience.filter((R,T)=>T!==k)}))},D=(k,F,R)=>{l(T=>({...T,professionalExperience:T.professionalExperience.map((M,X)=>X===k?{...M,[F]:R}:M)}))},b=k=>{const F=k.target.files[0];if(F){if(F.type!=="application/pdf"){E.error("Please upload only PDF files");return}if(F.size>5*1024*1024){E.error("File size must be less than 5MB");return}l(R=>({...R,resume:F}))}},C=async k=>{if(k.preventDefault(),!i.firstName||!i.lastName||!i.email||!i.phone){E.error("Please fill in all required fields");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.email)){E.error("Please enter a valid email address");return}if(!/^[0-9]{10,15}$/.test(i.phone.replace(/[\s\-\(\)]/g,""))){E.error("Please enter a valid phone number (10-15 digits)");return}r(!0);try{const T=new FormData;console.log("Preparing form data:",i),T.append("firstName",i.firstName),T.append("lastName",i.lastName),T.append("email",i.email),T.append("phone",i.phone),T.append("alternatePhone",i.alternatePhone||""),T.append("currentLocation",i.currentLocation||""),T.append("preferredLocation",JSON.stringify(i.preferredLocation)),T.append("experience[years]",parseInt(i.experience.years)||0),T.append("experience[months]",parseInt(i.experience.months)||0);const M=i.professionalExperience.filter(K=>K.company&&K.designation);T.append("professionalExperience",JSON.stringify(M)),T.append("currentCompany",i.currentCompany||""),T.append("currentDesignation",i.currentDesignation||"");const X=parseFloat(i.currentCTC);!isNaN(X)&&X>0&&T.append("currentCTC",X);const q=parseFloat(i.expectedCTC);!isNaN(q)&&q>0&&T.append("expectedCTC",q);const B=parseInt(i.noticePeriod);!isNaN(B)&&B>=0&&T.append("noticePeriod",B),T.append("skills",JSON.stringify(i.skills)),T.append("education",JSON.stringify(i.education.filter(K=>K.degree&&K.institution))),i.resume&&(T.append("resume",i.resume),console.log("Resume file added:",i.resume.name)),console.log("FormData entries:");for(let[K,Q]of T.entries())console.log(K,typeof Q=="object"?"File":Q);await s(T)}catch{}finally{r(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-dark-900 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-dark-900 border-b border-gray-700 p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-white",children:["Apply for ",t.title]}),e.jsxs("p",{className:"text-gray-400 mt-1",children:[(S=t.department)==null?void 0:S.name," â€¢ ",t.location]})]}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-dark-800 rounded-lg transition-colors",children:e.jsx(Ee,{size:24,className:"text-gray-400"})})]}),e.jsxs("form",{onSubmit:C,className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center space-x-2",children:[e.jsx(ft,{size:20,className:"text-primary-400"}),e.jsx("span",{children:"Personal Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"First Name *"}),e.jsx("input",{type:"text",name:"firstName",value:i.firstName,onChange:m,className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",name:"lastName",value:i.lastName,onChange:m,className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email *"}),e.jsx("input",{type:"email",name:"email",value:i.email,onChange:m,className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Phone *"}),e.jsx("input",{type:"tel",name:"phone",value:i.phone,onChange:m,className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Alternate Phone"}),e.jsx("input",{type:"tel",name:"alternatePhone",value:i.alternatePhone,onChange:m,className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Current Location"}),e.jsx("input",{type:"text",name:"currentLocation",value:i.currentLocation,onChange:m,className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Preferred Locations"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:d,onChange:k=>x(k.target.value),onKeyPress:k=>k.key==="Enter"&&(k.preventDefault(),j()),placeholder:"Add location and press Enter",className:"flex-1 px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"}),e.jsx("button",{type:"button",onClick:j,className:"px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg",children:"Add"})]}),i.preferredLocation.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:i.preferredLocation.map((k,F)=>e.jsxs("span",{className:"inline-flex items-center space-x-1 bg-primary-900/30 text-primary-400 px-3 py-1 rounded-full text-sm",children:[e.jsx("span",{children:k}),e.jsx("button",{type:"button",onClick:()=>y(k),className:"hover:text-primary-300",children:e.jsx(Ee,{size:14})})]},F))})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center space-x-2",children:[e.jsx(at,{size:20,className:"text-primary-400"}),e.jsx("span",{children:"Professional Experience"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Total Experience (Years)"}),e.jsx("input",{type:"number",name:"experience.years",value:i.experience.years,onChange:m,min:"0",className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Additional Months"}),e.jsx("input",{type:"number",name:"experience.months",value:i.experience.months,onChange:m,min:"0",max:"11",className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Current Company"}),e.jsx("input",{type:"text",name:"currentCompany",value:i.currentCompany,onChange:m,className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Current Designation"}),e.jsx("input",{type:"text",name:"currentDesignation",value:i.currentDesignation,onChange:m,className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Current CTC (Annual)"}),e.jsx("input",{type:"number",name:"currentCTC",value:i.currentCTC,onChange:m,className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Expected CTC (Annual)"}),e.jsx("input",{type:"number",name:"expectedCTC",value:i.expectedCTC,onChange:m,className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Notice Period (Days)"}),e.jsx("input",{type:"number",name:"noticePeriod",value:i.noticePeriod,onChange:m,className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center space-x-2",children:[e.jsx(Ds,{size:20,className:"text-primary-400"}),e.jsx("span",{children:"Skills"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:c,onChange:k=>o(k.target.value),onKeyPress:k=>k.key==="Enter"&&(k.preventDefault(),p()),placeholder:"Add skill and press Enter",className:"flex-1 px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"}),e.jsx("button",{type:"button",onClick:p,className:"px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg",children:"Add"})]}),i.skills.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:i.skills.map((k,F)=>e.jsxs("span",{className:"inline-flex items-center space-x-1 bg-primary-900/30 text-primary-400 px-3 py-1 rounded-full text-sm",children:[e.jsx("span",{children:k}),e.jsx("button",{type:"button",onClick:()=>u(k),className:"hover:text-primary-300",children:e.jsx(Ee,{size:14})})]},F))})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center space-x-2",children:[e.jsx(at,{size:20,className:"text-primary-400"}),e.jsx("span",{children:"Detailed Work Experience"})]}),i.professionalExperience.map((k,F)=>e.jsxs("div",{className:"mb-4 p-4 bg-dark-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"text-white font-medium",children:["Experience ",F+1]}),i.professionalExperience.length>1&&e.jsx("button",{type:"button",onClick:()=>w(F),className:"text-red-400 hover:text-red-300",children:e.jsx(Ee,{size:18})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Company Name *"}),e.jsx("input",{type:"text",value:k.company,onChange:R=>D(F,"company",R.target.value),className:"w-full px-4 py-2 bg-dark-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Designation *"}),e.jsx("input",{type:"text",value:k.designation,onChange:R=>D(F,"designation",R.target.value),className:"w-full px-4 py-2 bg-dark-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:k.startDate,onChange:R=>D(F,"startDate",R.target.value),className:"w-full px-4 py-2 bg-dark-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:k.endDate,onChange:R=>D(F,"endDate",R.target.value),disabled:k.currentlyWorking,className:"w-full px-4 py-2 bg-dark-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500 disabled:opacity-50"})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("label",{className:"flex items-center space-x-2 text-sm text-gray-300",children:[e.jsx("input",{type:"checkbox",checked:k.currentlyWorking,onChange:R=>D(F,"currentlyWorking",R.target.checked),className:"rounded bg-dark-700 border-gray-600 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{children:"Currently working here"})]})}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Key Responsibilities"}),e.jsx("textarea",{value:k.responsibilities,onChange:R=>D(F,"responsibilities",R.target.value),rows:3,className:"w-full px-4 py-2 bg-dark-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Describe your key responsibilities..."})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Key Achievements"}),e.jsx("textarea",{value:k.achievements,onChange:R=>D(F,"achievements",R.target.value),rows:2,className:"w-full px-4 py-2 bg-dark-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Highlight your key achievements..."})]})]})]},F)),e.jsx("button",{type:"button",onClick:N,className:"w-full py-2 border-2 border-dashed border-gray-600 rounded-lg text-gray-400 hover:border-primary-500 hover:text-primary-400 transition-colors",children:"+ Add Another Experience"})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center space-x-2",children:[e.jsx(es,{size:20,className:"text-primary-400"}),e.jsx("span",{children:"Resume Upload"})]}),e.jsxs("div",{className:"border-2 border-dashed border-gray-600 rounded-lg p-6 text-center",children:[e.jsx("input",{type:"file",id:"resume-upload",accept:".pdf",onChange:b,className:"hidden"}),e.jsxs("label",{htmlFor:"resume-upload",className:"cursor-pointer flex flex-col items-center space-y-2",children:[e.jsx(es,{size:48,className:"text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:i.resume?i.resume.name:"Upload your resume"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"PDF files only, max 5MB"})]})]}),i.resume&&e.jsxs("div",{className:"mt-4 flex items-center justify-center space-x-2",children:[e.jsxs("span",{className:"text-green-400 text-sm",children:["âœ“ ",i.resume.name," (",(i.resume.size/1024/1024).toFixed(2)," MB)"]}),e.jsx("button",{type:"button",onClick:()=>l(k=>({...k,resume:null})),className:"text-red-400 hover:text-red-300",children:e.jsx(Ee,{size:16})})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center space-x-2",children:[e.jsx(yi,{size:20,className:"text-primary-400"}),e.jsx("span",{children:"Education"})]}),i.education.map((k,F)=>e.jsxs("div",{className:"mb-4 p-4 bg-dark-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"text-white font-medium",children:["Education ",F+1]}),i.education.length>1&&e.jsx("button",{type:"button",onClick:()=>g(F),className:"text-red-400 hover:text-red-300",children:e.jsx(Ee,{size:18})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Degree"}),e.jsx("input",{type:"text",value:k.degree,onChange:R=>h(F,"degree",R.target.value),className:"w-full px-4 py-2 bg-dark-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Specialization"}),e.jsx("input",{type:"text",value:k.specialization,onChange:R=>h(F,"specialization",R.target.value),className:"w-full px-4 py-2 bg-dark-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Institution"}),e.jsx("input",{type:"text",value:k.institution,onChange:R=>h(F,"institution",R.target.value),className:"w-full px-4 py-2 bg-dark-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Passing Year"}),e.jsx("input",{type:"number",value:k.passingYear,onChange:R=>h(F,"passingYear",R.target.value),className:"w-full px-4 py-2 bg-dark-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Percentage/CGPA"}),e.jsx("input",{type:"number",step:"0.01",value:k.percentage,onChange:R=>h(F,"percentage",R.target.value),className:"w-full px-4 py-2 bg-dark-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]})]})]},F)),e.jsx("button",{type:"button",onClick:f,className:"text-primary-400 hover:text-primary-300 text-sm font-medium",children:"+ Add Another Education"})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:a,className:"px-6 py-2 bg-dark-800 hover:bg-dark-700 text-white rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:n,className:"px-6 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition-colors flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:n?e.jsxs(e.Fragment,{children:[e.jsx(aa,{size:20,className:"animate-spin"}),e.jsx("span",{children:"Submitting..."})]}):e.jsx("span",{children:"Submit Application"})})]})]})]})})},Jh=({isOpen:t,onClose:a})=>{const[s,n]=v.useState(!1),[r,i]=v.useState({name:"",email:"",phone:"",desiredDepartment:"",desiredPosition:"",experience:{years:"",months:""},currentCompany:"",currentDesignation:"",currentCTC:"",expectedCTC:"",noticePeriod:"",skills:[],education:[{degree:"",specialization:"",institution:"",passingYear:"",percentage:""}],currentLocation:"",preferredLocation:[],comments:""}),[l,c]=v.useState(""),[o,d]=v.useState(""),x=is.apiBaseUrl,m=j=>{const{name:y,value:N}=j.target;if(y.includes(".")){const[w,D]=y.split(".");i(b=>({...b,[w]:{...b[w],[D]:N}}))}else i(w=>({...w,[y]:N}))},h=()=>{l.trim()&&!r.skills.includes(l.trim())&&(i(j=>({...j,skills:[...j.skills,l.trim()]})),c(""))},f=j=>{i(y=>({...y,skills:y.skills.filter(N=>N!==j)}))},g=()=>{o.trim()&&!r.preferredLocation.includes(o.trim())&&(i(j=>({...j,preferredLocation:[...j.preferredLocation,o.trim()]})),d(""))},p=j=>{i(y=>({...y,preferredLocation:y.preferredLocation.filter(N=>N!==j)}))},u=async j=>{var w,D;if(j.preventDefault(),!r.name||!r.email||!r.phone||!r.desiredDepartment||!r.desiredPosition){E.error("Please fill in all required fields");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email)){E.error("Please enter a valid email address");return}if(!/^[0-9]{10,15}$/.test(r.phone.replace(/[\s\-\(\)]/g,""))){E.error("Please enter a valid phone number (10-15 digits)");return}n(!0);try{const b={...r,experience:{years:parseInt(r.experience.years)||0,months:parseInt(r.experience.months)||0},currentCTC:parseFloat(r.currentCTC)||void 0,expectedCTC:parseFloat(r.expectedCTC)||void 0,noticePeriod:parseInt(r.noticePeriod)||void 0,education:r.education.filter(S=>S.degree&&S.institution)},C=await Ze.post(`${x}/public/jobs/talent-pool/submit`,b);E.success(C.data.message),a(),i({name:"",email:"",phone:"",desiredDepartment:"",desiredPosition:"",experience:{years:"",months:""},currentCompany:"",currentDesignation:"",currentCTC:"",expectedCTC:"",noticePeriod:"",skills:[],education:[{degree:"",specialization:"",institution:"",passingYear:"",percentage:""}],currentLocation:"",preferredLocation:[],comments:""})}catch(b){const C=((D=(w=b.response)==null?void 0:w.data)==null?void 0:D.message)||"Failed to submit resume";E.error(C)}finally{n(!1)}};return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-dark-900 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-dark-900 border-b border-gray-700 p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Submit Your Resume"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"We'll contact you when a suitable opportunity arises"})]}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-dark-800 rounded-lg transition-colors",children:e.jsx(Ee,{size:24,className:"text-gray-400"})})]}),e.jsxs("form",{onSubmit:u,className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Full Name *"}),e.jsx("input",{type:"text",name:"name",value:r.name,onChange:m,className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email *"}),e.jsx("input",{type:"email",name:"email",value:r.email,onChange:m,className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Phone *"}),e.jsx("input",{type:"tel",name:"phone",value:r.phone,onChange:m,className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Current Location"}),e.jsx("input",{type:"text",name:"currentLocation",value:r.currentLocation,onChange:m,className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Desired Position"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Department of Interest *"}),e.jsx("input",{type:"text",name:"desiredDepartment",value:r.desiredDepartment,onChange:m,placeholder:"e.g., Engineering, Sales, Marketing",className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Desired Position *"}),e.jsx("input",{type:"text",name:"desiredPosition",value:r.desiredPosition,onChange:m,placeholder:"e.g., Software Engineer, Sales Manager",className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Preferred Locations"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:o,onChange:j=>d(j.target.value),onKeyPress:j=>j.key==="Enter"&&(j.preventDefault(),g()),placeholder:"Add location and press Enter",className:"flex-1 px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"}),e.jsx("button",{type:"button",onClick:g,className:"px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg",children:"Add"})]}),r.preferredLocation.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:r.preferredLocation.map((j,y)=>e.jsxs("span",{className:"inline-flex items-center space-x-1 bg-primary-900/30 text-primary-400 px-3 py-1 rounded-full text-sm",children:[e.jsx("span",{children:j}),e.jsx("button",{type:"button",onClick:()=>p(j),className:"hover:text-primary-300",children:e.jsx(Ee,{size:14})})]},y))})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Professional Experience"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Years of Experience"}),e.jsx("input",{type:"number",name:"experience.years",value:r.experience.years,onChange:m,min:"0",className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Additional Months"}),e.jsx("input",{type:"number",name:"experience.months",value:r.experience.months,onChange:m,min:"0",max:"11",className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Current Company"}),e.jsx("input",{type:"text",name:"currentCompany",value:r.currentCompany,onChange:m,className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Current Designation"}),e.jsx("input",{type:"text",name:"currentDesignation",value:r.currentDesignation,onChange:m,className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Current CTC (Annual)"}),e.jsx("input",{type:"number",name:"currentCTC",value:r.currentCTC,onChange:m,className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Expected CTC (Annual)"}),e.jsx("input",{type:"number",name:"expectedCTC",value:r.expectedCTC,onChange:m,className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Notice Period (Days)"}),e.jsx("input",{type:"number",name:"noticePeriod",value:r.noticePeriod,onChange:m,className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Skills"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"text",value:l,onChange:j=>c(j.target.value),onKeyPress:j=>j.key==="Enter"&&(j.preventDefault(),h()),placeholder:"Add skill and press Enter",className:"flex-1 px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"}),e.jsx("button",{type:"button",onClick:h,className:"px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg",children:"Add"})]}),r.skills.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:r.skills.map((j,y)=>e.jsxs("span",{className:"inline-flex items-center space-x-1 bg-primary-900/30 text-primary-400 px-3 py-1 rounded-full text-sm",children:[e.jsx("span",{children:j}),e.jsx("button",{type:"button",onClick:()=>f(j),className:"hover:text-primary-300",children:e.jsx(Ee,{size:14})})]},y))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Additional Comments"}),e.jsx("textarea",{name:"comments",value:r.comments,onChange:m,rows:"4",placeholder:"Tell us more about yourself, your career goals, or any specific requirements...",className:"w-full px-4 py-2 bg-dark-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:a,className:"px-6 py-2 bg-dark-800 hover:bg-dark-700 text-white rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:s,className:"px-6 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition-colors flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:s?e.jsxs(e.Fragment,{children:[e.jsx(aa,{size:20,className:"animate-spin"}),e.jsx("span",{children:"Submitting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(es,{size:20}),e.jsx("span",{children:"Submit Resume"})]})})]})]})]})}):null},El=()=>{var K,Q;const[t,a]=v.useState([]),[s,n]=v.useState([]),[r,i]=v.useState(!0),[l,c]=v.useState(""),[o,d]=v.useState(""),[x,m]=v.useState(""),[h,f]=v.useState(""),[g,p]=v.useState(null),[u,j]=v.useState(!1),[y,N]=v.useState(!1),[w,D]=v.useState(null),b=is.apiBaseUrl;v.useEffect(()=>{C(),S()},[]),v.useEffect(()=>{k()},[t,l,o,x,h]);const C=async()=>{try{i(!0);const _=await Ze.get(`${b}/public/jobs`);a(_.data.data),n(_.data.data)}catch(_){console.error("Error fetching jobs:",_),E.error("Failed to load job postings")}finally{i(!1)}},S=async()=>{try{const _=await Ze.get(`${b}/public/jobs/stats`);D(_.data.data)}catch(_){console.error("Error fetching stats:",_)}},k=()=>{let _=[...t];l&&(_=_.filter(ne=>{var ie;return ne.title.toLowerCase().includes(l.toLowerCase())||ne.description.toLowerCase().includes(l.toLowerCase())||((ie=ne.department)==null?void 0:ie.name.toLowerCase().includes(l.toLowerCase()))})),o&&(_=_.filter(ne=>{var ie;return((ie=ne.department)==null?void 0:ie._id)===o})),x&&(_=_.filter(ne=>ne.location===x)),h&&(_=_.filter(ne=>ne.employmentType===h)),n(_)},F=_=>{p(_),j(!0)},R=async _=>{var ne,ie;try{const A=await Ze.post(`${b}/public/jobs/${g._id}/apply`,_,{headers:{"Content-Type":"multipart/form-data"}});E.success(A.data.message),j(!1),p(null)}catch(A){const P=((ie=(ne=A.response)==null?void 0:ne.data)==null?void 0:ie.message)||"Failed to submit application";throw E.error(P),A}},T=()=>{c(""),d(""),m(""),f("")},M=[...new Set(t.map(_=>_.department).filter(Boolean))],X=[...new Set(t.map(_=>_.location).filter(Boolean))],q=[...new Set(t.map(_=>_.employmentType).filter(Boolean))],B=l||o||x||h;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-dark-900 to-gray-900",children:[e.jsx("div",{className:"bg-gradient-to-r from-primary-600 to-primary-800 text-white py-20",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",children:"Join Our Team"}),e.jsx("p",{className:"text-xl md:text-2xl text-primary-100 mb-8",children:"Discover exciting career opportunities and grow with us"}),w&&e.jsxs("div",{className:"flex justify-center space-x-8 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold",children:w.totalJobs}),e.jsx("div",{className:"text-primary-200",children:"Open Positions"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold",children:((K=w.byDepartment)==null?void 0:K.length)||0}),e.jsx("div",{className:"text-primary-200",children:"Departments"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold",children:((Q=w.byLocation)==null?void 0:Q.length)||0}),e.jsx("div",{className:"text-primary-200",children:"Locations"})]})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 -mt-8",children:e.jsxs("div",{className:"bg-dark-800 rounded-lg shadow-xl p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"lg:col-span-2 relative",children:[e.jsx(rt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Search jobs...",value:l,onChange:_=>c(_.target.value),className:"w-full pl-10 pr-4 py-2 bg-dark-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("select",{value:o,onChange:_=>d(_.target.value),className:"px-4 py-2 bg-dark-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"All Departments"}),M.map(_=>e.jsx("option",{value:_._id,children:_.name},_._id))]}),e.jsxs("select",{value:x,onChange:_=>m(_.target.value),className:"px-4 py-2 bg-dark-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"All Locations"}),X.map(_=>e.jsx("option",{value:_,children:_},_))]}),e.jsxs("select",{value:h,onChange:_=>f(_.target.value),className:"px-4 py-2 bg-dark-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"",children:"All Types"}),q.map(_=>e.jsx("option",{value:_,children:_.split("-").map(ne=>ne.charAt(0).toUpperCase()+ne.slice(1)).join(" ")},_))]})]}),B&&e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("p",{className:"text-gray-400 text-sm",children:["Showing ",s.length," of ",t.length," jobs"]}),e.jsxs("button",{onClick:T,className:"flex items-center space-x-2 text-primary-400 hover:text-primary-300 text-sm",children:[e.jsx(Ee,{size:16}),e.jsx("span",{children:"Clear Filters"})]})]})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):s.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(at,{size:64,className:"mx-auto text-gray-600 mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No Jobs Found"}),e.jsx("p",{className:"text-gray-400",children:B?"Try adjusting your filters to see more results":"No job openings available at the moment. Check back soon!"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(_=>{var ne;return e.jsx("div",{className:"bg-dark-800 rounded-lg shadow-lg hover:shadow-xl transition-shadow duration-300 overflow-hidden border border-gray-700 hover:border-primary-500",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2 line-clamp-2",children:_.title}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-400 text-sm",children:[e.jsx(qs,{size:16}),e.jsx("span",{children:((ne=_.department)==null?void 0:ne.name)||"N/A"})]})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-gray-300 text-sm",children:[e.jsx(ea,{size:16,className:"text-primary-400"}),e.jsx("span",{children:_.location})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-300 text-sm",children:[e.jsx(Te,{size:16,className:"text-primary-400"}),e.jsx("span",{className:"capitalize",children:_.employmentType.split("-").join(" ")})]}),_.experience&&e.jsxs("div",{className:"flex items-center space-x-2 text-gray-300 text-sm",children:[e.jsx(at,{size:16,className:"text-primary-400"}),e.jsxs("span",{children:[_.experience.min,"-",_.experience.max," years"]})]})]}),e.jsx("p",{className:"text-gray-400 text-sm mb-4 line-clamp-3",children:_.description}),_.openings>1&&e.jsx("div",{className:"mb-4",children:e.jsxs("span",{className:"inline-block bg-primary-900/30 text-primary-400 text-xs px-3 py-1 rounded-full",children:[_.openings," Openings"]})}),e.jsx("button",{onClick:()=>F(_),className:"w-full bg-primary-600 hover:bg-primary-700 text-white font-semibold py-2 px-4 rounded-lg transition-colors duration-200",children:"Apply Now"})]})},_._id)})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsxs("div",{className:"bg-gradient-to-r from-primary-600 to-primary-800 rounded-lg p-8 text-center",children:[e.jsx(es,{size:48,className:"mx-auto text-white mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Didn't Find a Suitable Job?"}),e.jsx("p",{className:"text-primary-100 mb-6",children:"Submit your resume and we'll contact you when a matching opportunity becomes available"}),e.jsx("button",{onClick:()=>N(!0),className:"bg-white text-primary-600 hover:bg-primary-50 font-semibold py-3 px-8 rounded-lg transition-colors duration-200",children:"Submit Your Resume"})]})}),u&&g&&e.jsx(Kh,{job:g,onClose:()=>{j(!1),p(null)},onSubmit:R}),e.jsx(Jh,{isOpen:y,onClose:()=>N(!1)})]})},Qh=()=>{const[t,a]=v.useState("login"),[s,n]=v.useState(""),[r,i]=v.useState(null),[l,c]=v.useState(!1),[o,d]=v.useState(""),[x,m]=v.useState(""),[h,f]=v.useState({aadharFile:null,panFile:null,bankProofFile:null,bankName:"",accountNumber:"",ifscCode:"",accountHolderName:""}),[g,p]=v.useState({aadhar:!1,pan:!1,bankProof:!1}),u=async N=>{var w,D;N.preventDefault(),d(""),c(!0);try{const b=await Ze.post("http://localhost:5000/api/candidate-documents/public/validate",{candidateCode:s.trim()});b.data.success&&(i(b.data.data),a("upload"),f(C=>({...C,accountHolderName:b.data.data.name})))}catch(b){d(((D=(w=b.response)==null?void 0:w.data)==null?void 0:D.message)||"Invalid Candidate ID. Please check and try again.")}finally{c(!1)}},j=(N,w)=>{const D=N.target.files[0];if(D){if(D.size>5*1024*1024){d(`${w} file size should not exceed 5MB`);return}if(!["image/jpeg","image/jpg","image/png","application/pdf"].includes(D.type)){d(`${w} must be a PDF or image file (JPEG, JPG, PNG)`);return}f(C=>({...C,[w]:D})),d("")}},y=async N=>{var w,D;if(N.preventDefault(),d(""),m(""),c(!0),!h.aadharFile||!h.panFile||!h.bankProofFile){d("Please upload all required documents"),c(!1);return}if(!h.bankName||!h.accountNumber||!h.ifscCode||!h.accountHolderName){d("Please fill all bank details"),c(!1);return}try{const b=new FormData;b.append("candidateCode",s),b.append("aadhar",h.aadharFile),b.append("pan",h.panFile),b.append("bankProof",h.bankProofFile),b.append("bankDetails",JSON.stringify({bankName:h.bankName,accountNumber:h.accountNumber,ifscCode:h.ifscCode,accountHolderName:h.accountHolderName})),(await Ze.post("http://localhost:5000/api/candidate-documents/public/submit",b,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:S=>{const k=Math.round(S.loaded*100/S.total);console.log("Upload progress:",k)}})).data.success&&(m("Documents submitted successfully! You will receive a confirmation email shortly."),f({aadharFile:null,panFile:null,bankProofFile:null,bankName:"",accountNumber:"",ifscCode:"",accountHolderName:""}))}catch(b){d(((D=(w=b.response)==null?void 0:w.data)==null?void 0:D.message)||"Failed to submit documents. Please try again.")}finally{c(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-white to-purple-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"Onboarding Document Submission"}),e.jsx("p",{className:"text-gray-600",children:"Submit your documents to complete the onboarding process"})]}),t==="login"&&e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-indigo-100 rounded-full mb-4",children:e.jsx(Ue,{className:"w-8 h-8 text-indigo-600"})}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",children:"Enter Your Candidate ID"}),e.jsx("p",{className:"text-gray-600",children:"You received this ID in your onboarding email"})]}),e.jsxs("form",{onSubmit:u,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Candidate ID"}),e.jsx("input",{type:"text",value:s,onChange:N=>n(N.target.value.toUpperCase()),placeholder:"e.g., CAN00001",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-center text-lg font-mono",required:!0})]}),o&&e.jsxs("div",{className:"flex items-center gap-2 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:[e.jsx(st,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:o})]}),e.jsx("button",{type:"submit",disabled:l||!s,className:"w-full bg-indigo-600 text-white py-3 rounded-lg font-medium hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:l?e.jsxs(e.Fragment,{children:[e.jsx(cs,{className:"w-5 h-5 animate-spin"}),"Validating..."]}):"Continue"})]}),e.jsx("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Note:"})," Your Candidate ID was sent to your email when you were moved to onboarding. Please check your inbox."]})})]}),t==="upload"&&r&&e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[e.jsxs("div",{className:"mb-6 p-4 bg-indigo-50 border border-indigo-200 rounded-lg",children:[e.jsxs("h3",{className:"font-semibold text-indigo-900 mb-2",children:["Welcome, ",r.name,"!"]}),e.jsxs("p",{className:"text-sm text-indigo-700",children:[e.jsx("strong",{children:"Candidate ID:"})," ",r.candidateCode]}),e.jsxs("p",{className:"text-sm text-indigo-700",children:[e.jsx("strong",{children:"Email:"})," ",r.email]})]}),x&&e.jsxs("div",{className:"mb-6 flex items-center gap-2 p-4 bg-green-50 border border-green-200 rounded-lg text-green-700",children:[e.jsx(we,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:x})]}),o&&e.jsxs("div",{className:"mb-6 flex items-center gap-2 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:[e.jsx(st,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:o})]}),e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(Ue,{className:"w-5 h-5 text-indigo-600"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"Aadhar Card"}),e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:N=>j(N,"aadharFile"),className:"w-full text-sm text-gray-600 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100",required:!0}),h.aadharFile&&e.jsxs("p",{className:"mt-2 text-sm text-green-600 flex items-center gap-1",children:[e.jsx(we,{className:"w-4 h-4"}),h.aadharFile.name]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(ha,{className:"w-5 h-5 text-indigo-600"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"PAN Card"}),e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:N=>j(N,"panFile"),className:"w-full text-sm text-gray-600 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100",required:!0}),h.panFile&&e.jsxs("p",{className:"mt-2 text-sm text-green-600 flex items-center gap-1",children:[e.jsx(we,{className:"w-4 h-4"}),h.panFile.name]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(qs,{className:"w-5 h-5 text-indigo-600"}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"Bank Details"}),e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Name"}),e.jsx("input",{type:"text",value:h.bankName,onChange:N=>f(w=>({...w,bankName:N.target.value})),placeholder:"e.g., HDFC Bank",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Holder Name"}),e.jsx("input",{type:"text",value:h.accountHolderName,onChange:N=>f(w=>({...w,accountHolderName:N.target.value})),placeholder:"As per bank records",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Number"}),e.jsx("input",{type:"text",value:h.accountNumber,onChange:N=>f(w=>({...w,accountNumber:N.target.value})),placeholder:"Enter account number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"IFSC Code"}),e.jsx("input",{type:"text",value:h.ifscCode,onChange:N=>f(w=>({...w,ifscCode:N.target.value.toUpperCase()})),placeholder:"e.g., HDFC0001234",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bank Proof (Cancelled Cheque / Passbook)"}),e.jsx("input",{type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:N=>j(N,"bankProofFile"),className:"w-full text-sm text-gray-600 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100",required:!0}),h.bankProofFile&&e.jsxs("p",{className:"mt-2 text-sm text-green-600 flex items-center gap-1",children:[e.jsx(we,{className:"w-4 h-4"}),h.bankProofFile.name]})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"button",onClick:()=>{a("login"),i(null),d(""),m("")},className:"px-6 py-3 border border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50 transition-colors",children:"Back"}),e.jsx("button",{type:"submit",disabled:l,className:"flex-1 bg-indigo-600 text-white py-3 rounded-lg font-medium hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:l?e.jsxs(e.Fragment,{children:[e.jsx(cs,{className:"w-5 h-5 animate-spin"}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(es,{className:"w-5 h-5"}),"Submit Documents"]})})]})]}),e.jsx("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Important:"})," Please ensure all documents are clear and readable. Maximum file size: 5MB per file. Accepted formats: PDF, JPG, PNG."]})})]})]})})};is.apiBaseUrl;const Zh=async(t,a)=>(await Y.get(`/public/document-upload/validate/${t}`,{params:{tenantId:a}})).data,eu=async(t,a,s,n,r)=>{const i=new FormData;return i.append("document",n),i.append("tenantId",a),i.append("documentType",s),(await Y.post(`/public/document-upload/upload/${t}`,i,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:c=>{if(r){const o=Math.round(c.loaded*100/c.total);r(o)}}})).data},tu=async(t,a)=>(await Y.get(`/public/document-upload/documents/${t}`,{params:{tenantId:a}})).data,su=async t=>(await Y.get("/document-verification/candidates",{params:{status:t}})).data,au=async t=>(await Y.get(`/document-verification/candidates/${t}/documents`)).data,ru=async(t,a)=>(await Y.put(`/document-verification/documents/${t}/verify`,{remarks:a})).data,nu=async(t,a)=>(await Y.put(`/document-verification/documents/${t}/unverify`,{reason:a})).data,iu=async(t,a)=>(await Y.post("/document-verification/documents/bulk-verify",{documentIds:t,remarks:a})).data,lu=async t=>(await Y.get(`/document-verification/documents/${t}/download`,{responseType:"blob"})).data,cu=async()=>(await Y.get("/document-verification/stats")).data,ou=()=>{const{token:t}=$a(),[a]=a0(),s=a.get("tenantId"),[n,r]=v.useState(!0),[i,l]=v.useState(!1),[c,o]=v.useState(null),[d,x]=v.useState([]),[m,h]=v.useState([]),[f,g]=v.useState([]),[p,u]=v.useState({}),[j,y]=v.useState({});v.useEffect(()=>{t&&s?N():(E.error("Invalid upload link. Missing token or tenant ID."),r(!1))},[t,s]);const N=async()=>{var F,R;try{const T=await Zh(t,s);T.success?(l(!0),o(T.data.candidate),x(T.data.documentConfigurations||[]),h(T.data.uploadedDocuments||[]),g(T.data.rejectedDocuments||[])):E.error(T.message||"Invalid upload link")}catch(T){console.error("Token validation error:",T),E.error(((R=(F=T.response)==null?void 0:F.data)==null?void 0:R.message)||"Failed to validate upload link")}finally{r(!1)}},w=async(F,R)=>{var q,B;if(!R)return;const T=d.find(K=>K.documentType===F);if(!T){E.error("Invalid document type");return}if(R.size/(1024*1024)>T.maxFileSizeMB){E.error(`File size exceeds ${T.maxFileSizeMB}MB limit`);return}const X=R.name.split(".").pop().toLowerCase();if(!T.allowedFormats.includes(X)){E.error(`Invalid file format. Allowed: ${T.allowedFormats.join(", ")}`);return}y(K=>({...K,[F]:!0})),u(K=>({...K,[F]:0}));try{if((await eu(t,s,F,R,Q=>{u(_=>({..._,[F]:Q}))})).success){E.success("Document uploaded successfully");const Q=await tu(t,s);Q.success&&h(Q.data)}}catch(K){console.error("Upload error:",K),E.error(((B=(q=K.response)==null?void 0:q.data)==null?void 0:B.message)||"Failed to upload document")}finally{y(K=>({...K,[F]:!1})),u(K=>({...K,[F]:0}))}},D=F=>{const R=m.find(T=>T.documentType===F);return R?R.verificationStatus:null},b=F=>{const R=m.find(T=>T.documentType===F);return(R==null?void 0:R.fileName)||null},C=F=>{const R=f.find(T=>T.documentType===F);return(R==null?void 0:R.reason)||null},S=F=>{switch(F){case"verified":return e.jsx(we,{className:"w-5 h-5 text-green-500"});case"unverified":return e.jsx(ze,{className:"w-5 h-5 text-red-500"});case"resubmitted":return e.jsx(st,{className:"w-5 h-5 text-blue-500"});case"pending":return e.jsx(st,{className:"w-5 h-5 text-yellow-500"});default:return null}},k=F=>{switch(F){case"verified":return"Verified";case"unverified":return"Rejected";case"resubmitted":return"Re-submitted";case"pending":return"Pending Review";default:return"Not Uploaded"}};return n?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(cs,{className:"w-12 h-12 animate-spin text-indigo-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Validating upload link..."})]})}):i?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 py-8 px-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 mb-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Document Upload Portal"}),e.jsx("p",{className:"text-gray-600",children:"Upload your onboarding documents securely"})]}),e.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 rounded-xl p-6 text-white",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-indigo-100 text-sm",children:"Candidate ID"}),e.jsx("p",{className:"font-semibold text-lg",children:c==null?void 0:c.candidateId})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-indigo-100 text-sm",children:"Name"}),e.jsx("p",{className:"font-semibold text-lg",children:c==null?void 0:c.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-indigo-100 text-sm",children:"Email"}),e.jsx("p",{className:"font-semibold text-lg",children:c==null?void 0:c.email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-indigo-100 text-sm",children:"Position"}),e.jsx("p",{className:"font-semibold text-lg",children:c==null?void 0:c.position})]})]})})]}),f.length>0&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 rounded-lg p-6 mb-6",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(st,{className:"w-6 h-6 text-red-500 mt-0.5 mr-3"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Documents Requiring Re-submission"}),e.jsx("p",{className:"text-red-700 mb-3",children:"The following documents were rejected. Please review the reasons and re-upload corrected versions."}),e.jsx("ul",{className:"space-y-2",children:f.map((F,R)=>e.jsxs("li",{className:"text-red-700",children:[e.jsxs("strong",{children:[F.documentType.replace(/_/g," ").toUpperCase(),":"]})," ",F.reason]},R))})]})]})}),e.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-500 rounded-lg p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-2",children:"Upload Guidelines"}),e.jsxs("ul",{className:"text-blue-700 space-y-1 text-sm",children:[e.jsx("li",{children:"â€¢ Ensure all documents are clear and readable"}),e.jsx("li",{children:"â€¢ Upload documents in the correct format (PDF, JPG, PNG)"}),e.jsx("li",{children:"â€¢ File size should not exceed the specified limit"}),e.jsx("li",{children:"â€¢ Make sure all required information is visible"})]})]}),e.jsx("div",{className:"space-y-4",children:d.map(F=>{const R=D(F.documentType),T=b(F.documentType),M=C(F.documentType),X=j[F.documentType],q=p[F.documentType]||0;return e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ue,{className:"w-5 h-5 text-indigo-600"}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:[F.displayName,F.isMandatory&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]})]}),F.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:F.description}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Formats: ",F.allowedFormats.join(", ").toUpperCase()," | Max size: ",F.maxFileSizeMB,"MB"]}),F.uploadInstructions&&e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:F.uploadInstructions})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[R&&S(R),R&&e.jsx("span",{className:`text-sm font-medium ${R==="verified"?"text-green-600":R==="unverified"?"text-red-600":R==="resubmitted"?"text-blue-600":"text-yellow-600"}`,children:k(R)})]})]}),T&&e.jsx("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Uploaded:"})," ",T]})}),M&&e.jsx("div",{className:"bg-red-50 rounded-lg p-3 mb-3",children:e.jsxs("p",{className:"text-sm text-red-700",children:[e.jsx("strong",{children:"Rejection Reason:"})," ",M]})}),X?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Uploading..."}),e.jsxs("span",{className:"text-indigo-600 font-medium",children:[q,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-indigo-600 h-2 rounded-full transition-all duration-300",style:{width:`${q}%`}})})]}):e.jsxs("div",{children:[e.jsx("input",{type:"file",id:`file-${F.documentType}`,className:"hidden",accept:F.allowedFormats.map(B=>`.${B}`).join(","),onChange:B=>w(F.documentType,B.target.files[0])}),e.jsxs("label",{htmlFor:`file-${F.documentType}`,className:`flex items-center justify-center gap-2 px-4 py-2 rounded-lg cursor-pointer transition-colors ${R==="verified"?"bg-gray-100 text-gray-600 hover:bg-gray-200":"bg-indigo-600 text-white hover:bg-indigo-700"}`,children:[e.jsx(es,{className:"w-4 h-4"}),R?"Re-upload Document":"Upload Document"]})]})]},F.documentType)})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mt-6 text-center",children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"If you have any questions or need assistance, please contact our HR team."}),e.jsx("p",{className:"text-gray-500 text-xs mt-2",children:"This is a secure upload portal. Your documents are encrypted and stored safely."})]})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 max-w-md w-full text-center",children:[e.jsx(ze,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Invalid Upload Link"}),e.jsx("p",{className:"text-gray-600",children:"This upload link is invalid, expired, or has been revoked. Please contact HR for assistance."})]})})},du=()=>{var l,c,o,d,x,m,h,f,g,p,u,j;const[t,a]=v.useState(null),[s,n]=v.useState(!0);v.useEffect(()=>{r()},[]);const r=async()=>{try{const y=await Y.get("/dashboard/stats");a(y.data.data)}catch{E.error("Failed to load dashboard data")}finally{n(!1)}};if(s)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})});const i=[{title:"Total Employees",value:((l=t==null?void 0:t.employees)==null?void 0:l.total)||0,icon:Re,color:"bg-blue-500"},{title:"Active Employees",value:((c=t==null?void 0:t.employees)==null?void 0:c.active)||0,icon:Re,color:"bg-green-500"},{title:"On Leave Today",value:((o=t==null?void 0:t.employees)==null?void 0:o.onLeave)||0,icon:Fe,color:"bg-yellow-500"},{title:"Today Attendance",value:((d=t==null?void 0:t.attendance)==null?void 0:d.today)||0,icon:Te,color:"bg-purple-500"},{title:"Pending Payroll",value:((x=t==null?void 0:t.payroll)==null?void 0:x.pending)||0,icon:tt,color:"bg-red-500"},{title:"Active Jobs",value:((m=t==null?void 0:t.jobs)==null?void 0:m.active)||0,icon:at,color:"bg-indigo-500"},{title:"Total Assets",value:((h=t==null?void 0:t.assets)==null?void 0:h.total)||0,icon:Tt,color:"bg-pink-500"},{title:"Assigned Assets",value:((f=t==null?void 0:t.assets)==null?void 0:f.assigned)||0,icon:Tt,color:"bg-orange-500"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Dashboard"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Overview of your organization"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:i.map((y,N)=>e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-1",children:y.title}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:y.value})]}),e.jsx("div",{className:`${y.color} w-12 h-12 rounded-lg flex items-center justify-center`,children:e.jsx(y.icon,{size:24,className:"text-white"})})]})},N))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Employees by Department"}),e.jsx("div",{className:"space-y-3",children:(g=t==null?void 0:t.employeesByDepartment)==null?void 0:g.map((y,N)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-300",children:y.department}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-32 bg-dark-800 rounded-full h-2",children:e.jsx("div",{className:"bg-primary-600 h-2 rounded-full",style:{width:`${y.count/t.employees.active*100}%`}})}),e.jsx("span",{className:"text-white font-medium w-8 text-right",children:y.count})]})]},N))})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Recent Leave Requests"}),e.jsx("div",{className:"space-y-3",children:(p=t==null?void 0:t.recentLeaves)==null?void 0:p.map((y,N)=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-dark-800 last:border-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:y.employeeName}),e.jsx("p",{className:"text-sm text-gray-400 capitalize",children:y.leaveType})]}),e.jsx("span",{className:`badge ${y.status==="approved"?"badge-success":y.status==="pending"?"badge-warning":"badge-danger"}`,children:y.status})]},N))})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Attendance Trend (Last 7 Days)"}),e.jsx("div",{className:"h-64 flex items-end justify-between space-x-2",children:(j=(u=t==null?void 0:t.attendance)==null?void 0:u.trend)==null?void 0:j.map((y,N)=>e.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[e.jsxs("div",{className:"w-full space-y-1",children:[e.jsx("div",{className:"bg-green-600 rounded-t",style:{height:`${y.present/t.employees.active*200}px`},title:`Present: ${y.present}`}),e.jsx("div",{className:"bg-red-600",style:{height:`${y.absent/t.employees.active*200}px`},title:`Absent: ${y.absent}`})]}),e.jsx("span",{className:"text-xs text-gray-400 mt-2",children:new Date(y._id).toLocaleDateString("en-US",{weekday:"short"})})]},N))}),e.jsxs("div",{className:"flex items-center justify-center space-x-6 mt-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-600 rounded"}),e.jsx("span",{className:"text-sm text-gray-400",children:"Present"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-red-600 rounded"}),e.jsx("span",{className:"text-sm text-gray-400",children:"Absent"})]})]})]})]})},xu=({isOpen:t,onClose:a,onJobCreated:s,onJobUpdated:n,editingJob:r})=>{const[i,l]=v.useState({title:"",department:"",location:"",employmentType:"full-time",experience:{min:"",max:""},salary:{min:"",max:"",currency:"USD"},description:"",requirements:[""],responsibilities:[""],skills:[""],openings:1,closingDate:"",status:"draft"}),[c,o]=v.useState([]),[d,x]=v.useState(!1),[m,h]=v.useState({});v.useEffect(()=>{var w,D,b,C;t&&(f(),l(r?{title:r.title||"",department:((w=r.department)==null?void 0:w._id)||"",location:r.location||"",employmentType:r.employmentType||"full-time",experience:r.experience||{min:"",max:""},salary:r.salary||{min:"",max:"",currency:"USD"},description:r.description||"",requirements:((D=r.requirements)==null?void 0:D.length)>0?r.requirements:[""],responsibilities:((b=r.responsibilities)==null?void 0:b.length)>0?r.responsibilities:[""],skills:((C=r.skills)==null?void 0:C.length)>0?r.skills:[""],openings:r.openings||1,closingDate:r.closingDate?r.closingDate.split("T")[0]:"",status:r.status||"draft"}:{title:"",department:"",location:"",employmentType:"full-time",experience:{min:"",max:""},salary:{min:"",max:"",currency:"USD"},description:"",requirements:[""],responsibilities:[""],skills:[""],openings:1,closingDate:"",status:"draft"}))},[t,r]);const f=async()=>{var w,D;try{console.log("Fetching departments...");const b=await Y.get("/departments");console.log("Departments response:",b.data),o(b.data.data||[])}catch(b){console.error("Error fetching departments:",b),E.error(`Failed to load departments: ${((D=(w=b.response)==null?void 0:w.data)==null?void 0:D.message)||b.message}`)}},g=(w,D)=>{l(b=>({...b,[w]:D})),m[w]&&h(b=>({...b,[w]:""}))},p=(w,D,b)=>{l(C=>({...C,[w]:C[w].map((S,k)=>k===D?b:S)}))},u=w=>{l(D=>({...D,[w]:[...D[w],""]}))},j=(w,D)=>{i[w].length>1&&l(b=>({...b,[w]:b[w].filter((C,S)=>S!==D)}))},y=()=>{const w={};return i.title.trim()||(w.title="Job title is required"),i.department||(w.department="Department is required"),i.location.trim()||(w.location="Location is required"),i.description.trim()||(w.description="Description is required"),h(w),Object.keys(w).length===0},N=async w=>{var D,b;if(w.preventDefault(),!y()){E.error("Please fill in all required fields");return}x(!0);try{const C={...i,requirements:i.requirements.filter(k=>k.trim()!==""),responsibilities:i.responsibilities.filter(k=>k.trim()!==""),skills:i.skills.filter(k=>k.trim()!==""),experience:{min:i.experience.min?Number(i.experience.min):void 0,max:i.experience.max?Number(i.experience.max):void 0},salary:{min:i.salary.min?Number(i.salary.min):void 0,max:i.salary.max?Number(i.salary.max):void 0,currency:i.salary.currency},openings:Number(i.openings),closingDate:i.closingDate||void 0};let S;r?(S=await Y.put(`/jobs/${r._id}`,C),E.success("Job posting updated successfully"),n(S.data.data)):(S=await Y.post("/jobs",C),E.success("Job posting created successfully"),s(S.data.data)),a(),l({title:"",department:"",location:"",employmentType:"full-time",experience:{min:"",max:""},salary:{min:"",max:"",currency:"USD"},description:"",requirements:[""],responsibilities:[""],skills:[""],openings:1,closingDate:""})}catch(C){E.error(((b=(D=C.response)==null?void 0:D.data)==null?void 0:b.message)||`Failed to ${r?"update":"create"} job posting`)}finally{x(!1)}};return t?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-dark-900 rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-800",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:r?"Edit Job Posting":"Post New Job"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(Ee,{size:24})})]}),e.jsxs("form",{onSubmit:N,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Job Title *"}),e.jsx("input",{type:"text",value:i.title,onChange:w=>g("title",w.target.value),className:`input-field ${m.title?"border-red-500":""}`,placeholder:"e.g. Senior Software Developer"}),m.title&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Department *"}),e.jsxs("select",{value:i.department,onChange:w=>g("department",w.target.value),className:`input-field ${m.department?"border-red-500":""}`,children:[e.jsx("option",{value:"",children:"Select Department"}),c.length>0?c.map(w=>e.jsx("option",{value:w._id,children:w.name},w._id)):e.jsx("option",{value:"",disabled:!0,children:"No departments available - please create departments first"})]}),m.department&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.department})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Location *"}),e.jsx("input",{type:"text",value:i.location,onChange:w=>g("location",w.target.value),className:`input-field ${m.location?"border-red-500":""}`,placeholder:"e.g. New York, NY"}),m.location&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.location})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Employment Type"}),e.jsxs("select",{value:i.employmentType,onChange:w=>g("employmentType",w.target.value),className:"input-field",children:[e.jsx("option",{value:"full-time",children:"Full Time"}),e.jsx("option",{value:"part-time",children:"Part Time"}),e.jsx("option",{value:"contract",children:"Contract"}),e.jsx("option",{value:"intern",children:"Intern"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Openings"}),e.jsx("input",{type:"number",min:"1",value:i.openings,onChange:w=>g("openings",w.target.value),className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Closing Date"}),e.jsx("input",{type:"date",value:i.closingDate,onChange:w=>g("closingDate",w.target.value),className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status"}),e.jsxs("select",{value:i.status,onChange:w=>g("status",w.target.value),className:"input-field",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"on-hold",children:"On Hold"}),e.jsx("option",{value:"closed",children:"Closed"}),e.jsx("option",{value:"archived",children:"Archived"})]}),e.jsx("p",{className:"text-gray-400 text-xs mt-1",children:'Only "Active" jobs will be visible on the careers page'})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Min Experience (years)"}),e.jsx("input",{type:"number",min:"0",value:i.experience.min,onChange:w=>g("experience",{...i.experience,min:w.target.value}),className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Max Experience (years)"}),e.jsx("input",{type:"number",min:"0",value:i.experience.max,onChange:w=>g("experience",{...i.experience,max:w.target.value}),className:"input-field"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Min Salary"}),e.jsx("input",{type:"number",min:"0",value:i.salary.min,onChange:w=>g("salary",{...i.salary,min:w.target.value}),className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Max Salary"}),e.jsx("input",{type:"number",min:"0",value:i.salary.max,onChange:w=>g("salary",{...i.salary,max:w.target.value}),className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Currency"}),e.jsxs("select",{value:i.salary.currency,onChange:w=>g("salary",{...i.salary,currency:w.target.value}),className:"input-field",children:[e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"GBP",children:"GBP"}),e.jsx("option",{value:"INR",children:"INR"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Job Description *"}),e.jsx("textarea",{rows:4,value:i.description,onChange:w=>g("description",w.target.value),className:`input-field ${m.description?"border-red-500":""}`,placeholder:"Describe the role, team, and what the candidate will be doing..."}),m.description&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:m.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Requirements"}),i.requirements.map((w,D)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:w,onChange:b=>p("requirements",D,b.target.value),className:"input-field flex-1",placeholder:"e.g. Bachelor's degree in Computer Science"}),e.jsx("button",{type:"button",onClick:()=>j("requirements",D),className:"p-2 text-red-500 hover:bg-red-500/10 rounded-lg transition-colors",disabled:i.requirements.length===1,children:e.jsx(An,{size:20})})]},D)),e.jsxs("button",{type:"button",onClick:()=>u("requirements"),className:"flex items-center space-x-2 text-primary-500 hover:text-primary-400 transition-colors",children:[e.jsx(Pe,{size:16}),e.jsx("span",{children:"Add Requirement"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Responsibilities"}),i.responsibilities.map((w,D)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:w,onChange:b=>p("responsibilities",D,b.target.value),className:"input-field flex-1",placeholder:"e.g. Develop and maintain web applications"}),e.jsx("button",{type:"button",onClick:()=>j("responsibilities",D),className:"p-2 text-red-500 hover:bg-red-500/10 rounded-lg transition-colors",disabled:i.responsibilities.length===1,children:e.jsx(An,{size:20})})]},D)),e.jsxs("button",{type:"button",onClick:()=>u("responsibilities"),className:"flex items-center space-x-2 text-primary-500 hover:text-primary-400 transition-colors",children:[e.jsx(Pe,{size:16}),e.jsx("span",{children:"Add Responsibility"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Skills"}),i.skills.map((w,D)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:w,onChange:b=>p("skills",D,b.target.value),className:"input-field flex-1",placeholder:"e.g. React, Node.js, MongoDB"}),e.jsx("button",{type:"button",onClick:()=>j("skills",D),className:"p-2 text-red-500 hover:bg-red-500/10 rounded-lg transition-colors",disabled:i.skills.length===1,children:e.jsx(An,{size:20})})]},D)),e.jsxs("button",{type:"button",onClick:()=>u("skills"),className:"flex items-center space-x-2 text-primary-500 hover:text-primary-400 transition-colors",children:[e.jsx(Pe,{size:16}),e.jsx("span",{children:"Add Skill"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-dark-800",children:[e.jsx("button",{type:"button",onClick:a,className:"btn-outline",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:d,className:"btn-primary",children:d?"Creating...":"Create Job Posting"})]})]})]})}):null},Fl=()=>{const t=Ke(),a=ya(),[s,n]=v.useState([]),[r,i]=v.useState(!0),[l,c]=v.useState(""),[o,d]=v.useState("all"),[x,m]=v.useState(!1),[h,f]=v.useState(null);v.useEffect(()=>{g()},[]);const g=async()=>{try{const b=await Y.get("/jobs");n(b.data.data)}catch{E.error("Failed to load job postings")}finally{i(!1)}},p=b=>{n(C=>[b,...C]),m(!1)},u=b=>{n(C=>C.map(S=>S._id===b._id?b:S)),m(!1),f(null)},j=b=>{f(b),m(!0)},y=async b=>{var C,S;if(window.confirm("Are you sure you want to delete this job posting?"))try{await Y.delete(`/jobs/${b}`),n(k=>k.filter(F=>F._id!==b)),E.success("Job posting deleted successfully")}catch(k){E.error(((S=(C=k.response)==null?void 0:C.data)==null?void 0:S.message)||"Failed to delete job posting")}},N=async(b,C)=>{var S,k;try{const F=await Y.put(`/jobs/${b}/status`,{status:C});n(R=>R.map(T=>T._id===b?F.data.data:T)),E.success(`Job status updated to ${C}`)}catch(F){E.error(((k=(S=F.response)==null?void 0:S.data)==null?void 0:k.message)||"Failed to update job status")}},w=s.filter(b=>{const C=b.title.toLowerCase().includes(l.toLowerCase())||b.location.toLowerCase().includes(l.toLowerCase()),S=o==="all"||b.status===o;return C&&S}),D=b=>({active:"badge-success",draft:"badge-warning",closed:"badge-danger","on-hold":"badge-info",archived:"bg-gray-600 text-gray-300"})[b]||"badge-default";return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:a.pathname.includes("/hr/recruitment")?"w-12 h-12 border-4 border-[#A88BFF] border-t-transparent rounded-full animate-spin":"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",style:{backgroundColor:a.pathname.includes("/hr/recruitment")?"#1E1E2A":void 0},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Job Desk"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage job postings and positions"})]}),e.jsxs("button",{onClick:()=>m(!0),className:a.pathname.includes("/hr/recruitment")?"bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] text-white px-6 py-2.5 rounded-xl font-medium hover:shadow-lg transition-all flex items-center space-x-2":"btn-primary flex items-center space-x-2",children:[e.jsx(Pe,{size:20}),e.jsx("span",{children:"Post New Job"})]})]}),e.jsx("div",{className:a.pathname.includes("/hr/recruitment")?"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-800":"card",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(rt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",size:20}),e.jsx("input",{type:"text",placeholder:"Search jobs...",value:l,onChange:b=>c(b.target.value),className:a.pathname.includes("/hr/recruitment")?"w-full bg-[#1E1E2A] text-white pl-10 pr-4 py-2.5 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none transition-colors":"input-field pl-10"})]}),e.jsxs("select",{value:o,onChange:b=>d(b.target.value),className:a.pathname.includes("/hr/recruitment")?"bg-[#1E1E2A] text-white px-4 py-2.5 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none transition-colors md:w-48":"input-field md:w-48",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"closed",children:"Closed"}),e.jsx("option",{value:"on-hold",children:"On Hold"}),e.jsx("option",{value:"archived",children:"Archived"})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:w.map(b=>{var C,S,k;return e.jsxs("div",{className:a.pathname.includes("/hr/recruitment")?"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-800 hover:border-[#A88BFF] transition-all cursor-pointer":"card hover:border-primary-600 transition-colors cursor-pointer",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:a.pathname.includes("/hr/recruitment")?"w-12 h-12 bg-gradient-to-br from-[#A88BFF]/20 to-[#8B6FE8]/20 rounded-xl flex items-center justify-center":"w-12 h-12 bg-primary-600/20 rounded-lg flex items-center justify-center",children:e.jsx(at,{size:24,className:a.pathname.includes("/hr/recruitment")?"text-[#A88BFF]":"text-primary-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:b.title}),e.jsx("p",{className:"text-sm text-gray-400",children:(C=b.department)==null?void 0:C.name})]})]}),e.jsxs("select",{value:b.status,onChange:F=>N(b._id,F.target.value),className:`badge ${D(b.status)} cursor-pointer hover:opacity-80`,onClick:F=>F.stopPropagation(),style:{backgroundImage:"none"},children:[e.jsx("option",{value:"draft",className:"bg-gray-800 text-white",children:"Draft"}),e.jsx("option",{value:"active",className:"bg-gray-800 text-white",children:"Active"}),e.jsx("option",{value:"on-hold",className:"bg-gray-800 text-white",children:"On Hold"}),e.jsx("option",{value:"closed",className:"bg-gray-800 text-white",children:"Closed"}),e.jsx("option",{value:"archived",className:"bg-gray-800 text-white",children:"Archived"})]})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx("span",{className:"font-medium text-gray-300 w-24",children:"Location:"}),e.jsx("span",{children:b.location})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx("span",{className:"font-medium text-gray-300 w-24",children:"Type:"}),e.jsx("span",{className:"capitalize",children:b.employmentType})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx("span",{className:"font-medium text-gray-300 w-24",children:"Experience:"}),e.jsxs("span",{children:[(S=b.experience)==null?void 0:S.min,"-",(k=b.experience)==null?void 0:k.max," years"]})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx("span",{className:"font-medium text-gray-300 w-24",children:"Openings:"}),e.jsx("span",{children:b.openings})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx("span",{className:"font-medium text-gray-300 w-24",children:"Applications:"}),e.jsx("span",{children:b.applications})]})]}),e.jsxs("div",{className:a.pathname.includes("/hr/recruitment")?"flex items-center space-x-2 pt-4 border-t border-gray-700":"flex items-center space-x-2 pt-4 border-t border-dark-800",children:[e.jsxs("button",{onClick:()=>{a.pathname.includes("/hr/recruitment")?t(`/employee/hr/recruitment/${b._id}/applicants`):t(`/job-desk/${b._id}/applicants`)},className:a.pathname.includes("/hr/recruitment")?"flex-1 bg-[#1E1E2A] text-white text-sm py-2 rounded-xl border border-gray-700 hover:border-[#A88BFF] transition-all flex items-center justify-center space-x-1":"flex-1 btn-outline text-sm py-2 flex items-center justify-center space-x-1",children:[e.jsx(Rt,{size:16}),e.jsx("span",{children:"View"})]}),e.jsxs("button",{onClick:()=>j(b),className:a.pathname.includes("/hr/recruitment")?"flex-1 bg-[#1E1E2A] text-white text-sm py-2 rounded-xl border border-gray-700 hover:border-[#A88BFF] transition-all flex items-center justify-center space-x-1":"flex-1 btn-outline text-sm py-2 flex items-center justify-center space-x-1",children:[e.jsx(Is,{size:16}),e.jsx("span",{children:"Edit"})]}),e.jsx("button",{onClick:()=>y(b._id),className:a.pathname.includes("/hr/recruitment")?"bg-[#1E1E2A] text-red-400 text-sm py-2 px-3 rounded-xl border border-gray-700 hover:border-red-500 hover:bg-red-500/10 transition-all":"btn-outline text-sm py-2 px-3 text-red-500 hover:bg-red-500/10",children:e.jsx(ct,{size:16})})]})]},b._id)})}),w.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(at,{size:48,className:"mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No job postings found"})]}),e.jsx(xu,{isOpen:x,onClose:()=>{m(!1),f(null)},onJobCreated:p,onJobUpdated:u,editingJob:h})]})},Tl=({analysis:t,compact:a=!1})=>{if(!t||!t.isAnalyzed)return null;const{matchScore:s,skillsMatch:n,experienceMatch:r,keyHighlights:i,weaknesses:l,overallFit:c}=t,d=(m=>{const h={excellent:{bg:"bg-green-500/20",text:"text-green-400",label:"Excellent Fit"},good:{bg:"bg-blue-500/20",text:"text-blue-400",label:"Good Fit"},average:{bg:"bg-yellow-500/20",text:"text-yellow-400",label:"Average Fit"},poor:{bg:"bg-red-500/20",text:"text-red-400",label:"Poor Fit"}};return h[m]||h.average})(c),x=m=>m>=80?"text-green-400":m>=60?"text-blue-400":m>=40?"text-yellow-400":"text-red-400";return a?e.jsxs("div",{className:"mt-3 pt-3 border-t border-dark-800",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qn,{size:16,className:"text-primary-500"}),e.jsx("span",{className:"text-xs font-medium text-gray-400",children:"AI Match Score"})]}),e.jsxs("span",{className:`text-lg font-bold ${x(s)}`,children:[s,"%"]})]}),e.jsx("div",{className:"w-full bg-dark-800 rounded-full h-2 mb-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${s>=80?"bg-green-500":s>=60?"bg-blue-500":s>=40?"bg-yellow-500":"bg-red-500"}`,style:{width:`${s}%`}})}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:`px-2 py-1 rounded ${d.bg} ${d.text} font-medium`,children:d.label}),e.jsxs("span",{className:"text-gray-500",children:[(n==null?void 0:n.matchPercentage)||0,"% skills match"]})]}),i&&i.length>0&&e.jsx("div",{className:"mt-2 space-y-1",children:i.slice(0,2).map((m,h)=>e.jsxs("div",{className:"flex items-start space-x-1 text-xs text-gray-400",children:[e.jsx(we,{size:12,className:"text-green-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"line-clamp-1",children:m})]},h))})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-primary-600/20 rounded-lg",children:e.jsx(Jr,{size:24,className:"text-primary-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"AI Analysis"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Powered by intelligent matching"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-4xl font-bold ${x(s)}`,children:[s,"%"]}),e.jsx("div",{className:`px-3 py-1 rounded-lg ${d.bg} ${d.text} text-sm font-medium mt-1`,children:d.label})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Overall Match"}),e.jsxs("span",{className:`font-semibold ${x(s)}`,children:[s,"%"]})]}),e.jsx("div",{className:"w-full bg-dark-800 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full transition-all ${s>=80?"bg-gradient-to-r from-green-500 to-emerald-500":s>=60?"bg-gradient-to-r from-blue-500 to-cyan-500":s>=40?"bg-gradient-to-r from-yellow-500 to-orange-500":"bg-gradient-to-r from-red-500 to-pink-500"}`,style:{width:`${s}%`}})})]}),n&&e.jsxs("div",{className:"card bg-dark-800/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(co,{size:18,className:"text-blue-400"}),e.jsx("h4",{className:"font-semibold text-white",children:"Skills Analysis"})]}),e.jsxs("span",{className:`font-bold ${x(n.matchPercentage)}`,children:[n.matchPercentage,"%"]})]}),n.matched&&n.matched.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:"text-xs text-gray-500 mb-2 flex items-center",children:[e.jsx(we,{size:14,className:"mr-1 text-green-500"}),"Matched Skills (",n.matched.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.matched.map((m,h)=>e.jsx("span",{className:"px-2 py-1 bg-green-500/20 text-green-400 rounded text-xs font-medium",children:m},h))})]}),n.missing&&n.missing.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:"text-xs text-gray-500 mb-2 flex items-center",children:[e.jsx(ze,{size:14,className:"mr-1 text-red-500"}),"Missing Skills (",n.missing.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.missing.map((m,h)=>e.jsx("span",{className:"px-2 py-1 bg-red-500/20 text-red-400 rounded text-xs font-medium",children:m},h))})]}),n.additional&&n.additional.length>0&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-gray-500 mb-2 flex items-center",children:[e.jsx(Ds,{size:14,className:"mr-1 text-purple-500"}),"Additional Skills (",n.additional.length,")"]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.additional.slice(0,5).map((m,h)=>e.jsx("span",{className:"px-2 py-1 bg-purple-500/20 text-purple-400 rounded text-xs font-medium",children:m},h)),n.additional.length>5&&e.jsxs("span",{className:"px-2 py-1 bg-dark-700 text-gray-400 rounded text-xs",children:["+",n.additional.length-5," more"]})]})]})]}),r&&e.jsxs("div",{className:"card bg-dark-800/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ss,{size:18,className:"text-cyan-400"}),e.jsx("h4",{className:"font-semibold text-white",children:"Experience Match"})]}),e.jsxs("span",{className:`font-bold ${x(r.score)}`,children:[r.score,"%"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-xs",children:"Candidate"}),e.jsxs("p",{className:"text-white font-medium",children:[r.candidateYears," years"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-xs",children:"Required"}),e.jsxs("p",{className:"text-white font-medium",children:[r.requiredYears," years"]})]})]}),e.jsx("div",{className:"mt-2",children:r.isMatch?e.jsxs("span",{className:"text-xs text-green-400 flex items-center",children:[e.jsx(we,{size:14,className:"mr-1"}),"Experience requirement met"]}):e.jsxs("span",{className:"text-xs text-yellow-400 flex items-center",children:[e.jsx(Ct,{size:14,className:"mr-1"}),"Experience requirement not fully met"]})})]}),i&&i.length>0&&e.jsxs("div",{className:"card bg-dark-800/50",children:[e.jsxs("h4",{className:"font-semibold text-white mb-3 flex items-center",children:[e.jsx(we,{size:18,className:"mr-2 text-green-500"}),"Key Strengths"]}),e.jsx("ul",{className:"space-y-2",children:i.map((m,h)=>e.jsxs("li",{className:"flex items-start space-x-2 text-sm text-gray-300",children:[e.jsx("span",{className:"text-green-500 mt-1",children:"âœ“"}),e.jsx("span",{children:m})]},h))})]}),l&&l.length>0&&e.jsxs("div",{className:"card bg-dark-800/50",children:[e.jsxs("h4",{className:"font-semibold text-white mb-3 flex items-center",children:[e.jsx(Ct,{size:18,className:"mr-2 text-yellow-500"}),"Areas of Concern"]}),e.jsx("ul",{className:"space-y-2",children:l.map((m,h)=>e.jsxs("li",{className:"flex items-start space-x-2 text-sm text-gray-300",children:[e.jsx("span",{className:"text-yellow-500 mt-1",children:"âš "}),e.jsx("span",{children:m})]},h))})]})]})},Dl=()=>{const{jobId:t}=$a(),a=Ke(),s=ya(),[n,r]=v.useState([]),[i,l]=v.useState(null),[c,o]=v.useState(!0),[d,x]=v.useState(""),[m,h]=v.useState("all"),[f,g]=v.useState("all"),[p,u]=v.useState("date"),[j,y]=v.useState(!1),[N,w]=v.useState(null),[D,b]=v.useState({});v.useEffect(()=>{C(),S()},[t,m,f]);const C=async()=>{try{o(!0);const A=new URLSearchParams;m!=="all"&&A.append("stage",m),f!=="all"&&A.append("status",f),d&&A.append("search",d);const P=await Y.get(`/jobs/${t}/applicants?${A.toString()}`);let O=P.data.data;O=k(O,p),r(O),l(P.data.job)}catch(A){E.error("Failed to load applicants"),console.error(A)}finally{o(!1)}},S=async()=>{try{const A=await Y.get(`/ai-analysis/jobs/${t}/stats`);w(A.data.data)}catch(A){console.error("Failed to fetch analysis stats:",A)}},k=(A,P)=>{const O=[...A];switch(P){case"ai-score":return O.sort((I,J)=>{var le,ue;const te=((le=I.aiAnalysis)==null?void 0:le.matchScore)||0;return(((ue=J.aiAnalysis)==null?void 0:ue.matchScore)||0)-te});case"date":return O.sort((I,J)=>new Date(J.createdAt)-new Date(I.createdAt));case"name":return O.sort((I,J)=>`${I.firstName} ${I.lastName}`.localeCompare(`${J.firstName} ${J.lastName}`));default:return O}},F=async()=>{var A,P;if(window.confirm("Analyze all candidates for this job? This may take a few moments."))try{y(!0);const O=await Y.post(`/ai-analysis/jobs/${t}/analyze`);E.success(O.data.message),await C(),await S()}catch(O){E.error(((P=(A=O.response)==null?void 0:A.data)==null?void 0:P.message)||"Failed to analyze candidates"),console.error(O)}finally{y(!1)}},R=A=>{b(P=>({...P,[A]:!P[A]}))},T=()=>{C()},M=A=>{u(A),r(P=>k(P,A))},X=A=>({applied:"bg-blue-500/20 text-blue-400",screening:"bg-yellow-500/20 text-yellow-400",shortlisted:"bg-purple-500/20 text-purple-400","interview-scheduled":"bg-indigo-500/20 text-indigo-400","interview-completed":"bg-cyan-500/20 text-cyan-400","offer-extended":"bg-green-500/20 text-green-400","offer-accepted":"bg-emerald-500/20 text-emerald-400","offer-rejected":"bg-red-500/20 text-red-400","sent-to-onboarding":"bg-orange-500/20 text-orange-400",joined:"bg-teal-500/20 text-teal-400",rejected:"bg-gray-500/20 text-gray-400"})[A]||"bg-gray-500/20 text-gray-400",q=A=>({active:"badge-success",hired:"badge-info",rejected:"badge-danger",withdrawn:"badge-warning"})[A]||"badge-default",B=A=>{if(!A)return"N/A";const{years:P=0,months:O=0}=A;return P===0&&O===0?"Fresher":P===0?`${O} months`:O===0?`${P} years`:`${P}y ${O}m`},K=A=>A?new Date(A).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",Q=A=>{s.pathname.includes("/hr/recruitment")?a(`/employee/hr/recruitment/candidates/${A}/timeline`):a(`/candidates/${A}/timeline`)},_=async(A,P)=>{var O,I,J;if(P.stopPropagation(),!!window.confirm(`Send ${A.firstName} ${A.lastName} to comprehensive onboarding process?`))try{const te=await Y.post(`/candidates/${A._id}/send-to-onboarding`,{notes:"Candidate sent to onboarding from job application review"});E.success("Candidate successfully sent to onboarding!");const se=te.data.data.onboarding;E.success(`Onboarding record created: ${se.onboardingId}`,{duration:4e3}),C()}catch(te){const se=((I=(O=te.response)==null?void 0:O.data)==null?void 0:I.message)||"Failed to send candidate to onboarding";E.error(se),console.error("Onboarding error:",(J=te.response)==null?void 0:J.data)}},ne=A=>{const P=["interview-completed","offer-extended","offer-accepted"],O=A.stage!=="sent-to-onboarding",I=A.status==="active";return P.includes(A.stage)&&O&&I},ie=()=>{try{const P=[["Candidate Code","Name","Email","Phone","Current Location","Experience","Current Company","Current Designation","Expected CTC","Notice Period","Stage","Status","Applied On","Skills"].join(",")];n.forEach(se=>{const le=[se.candidateCode||"",`"${se.firstName} ${se.lastName}"`,se.email||"",se.phone||"",`"${se.currentLocation||""}"`,B(se.experience),`"${se.currentCompany||""}"`,`"${se.currentDesignation||""}"`,se.expectedCTC||"",se.noticePeriod!==void 0?se.noticePeriod:"",se.stage||"",se.status||"",K(se.createdAt),`"${se.skills?se.skills.join(", "):""}"`];P.push(le.join(","))});const O=P.join(`
`),I=new Blob([O],{type:"text/csv;charset=utf-8;"}),J=document.createElement("a"),te=URL.createObjectURL(I);J.setAttribute("href",te),J.setAttribute("download",`applicants_${(i==null?void 0:i.title)||"job"}_${new Date().toISOString().split("T")[0]}.csv`),J.style.visibility="hidden",document.body.appendChild(J),J.click(),document.body.removeChild(J),E.success("Applicants exported successfully!")}catch(A){E.error("Failed to export applicants"),console.error("Export error:",A)}};return c?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:s.pathname.includes("/hr/recruitment")?"w-12 h-12 border-4 border-[#A88BFF] border-t-transparent rounded-full animate-spin":"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",style:{backgroundColor:s.pathname.includes("/hr/recruitment")?"#1E1E2A":void 0},children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>{s.pathname.includes("/hr/recruitment")?a("/employee/hr/recruitment"):a("/job-desk")},className:s.pathname.includes("/hr/recruitment")?"bg-[#2A2A3A] text-white p-2 rounded-xl border border-gray-700 hover:border-[#A88BFF] transition-all":"btn-outline p-2",children:e.jsx(wt,{size:20})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white",children:[(i==null?void 0:i.title)||"Job"," - Applicants"]}),e.jsxs("p",{className:"text-gray-400 mt-1",children:[n.length," ",n.length===1?"applicant":"applicants"," found",N&&N.analyzed>0&&e.jsxs("span",{className:s.pathname.includes("/hr/recruitment")?"ml-2 text-[#A88BFF]":"ml-2 text-primary-500",children:["â€¢ ",N.analyzed," analyzed"]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:F,disabled:j,className:s.pathname.includes("/hr/recruitment")?"bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] text-white px-6 py-2.5 rounded-xl font-medium hover:shadow-lg transition-all flex items-center space-x-2 disabled:opacity-50":"btn-primary flex items-center space-x-2",children:j?e.jsxs(e.Fragment,{children:[e.jsx(aa,{size:18,className:"animate-spin"}),e.jsx("span",{children:"Analyzing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Jr,{size:18}),e.jsx("span",{children:"Analyze Candidates"})]})}),e.jsxs("button",{onClick:ie,className:s.pathname.includes("/hr/recruitment")?"bg-[#2A2A3A] text-white px-6 py-2.5 rounded-xl border border-gray-700 hover:border-[#A88BFF] transition-all flex items-center space-x-2 disabled:opacity-50":"btn-outline flex items-center space-x-2",disabled:n.length===0,children:[e.jsx(_t,{size:18}),e.jsx("span",{children:"Export"})]})]})]}),N&&N.analyzed>0&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"card bg-gradient-to-br from-primary-600/20 to-primary-800/20 border-primary-600/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Average Score"}),e.jsxs("p",{className:"text-2xl font-bold text-white mt-1",children:[N.averageScore,"%"]})]}),e.jsx(Zs,{size:32,className:"text-primary-500"})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-green-600/20 to-green-800/20 border-green-600/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Excellent Fit"}),e.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:N.fitDistribution.excellent})]}),e.jsx(Ss,{size:32,className:"text-green-500"})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-blue-600/20 to-blue-800/20 border-blue-600/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Good Fit"}),e.jsx("p",{className:"text-2xl font-bold text-white mt-1",children:N.fitDistribution.good})]}),e.jsx(qn,{size:32,className:"text-blue-500"})]})}),e.jsx("div",{className:"card bg-gradient-to-br from-purple-600/20 to-purple-800/20 border-purple-600/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Top Score"}),e.jsxs("p",{className:"text-2xl font-bold text-white mt-1",children:[N.topScore,"%"]})]}),e.jsx(Jr,{size:32,className:"text-purple-500"})]})})]}),e.jsx("div",{className:s.pathname.includes("/hr/recruitment")?"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-800":"card",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(rt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",size:20}),e.jsx("input",{type:"text",placeholder:"Search by name, email, or candidate code...",value:d,onChange:A=>x(A.target.value),onKeyPress:A=>A.key==="Enter"&&T(),className:s.pathname.includes("/hr/recruitment")?"w-full bg-[#1E1E2A] text-white pl-10 pr-4 py-2.5 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none transition-colors":"input-field pl-10"})]}),e.jsx("button",{onClick:T,className:s.pathname.includes("/hr/recruitment")?"bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] text-white px-6 py-2.5 rounded-xl font-medium hover:shadow-lg transition-all md:w-auto":"btn-primary md:w-auto",children:"Search"}),e.jsxs("select",{value:p,onChange:A=>M(A.target.value),className:s.pathname.includes("/hr/recruitment")?"bg-[#1E1E2A] text-white px-4 py-2.5 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none transition-colors md:w-48":"input-field md:w-48",children:[e.jsx("option",{value:"date",children:"Sort by Date"}),e.jsx("option",{value:"ai-score",children:"Sort by AI Score"}),e.jsx("option",{value:"name",children:"Sort by Name"})]}),e.jsxs("select",{value:m,onChange:A=>h(A.target.value),className:s.pathname.includes("/hr/recruitment")?"bg-[#1E1E2A] text-white px-4 py-2.5 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none transition-colors md:w-48":"input-field md:w-48",children:[e.jsx("option",{value:"all",children:"All Stages"}),e.jsx("option",{value:"applied",children:"Applied"}),e.jsx("option",{value:"screening",children:"Screening"}),e.jsx("option",{value:"shortlisted",children:"Shortlisted"}),e.jsx("option",{value:"interview-scheduled",children:"Interview Scheduled"}),e.jsx("option",{value:"interview-completed",children:"Interview Completed"}),e.jsx("option",{value:"offer-extended",children:"Offer Extended"}),e.jsx("option",{value:"offer-accepted",children:"Offer Accepted"}),e.jsx("option",{value:"offer-rejected",children:"Offer Rejected"}),e.jsx("option",{value:"joined",children:"Joined"}),e.jsx("option",{value:"rejected",children:"Rejected"})]}),e.jsxs("select",{value:f,onChange:A=>g(A.target.value),className:s.pathname.includes("/hr/recruitment")?"bg-[#1E1E2A] text-white px-4 py-2.5 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none transition-colors md:w-48":"input-field md:w-48",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"hired",children:"Hired"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"withdrawn",children:"Withdrawn"})]})]})}),n.length===0?e.jsxs("div",{className:s.pathname.includes("/hr/recruitment")?"bg-[#2A2A3A] rounded-2xl p-12 border border-gray-800 text-center":"card text-center py-12",children:[e.jsx(ft,{size:48,className:"mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No applicants found for this job posting"})]}):e.jsx("div",{className:"space-y-4",children:n.map(A=>{var P,O;return e.jsxs("div",{className:s.pathname.includes("/hr/recruitment")?"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-800 hover:border-[#A88BFF] transition-all cursor-pointer":"card hover:border-primary-600 transition-all cursor-pointer",onClick:()=>Q(A._id),children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[e.jsx("div",{className:s.pathname.includes("/hr/recruitment")?"w-12 h-12 bg-gradient-to-br from-[#A88BFF]/20 to-[#8B6FE8]/20 rounded-full flex items-center justify-center flex-shrink-0":"w-12 h-12 bg-primary-600/20 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(ft,{size:24,className:s.pathname.includes("/hr/recruitment")?"text-[#A88BFF]":"text-primary-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white truncate",children:[A.firstName," ",A.lastName]}),e.jsx("span",{className:`badge ${q(A.status)}`,children:A.status}),e.jsx("span",{className:`px-2 py-1 rounded-md text-xs font-medium ${X(A.stage)}`,children:A.stage.replace(/-/g," ")})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center text-gray-400",children:[e.jsx(ut,{size:14,className:"mr-2 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:A.email})]}),e.jsxs("div",{className:"flex items-center text-gray-400",children:[e.jsx(ts,{size:14,className:"mr-2 flex-shrink-0"}),e.jsx("span",{children:A.phone})]}),A.currentLocation&&e.jsxs("div",{className:"flex items-center text-gray-400",children:[e.jsx(ea,{size:14,className:"mr-2 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:A.currentLocation})]}),e.jsxs("div",{className:"flex items-center text-gray-400",children:[e.jsx(at,{size:14,className:"mr-2 flex-shrink-0"}),e.jsx("span",{children:B(A.experience)})]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 lg:gap-6 text-sm",children:[A.currentCompany&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-xs mb-1",children:"Current Company"}),e.jsx("p",{className:"text-white font-medium",children:A.currentCompany})]}),A.currentDesignation&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-xs mb-1",children:"Current Role"}),e.jsx("p",{className:"text-white font-medium",children:A.currentDesignation})]}),A.expectedCTC&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-xs mb-1",children:"Expected CTC"}),e.jsxs("p",{className:"text-white font-medium flex items-center",children:[e.jsx(tt,{size:14,className:"mr-1"}),A.expectedCTC.toLocaleString()]})]}),A.noticePeriod!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-xs mb-1",children:"Notice Period"}),e.jsxs("p",{className:"text-white font-medium flex items-center",children:[e.jsx(Te,{size:14,className:"mr-1"}),A.noticePeriod," days"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 lg:flex-col lg:space-x-0 lg:space-y-2",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-500 text-xs mb-1",children:"Applied On"}),e.jsxs("p",{className:"text-white text-sm font-medium flex items-center",children:[e.jsx(Fe,{size:14,className:"mr-1"}),K(A.createdAt)]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[((P=A.resume)==null?void 0:P.url)&&e.jsxs("a",{href:A.resume.url,target:"_blank",rel:"noopener noreferrer",onClick:I=>I.stopPropagation(),className:s.pathname.includes("/hr/recruitment")?"bg-[#1E1E2A] text-white text-sm py-2 px-4 rounded-xl border border-gray-700 hover:border-[#A88BFF] transition-all flex items-center space-x-2":"btn-outline text-sm py-2 px-4 flex items-center space-x-2",children:[e.jsx(Ue,{size:16}),e.jsx("span",{children:"Resume"})]}),ne(A)&&e.jsxs("button",{onClick:I=>_(A,I),className:s.pathname.includes("/hr/recruitment")?"bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] text-white text-sm py-2 px-4 rounded-xl font-medium hover:shadow-lg transition-all flex items-center space-x-2 whitespace-nowrap":"btn-primary text-sm py-2 px-4 flex items-center space-x-2 whitespace-nowrap",title:`Send ${A.firstName} ${A.lastName} to comprehensive onboarding process`,children:[e.jsx(ls,{size:16}),e.jsx("span",{children:"Send to Onboarding"})]})]})]})]}),A.skills&&A.skills.length>0&&e.jsxs("div",{className:s.pathname.includes("/hr/recruitment")?"mt-4 pt-4 border-t border-gray-700":"mt-4 pt-4 border-t border-dark-800",children:[e.jsx("p",{className:"text-gray-500 text-xs mb-2",children:"Skills"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[A.skills.slice(0,8).map((I,J)=>e.jsx("span",{className:s.pathname.includes("/hr/recruitment")?"px-2 py-1 bg-[#1E1E2A] text-gray-300 rounded-lg text-xs":"px-2 py-1 bg-dark-800 text-gray-300 rounded text-xs",children:I},J)),A.skills.length>8&&e.jsxs("span",{className:s.pathname.includes("/hr/recruitment")?"px-2 py-1 bg-[#1E1E2A] text-gray-400 rounded-lg text-xs":"px-2 py-1 bg-dark-800 text-gray-400 rounded text-xs",children:["+",A.skills.length-8," more"]})]})]}),((O=A.aiAnalysis)==null?void 0:O.isAnalyzed)&&e.jsxs("div",{children:[e.jsx(Tl,{analysis:A.aiAnalysis,compact:!0}),e.jsxs("button",{onClick:I=>{I.stopPropagation(),R(A._id)},className:s.pathname.includes("/hr/recruitment")?"mt-3 text-sm text-[#A88BFF] hover:text-[#8B6FE8] flex items-center space-x-1":"mt-3 text-sm text-primary-500 hover:text-primary-400 flex items-center space-x-1",children:[e.jsx(qn,{size:14}),e.jsxs("span",{children:[D[A._id]?"Hide":"View"," Detailed AI Insights"]})]}),D[A._id]&&e.jsx("div",{className:s.pathname.includes("/hr/recruitment")?"mt-4 pt-4 border-t border-gray-700":"mt-4 pt-4 border-t border-dark-800",children:e.jsx(Tl,{analysis:A.aiAnalysis,compact:!1})})]})]},A._id)})})]})},mu=({candidateId:t,onClose:a,onSuccess:s})=>{const[n,r]=v.useState({interviewType:"Technical",round:"",scheduledDate:"",scheduledTime:"",meetingPlatform:"Google Meet",meetingLink:"",interviewer:[]}),[i,l]=v.useState([]),[c,o]=v.useState(!1);v.useEffect(()=>{d()},[]);const d=async()=>{try{const f=await Y.get("/employees");l(f.data.data||[])}catch(f){console.error("Failed to fetch employees:",f)}},x=async f=>{var g,p;if(f.preventDefault(),!n.scheduledDate||!n.scheduledTime){E.error("Please fill in all required fields");return}try{o(!0),await Y.post(`/candidates/${t}/interview`,n),E.success("Interview scheduled successfully"),s()}catch(u){E.error(((p=(g=u.response)==null?void 0:g.data)==null?void 0:p.message)||"Failed to schedule interview")}finally{o(!1)}},m=f=>{const{name:g,value:p}=f.target;r(u=>({...u,[g]:p}))},h=f=>{const g=Array.from(f.target.selectedOptions,p=>p.value);r(p=>({...p,interviewer:g}))};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-900 rounded-lg border border-dark-800 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-dark-900 border-b border-dark-800 p-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Schedule Interview"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:24})})]}),e.jsxs("form",{onSubmit:x,className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Interview Type *"}),e.jsxs("select",{name:"interviewType",value:n.interviewType,onChange:m,className:"input-field",required:!0,children:[e.jsx("option",{value:"Technical",children:"Technical"}),e.jsx("option",{value:"HR",children:"HR"}),e.jsx("option",{value:"Managerial",children:"Managerial"}),e.jsx("option",{value:"Cultural Fit",children:"Cultural Fit"}),e.jsx("option",{value:"Final Round",children:"Final Round"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Round Name"}),e.jsx("input",{type:"text",name:"round",value:n.round,onChange:m,placeholder:"e.g., Round 1, First Technical Interview",className:"input-field"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[e.jsx(Fe,{size:16,className:"inline mr-2"}),"Date *"]}),e.jsx("input",{type:"date",name:"scheduledDate",value:n.scheduledDate,onChange:m,className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[e.jsx(Te,{size:16,className:"inline mr-2"}),"Time *"]}),e.jsx("input",{type:"time",name:"scheduledTime",value:n.scheduledTime,onChange:m,className:"input-field",required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[e.jsx(oo,{size:16,className:"inline mr-2"}),"Meeting Platform"]}),e.jsxs("select",{name:"meetingPlatform",value:n.meetingPlatform,onChange:m,className:"input-field",children:[e.jsx("option",{value:"Google Meet",children:"Google Meet"}),e.jsx("option",{value:"Microsoft Teams",children:"Microsoft Teams"}),e.jsx("option",{value:"Zoom",children:"Zoom"}),e.jsx("option",{value:"Phone",children:"Phone"}),e.jsx("option",{value:"In-Person",children:"In-Person"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Meeting Link"}),e.jsx("input",{type:"url",name:"meetingLink",value:n.meetingLink,onChange:m,placeholder:"https://meet.google.com/...",className:"input-field"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[e.jsx(Re,{size:16,className:"inline mr-2"}),"Assign Interviewer(s)"]}),e.jsx("select",{multiple:!0,value:n.interviewer,onChange:h,className:"input-field h-32",children:i.map(f=>e.jsxs("option",{value:f._id,children:[f.firstName," ",f.lastName," - ",f.designation||"N/A"]},f._id))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Hold Ctrl/Cmd to select multiple"})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t border-dark-800",children:[e.jsx("button",{type:"button",onClick:a,className:"btn-outline",disabled:c,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary flex items-center space-x-2",disabled:c,children:c?e.jsxs(e.Fragment,{children:[e.jsx(aa,{size:18,className:"animate-spin"}),e.jsx("span",{children:"Scheduling..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Fe,{size:18}),e.jsx("span",{children:"Schedule Interview"})]})})]})]})]})})},hu=({candidateId:t,interview:a,onClose:s,onSuccess:n})=>{const[r,i]=v.useState({feedback:a.feedback||"",rating:a.rating||0,decision:a.decision||"pending",notes:a.notes||"",status:"completed"}),[l,c]=v.useState(!1),[o,d]=v.useState(0),x=async f=>{var g,p;if(f.preventDefault(),!r.feedback||r.rating===0){E.error("Please provide feedback and rating");return}try{c(!0),await Y.put(`/candidates/${t}/interview/${a._id}/feedback`,r),E.success("Feedback submitted successfully"),n()}catch(u){E.error(((p=(g=u.response)==null?void 0:g.data)==null?void 0:p.message)||"Failed to submit feedback")}finally{c(!1)}},m=f=>{const{name:g,value:p}=f.target;i(u=>({...u,[g]:p}))},h=f=>{i(g=>({...g,rating:f}))};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-900 rounded-lg border border-dark-800 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-dark-900 border-b border-dark-800 p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Interview Feedback"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[a.interviewType," - ",new Date(a.scheduledDate).toLocaleDateString()]})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:24})})]}),e.jsxs("form",{onSubmit:x,className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Rating *"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[[1,2,3,4,5].map(f=>e.jsx("button",{type:"button",onClick:()=>h(f),onMouseEnter:()=>d(f),onMouseLeave:()=>d(0),className:"focus:outline-none transition-transform hover:scale-110",children:e.jsx(bi,{size:32,className:`${f<=(o||r.rating)?"text-yellow-500 fill-yellow-500":"text-gray-600"}`})},f)),e.jsx("span",{className:"ml-4 text-white font-semibold",children:r.rating>0?`${r.rating}/5`:"Not rated"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[e.jsx(Ba,{size:16,className:"inline mr-2"}),"Feedback Summary *"]}),e.jsx("textarea",{name:"feedback",value:r.feedback,onChange:m,rows:4,placeholder:"Provide detailed feedback about the candidate's performance...",className:"input-field resize-none",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Decision *"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>i(f=>({...f,decision:"selected"})),className:`p-4 rounded-lg border-2 transition-all ${r.decision==="selected"?"border-green-500 bg-green-500/20":"border-dark-800 hover:border-green-500/50"}`,children:[e.jsx(we,{size:24,className:`mx-auto mb-2 ${r.decision==="selected"?"text-green-500":"text-gray-400"}`}),e.jsx("p",{className:`text-sm font-medium ${r.decision==="selected"?"text-green-400":"text-gray-400"}`,children:"Selected"})]}),e.jsxs("button",{type:"button",onClick:()=>i(f=>({...f,decision:"rejected"})),className:`p-4 rounded-lg border-2 transition-all ${r.decision==="rejected"?"border-red-500 bg-red-500/20":"border-dark-800 hover:border-red-500/50"}`,children:[e.jsx(ze,{size:24,className:`mx-auto mb-2 ${r.decision==="rejected"?"text-red-500":"text-gray-400"}`}),e.jsx("p",{className:`text-sm font-medium ${r.decision==="rejected"?"text-red-400":"text-gray-400"}`,children:"Rejected"})]}),e.jsxs("button",{type:"button",onClick:()=>i(f=>({...f,decision:"on-hold"})),className:`p-4 rounded-lg border-2 transition-all ${r.decision==="on-hold"?"border-yellow-500 bg-yellow-500/20":"border-dark-800 hover:border-yellow-500/50"}`,children:[e.jsx(Te,{size:24,className:`mx-auto mb-2 ${r.decision==="on-hold"?"text-yellow-500":"text-gray-400"}`}),e.jsx("p",{className:`text-sm font-medium ${r.decision==="on-hold"?"text-yellow-400":"text-gray-400"}`,children:"On Hold"})]}),e.jsxs("button",{type:"button",onClick:()=>i(f=>({...f,decision:"pending"})),className:`p-4 rounded-lg border-2 transition-all ${r.decision==="pending"?"border-blue-500 bg-blue-500/20":"border-dark-800 hover:border-blue-500/50"}`,children:[e.jsx(Te,{size:24,className:`mx-auto mb-2 ${r.decision==="pending"?"text-blue-500":"text-gray-400"}`}),e.jsx("p",{className:`text-sm font-medium ${r.decision==="pending"?"text-blue-400":"text-gray-400"}`,children:"Pending"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Additional Notes"}),e.jsx("textarea",{name:"notes",value:r.notes,onChange:m,rows:3,placeholder:"Any additional observations or comments...",className:"input-field resize-none"})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t border-dark-800",children:[e.jsx("button",{type:"button",onClick:s,className:"btn-outline",disabled:l,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary flex items-center space-x-2",disabled:l,children:l?e.jsxs(e.Fragment,{children:[e.jsx(aa,{size:18,className:"animate-spin"}),e.jsx("span",{children:"Submitting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{size:18}),e.jsx("span",{children:"Submit Feedback"})]})})]})]})]})})},uu=({candidateId:t,hrCall:a,onClose:s,onSuccess:n})=>{const[r,i]=v.useState({status:(a==null?void 0:a.status)||"pending",scheduledDate:a!=null&&a.scheduledDate?new Date(a.scheduledDate).toISOString().split("T")[0]:"",completedDate:a!=null&&a.completedDate?new Date(a.completedDate).toISOString().split("T")[0]:"",summary:(a==null?void 0:a.summary)||"",decision:(a==null?void 0:a.decision)||"pending"}),[l,c]=v.useState(!1),o=async x=>{var m,h;if(x.preventDefault(),r.status==="completed"&&!r.summary){E.error("Please provide a summary for completed calls");return}try{c(!0);const f={...r};r.status==="completed"&&!r.completedDate&&(f.completedDate=new Date().toISOString().split("T")[0]),await Y.put(`/candidates/${t}/hr-call`,f),E.success("HR call updated successfully"),n()}catch(f){E.error(((h=(m=f.response)==null?void 0:m.data)==null?void 0:h.message)||"Failed to update HR call")}finally{c(!1)}},d=x=>{const{name:m,value:h}=x.target;i(f=>({...f,[m]:h}))};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-900 rounded-lg border border-dark-800 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-dark-900 border-b border-dark-800 p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"HR Call / Final Discussion"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Manage final HR discussion with candidate"})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:24})})]}),e.jsxs("form",{onSubmit:o,className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Call Status *"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>i(x=>({...x,status:"pending"})),className:`p-4 rounded-lg border-2 transition-all ${r.status==="pending"?"border-gray-500 bg-gray-500/20":"border-dark-800 hover:border-gray-500/50"}`,children:[e.jsx(Te,{size:24,className:`mx-auto mb-2 ${r.status==="pending"?"text-gray-400":"text-gray-600"}`}),e.jsx("p",{className:`text-sm font-medium ${r.status==="pending"?"text-gray-300":"text-gray-500"}`,children:"Pending"})]}),e.jsxs("button",{type:"button",onClick:()=>i(x=>({...x,status:"scheduled"})),className:`p-4 rounded-lg border-2 transition-all ${r.status==="scheduled"?"border-blue-500 bg-blue-500/20":"border-dark-800 hover:border-blue-500/50"}`,children:[e.jsx(Fe,{size:24,className:`mx-auto mb-2 ${r.status==="scheduled"?"text-blue-500":"text-gray-400"}`}),e.jsx("p",{className:`text-sm font-medium ${r.status==="scheduled"?"text-blue-400":"text-gray-400"}`,children:"Scheduled"})]}),e.jsxs("button",{type:"button",onClick:()=>i(x=>({...x,status:"completed"})),className:`p-4 rounded-lg border-2 transition-all ${r.status==="completed"?"border-green-500 bg-green-500/20":"border-dark-800 hover:border-green-500/50"}`,children:[e.jsx(we,{size:24,className:`mx-auto mb-2 ${r.status==="completed"?"text-green-500":"text-gray-400"}`}),e.jsx("p",{className:`text-sm font-medium ${r.status==="completed"?"text-green-400":"text-gray-400"}`,children:"Completed"})]})]})]}),r.status==="scheduled"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[e.jsx(Fe,{size:16,className:"inline mr-2"}),"Scheduled Date"]}),e.jsx("input",{type:"date",name:"scheduledDate",value:r.scheduledDate,onChange:d,className:"input-field"})]}),r.status==="completed"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[e.jsx(Fe,{size:16,className:"inline mr-2"}),"Completed Date"]}),e.jsx("input",{type:"date",name:"completedDate",value:r.completedDate,onChange:d,className:"input-field"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[e.jsx(ts,{size:16,className:"inline mr-2"}),"Call Summary ",r.status==="completed"&&"*"]}),e.jsx("textarea",{name:"summary",value:r.summary,onChange:d,rows:4,placeholder:"Provide a summary of the HR discussion...",className:"input-field resize-none",required:r.status==="completed"})]}),r.status==="completed"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Final Decision *"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>i(x=>({...x,decision:"move-to-onboarding"})),className:`p-4 rounded-lg border-2 transition-all ${r.decision==="move-to-onboarding"?"border-green-500 bg-green-500/20":"border-dark-800 hover:border-green-500/50"}`,children:[e.jsx(ls,{size:24,className:`mx-auto mb-2 ${r.decision==="move-to-onboarding"?"text-green-500":"text-gray-400"}`}),e.jsx("p",{className:`text-sm font-medium ${r.decision==="move-to-onboarding"?"text-green-400":"text-gray-400"}`,children:"Onboarding"})]}),e.jsxs("button",{type:"button",onClick:()=>i(x=>({...x,decision:"reject"})),className:`p-4 rounded-lg border-2 transition-all ${r.decision==="reject"?"border-red-500 bg-red-500/20":"border-dark-800 hover:border-red-500/50"}`,children:[e.jsx(ze,{size:24,className:`mx-auto mb-2 ${r.decision==="reject"?"text-red-500":"text-gray-400"}`}),e.jsx("p",{className:`text-sm font-medium ${r.decision==="reject"?"text-red-400":"text-gray-400"}`,children:"Reject"})]}),e.jsxs("button",{type:"button",onClick:()=>i(x=>({...x,decision:"on-hold"})),className:`p-4 rounded-lg border-2 transition-all ${r.decision==="on-hold"?"border-yellow-500 bg-yellow-500/20":"border-dark-800 hover:border-yellow-500/50"}`,children:[e.jsx(Te,{size:24,className:`mx-auto mb-2 ${r.decision==="on-hold"?"text-yellow-500":"text-gray-400"}`}),e.jsx("p",{className:`text-sm font-medium ${r.decision==="on-hold"?"text-yellow-400":"text-gray-400"}`,children:"On Hold"})]}),e.jsxs("button",{type:"button",onClick:()=>i(x=>({...x,decision:"pending"})),className:`p-4 rounded-lg border-2 transition-all ${r.decision==="pending"?"border-blue-500 bg-blue-500/20":"border-dark-800 hover:border-blue-500/50"}`,children:[e.jsx(Te,{size:24,className:`mx-auto mb-2 ${r.decision==="pending"?"text-blue-500":"text-gray-400"}`}),e.jsx("p",{className:`text-sm font-medium ${r.decision==="pending"?"text-blue-400":"text-gray-400"}`,children:"Pending"})]})]})]}),r.decision==="move-to-onboarding"&&e.jsx("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-green-400",children:"âœ“ Candidate will be moved to offer-accepted stage and can be moved to onboarding"})}),r.decision==="reject"&&e.jsx("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-red-400",children:"âš  Candidate will be marked as rejected"})}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t border-dark-800",children:[e.jsx("button",{type:"button",onClick:s,className:"btn-outline",disabled:l,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary flex items-center space-x-2",disabled:l,children:l?e.jsxs(e.Fragment,{children:[e.jsx(aa,{size:18,className:"animate-spin"}),e.jsx("span",{children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{size:18}),e.jsx("span",{children:"Save HR Call"})]})})]})]})]})})},_l=()=>{var w,D,b,C,S,k,F,R,T,M,X,q,B,K,Q,_,ne,ie,A,P,O,I,J,te,se,le,ue,be,H,De,re,Z,ee,ae,xe,fe,ve,Ae;const{candidateId:t}=$a(),a=Ke(),[s,n]=v.useState(null),[r,i]=v.useState([]),[l,c]=v.useState(!0),[o,d]=v.useState(!1),[x,m]=v.useState(!1),[h,f]=v.useState(!1),[g,p]=v.useState(null),[u,j]=v.useState(!1);v.useEffect(()=>{y()},[t]);const y=async()=>{try{c(!0);const[ye,He]=await Promise.all([Y.get(`/candidates/${t}`),Y.get(`/candidates/${t}/timeline`)]);n(ye.data.data);const _e=He.data.data;i({timeline:_e.timeline||[],interviews:_e.interviews||[],notifications:_e.notifications||{},hrCall:_e.hrCall||{},stage:_e.stage,status:_e.status})}catch(ye){E.error("Failed to load candidate data"),console.error(ye)}finally{c(!1)}},N=async(ye,He="")=>{var _e,Qe;try{j(!0),await Y.post(`/candidates/${t}/notification`,{type:ye,notes:He}),E.success("Notification sent successfully"),y()}catch(Je){E.error(((Qe=(_e=Je.response)==null?void 0:_e.data)==null?void 0:Qe.message)||"Failed to send notification")}finally{j(!1)}};return l?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(aa,{className:"w-12 h-12 text-primary-600 animate-spin"})}):s?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>a(-1),className:"btn-outline p-2",children:e.jsx(wt,{size:20})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white",children:[s.firstName," ",s.lastName]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Hiring Journey Timeline"})]})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Email"}),e.jsx("p",{className:"text-white font-medium",children:s.email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Phone"}),e.jsx("p",{className:"text-white font-medium",children:s.phone})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"Applied For"}),e.jsx("p",{className:"text-white font-medium",children:((w=s.appliedFor)==null?void 0:w.title)||"N/A"})]})]})}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-6",children:"Hiring Process"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-6 top-0 bottom-0 w-0.5 bg-dark-800"}),e.jsxs("div",{className:"space-y-8",children:[e.jsx(Ir,{icon:ut,title:"Interview Notification",color:"bg-blue-500",completed:((b=(D=r.notifications)==null?void 0:D.interviewEmail)==null?void 0:b.sent)||((S=(C=r.notifications)==null?void 0:C.interviewCall)==null?void 0:S.completed),children:e.jsxs("div",{className:"space-y-3",children:[!((F=(k=r.notifications)==null?void 0:k.interviewEmail)!=null&&F.sent)&&!((T=(R=r.notifications)==null?void 0:R.interviewCall)!=null&&T.completed)&&e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-3 mb-3",children:e.jsxs("p",{className:"text-sm text-blue-400 flex items-center",children:[e.jsx(st,{size:16,className:"mr-2"}),"Start by sending an email or marking the call as done to proceed with interview scheduling"]})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:()=>N("interviewEmail"),disabled:u||((X=(M=r.notifications)==null?void 0:M.interviewEmail)==null?void 0:X.sent),className:`btn-sm ${(B=(q=r.notifications)==null?void 0:q.interviewEmail)!=null&&B.sent?"btn-success":"btn-primary"}`,children:[e.jsx(ut,{size:16,className:"mr-2"}),(Q=(K=r.notifications)==null?void 0:K.interviewEmail)!=null&&Q.sent?"Email Sent":"Send Email"]}),e.jsxs("button",{onClick:()=>{const ye=prompt("Add call notes:");ye!==null&&N("interviewCall",ye)},disabled:u||((ne=(_=r.notifications)==null?void 0:_.interviewCall)==null?void 0:ne.completed),className:`btn-sm ${(A=(ie=r.notifications)==null?void 0:ie.interviewCall)!=null&&A.completed?"btn-success":"btn-outline"}`,children:[e.jsx(ts,{size:16,className:"mr-2"}),(O=(P=r.notifications)==null?void 0:P.interviewCall)!=null&&O.completed?"Call Done":"Mark Call Done"]})]}),((J=(I=r.notifications)==null?void 0:I.interviewEmail)==null?void 0:J.sent)&&r.notifications.interviewEmail.sentAt&&e.jsxs("p",{className:"text-sm text-gray-400",children:["Email sent on ",new Date(r.notifications.interviewEmail.sentAt).toLocaleString()]}),((se=(te=r.notifications)==null?void 0:te.interviewCall)==null?void 0:se.completed)&&r.notifications.interviewCall.completedAt&&e.jsxs("p",{className:"text-sm text-gray-400",children:["Call completed on ",new Date(r.notifications.interviewCall.completedAt).toLocaleString(),r.notifications.interviewCall.notes&&` - ${r.notifications.interviewCall.notes}`]})]})}),e.jsx(Ir,{icon:Fe,title:"Interview Scheduling",color:"bg-indigo-500",completed:((le=r.interviews)==null?void 0:le.length)>0,children:e.jsxs("div",{className:"space-y-3",children:[!((be=(ue=r.notifications)==null?void 0:ue.interviewEmail)!=null&&be.sent)&&e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-3 mb-3",children:e.jsxs("p",{className:"text-sm text-yellow-400 flex items-center",children:[e.jsx(st,{size:16,className:"mr-2"}),"Please send interview notification email before scheduling interviews"]})}),e.jsxs("button",{onClick:()=>d(!0),disabled:!((De=(H=r.notifications)==null?void 0:H.interviewEmail)!=null&&De.sent),className:`btn-sm ${(Z=(re=r.notifications)==null?void 0:re.interviewEmail)!=null&&Z.sent?"btn-primary":"btn-outline opacity-50 cursor-not-allowed"}`,children:[e.jsx(Fe,{size:16,className:"mr-2"}),"Schedule Interview"]}),(ee=r.interviews)==null?void 0:ee.map((ye,He)=>e.jsx("div",{className:"card bg-dark-800/50 p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("span",{className:"font-semibold text-white",children:ye.interviewType}),e.jsx("span",{className:`badge ${ye.status==="completed"?"badge-success":ye.status==="scheduled"?"badge-info":"badge-warning"}`,children:ye.status})]}),e.jsxs("div",{className:"text-sm text-gray-400 space-y-1",children:[e.jsxs("p",{children:[e.jsx(Fe,{size:14,className:"inline mr-2"}),new Date(ye.scheduledDate).toLocaleDateString()," at ",ye.scheduledTime]}),e.jsxs("p",{children:[e.jsx(oo,{size:14,className:"inline mr-2"}),ye.meetingPlatform]}),ye.meetingLink&&e.jsx("a",{href:ye.meetingLink,target:"_blank",rel:"noopener noreferrer",className:"text-primary-500 hover:underline",children:"Join Meeting"})]}),ye.feedback&&e.jsxs("div",{className:"mt-2 p-2 bg-dark-700 rounded",children:[e.jsx("p",{className:"text-sm text-gray-300",children:ye.feedback}),ye.rating&&e.jsx("div",{className:"flex items-center mt-1",children:[...Array(5)].map((_e,Qe)=>e.jsx(bi,{size:14,className:Qe<ye.rating?"text-yellow-500 fill-yellow-500":"text-gray-600"},Qe))})]})]}),(ye.status==="scheduled"||ye.status==="completed"&&!ye.feedback)&&e.jsx("button",{onClick:()=>{p(ye),m(!0)},className:`btn-sm ${ye.status==="completed"&&!ye.feedback?"btn-primary animate-pulse":"btn-outline"}`,children:ye.status==="completed"&&!ye.feedback?e.jsxs(e.Fragment,{children:[e.jsx(st,{size:14,className:"mr-1"}),"Add Feedback (Required)"]}):"Add Feedback"})]})},ye._id))]})}),e.jsx(Ir,{icon:ts,title:"HR Call / Final Discussion",color:"bg-purple-500",completed:((ae=r.hrCall)==null?void 0:ae.status)==="completed",children:e.jsxs("div",{className:"space-y-3",children:[(()=>{var He;return!((He=r.interviews)==null?void 0:He.some(_e=>_e.status==="completed"&&_e.feedback&&_e.rating))&&e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/30 rounded-lg p-3 mb-3",children:e.jsxs("p",{className:"text-sm text-yellow-400 flex items-center",children:[e.jsx(st,{size:16,className:"mr-2"}),"Please complete at least one interview and submit feedback before conducting HR call"]})})})(),e.jsxs("button",{onClick:()=>f(!0),disabled:!((xe=r.interviews)!=null&&xe.some(ye=>ye.status==="completed"&&ye.feedback&&ye.rating)),className:`btn-sm ${(fe=r.interviews)!=null&&fe.some(ye=>ye.status==="completed"&&ye.feedback&&ye.rating)?"btn-primary":"btn-outline opacity-50 cursor-not-allowed"}`,children:[e.jsx(ts,{size:16,className:"mr-2"}),((ve=r.hrCall)==null?void 0:ve.status)==="completed"?"Update HR Call":"Conduct HR Call"]}),r.hrCall&&r.hrCall.status!=="pending"&&e.jsxs("div",{className:"card bg-dark-800/50 p-4",children:[e.jsxs("p",{className:"text-sm text-gray-400",children:["Status: ",e.jsx("span",{className:"text-white capitalize",children:r.hrCall.status})]}),r.hrCall.summary&&e.jsx("p",{className:"text-sm text-gray-300 mt-2",children:r.hrCall.summary}),r.hrCall.decision&&r.hrCall.decision!=="pending"&&e.jsxs("p",{className:"text-sm mt-2",children:["Decision: ",e.jsx("span",{className:`font-semibold ${r.hrCall.decision==="move-to-onboarding"?"text-green-400":r.hrCall.decision==="reject"?"text-red-400":"text-yellow-400"}`,children:r.hrCall.decision.replace(/-/g," ").toUpperCase()})]})]})]})}),e.jsxs(Ir,{icon:s.status==="rejected"?ze:we,title:s.status==="rejected"?"Rejected":"Onboarding",color:s.status==="rejected"?"bg-red-500":"bg-green-500",completed:s.stage==="joined"||s.status==="rejected",children:[s.stage==="joined"&&e.jsx("p",{className:"text-green-400",children:"Candidate has been moved to onboarding"}),s.status==="rejected"&&e.jsx("p",{className:"text-red-400",children:"Candidate was rejected"})]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-6",children:"Activity Log"}),e.jsxs("div",{className:"space-y-4",children:[(Ae=r.timeline)==null?void 0:Ae.map((ye,He)=>e.jsxs("div",{className:"flex items-start space-x-4 pb-4 border-b border-dark-800 last:border-0",children:[e.jsx("div",{className:"w-2 h-2 bg-primary-500 rounded-full mt-2"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-white",children:ye.action}),e.jsx("p",{className:"text-sm text-gray-400",children:ye.description}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[new Date(ye.timestamp).toLocaleString(),ye.performedBy&&` â€¢ by ${ye.performedBy.firstName} ${ye.performedBy.lastName}`]})]})]},He)),(!r.timeline||r.timeline.length===0)&&e.jsx("p",{className:"text-gray-400 text-center py-4",children:"No activity recorded yet"})]})]}),o&&e.jsx(mu,{candidateId:t,onClose:()=>d(!1),onSuccess:()=>{d(!1),y()}}),x&&g&&e.jsx(hu,{candidateId:t,interview:g,onClose:()=>{m(!1),p(null)},onSuccess:()=>{m(!1),p(null),y()}}),h&&e.jsx(uu,{candidateId:t,hrCall:r.hrCall,onClose:()=>f(!1),onSuccess:()=>{f(!1),y()}})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-400",children:"Candidate not found"})})},Ir=({icon:t,title:a,color:s,completed:n,children:r})=>e.jsxs("div",{className:"relative flex items-start space-x-4",children:[e.jsx("div",{className:`relative z-10 flex items-center justify-center w-12 h-12 rounded-full ${s} ${!n&&"opacity-50"}`,children:e.jsx(t,{size:24,className:"text-white"})}),e.jsxs("div",{className:"flex-1 pb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:a}),r]})]}),Qo=()=>{const[t,a]=v.useState([]),[s,n]=v.useState(!0),[r,i]=v.useState(""),[l,c]=v.useState("all");v.useEffect(()=>{o()},[]);const o=async()=>{try{const h=await Y.get("/employees");a(h.data.data)}catch{E.error("Failed to load employees")}finally{n(!1)}},d=async h=>{if(window.confirm("Are you sure you want to delete this employee?"))try{await Y.delete(`/employees/${h}`),E.success("Employee deleted successfully"),o()}catch{E.error("Failed to delete employee")}},x=t.filter(h=>{const f=h.firstName.toLowerCase().includes(r.toLowerCase())||h.lastName.toLowerCase().includes(r.toLowerCase())||h.email.toLowerCase().includes(r.toLowerCase())||h.employeeCode.toLowerCase().includes(r.toLowerCase()),g=l==="all"||h.status===l;return f&&g}),m=h=>({active:"badge-success",inactive:"badge-default","on-leave":"badge-warning",terminated:"badge-danger"})[h]||"badge-default";return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Employees"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage your workforce"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(Ut,{to:"/employees/bulk-upload",className:"btn-outline flex items-center space-x-2",children:[e.jsx(es,{size:20}),e.jsx("span",{children:"Bulk Upload"})]}),e.jsxs(Ut,{to:"/employees/add",className:"btn-primary flex items-center space-x-2",children:[e.jsx(Pe,{size:20}),e.jsx("span",{children:"Add Employee"})]})]})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(rt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",size:20}),e.jsx("input",{type:"text",placeholder:"Search employees...",value:r,onChange:h=>i(h.target.value),className:"input-field pl-10"})]}),e.jsxs("select",{value:l,onChange:h=>c(h.target.value),className:"input-field md:w-48",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"on-leave",children:"On Leave"}),e.jsx("option",{value:"terminated",children:"Terminated"})]})]})}),e.jsx("div",{className:"card p-0",children:e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"min-w-[200px]",children:"Employee"}),e.jsx("th",{className:"min-w-[120px]",children:"Employee Code"}),e.jsx("th",{className:"min-w-[120px]",children:"Department"}),e.jsx("th",{className:"min-w-[120px]",children:"Designation"}),e.jsx("th",{className:"min-w-[200px]",children:"Email"}),e.jsx("th",{className:"min-w-[120px]",children:"Phone"}),e.jsx("th",{className:"min-w-[100px]",children:"Status"}),e.jsx("th",{className:"min-w-[120px]",children:"Actions"})]})}),e.jsx("tbody",{children:x.map(h=>{var f;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary-600 rounded-full flex items-center justify-center",children:e.jsxs("span",{className:"text-white font-medium",children:[h.firstName[0],h.lastName[0]]})}),e.jsx("div",{children:e.jsxs("p",{className:"font-medium text-white",children:[h.firstName," ",h.lastName]})})]})}),e.jsx("td",{children:h.employeeCode}),e.jsx("td",{children:((f=h.department)==null?void 0:f.name)||"N/A"}),e.jsx("td",{children:h.designation}),e.jsx("td",{children:h.email}),e.jsx("td",{children:h.phone}),e.jsx("td",{children:e.jsx("span",{className:`badge ${m(h.status)}`,children:h.status})}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ut,{to:`/employees/${h._id}`,className:"p-2 text-blue-400 hover:bg-dark-800 rounded",children:e.jsx(Rt,{size:16})}),e.jsx(Ut,{to:`/employees/${h._id}/edit`,className:"p-2 text-yellow-400 hover:bg-dark-800 rounded",children:e.jsx(Is,{size:16})}),e.jsx("button",{onClick:()=>d(h._id),className:"p-2 text-red-400 hover:bg-dark-800 rounded",children:e.jsx(ct,{size:16})})]})})]},h._id)})})]})})}),x.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-400",children:"No employees found"})})]})},pu=()=>{const t=Ke(),[a,s]=v.useState([]),[n,r]=v.useState(!1),[i,l]=v.useState({employeeCode:"",firstName:"",lastName:"",email:"",phone:"",dateOfBirth:"",gender:"male",bloodGroup:"",maritalStatus:"single",alternatePhone:"",address:{street:"",city:"",state:"",zipCode:"",country:""},department:"",designation:"",joiningDate:"",employmentType:"full-time",status:"active",salary:{basic:"",hra:"",allowances:"",deductions:"",total:""},bankDetails:{accountNumber:"",bankName:"",ifscCode:"",accountHolderName:"",branch:""},emergencyContact:{name:"",relationship:"",phone:""}});v.useEffect(()=>{c()},[]);const c=async()=>{try{const m=await Y.get("/departments");s(m.data.data)}catch{E.error("Failed to load departments")}},o=(m,h,f,g)=>{const p=parseFloat(m)||0,u=parseFloat(h)||0,j=parseFloat(f)||0,y=parseFloat(g)||0;return p+u+j-y},d=m=>{const{name:h,value:f}=m.target;if(h.includes(".")){const[g,p]=h.split(".");l(g==="salary"?u=>{const j={...u.salary,[p]:f},y=o(j.basic,j.hra,j.allowances,j.deductions);return{...u,salary:{...j,total:y.toString()}}}:u=>({...u,[g]:{...u[g],[p]:f}}))}else l(g=>({...g,[h]:f}))},x=async m=>{var f,g,p,u,j,y;if(m.preventDefault(),r(!0),!i.firstName||!i.lastName||!i.email||!i.phone||!i.department||!i.designation||!i.joiningDate){E.error("Please fill in all required fields"),r(!1);return}const h={...i,...i.employeeCode&&i.employeeCode.trim()?{employeeCode:i.employeeCode}:{},salary:{basic:parseFloat(i.salary.basic)||0,hra:parseFloat(i.salary.hra)||0,allowances:parseFloat(i.salary.allowances)||0,deductions:parseFloat(i.salary.deductions)||0,total:parseFloat(i.salary.total)||0}};try{const N=await Y.post("/employees",h);E.success("Employee added successfully"),console.log("Employee created:",N.data),t("/employees")}catch(N){console.error("Employee creation error details:",N),(g=(f=N.response)==null?void 0:f.data)!=null&&g.message?E.error(N.response.data.message):((p=N.response)==null?void 0:p.status)===400?E.error("Please check all required fields and try again"):((u=N.response)==null?void 0:u.status)===401?E.error("You are not authorized to add employees"):((j=N.response)==null?void 0:j.status)===403?E.error("Access denied. Admin or HR permissions required"):((y=N.response)==null?void 0:y.status)===500?E.error("Server error. Please check if MongoDB is running and properly connected."):E.error("Failed to add employee. Please try again."),console.error("Employee creation error:",N)}finally{r(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>t("/employees"),className:"p-2 hover:bg-dark-800 rounded-lg",children:e.jsx(wt,{size:20,className:"text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Add New Employee"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Fill in the employee details"})]})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("button",{onClick:()=>t("/employees/bulk-upload"),className:"btn-outline flex items-center space-x-2",title:"Bulk Upload Employees",children:[e.jsx(es,{size:20}),e.jsx("span",{children:"Bulk Upload"})]})})]}),e.jsxs("form",{onSubmit:x,className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Employee Code *"}),e.jsx("input",{type:"text",name:"employeeCode",value:i.employeeCode,onChange:d,className:"input-field",placeholder:"Leave blank for auto-generation"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"First Name *"}),e.jsx("input",{type:"text",name:"firstName",value:i.firstName,onChange:d,className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",name:"lastName",value:i.lastName,onChange:d,className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email *"}),e.jsx("input",{type:"email",name:"email",value:i.email,onChange:d,className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Phone *"}),e.jsx("input",{type:"tel",name:"phone",value:i.phone,onChange:d,className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Date of Birth (Optional)"}),e.jsx("input",{type:"date",name:"dateOfBirth",value:i.dateOfBirth,onChange:d,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Gender (Optional)"}),e.jsxs("select",{name:"gender",value:i.gender,onChange:d,className:"input-field",children:[e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Blood Group (Optional)"}),e.jsxs("select",{name:"bloodGroup",value:i.bloodGroup,onChange:d,className:"input-field",children:[e.jsx("option",{value:"",children:"Select Blood Group"}),e.jsx("option",{value:"A+",children:"A+"}),e.jsx("option",{value:"A-",children:"A-"}),e.jsx("option",{value:"B+",children:"B+"}),e.jsx("option",{value:"B-",children:"B-"}),e.jsx("option",{value:"AB+",children:"AB+"}),e.jsx("option",{value:"AB-",children:"AB-"}),e.jsx("option",{value:"O+",children:"O+"}),e.jsx("option",{value:"O-",children:"O-"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Marital Status (Optional)"}),e.jsxs("select",{name:"maritalStatus",value:i.maritalStatus,onChange:d,className:"input-field",children:[e.jsx("option",{value:"single",children:"Single"}),e.jsx("option",{value:"married",children:"Married"}),e.jsx("option",{value:"divorced",children:"Divorced"}),e.jsx("option",{value:"widowed",children:"Widowed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Alternate Phone (Optional)"}),e.jsx("input",{type:"tel",name:"alternatePhone",value:i.alternatePhone,onChange:d,className:"input-field"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Employment Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Department *"}),e.jsxs("select",{name:"department",value:i.department,onChange:d,className:"input-field",required:!0,children:[e.jsx("option",{value:"",children:"Select Department"}),a.map(m=>e.jsx("option",{value:m._id,children:m.name},m._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Designation *"}),e.jsx("input",{type:"text",name:"designation",value:i.designation,onChange:d,className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Joining Date *"}),e.jsx("input",{type:"date",name:"joiningDate",value:i.joiningDate,onChange:d,className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Employment Type (Optional)"}),e.jsxs("select",{name:"employmentType",value:i.employmentType,onChange:d,className:"input-field",children:[e.jsx("option",{value:"full-time",children:"Full Time"}),e.jsx("option",{value:"part-time",children:"Part Time"}),e.jsx("option",{value:"contract",children:"Contract"}),e.jsx("option",{value:"intern",children:"Intern"})]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Salary Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Basic Salary"}),e.jsx("input",{type:"number",name:"salary.basic",value:i.salary.basic,onChange:d,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"HRA"}),e.jsx("input",{type:"number",name:"salary.hra",value:i.salary.hra,onChange:d,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Allowances"}),e.jsx("input",{type:"number",name:"salary.allowances",value:i.salary.allowances,onChange:d,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Deductions"}),e.jsx("input",{type:"number",name:"salary.deductions",value:i.salary.deductions,onChange:d,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Total Salary (Auto-calculated)"}),e.jsx("input",{type:"number",name:"salary.total",value:i.salary.total,className:"input-field bg-gray-700 cursor-not-allowed",readOnly:!0})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Bank Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Account Number"}),e.jsx("input",{type:"text",name:"bankDetails.accountNumber",value:i.bankDetails.accountNumber,onChange:d,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Bank Name"}),e.jsx("input",{type:"text",name:"bankDetails.bankName",value:i.bankDetails.bankName,onChange:d,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"IFSC Code"}),e.jsx("input",{type:"text",name:"bankDetails.ifscCode",value:i.bankDetails.ifscCode,onChange:d,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Account Holder Name"}),e.jsx("input",{type:"text",name:"bankDetails.accountHolderName",value:i.bankDetails.accountHolderName,onChange:d,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Branch"}),e.jsx("input",{type:"text",name:"bankDetails.branch",value:i.bankDetails.branch,onChange:d,className:"input-field"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Emergency Contact"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Name"}),e.jsx("input",{type:"text",name:"emergencyContact.name",value:i.emergencyContact.name,onChange:d,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Relationship"}),e.jsx("input",{type:"text",name:"emergencyContact.relationship",value:i.emergencyContact.relationship,onChange:d,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Phone"}),e.jsx("input",{type:"tel",name:"emergencyContact.phone",value:i.emergencyContact.phone,onChange:d,className:"input-field"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>t("/employees"),className:"btn-outline",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:n,className:"btn-primary flex items-center space-x-2",children:[e.jsx(ds,{size:20}),e.jsx("span",{children:n?"Saving...":"Save Employee"})]})]})]})]})},fu=()=>{const{id:t}=$a(),a=Ke(),[s,n]=v.useState(!0),[r,i]=v.useState(!1),[l,c]=v.useState([]),[o,d]=v.useState({firstName:"",lastName:"",email:"",phone:"",employeeCode:"",designation:"",department:"",dateOfJoining:"",dateOfBirth:"",address:"",emergencyContact:"",status:"active",salary:"",bankAccount:"",panNumber:"",aadharNumber:""});v.useEffect(()=>{x(),m()},[t]);const x=async()=>{var g;try{const u=(await Y.get(`/employees/${t}`)).data.data;d({firstName:u.firstName||"",lastName:u.lastName||"",email:u.email||"",phone:u.phone||"",employeeCode:u.employeeCode||"",designation:u.designation||"",department:((g=u.department)==null?void 0:g._id)||"",dateOfJoining:u.dateOfJoining?new Date(u.dateOfJoining).toISOString().split("T")[0]:"",dateOfBirth:u.dateOfBirth?new Date(u.dateOfBirth).toISOString().split("T")[0]:"",address:u.address||"",emergencyContact:u.emergencyContact||"",status:u.status||"active",salary:u.salary||"",bankAccount:u.bankAccount||"",panNumber:u.panNumber||"",aadharNumber:u.aadharNumber||""})}catch{E.error("Failed to load employee details"),a("/employees")}finally{n(!1)}},m=async()=>{try{const g=await Y.get("/departments");c(g.data.data||[])}catch{console.error("Failed to load departments")}},h=async g=>{var p,u;g.preventDefault(),i(!0);try{await Y.put(`/employees/${t}`,o),E.success("Employee updated successfully"),a("/employees")}catch(j){E.error(((u=(p=j.response)==null?void 0:p.data)==null?void 0:u.message)||"Failed to update employee")}finally{i(!1)}},f=g=>{const{name:p,value:u}=g.target;d(j=>({...j,[p]:u}))};return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>a("/employees"),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx(wt,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Edit Employee"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Update employee information"})]})]})}),e.jsxs("form",{onSubmit:h,className:"space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white mb-4 flex items-center space-x-2",children:[e.jsx(ft,{size:20}),e.jsx("span",{children:"Personal Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"First Name *"}),e.jsx("input",{type:"text",name:"firstName",value:o.firstName,onChange:f,className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Last Name *"}),e.jsx("input",{type:"text",name:"lastName",value:o.lastName,onChange:f,className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Email *"}),e.jsx("input",{type:"email",name:"email",value:o.email,onChange:f,className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",value:o.phone,onChange:f,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Date of Birth"}),e.jsx("input",{type:"date",name:"dateOfBirth",value:o.dateOfBirth,onChange:f,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Emergency Contact"}),e.jsx("input",{type:"tel",name:"emergencyContact",value:o.emergencyContact,onChange:f,className:"input-field"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Address"}),e.jsx("textarea",{name:"address",value:o.address,onChange:f,rows:"3",className:"input-field"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white mb-4 flex items-center space-x-2",children:[e.jsx(at,{size:20}),e.jsx("span",{children:"Employment Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Employee Code *"}),e.jsx("input",{type:"text",name:"employeeCode",value:o.employeeCode,onChange:f,className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Designation *"}),e.jsx("input",{type:"text",name:"designation",value:o.designation,onChange:f,className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Department *"}),e.jsxs("select",{name:"department",value:o.department,onChange:f,className:"input-field",required:!0,children:[e.jsx("option",{value:"",children:"Select Department"}),l.map(g=>e.jsx("option",{value:g._id,children:g.name},g._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Date of Joining *"}),e.jsx("input",{type:"date",name:"dateOfJoining",value:o.dateOfJoining,onChange:f,className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Status"}),e.jsxs("select",{name:"status",value:o.status,onChange:f,className:"input-field",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"on-leave",children:"On Leave"}),e.jsx("option",{value:"terminated",children:"Terminated"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Salary"}),e.jsx("input",{type:"number",name:"salary",value:o.salary,onChange:f,className:"input-field",min:"0"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white mb-4 flex items-center space-x-2",children:[e.jsx(Nr,{size:20}),e.jsx("span",{children:"Financial Information"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Bank Account Number"}),e.jsx("input",{type:"text",name:"bankAccount",value:o.bankAccount,onChange:f,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"PAN Number"}),e.jsx("input",{type:"text",name:"panNumber",value:o.panNumber,onChange:f,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Aadhar Number"}),e.jsx("input",{type:"text",name:"aadharNumber",value:o.aadharNumber,onChange:f,className:"input-field"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>a("/employees"),className:"btn-outline",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:r,className:"btn-primary flex items-center space-x-2",children:[e.jsx(ds,{size:20}),e.jsx("span",{children:r?"Saving...":"Save Changes"})]})]})]})]})},gu=()=>{var c,o,d,x,m,h,f,g,p,u,j,y;const{id:t}=$a(),a=Ke(),[s,n]=v.useState(null),[r,i]=v.useState(!0);v.useEffect(()=>{l()},[t]);const l=async()=>{try{const N=await Y.get(`/employees/${t}`);n(N.data.data)}catch{E.error("Failed to load employee details"),a("/employees")}finally{i(!1)}};return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):s?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>a("/employees"),className:"p-2 hover:bg-dark-800 rounded-lg",children:e.jsx(wt,{size:20,className:"text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Employee Details"}),e.jsx("p",{className:"text-gray-400 mt-1",children:s.employeeCode})]})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-start space-x-6",children:[e.jsx("div",{className:"w-24 h-24 bg-primary-600 rounded-full flex items-center justify-center",children:e.jsxs("span",{className:"text-white font-bold text-3xl",children:[s.firstName[0],s.lastName[0]]})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h2",{className:"text-2xl font-bold text-white",children:[s.firstName," ",s.lastName]}),e.jsx("p",{className:"text-gray-400 mt-1",children:s.designation}),e.jsxs("div",{className:"flex items-center space-x-4 mt-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-gray-400",children:[e.jsx(ut,{size:16}),e.jsx("span",{children:s.email})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-gray-400",children:[e.jsx(ts,{size:16}),e.jsx("span",{children:s.phone})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx("span",{className:`badge ${s.status==="active"?"badge-success":s.status==="on-leave"?"badge-warning":"badge-danger"}`,children:s.status})})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center space-x-2",children:[e.jsx(at,{size:20}),e.jsx("span",{children:"Employment Information"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Department"}),e.jsx("p",{className:"text-white",children:((c=s.department)==null?void 0:c.name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Employment Type"}),e.jsx("p",{className:"text-white capitalize",children:s.employmentType})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Joining Date"}),e.jsx("p",{className:"text-white",children:new Date(s.joiningDate).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Reporting Manager"}),e.jsx("p",{className:"text-white",children:s.reportingManager?`${s.reportingManager.firstName} ${s.reportingManager.lastName}`:"N/A"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center space-x-2",children:[e.jsx(tt,{size:20}),e.jsx("span",{children:"Salary Information"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Basic Salary"}),e.jsxs("p",{className:"text-white",children:["$",((o=s.salary)==null?void 0:o.basic)||0]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"HRA"}),e.jsxs("p",{className:"text-white",children:["$",((d=s.salary)==null?void 0:d.hra)||0]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Allowances"}),e.jsxs("p",{className:"text-white",children:["$",((x=s.salary)==null?void 0:x.allowances)||0]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Total Salary"}),e.jsxs("p",{className:"text-white font-bold text-lg",children:["$",((m=s.salary)==null?void 0:m.total)||0]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center space-x-2",children:[e.jsx(Fe,{size:20}),e.jsx("span",{children:"Personal Information"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Date of Birth"}),e.jsx("p",{className:"text-white",children:s.dateOfBirth?new Date(s.dateOfBirth).toLocaleDateString():"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Gender"}),e.jsx("p",{className:"text-white capitalize",children:s.gender||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Address"}),e.jsxs("p",{className:"text-white",children:[((h=s.address)==null?void 0:h.street)&&`${s.address.street}, `,((f=s.address)==null?void 0:f.city)&&`${s.address.city}, `,((g=s.address)==null?void 0:g.state)&&`${s.address.state} `,(p=s.address)==null?void 0:p.zipCode]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center space-x-2",children:[e.jsx(ts,{size:20}),e.jsx("span",{children:"Emergency Contact"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Name"}),e.jsx("p",{className:"text-white",children:((u=s.emergencyContact)==null?void 0:u.name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Relationship"}),e.jsx("p",{className:"text-white",children:((j=s.emergencyContact)==null?void 0:j.relationship)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Phone"}),e.jsx("p",{className:"text-white",children:((y=s.emergencyContact)==null?void 0:y.phone)||"N/A"})]})]})]})]})]}):null},dr={preboarding:{label:"Pre-boarding",color:"bg-blue-500",icon:xo},offer_sent:{label:"Offer Sent",color:"bg-yellow-500",icon:ut},offer_accepted:{label:"Offer Accepted",color:"bg-green-500",icon:we},docs_pending:{label:"Documents Pending",color:"bg-orange-500",icon:Ue},docs_verified:{label:"Documents Verified",color:"bg-emerald-500",icon:pi},ready_for_joining:{label:"Ready for Joining",color:"bg-purple-500",icon:Fe},completed:{label:"Completed",color:"bg-green-600",icon:we},rejected:{label:"Rejected",color:"bg-red-500",icon:st}},Zo=({status:t})=>{const a=["preboarding","offer_sent","offer_accepted","docs_pending","docs_verified","ready_for_joining","completed"],s=a.indexOf(t),n=t==="rejected";return e.jsx("div",{className:"flex items-center space-x-2 mb-4",children:a.map((r,i)=>{const l=i<s||t==="completed",c=i===s&&!n,o=i===a.length-1,d=dr[r];return e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full transition-all duration-300 ${n?"bg-red-500 text-white":l?"bg-green-500 text-white":c?`${d.color} text-white animate-pulse`:"bg-gray-700 text-gray-400"}`,children:Hs.createElement(d.icon,{size:16})}),e.jsx("div",{className:`mt-1 text-xs font-medium text-center max-w-20 ${n?"text-red-400":l?"text-green-400":c?"text-blue-400":"text-gray-500"}`,children:d.label})]}),!o&&e.jsx("div",{className:`mx-2 h-0.5 w-12 transition-all duration-300 ${n?"bg-red-500":l?"bg-green-500":"bg-gray-700"}`})]},r)})})},yu=()=>{const[t,a]=v.useState("onboarding"),[s,n]=v.useState([]),[r,i]=v.useState(!1),[l,c]=v.useState(""),[o,d]=v.useState(""),[x,m]=v.useState(""),[h,f]=v.useState({}),[g,p]=v.useState(null),[u,j]=v.useState(!1),[y,N]=v.useState(!1),[w,D]=v.useState(null),[b,C]=v.useState(""),[S,k]=v.useState(null),[F,R]=v.useState([]),[T,M]=v.useState(!1),[X,q]=v.useState(!1),[B,K]=v.useState(null),[Q,_]=v.useState({status:"",category:"",search:""}),[ne,ie]=v.useState(!1),[A,P]=v.useState(null);v.useEffect(()=>{t==="onboarding"?O():t==="templates"&&De()},[t,l,o,x,Q]);const O=async()=>{var fe,ve,Ae,ye,He,_e,Qe,Je,dt;i(!0);try{const qe=new URLSearchParams;l&&qe.append("status",l),o&&qe.append("department",o),x&&qe.append("search",x),qe.append("_t",Date.now()),console.log("ðŸ” Fetching onboarding list with params:",qe.toString());const Ye=await Y.get(`/onboarding?${qe.toString()}`,{headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});console.log("ðŸ“¦ Onboarding API Response:",Ye==null?void 0:Ye.data),console.log("ðŸ“‹ Onboarding List Data:",(fe=Ye==null?void 0:Ye.data)==null?void 0:fe.data),console.log("ðŸ“Š List Length:",(Ae=(ve=Ye==null?void 0:Ye.data)==null?void 0:ve.data)==null?void 0:Ae.length),n(((ye=Ye==null?void 0:Ye.data)==null?void 0:ye.data)||[]),f(((He=Ye==null?void 0:Ye.data)==null?void 0:He.summary)||{}),((Qe=(_e=Ye==null?void 0:Ye.data)==null?void 0:_e.data)==null?void 0:Qe.length)===0&&console.warn("âš ï¸ No onboarding records returned from API")}catch(qe){console.error("âŒ Error fetching onboarding list:",qe),E.error(((dt=(Je=qe==null?void 0:qe.response)==null?void 0:Je.data)==null?void 0:dt.message)||"Failed to load onboarding list")}finally{i(!1)}},I=async(fe,ve,Ae="")=>{var ye,He;try{await Y.put(`/onboarding/${fe}/status`,{status:ve,notes:Ae}),E.success("Status updated successfully"),O()}catch(_e){E.error(((He=(ye=_e==null?void 0:_e.response)==null?void 0:ye.data)==null?void 0:He.message)||"Failed to update status")}},J=async(fe,ve)=>{var Ae,ye;try{await Y.post(`/onboarding/${fe}/send-offer`,ve),E.success("Offer sent successfully"),O()}catch(He){E.error(((ye=(Ae=He==null?void 0:He.response)==null?void 0:Ae.data)==null?void 0:ye.message)||"Failed to send offer")}},te=async(fe,ve,Ae=!0)=>{var ye,He;try{await Y.post(`/onboarding/${fe}/set-joining-date`,{joiningDate:ve,notifyTeams:Ae}),E.success("Joining date set and teams notified"),O()}catch(_e){E.error(((He=(ye=_e==null?void 0:_e.response)==null?void 0:ye.data)==null?void 0:He.message)||"Failed to set joining date")}},se=async fe=>{var ve,Ae;if(confirm("Are you sure you want to complete this onboarding? This will create an employee record."))try{await Y.post(`/onboarding/${fe}/complete`),E.success("Onboarding completed successfully"),O()}catch(ye){E.error(((Ae=(ve=ye==null?void 0:ye.response)==null?void 0:ve.data)==null?void 0:Ae.message)||"Failed to complete onboarding")}},le=async fe=>{var ve,Ae;try{const ye=await Y.post(`/onboarding/${fe}/request-documents`);E.success(`Document request email sent to ${ye.data.data.sentTo}`)}catch(ye){E.error(((Ae=(ve=ye==null?void 0:ye.response)==null?void 0:ve.data)==null?void 0:Ae.message)||"Failed to send document request")}},ue=async fe=>{k(fe);try{const ve=await Y.put(`/onboarding/${g._id}/documents/${fe}/verify`,{action:"approve",notes:"Document verified and accepted"});if(ve.data.success){if(E.success("Document accepted successfully!"),O(),g){const Ae=s.find(ye=>ye._id===g._id);p(Ae)}}else E.error(ve.data.message||"Failed to accept document")}catch(ve){console.error("Error accepting document:",ve),E.error("Failed to accept document")}finally{k(null)}},be=fe=>{D(fe),C(""),N(!0)},H=async()=>{if(!b.trim()){E.error("Please provide a reason for rejection");return}k(w._id);try{const fe=await Y.put(`/onboarding/${g._id}/documents/${w._id}/verify`,{action:"reject",notes:b});if(fe.data.success){if(E.success("Document rejected and email sent to candidate"),N(!1),D(null),C(""),O(),g){const ve=s.find(Ae=>Ae._id===g._id);p(ve)}}else E.error(fe.data.message||"Failed to reject document")}catch(fe){console.error("Error rejecting document:",fe),E.error("Failed to reject document")}finally{k(null)}},De=async()=>{M(!0);try{const fe=new URLSearchParams;Q.status&&fe.append("status",Q.status),Q.category&&fe.append("category",Q.category),Q.search&&fe.append("search",Q.search);const ve=await Y.get(`/offer-templates?${fe.toString()}`);R(ve.data.data||[])}catch(fe){E.error("Failed to load offer templates"),console.error(fe)}finally{M(!1)}},re=async fe=>{var ve,Ae;try{B?(await Y.put(`/offer-templates/${B._id}`,fe),E.success("Template updated successfully")):(await Y.post("/offer-templates",fe),E.success("Template created successfully")),q(!1),K(null),De()}catch(ye){E.error(((Ae=(ve=ye==null?void 0:ye.response)==null?void 0:ve.data)==null?void 0:Ae.message)||"Failed to save template")}},Z=async fe=>{if(confirm("Are you sure you want to delete this template?"))try{await Y.delete(`/offer-templates/${fe}`),E.success("Template deleted successfully"),De()}catch{E.error("Failed to delete template")}},ee=async fe=>{try{const ve={...fe,name:`${fe.name} (Copy)`,isDefault:!1};delete ve._id,delete ve.createdAt,delete ve.updatedAt,await Y.post("/offer-templates",ve),E.success("Template duplicated successfully"),De()}catch{E.error("Failed to duplicate template")}},ae=async(fe,ve)=>{try{await Y.put(`/offer-templates/${fe}/status`,{status:ve}),E.success(`Template ${ve==="active"?"activated":"deactivated"} successfully`),De()}catch{E.error("Failed to update template status")}},xe=s;return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Employee Onboarding"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage comprehensive candidate onboarding process"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[t==="onboarding"&&h.overdue>0&&e.jsxs("div",{className:"flex items-center space-x-2 px-3 py-2 bg-red-900/20 border border-red-800 rounded-lg",children:[e.jsx(st,{size:16,className:"text-red-400"}),e.jsxs("span",{className:"text-sm text-red-400",children:[h.overdue," Overdue"]})]}),t==="onboarding"&&e.jsxs("span",{className:"text-sm text-gray-400",children:["Total: ",h.total||0]}),t==="templates"&&e.jsxs("button",{onClick:()=>{K(null),q(!0)},className:"btn-primary flex items-center space-x-2",children:[e.jsx(Pe,{size:18}),e.jsx("span",{children:"Create Template"})]})]})]}),e.jsx("div",{className:"card p-1",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>a("onboarding"),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-colors ${t==="onboarding"?"bg-primary-600 text-white":"text-gray-400 hover:text-white hover:bg-dark-700"}`,children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(Re,{size:18}),e.jsx("span",{children:"Onboarding List"})]})}),e.jsx("button",{onClick:()=>a("templates"),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-colors ${t==="templates"?"bg-primary-600 text-white":"text-gray-400 hover:text-white hover:bg-dark-700"}`,children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(un,{size:18}),e.jsx("span",{children:"Offer Templates"})]})})]})}),t==="onboarding"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:Object.entries(h.byStatus||{}).map(([fe,ve])=>{const Ae=dr[fe];return Ae?e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${Ae.color}`,children:Hs.createElement(Ae.icon,{size:20,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:Ae.label}),e.jsx("p",{className:"text-xl font-bold text-white",children:ve})]})]})},fe):null})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(rt,{size:16,className:"text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search candidates...",value:x,onChange:fe=>m(fe.target.value),className:"input-field w-64"})]}),e.jsxs("select",{value:l,onChange:fe=>c(fe.target.value),className:"input-field w-48",children:[e.jsx("option",{value:"",children:"All Status"}),Object.entries(dr).map(([fe,ve])=>e.jsx("option",{value:fe,children:ve.label},fe))]}),e.jsx("button",{onClick:()=>{c(""),d(""),m("")},className:"btn-outline text-sm",children:"Clear Filters"})]})}),e.jsx("div",{className:"space-y-4",children:xe.map(fe=>e.jsx(bu,{item:fe,onUpdateStatus:I,onSendOffer:J,onSetJoiningDate:te,onComplete:se,onOpenSendOfferModal:ve=>{P(ve),ie(!0)},onViewDetails:ve=>{p(ve),j(!0)},onRequestDocuments:le},fe._id))}),xe.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Re,{size:48,className:"mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400 text-lg",children:"No onboarding records found"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:x||l?"Try adjusting your filters":"Candidates will appear here when sent to onboarding"})]}),u&&g&&e.jsx(ju,{onboarding:g,onClose:()=>{j(!1),p(null)},verifyingDoc:S,onAcceptDocument:ue,onRejectDocument:be}),e.jsx(ku,{isOpen:y,onClose:()=>{N(!1),D(null),C("")},document:w,rejectionNotes:b,setRejectionNotes:C,onSubmit:H,isSubmitting:S!==null})]}),t==="templates"&&e.jsx(vu,{templates:F,loading:T,filter:Q,setFilter:_,onEdit:fe=>{K(fe),q(!0)},onDelete:Z,onDuplicate:ee,onUpdateStatus:ae}),X&&e.jsx(Nu,{template:B,onClose:()=>{q(!1),K(null)},onSave:re}),ne&&A&&e.jsx(wu,{candidate:A,onClose:()=>{ie(!1),P(null)},onSend:J})]})},bu=({item:t,onUpdateStatus:a,onSendOffer:s,onSetJoiningDate:n,onComplete:r,onViewDetails:i,onOpenSendOfferModal:l,onRequestDocuments:c})=>{var N;const[o,d]=v.useState(!1),[x,m]=v.useState(!1),[h,f]=v.useState(""),g=dr[t.status],p=()=>{switch(t.status){case"preboarding":return[{label:"Send Offer",action:()=>l(t),color:"btn-primary"}];case"offer_sent":return[{label:"Mark Accepted",action:()=>a(t._id,"offer_accepted"),color:"btn-success"},{label:"Mark Rejected",action:()=>a(t._id,"rejected"),color:"btn-danger"}];case"offer_accepted":return[{label:"Request Documents",action:()=>a(t._id,"docs_pending"),color:"btn-primary"}];case"docs_pending":return[{label:"Verify Documents",action:()=>a(t._id,"docs_verified"),color:"btn-success"}];case"docs_verified":return[{label:"Set Joining Date",action:()=>u(),color:"btn-primary"}];case"ready_for_joining":return[{label:"Complete Onboarding",action:()=>r(t._id),color:"btn-success"}];default:return[]}},u=()=>{m(!0);const w=new Date().toISOString().split("T")[0];f(w)},j=()=>{h&&(n(t._id,h),m(!1),f(""))},y=p();return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:t.candidateName}),e.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${g.color} text-white`,children:[Hs.createElement(g.icon,{size:12,className:"mr-1"}),g.label]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-400",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ut,{size:14}),e.jsx("span",{children:t.candidateEmail})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ts,{size:14}),e.jsx("span",{children:t.candidatePhone})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Re,{size:14}),e.jsx("span",{children:t.position})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>i(t),className:"btn-outline text-sm",children:e.jsx(Rt,{size:16})}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>d(!o),className:"btn-outline text-sm",children:e.jsx(x0,{size:16})}),o&&e.jsx("div",{className:"absolute right-0 top-full mt-2 w-48 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-10",children:y.map((w,D)=>e.jsx("button",{onClick:()=>{w.action(),d(!1)},className:"w-full text-left px-4 py-2 text-sm text-white hover:bg-gray-700 first:rounded-t-lg last:rounded-b-lg",children:w.label},D))})]})]})]}),e.jsx(Zo,{status:t.status}),t.joiningDate&&e.jsx("div",{className:"mb-4 p-3 bg-green-900/20 border border-green-800 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{size:16,className:"text-green-400"}),e.jsxs("span",{className:"text-sm text-green-400",children:["Joining Date: ",new Date(t.joiningDate).toLocaleDateString()]})]})}),((N=t.offer)==null?void 0:N.expiryDate)&&t.status==="offer_sent"&&e.jsx("div",{className:"mb-4 p-3 bg-yellow-900/20 border border-yellow-800 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{size:16,className:"text-yellow-400"}),e.jsxs("span",{className:"text-sm text-yellow-400",children:["Offer expires: ",new Date(t.offer.expiryDate).toLocaleDateString()]})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",t.onboardingId," â€¢ Created: ",new Date(t.createdAt).toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>c(t._id),className:"btn-outline text-sm flex items-center space-x-1",title:"Send document upload link to candidate",children:[e.jsx(Ue,{size:14}),e.jsx("span",{children:"Request Documents"})]}),y.slice(0,2).map((w,D)=>e.jsx("button",{onClick:w.action,className:`${w.color} text-sm`,children:w.label},D))]})]}),x&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-900 border border-dark-700 rounded-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Set Joining Date"}),e.jsx("button",{onClick:()=>{m(!1),f("")},className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:20})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Joining Date"}),e.jsx("input",{type:"date",value:h,onChange:w=>f(w.target.value),min:new Date().toISOString().split("T")[0],className:"w-full px-4 py-2 bg-dark-800 border border-dark-700 rounded-lg text-white focus:border-primary-600 focus:outline-none"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:j,className:"flex-1 btn-primary",disabled:!h,children:[e.jsx(Fe,{size:16,className:"mr-2"}),"Set Date"]}),e.jsx("button",{onClick:()=>{m(!1),f("")},className:"flex-1 btn-outline",children:"Cancel"})]})]})]})})]})},ju=({onboarding:t,onClose:a,verifyingDoc:s,onAcceptDocument:n,onRejectDocument:r})=>{var d;const i=dr[t.status],l=x=>x?new Date(x).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A",c=x=>x?new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(x):"N/A",o=x=>{if(!x)return"";if(x.startsWith("http://")||x.startsWith("https://"))return x;const m="";return x.startsWith("/uploads/")?`${m}${x}`:x.startsWith("/")?x:`${m}/uploads/${x}`};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-900 border border-dark-700 rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-dark-900 border-b border-dark-700 p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:t.candidateName}),e.jsxs("p",{className:"text-gray-400 mt-1",children:["Onboarding ID: ",t.onboardingId]})]}),e.jsx("button",{onClick:a,className:"btn-outline p-2",children:e.jsx(Ee,{size:20})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Current Status"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-3 rounded-lg ${i.color}`,children:Hs.createElement(i.icon,{size:24,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:i.label}),e.jsxs("p",{className:"text-gray-400 text-sm",children:["Updated: ",l(t.updatedAt)]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(Zo,{status:t.status})})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ut,{size:18,className:"text-primary-500 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Email"}),e.jsx("p",{className:"text-white",children:t.candidateEmail})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ts,{size:18,className:"text-primary-500 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Phone"}),e.jsx("p",{className:"text-white",children:t.candidatePhone})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(at,{size:18,className:"text-primary-500 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Position"}),e.jsx("p",{className:"text-white",children:t.position})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Nr,{size:18,className:"text-primary-500 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Department"}),e.jsx("p",{className:"text-white",children:((d=t.department)==null?void 0:d.name)||"N/A"})]})]})]})]}),t.offer&&e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Offer Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(at,{size:18,className:"text-primary-500 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Offered Designation"}),e.jsx("p",{className:"text-white",children:t.offer.offeredDesignation||"N/A"})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(tt,{size:18,className:"text-primary-500 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Offered CTC"}),e.jsx("p",{className:"text-white",children:c(t.offer.offeredCTC)})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Fe,{size:18,className:"text-primary-500 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Start Date"}),e.jsx("p",{className:"text-white",children:l(t.offer.startDate)})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Te,{size:18,className:"text-primary-500 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Offer Sent"}),e.jsx("p",{className:"text-white",children:l(t.offer.sentAt)})]})]}),t.offer.expiryDate&&e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(st,{size:18,className:"text-yellow-500 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Offer Expires"}),e.jsx("p",{className:"text-white",children:l(t.offer.expiryDate)})]})]})]}),t.offer.salary&&e.jsxs("div",{className:"mt-4 p-4 bg-dark-800 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-400 mb-3",children:"Salary Breakdown"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Basic"}),e.jsx("p",{className:"text-white font-medium",children:c(t.offer.salary.basic)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"HRA"}),e.jsx("p",{className:"text-white font-medium",children:c(t.offer.salary.hra)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Allowances"}),e.jsx("p",{className:"text-white font-medium",children:c(t.offer.salary.allowances)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Total"}),e.jsx("p",{className:"text-white font-medium",children:c(t.offer.salary.total)})]})]})]})]}),t.joiningDate&&e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Joining Information"}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Fe,{size:18,className:"text-primary-500 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Joining Date"}),e.jsx("p",{className:"text-white font-medium text-lg",children:l(t.joiningDate)})]})]})]}),t.auditTrail&&t.auditTrail.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Activity Timeline"}),e.jsx("div",{className:"space-y-3",children:t.auditTrail.slice().reverse().map((x,m)=>e.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-dark-800 rounded-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-primary-500 rounded-full mt-2"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-white font-medium",children:x.action.replace(/_/g," ").toUpperCase()}),e.jsx("p",{className:"text-gray-400 text-sm",children:x.description}),e.jsx("p",{className:"text-gray-500 text-xs mt-1",children:l(x.timestamp)})]})]},m))})]}),t.documents&&t.documents.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Documents"}),e.jsx("div",{className:"space-y-3",children:t.documents.map((x,m)=>e.jsxs("div",{className:"p-4 bg-dark-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ue,{size:18,className:"text-primary-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:x.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:x.type})]})]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${x.status==="verified"?"bg-green-500/20 text-green-400":x.status==="rejected"?"bg-red-500/20 text-red-400":x.status==="pending"?"bg-yellow-500/20 text-yellow-400":"bg-gray-500/20 text-gray-400"}`,children:x.status||"uploaded"})]}),x.rejectionReason&&e.jsxs("div",{className:"mb-3 p-2 bg-red-500/10 border border-red-500/20 rounded text-sm text-red-400",children:[e.jsx("strong",{children:"Rejection Reason:"})," ",x.rejectionReason]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-2",children:x.url&&e.jsxs("a",{href:o(x.url),target:"_blank",rel:"noreferrer",className:"text-sm text-primary-400 hover:text-primary-300 flex items-center space-x-1",children:[e.jsx(Rt,{size:14}),e.jsx("span",{children:"View"})]})}),x.status!=="verified"&&x.url&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>n(x._id),disabled:s===x._id,className:"flex items-center space-x-1 px-3 py-1.5 bg-green-500/20 hover:bg-green-500/30 text-green-400 rounded text-sm font-medium transition-colors disabled:opacity-50",children:[e.jsx(Pa,{size:14}),e.jsx("span",{children:s===x._id?"Processing...":"Accept"})]}),e.jsxs("button",{onClick:()=>r(x),disabled:s===x._id,className:"flex items-center space-x-1 px-3 py-1.5 bg-red-500/20 hover:bg-red-500/30 text-red-400 rounded text-sm font-medium transition-colors disabled:opacity-50",children:[e.jsx(Ee,{size:14}),e.jsx("span",{children:"Reject"})]})]})]})]},m))})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-dark-900 border-t border-dark-700 p-6 flex justify-end",children:e.jsx("button",{onClick:a,className:"btn-primary",children:"Close"})})]})})},vu=({templates:t,loading:a,filter:s,setFilter:n,onEdit:r,onDelete:i,onDuplicate:l,onUpdateStatus:c})=>a?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(rt,{size:16,className:"text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search templates...",value:s.search,onChange:o=>n({...s,search:o.target.value}),className:"input-field w-64"})]}),e.jsxs("select",{value:s.status,onChange:o=>n({...s,status:o.target.value}),className:"input-field w-40",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"draft",children:"Draft"})]}),e.jsxs("select",{value:s.category,onChange:o=>n({...s,category:o.target.value}),className:"input-field w-40",children:[e.jsx("option",{value:"",children:"All Categories"}),e.jsx("option",{value:"full-time",children:"Full Time"}),e.jsx("option",{value:"part-time",children:"Part Time"}),e.jsx("option",{value:"contract",children:"Contract"}),e.jsx("option",{value:"intern",children:"Intern"}),e.jsx("option",{value:"executive",children:"Executive"})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(o=>e.jsxs("div",{className:"card p-4 hover:border-primary-500 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-1",children:o.name}),e.jsx("p",{className:"text-sm text-gray-400 line-clamp-2",children:o.description})]}),o.isDefault&&e.jsx("span",{className:"px-2 py-1 bg-primary-500/20 text-primary-400 text-xs font-medium rounded",children:"Default"})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Category:"}),e.jsx("span",{className:"text-white capitalize",children:o.category})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Status:"}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${o.status==="active"?"bg-green-500/20 text-green-400":o.status==="inactive"?"bg-gray-500/20 text-gray-400":"bg-yellow-500/20 text-yellow-400"}`,children:o.status})]}),o.usageCount>0&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Used:"}),e.jsxs("span",{className:"text-white",children:[o.usageCount," times"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>r(o),className:"flex-1 btn-outline text-sm py-2",children:[e.jsx(Is,{size:14,className:"inline mr-1"}),"Edit"]}),e.jsx("button",{onClick:()=>l(o),className:"btn-outline p-2",title:"Duplicate",children:e.jsx(ji,{size:16})}),e.jsx("button",{onClick:()=>c(o._id,o.status==="active"?"inactive":"active"),className:`btn-outline p-2 ${o.status==="active"?"text-yellow-400":"text-green-400"}`,title:o.status==="active"?"Deactivate":"Activate",children:o.status==="active"?e.jsx(Te,{size:16}):e.jsx(we,{size:16})}),e.jsx("button",{onClick:()=>i(o._id),className:"btn-outline p-2 text-red-400 hover:bg-red-500/10",title:"Delete",children:e.jsx(ct,{size:16})})]})]},o._id))}),t.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(un,{size:48,className:"mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400 text-lg",children:"No templates found"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:s.search||s.status||s.category?"Try adjusting your filters":"Create your first offer template to get started"})]})]}),Nu=({template:t,onClose:a,onSave:s})=>{const[n,r]=v.useState({name:(t==null?void 0:t.name)||"",description:(t==null?void 0:t.description)||"",category:(t==null?void 0:t.category)||"full-time",subject:(t==null?void 0:t.subject)||"",content:(t==null?void 0:t.content)||"",status:(t==null?void 0:t.status)||"draft",isDefault:(t==null?void 0:t.isDefault)||!1,variables:(t==null?void 0:t.variables)||[],expiryDays:(t==null?void 0:t.expiryDays)||1,reminderDays:(t==null?void 0:t.reminderDays)||[]}),[i,l]=v.useState({}),c=()=>{const m={};return n.name.trim()||(m.name="Template name is required"),n.subject.trim()||(m.subject="Email subject is required"),n.content.trim()||(m.content="Template content is required"),n.expiryDays<1&&(m.expiryDays="Expiry days must be at least 1"),l(m),Object.keys(m).length===0},o=m=>{m.preventDefault(),c()&&s(n)},d=m=>{r({...n,content:n.content+`{{${m}}}`})},x=["candidateName","candidateEmail","position","department","offeredCTC","startDate","joiningDate","companyName","hrName","hrEmail","hrPhone"];return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-900 border border-dark-700 rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-dark-900 border-b border-dark-700 p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:t?"Edit Template":"Create New Template"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Design your offer letter template"})]}),e.jsx("button",{onClick:a,className:"btn-outline p-2",children:e.jsx(Ee,{size:20})})]}),e.jsxs("form",{onSubmit:o,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Template Name *"}),e.jsx("input",{type:"text",value:n.name,onChange:m=>r({...n,name:m.target.value}),className:`input-field w-full ${i.name?"border-red-500":""}`,placeholder:"e.g., Full-Time Offer Letter"}),i.name&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:i.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Category *"}),e.jsxs("select",{value:n.category,onChange:m=>r({...n,category:m.target.value}),className:"input-field w-full",children:[e.jsx("option",{value:"full-time",children:"Full Time"}),e.jsx("option",{value:"part-time",children:"Part Time"}),e.jsx("option",{value:"contract",children:"Contract"}),e.jsx("option",{value:"intern",children:"Intern"}),e.jsx("option",{value:"executive",children:"Executive"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Description"}),e.jsx("textarea",{value:n.description,onChange:m=>r({...n,description:m.target.value}),className:"input-field w-full",rows:"2",placeholder:"Brief description of this template"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Subject *"}),e.jsx("input",{type:"text",value:n.subject,onChange:m=>r({...n,subject:m.target.value}),className:`input-field w-full ${i.subject?"border-red-500":""}`,placeholder:"e.g., Offer Letter - {{position}} at {{companyName}}"}),i.subject&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:i.subject})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Template Content *"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-400",children:"Insert Variable:"}),e.jsxs("select",{onChange:m=>{m.target.value&&(d(m.target.value),m.target.value="")},className:"input-field text-xs py-1",children:[e.jsx("option",{value:"",children:"Select..."}),x.map(m=>e.jsx("option",{value:m,children:m},m))]})]})]}),e.jsx("textarea",{value:n.content,onChange:m=>r({...n,content:m.target.value}),className:`input-field w-full font-mono text-sm ${i.content?"border-red-500":""}`,rows:"12",placeholder:`Dear {{candidateName}},

We are pleased to offer you the position of {{position}} at {{companyName}}...

Use {{variableName}} to insert dynamic content.`}),i.content&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:i.content}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Use double curly braces for variables, e.g., ","{{candidateName}}"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status"}),e.jsxs("select",{value:n.status,onChange:m=>r({...n,status:m.target.value}),className:"input-field w-full",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Offer Expiry (Days) *"}),e.jsx("input",{type:"number",min:"1",value:n.expiryDays,onChange:m=>r({...n,expiryDays:parseInt(m.target.value)}),className:`input-field w-full ${i.expiryDays?"border-red-500":""}`}),i.expiryDays&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:i.expiryDays})]}),e.jsx("div",{className:"flex items-center pt-8",children:e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:n.isDefault,onChange:m=>r({...n,isDefault:m.target.checked}),className:"w-4 h-4 rounded border-gray-600 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Set as Default"})]})})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t border-dark-700",children:[e.jsx("button",{type:"button",onClick:a,className:"btn-outline",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn-primary flex items-center space-x-2",children:[e.jsx(ds,{size:18}),e.jsx("span",{children:t?"Update Template":"Create Template"})]})]})]})]})})},wu=({candidate:t,onClose:a,onSend:s})=>{const[n,r]=v.useState({candidateName:t.candidateName||"",salary:"",templateId:"default"}),[i,l]=v.useState({}),[c,o]=v.useState(!1),d=()=>{const m={};return n.candidateName.trim()||(m.candidateName="Candidate name is required"),(!n.salary||n.salary<=0)&&(m.salary="Valid salary is required"),l(m),Object.keys(m).length===0},x=async m=>{if(m.preventDefault(),!!d()){o(!0);try{await s(t._id,{templateId:n.templateId,offerDetails:{designation:t.position,ctc:parseFloat(n.salary),salary:parseFloat(n.salary)}}),a()}catch{E.error("Failed to send offer")}finally{o(!1)}}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-900 border border-dark-700 rounded-xl max-w-md w-full",children:[e.jsxs("div",{className:"border-b border-dark-700 p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Send Offer Letter"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Fill in the offer details"})]}),e.jsx("button",{onClick:a,className:"btn-outline p-2",children:e.jsx(Ee,{size:20})})]}),e.jsxs("form",{onSubmit:x,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"bg-dark-800 p-4 rounded-lg space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Position:"}),e.jsx("span",{className:"text-white font-medium",children:t.position})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Email:"}),e.jsx("span",{className:"text-white",children:t.candidateEmail})]}),t.department&&e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Department:"}),e.jsx("span",{className:"text-white",children:t.department.name||t.department})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Candidate Name *"}),e.jsx("input",{type:"text",value:n.candidateName,onChange:m=>r({...n,candidateName:m.target.value}),className:`input-field w-full ${i.candidateName?"border-red-500":""}`,placeholder:"Enter candidate's full name"}),i.candidateName&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:i.candidateName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Annual CTC (â‚¹) *"}),e.jsx("input",{type:"number",min:"0",step:"1000",value:n.salary,onChange:m=>r({...n,salary:m.target.value}),className:`input-field w-full ${i.salary?"border-red-500":""}`,placeholder:"e.g., 500000"}),i.salary&&e.jsx("p",{className:"text-red-400 text-sm mt-1",children:i.salary}),n.salary&&e.jsxs("p",{className:"text-gray-400 text-xs mt-1",children:["â‚¹",parseFloat(n.salary).toLocaleString("en-IN")," per annum"]})]}),e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-3",children:e.jsxs("p",{className:"text-blue-400 text-sm",children:[e.jsx("strong",{children:"Note:"})," A default offer letter template will be used. The offer will be sent to ",t.candidateEmail]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"btn-outline",disabled:c,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary flex items-center space-x-2",disabled:c,children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Sending..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ut,{size:18}),e.jsx("span",{children:"Send Offer"})]})})]})]})]})})},ku=({isOpen:t,onClose:a,document:s,rejectionNotes:n,setRejectionNotes:r,onSubmit:i,isSubmitting:l})=>t?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-dark-800 rounded-lg shadow-xl max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Reject Document"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:20})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-gray-300 mb-2",children:["Document: ",e.jsx("strong",{children:(s==null?void 0:s.name)||(s==null?void 0:s.type)})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Please provide a reason for rejecting this document. The candidate will receive an email with your notes."})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Rejection Reason ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("textarea",{value:n,onChange:c=>r(c.target.value),placeholder:"e.g., Document is not clear, please upload a better quality scan...",className:"w-full px-3 py-2 bg-dark-700 border border-dark-600 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-primary-500",rows:4})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:a,disabled:l,className:"px-4 py-2 bg-dark-700 hover:bg-dark-600 text-white rounded-lg transition-colors",children:"Cancel"}),e.jsx("button",{onClick:i,disabled:!n.trim()||l,className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Sending...":"Reject & Send Email"})]})]})})}):null,ti=[{key:"exitDiscussion",label:"Exit Discussion"},{key:"assetReturn",label:"Asset Return"},{key:"documentation",label:"Documentation"},{key:"finalSettlement",label:"Final Settlement"},{key:"success",label:"Completed"}],Rl={"in-progress":{label:"In Progress",color:"bg-blue-500",badge:"badge-info"},completed:{label:"Completed",color:"bg-green-500",badge:"badge-success"},cancelled:{label:"Cancelled",color:"bg-red-500",badge:"badge-danger"}},ed={voluntary:"Voluntary",involuntary:"Involuntary",retirement:"Retirement","contract-end":"Contract End"},td=({stages:t,currentStage:a,status:s})=>{const n=t||ti.map(i=>i.key),r=n.indexOf(a);return e.jsx("div",{className:"flex items-center space-x-1 overflow-x-auto pb-2",children:n.map((i,l)=>{var x;const c=s==="completed"||l<r,o=l===r&&s!=="completed",d=l===n.length-1;return e.jsxs("div",{className:"flex items-center flex-shrink-0",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full transition-all duration-300 ${c?"bg-green-500 text-white":o?"bg-blue-500 text-white animate-pulse":"bg-gray-700 text-gray-400"}`,children:c?e.jsx(we,{size:18}):o?e.jsx(Te,{size:18}):e.jsx(xo,{size:18})}),e.jsx("div",{className:`mt-1 text-xs font-medium text-center max-w-[80px] ${c?"text-green-400":o?"text-blue-400":"text-gray-500"}`,children:((x=ti.find(m=>m.key===i))==null?void 0:x.label)||i})]}),!d&&e.jsx("div",{className:`mx-2 h-0.5 w-12 transition-all duration-300 ${c?"bg-green-500":"bg-gray-700"}`})]},i)})})},Su=()=>{const[t,a]=v.useState([]),[s,n]=v.useState(!1),[r,i]=v.useState({total:0,inProgress:0,completed:0,cancelled:0}),[l,c]=v.useState("all"),[o,d]=v.useState(""),[x,m]=v.useState(""),[h,f]=v.useState(1),[g,p]=v.useState(1),[u,j]=v.useState(!1),[y,N]=v.useState(!1),[w,D]=v.useState(!1),[b,C]=v.useState(!1),[S,k]=v.useState(!1),[F,R]=v.useState(!1),[T,M]=v.useState(!1),[X,q]=v.useState(null),[B,K]=v.useState([]),[Q,_]=v.useState(1);v.useEffect(()=>{ne()},[l,o,x,Q]);const ne=async()=>{var Z,ee,ae,xe,fe,ve;n(!0);try{const Ae=new URLSearchParams;l!=="all"&&Ae.append("status",l),o&&Ae.append("stage",o),x&&Ae.append("search",x),Ae.append("page",Q),Ae.append("limit","10");const ye=await Y.get(`/offboarding?${Ae.toString()}`);a(((Z=ye==null?void 0:ye.data)==null?void 0:Z.data)||[]),i(((ee=ye==null?void 0:ye.data)==null?void 0:ee.summary)||{}),p(((xe=(ae=ye==null?void 0:ye.data)==null?void 0:ae.pagination)==null?void 0:xe.pages)||1)}catch(Ae){E.error(((ve=(fe=Ae==null?void 0:Ae.response)==null?void 0:fe.data)==null?void 0:ve.message)||"Failed to load offboarding list")}finally{n(!1)}},ie=async()=>{var Z;try{const ee=await Y.get("/employees");K(((Z=ee==null?void 0:ee.data)==null?void 0:Z.data)||[])}catch{E.error("Failed to load employees")}},A=async Z=>{var ee,ae;try{const xe=await Y.get(`/offboarding/${Z}`);return q((ee=xe==null?void 0:xe.data)==null?void 0:ee.data),(ae=xe==null?void 0:xe.data)==null?void 0:ae.data}catch{return E.error("Failed to load offboarding details"),null}},P=async Z=>{var ee,ae;try{const xe={employeeId:Z.employeeId,lastWorkingDate:Z.lastWorkingDay||Z.lastWorkingDate,resignationType:Z.reason||Z.resignationType,reason:Z.reason||Z.resignationType};await Y.post("/offboarding",xe),E.success("Offboarding initiated successfully"),j(!1),ne()}catch(xe){E.error(((ae=(ee=xe==null?void 0:xe.response)==null?void 0:ee.data)==null?void 0:ae.message)||"Failed to initiate offboarding")}},O=async(Z,ee)=>{var ae,xe;try{await Y.put(`/offboarding/${Z}`,ee),E.success("Offboarding updated successfully"),D(!1),ne(),(X==null?void 0:X._id)===Z&&A(Z)}catch(fe){E.error(((xe=(ae=fe==null?void 0:fe.response)==null?void 0:ae.data)==null?void 0:xe.message)||"Failed to update offboarding")}},I=async Z=>{var ee,ae;try{await Y.post(`/offboarding/${Z}/advance`),E.success("Stage advanced successfully"),ne(),(X==null?void 0:X._id)===Z&&A(Z)}catch(xe){E.error(((ae=(ee=xe==null?void 0:xe.response)==null?void 0:ee.data)==null?void 0:ae.message)||"Failed to advance stage")}},J=async(Z,ee)=>{var ae,xe;try{await Y.put(`/offboarding/${Z}/cancel`,{reason:ee}),E.success("Offboarding cancelled successfully"),ne(),(X==null?void 0:X._id)===Z&&(N(!1),q(null))}catch(fe){E.error(((xe=(ae=fe==null?void 0:fe.response)==null?void 0:ae.data)==null?void 0:xe.message)||"Failed to cancel offboarding")}},te=async Z=>{var ee,ae;if(window.confirm("Are you sure you want to delete this offboarding record?"))try{await Y.delete(`/offboarding/${Z}`),E.success("Offboarding deleted successfully"),ne(),(X==null?void 0:X._id)===Z&&(N(!1),q(null))}catch(xe){E.error(((ae=(ee=xe==null?void 0:xe.response)==null?void 0:ee.data)==null?void 0:ae.message)||"Failed to delete offboarding")}},se=async(Z,ee)=>{var ae,xe;try{await Y.post(`/offboarding/${Z}/exit-interview/schedule`,ee),E.success("Exit interview scheduled successfully"),ne(),(X==null?void 0:X._id)===Z&&A(Z),C(!1)}catch(fe){E.error(((xe=(ae=fe==null?void 0:fe.response)==null?void 0:ae.data)==null?void 0:xe.message)||"Failed to schedule exit interview")}},le=async(Z,ee)=>{var ae,xe;try{await Y.post(`/offboarding/${Z}/exit-interview/complete`,{feedback:ee}),E.success("Exit interview completed successfully"),ne(),(X==null?void 0:X._id)===Z&&A(Z),C(!1)}catch(fe){E.error(((xe=(ae=fe==null?void 0:fe.response)==null?void 0:ae.data)==null?void 0:xe.message)||"Failed to complete exit interview")}},ue=async(Z,ee,ae,xe)=>{var fe,ve;try{await Y.post(`/offboarding/${Z}/clearance`,{department:ee,cleared:ae,notes:xe}),E.success(`${ee.toUpperCase()} clearance updated successfully`),ne(),(X==null?void 0:X._id)===Z&&A(Z),k(!1)}catch(Ae){E.error(((ve=(fe=Ae==null?void 0:Ae.response)==null?void 0:fe.data)==null?void 0:ve.message)||"Failed to update clearance")}},be=async(Z,ee,ae)=>{var xe,fe;try{await Y.post(`/offboarding/${Z}/assets/return`,{asset:ee,condition:ae}),E.success("Asset return recorded successfully"),ne(),(X==null?void 0:X._id)===Z&&A(Z),R(!1)}catch(ve){E.error(((fe=(xe=ve==null?void 0:ve.response)==null?void 0:xe.data)==null?void 0:fe.message)||"Failed to record asset return")}},H=async(Z,ee,ae)=>{var xe,fe;try{await Y.post(`/offboarding/${Z}/settlement`,{amount:ee,paymentStatus:ae}),E.success("Settlement processed successfully"),ne(),(X==null?void 0:X._id)===Z&&A(Z),M(!1)}catch(ve){E.error(((fe=(xe=ve==null?void 0:ve.response)==null?void 0:xe.data)==null?void 0:fe.message)||"Failed to process settlement")}},De=async Z=>{await A(Z._id)&&N(!0)},re=async Z=>{await A(Z._id)&&D(!0)};return s&&t.length===0?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Offboarding"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage employee exit process"})]}),e.jsxs("button",{onClick:()=>{j(!0),ie()},className:"btn-primary flex items-center space-x-2 w-full sm:w-auto",children:[e.jsx(Pe,{size:20}),e.jsx("span",{children:"Initiate Offboarding"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-500",children:e.jsx(Re,{size:20,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Total"}),e.jsx("p",{className:"text-xl font-bold text-white",children:r.total||0})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-yellow-500",children:e.jsx(Te,{size:20,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"In Progress"}),e.jsx("p",{className:"text-xl font-bold text-white",children:r.inProgress||0})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-green-500",children:e.jsx(we,{size:20,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Completed"}),e.jsx("p",{className:"text-xl font-bold text-white",children:r.completed||0})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-red-500",children:e.jsx(Ee,{size:20,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Cancelled"}),e.jsx("p",{className:"text-xl font-bold text-white",children:r.cancelled||0})]})]})})]}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 flex-1 min-w-[250px]",children:[e.jsx(rt,{size:16,className:"text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by employee name, email, or code...",value:x,onChange:Z=>{m(Z.target.value),_(1)},className:"input-field w-full"})]}),e.jsxs("select",{value:l,onChange:Z=>{c(Z.target.value),_(1)},className:"input-field w-48",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"in-progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]}),e.jsxs("select",{value:o,onChange:Z=>{d(Z.target.value),_(1)},className:"input-field w-48",children:[e.jsx("option",{value:"",children:"All Stages"}),ti.map(Z=>e.jsx("option",{value:Z.key,children:Z.label},Z.key))]}),e.jsxs("button",{onClick:()=>{c("all"),d(""),m(""),_(1)},className:"btn-outline text-sm",children:[e.jsx(xs,{size:16,className:"mr-2"}),"Clear Filters"]})]})}),e.jsx("div",{className:"space-y-4",children:t.map(Z=>e.jsx(Cu,{item:Z,onViewDetails:De,onEdit:re,onAdvanceStage:I,onCancel:J,onDelete:te,onScheduleExitInterview:ee=>{q(Z),C(!0)},onUpdateClearance:ee=>{q(Z),k(!0)},onRecordAsset:ee=>{q(Z),R(!0)},onProcessSettlement:ee=>{q(Z),M(!0)}},Z._id))}),t.length===0&&!s&&e.jsxs("div",{className:"text-center py-12 card",children:[e.jsx(Re,{size:48,className:"mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400 text-lg",children:"No offboarding records found"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:x||l!=="all"||o?"Try adjusting your filters":"Initiate an offboarding process to get started"})]}),g>1&&e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("button",{onClick:()=>_(Math.max(1,Q-1)),disabled:Q===1,className:"btn-outline disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsxs("span",{className:"text-gray-400 px-4",children:["Page ",Q," of ",g]}),e.jsx("button",{onClick:()=>_(Math.min(g,Q+1)),disabled:Q===g,className:"btn-outline disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),u&&e.jsx(Au,{employees:B,onClose:()=>j(!1),onSubmit:P}),y&&X&&e.jsx(Eu,{offboarding:X,onClose:()=>{N(!1),q(null)},onRefresh:()=>A(X._id),onEdit:()=>{N(!1),D(!0)},onAdvanceStage:I,onScheduleExitInterview:()=>C(!0),onUpdateClearance:()=>k(!0),onRecordAsset:()=>R(!0),onProcessSettlement:()=>M(!0),onCancel:J,onDelete:te}),w&&X&&e.jsx(Fu,{offboarding:X,onClose:()=>{D(!1),q(null)},onSave:Z=>O(X._id,Z)}),b&&X&&e.jsx(Tu,{offboarding:X,employees:B,onClose:()=>{C(!1)},onSchedule:Z=>se(X._id,Z),onComplete:Z=>le(X._id,Z)}),S&&X&&e.jsx(Du,{offboarding:X,onClose:()=>{k(!1)},onUpdate:(Z,ee,ae)=>ue(X._id,Z,ee,ae)}),F&&X&&e.jsx(_u,{offboarding:X,onClose:()=>{R(!1)},onRecord:(Z,ee)=>be(X._id,Z,ee)}),T&&X&&e.jsx(Ru,{offboarding:X,onClose:()=>{M(!1)},onProcess:(Z,ee)=>H(X._id,Z,ee)})]})},Cu=({item:t,onViewDetails:a,onEdit:s,onAdvanceStage:n,onCancel:r,onDelete:i,onScheduleExitInterview:l,onUpdateClearance:c,onRecordAsset:o,onProcessSettlement:d})=>{var g;const[x,m]=v.useState(!1),h=t.employee||{},f=Rl[t.status]||Rl["in-progress"];return e.jsxs("div",{className:"card hover:border-primary-600 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 bg-primary-600/20 rounded-lg flex items-center justify-center",children:e.jsx(ft,{size:24,className:"text-primary-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:h.firstName&&h.lastName?`${h.firstName} ${h.lastName}`:"Employee Name Not Available"}),e.jsx("p",{className:"text-sm text-gray-400",children:h.email||"Email not available"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Employee Code"}),e.jsx("p",{className:"text-sm text-gray-300",children:h.employeeCode||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Department"}),e.jsx("p",{className:"text-sm text-gray-300",children:((g=h.department)==null?void 0:g.name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Resignation Type"}),e.jsx("p",{className:"text-sm text-gray-300 capitalize",children:ed[t.resignationType]||t.resignationType||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Last Working Date"}),e.jsx("p",{className:"text-sm text-gray-300",children:t.lastWorkingDate?new Date(t.lastWorkingDate).toLocaleDateString():"N/A"})]})]})]}),e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("span",{className:`badge ${f.badge}`,children:f.label}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>m(!x),className:"p-2 rounded-lg hover:bg-gray-700 text-gray-400",children:e.jsx(mo,{size:18})}),x&&e.jsxs("div",{className:"absolute right-0 top-10 w-48 bg-gray-800 border border-gray-700 rounded-lg shadow-lg z-10",children:[e.jsxs("button",{onClick:()=>{a(t),m(!1)},className:"w-full text-left px-4 py-2 text-sm text-white hover:bg-gray-700 flex items-center space-x-2",children:[e.jsx(Rt,{size:16}),e.jsx("span",{children:"View Details"})]}),e.jsxs("button",{onClick:()=>{s(t),m(!1)},className:"w-full text-left px-4 py-2 text-sm text-white hover:bg-gray-700 flex items-center space-x-2",children:[e.jsx(Is,{size:16}),e.jsx("span",{children:"Edit"})]}),t.status==="in-progress"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{n(t._id),m(!1)},className:"w-full text-left px-4 py-2 text-sm text-white hover:bg-gray-700 flex items-center space-x-2",children:[e.jsx(Hn,{size:16}),e.jsx("span",{children:"Advance Stage"})]}),e.jsxs("button",{onClick:()=>{if(window.confirm("Are you sure you want to cancel this offboarding?")){const p=prompt("Please provide a reason for cancellation:");p&&r(t._id,p)}m(!1)},className:"w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-gray-700 flex items-center space-x-2",children:[e.jsx(Ee,{size:16}),e.jsx("span",{children:"Cancel"})]})]}),e.jsxs("button",{onClick:()=>{window.confirm("Are you sure you want to delete this offboarding record?")&&i(t._id),m(!1)},className:"w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-gray-700 flex items-center space-x-2 rounded-b-lg",children:[e.jsx(ct,{size:16}),e.jsx("span",{children:"Delete"})]})]})]})]})]}),e.jsx("div",{className:"mb-4",children:e.jsx(td,{stages:t.stages,currentStage:t.currentStage,status:t.status})}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-700",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Created: ",new Date(t.createdAt).toLocaleDateString()]}),t.status==="in-progress"&&e.jsx("button",{onClick:()=>n(t._id),className:"btn-primary text-sm",children:"Advance Stage"})]})]})},Au=({employees:t,onClose:a,onSubmit:s})=>{const[n,r]=v.useState({employeeId:"",reason:"",lastWorkingDay:""}),[i,l]=v.useState(!1),c=async o=>{if(o.preventDefault(),!n.employeeId||!n.reason||!n.lastWorkingDay){E.error("Please fill all required fields");return}l(!0),await s(n),l(!1)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Initiate Offboarding"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:20})})]}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Employee *"}),e.jsxs("select",{value:n.employeeId,onChange:o=>r({...n,employeeId:o.target.value}),className:"input-field w-full",required:!0,children:[e.jsx("option",{value:"",children:"Select Employee"}),t.map(o=>e.jsxs("option",{value:o._id,children:[o.firstName," ",o.lastName," - ",o.email]},o._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Reason *"}),e.jsxs("select",{value:n.reason,onChange:o=>r({...n,reason:o.target.value}),className:"input-field w-full",required:!0,children:[e.jsx("option",{value:"",children:"Select Reason"}),e.jsx("option",{value:"voluntary_resignation",children:"Voluntary Resignation"}),e.jsx("option",{value:"involuntary_termination",children:"Involuntary Termination"}),e.jsx("option",{value:"retirement",children:"Retirement"}),e.jsx("option",{value:"contract_end",children:"Contract End"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Last Working Day *"}),e.jsx("input",{type:"date",value:n.lastWorkingDay,onChange:o=>r({...n,lastWorkingDay:o.target.value}),className:"input-field w-full",required:!0})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-2 border border-gray-600 text-gray-300 rounded-lg hover:bg-gray-700",disabled:i,children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 btn-primary",disabled:i,children:i?"Creating...":"Initiate Offboarding"})]})]})]})})},Eu=({offboarding:t,onClose:a,onRefresh:s,onEdit:n,onAdvanceStage:r,onScheduleExitInterview:i,onUpdateClearance:l,onRecordAsset:c,onProcessSettlement:o,onCancel:d,onDelete:x})=>{var f;const m=t.employee||{},h=t.clearanceSummary||t.clearance||{};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-800 border-b border-gray-700 p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-white",children:[m.firstName," ",m.lastName]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Offboarding Details"})]}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:24})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Employee Information"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Email"}),e.jsx("p",{className:"text-sm text-gray-300",children:m.email||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Employee Code"}),e.jsx("p",{className:"text-sm text-gray-300",children:m.employeeCode||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Department"}),e.jsx("p",{className:"text-sm text-gray-300",children:((f=m.department)==null?void 0:f.name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Designation"}),e.jsx("p",{className:"text-sm text-gray-300",children:m.designation||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Last Working Date"}),e.jsx("p",{className:"text-sm text-gray-300",children:t.lastWorkingDate?new Date(t.lastWorkingDate).toLocaleDateString():"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Resignation Type"}),e.jsx("p",{className:"text-sm text-gray-300 capitalize",children:ed[t.resignationType]||t.resignationType||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Stage Progress"}),e.jsx(td,{stages:t.stages,currentStage:t.currentStage,status:t.status})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Clearance Status"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:["hr","finance","it","admin"].map(g=>{var p,u,j;return e.jsxs("div",{className:"card p-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-300 mb-2 capitalize",children:g}),e.jsx("div",{className:`badge ${(p=h[g])!=null&&p.cleared?"badge-success":"badge-warning"}`,children:(u=h[g])!=null&&u.cleared?"Cleared":"Pending"}),((j=h[g])==null?void 0:j.clearedAt)&&e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:new Date(h[g].clearedAt).toLocaleDateString()})]},g)})})]}),t.exitInterview&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Exit Interview"}),e.jsx("div",{className:"card p-4",children:t.exitInterview.completed?e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-400 mb-2",children:"Completed"}),t.exitInterview.feedback&&e.jsx("p",{className:"text-sm text-gray-300",children:t.exitInterview.feedback})]}):t.exitInterview.scheduledDate?e.jsxs("p",{className:"text-sm text-gray-300",children:["Scheduled for ",new Date(t.exitInterview.scheduledDate).toLocaleDateString()]}):e.jsx("p",{className:"text-sm text-gray-400",children:"Not scheduled"})})]}),t.finalSettlement&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Final Settlement"}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Amount"}),e.jsx("p",{className:"text-sm text-gray-300",children:t.finalSettlement.amount?`â‚¹${t.finalSettlement.amount.toLocaleString()}`:"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Payment Status"}),e.jsx("p",{className:"text-sm text-gray-300 capitalize",children:t.finalSettlement.paymentStatus||"Pending"})]})]})})]}),t.status==="in-progress"&&e.jsxs("div",{className:"flex flex-wrap gap-2 pt-4 border-t border-gray-700",children:[e.jsx("button",{onClick:()=>r(t._id),className:"btn-primary",children:"Advance Stage"}),e.jsx("button",{onClick:i,className:"btn-outline",children:"Schedule Exit Interview"}),e.jsx("button",{onClick:l,className:"btn-outline",children:"Update Clearance"}),e.jsx("button",{onClick:c,className:"btn-outline",children:"Record Asset Return"}),e.jsx("button",{onClick:o,className:"btn-outline",children:"Process Settlement"})]})]})]})})},Fu=({offboarding:t,onClose:a,onSave:s})=>{const[n,r]=v.useState({lastWorkingDate:t.lastWorkingDate?new Date(t.lastWorkingDate).toISOString().split("T")[0]:"",reason:t.reason||"",notes:t.notes||""}),[i,l]=v.useState(!1),c=async o=>{o.preventDefault(),l(!0),await s(n),l(!1)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Edit Offboarding"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:20})})]}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Last Working Date"}),e.jsx("input",{type:"date",value:n.lastWorkingDate,onChange:o=>r({...n,lastWorkingDate:o.target.value}),className:"input-field w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Notes"}),e.jsx("textarea",{value:n.notes,onChange:o=>r({...n,notes:o.target.value}),className:"input-field w-full",rows:"4"})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-2 border border-gray-600 text-gray-300 rounded-lg hover:bg-gray-700",disabled:i,children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 btn-primary",disabled:i,children:i?"Saving...":"Save Changes"})]})]})]})})},Tu=({offboarding:t,employees:a,onClose:s,onSchedule:n,onComplete:r})=>{var m,h;const[i,l]=v.useState(""),[c,o]=v.useState(""),[d,x]=v.useState("");return(m=t.exitInterview)!=null&&m.completed?e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Exit Interview"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:20})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-green-400",children:"Exit interview completed"}),t.exitInterview.feedback&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Feedback:"}),e.jsx("p",{className:"text-sm text-gray-300",children:t.exitInterview.feedback})]}),e.jsx("button",{onClick:s,className:"btn-primary w-full",children:"Close"})]})]})}):e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Exit Interview"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:20})})]}),(h=t.exitInterview)!=null&&h.scheduledDate?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-gray-300",children:["Scheduled for ",new Date(t.exitInterview.scheduledDate).toLocaleDateString()]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Feedback"}),e.jsx("textarea",{value:d,onChange:f=>x(f.target.value),className:"input-field w-full",rows:"4",placeholder:"Enter exit interview feedback..."})]}),e.jsx("button",{onClick:()=>r(d),className:"btn-primary w-full",children:"Complete Interview"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Scheduled Date"}),e.jsx("input",{type:"date",value:i,onChange:f=>l(f.target.value),className:"input-field w-full"})]}),e.jsx("button",{onClick:()=>n({scheduledDate:i,conductedBy:c}),className:"btn-primary w-full",children:"Schedule Interview"})]})]})})},Du=({offboarding:t,onClose:a,onUpdate:s})=>{const[n,r]=v.useState("hr"),[i,l]=v.useState(!1),[c,o]=v.useState(""),d=x=>{x.preventDefault(),s(n,i,c)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Update Clearance"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:20})})]}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Department"}),e.jsxs("select",{value:n,onChange:x=>r(x.target.value),className:"input-field w-full",children:[e.jsx("option",{value:"hr",children:"HR"}),e.jsx("option",{value:"finance",children:"Finance"}),e.jsx("option",{value:"it",children:"IT"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:x=>l(x.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Mark as Cleared"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Notes"}),e.jsx("textarea",{value:c,onChange:x=>o(x.target.value),className:"input-field w-full",rows:"3"})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-2 border border-gray-600 text-gray-300 rounded-lg hover:bg-gray-700",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 btn-primary",children:"Update Clearance"})]})]})]})})},_u=({offboarding:t,onClose:a,onRecord:s})=>{const[n,r]=v.useState(""),[i,l]=v.useState(""),c=o=>{if(o.preventDefault(),!n||!i){E.error("Please fill all required fields");return}s(n,i)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Record Asset Return"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:20})})]}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Asset ID"}),e.jsx("input",{type:"text",value:n,onChange:o=>r(o.target.value),className:"input-field w-full",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Condition"}),e.jsx("textarea",{value:i,onChange:o=>l(o.target.value),className:"input-field w-full",rows:"3",required:!0})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-2 border border-gray-600 text-gray-300 rounded-lg hover:bg-gray-700",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 btn-primary",children:"Record Return"})]})]})]})})},Ru=({offboarding:t,onClose:a,onProcess:s})=>{var o,d;const[n,r]=v.useState(((o=t.finalSettlement)==null?void 0:o.amount)||""),[i,l]=v.useState(((d=t.finalSettlement)==null?void 0:d.paymentStatus)||"pending"),c=x=>{x.preventDefault(),s(parseFloat(n),i)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Process Settlement"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:20})})]}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Settlement Amount"}),e.jsx("input",{type:"number",value:n,onChange:x=>r(x.target.value),className:"input-field w-full",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Payment Status"}),e.jsxs("select",{value:i,onChange:x=>l(x.target.value),className:"input-field w-full",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"processed",children:"Processed"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-2 border border-gray-600 text-gray-300 rounded-lg hover:bg-gray-700",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 btn-primary",children:"Process Settlement"})]})]})]})})};var sd={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,a){((s,n)=>{t.exports=n()})(t0,function s(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},r,i=!n.document&&!!n.postMessage,l=n.IS_PAPA_WORKER||!1,c={},o=0,d={};function x(S){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(k){var F=D(k);F.chunkSize=parseInt(F.chunkSize),k.step||k.chunk||(F.chunkSize=null),this._handle=new p(F),(this._handle.streamer=this)._config=F}).call(this,S),this.parseChunk=function(k,F){var R=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<R){let M=this._config.newline;M||(T=this._config.quoteChar||'"',M=this._handle.guessLineEndings(k,T)),k=[...k.split(M).slice(R)].join(M)}this.isFirstChunk&&C(this._config.beforeFirstChunk)&&(T=this._config.beforeFirstChunk(k))!==void 0&&(k=T),this.isFirstChunk=!1,this._halted=!1;var R=this._partialLine+k,T=(this._partialLine="",this._handle.parse(R,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(k=T.meta.cursor,R=(this._finished||(this._partialLine=R.substring(k-this._baseIndex),this._baseIndex=k),T&&T.data&&(this._rowCount+=T.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),l)n.postMessage({results:T,workerId:d.WORKER_ID,finished:R});else if(C(this._config.chunk)&&!F){if(this._config.chunk(T,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=T=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(T.data),this._completeResults.errors=this._completeResults.errors.concat(T.errors),this._completeResults.meta=T.meta),this._completed||!R||!C(this._config.complete)||T&&T.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),R||T&&T.meta.paused||this._nextChunk(),T}this._halted=!0},this._sendError=function(k){C(this._config.error)?this._config.error(k):l&&this._config.error&&n.postMessage({workerId:d.WORKER_ID,error:k,finished:!1})}}function m(S){var k;(S=S||{}).chunkSize||(S.chunkSize=d.RemoteChunkSize),x.call(this,S),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(F){this._input=F,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(k=new XMLHttpRequest,this._config.withCredentials&&(k.withCredentials=this._config.withCredentials),i||(k.onload=b(this._chunkLoaded,this),k.onerror=b(this._chunkError,this)),k.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var F,R=this._config.downloadRequestHeaders;for(F in R)k.setRequestHeader(F,R[F])}var T;this._config.chunkSize&&(T=this._start+this._config.chunkSize-1,k.setRequestHeader("Range","bytes="+this._start+"-"+T));try{k.send(this._config.downloadRequestBody)}catch(M){this._chunkError(M.message)}i&&k.status===0&&this._chunkError()}},this._chunkLoaded=function(){k.readyState===4&&(k.status<200||400<=k.status?this._chunkError():(this._start+=this._config.chunkSize||k.responseText.length,this._finished=!this._config.chunkSize||this._start>=(F=>(F=F.getResponseHeader("Content-Range"))!==null?parseInt(F.substring(F.lastIndexOf("/")+1)):-1)(k),this.parseChunk(k.responseText)))},this._chunkError=function(F){F=k.statusText||F,this._sendError(new Error(F))}}function h(S){(S=S||{}).chunkSize||(S.chunkSize=d.LocalChunkSize),x.call(this,S);var k,F,R=typeof FileReader<"u";this.stream=function(T){this._input=T,F=T.slice||T.webkitSlice||T.mozSlice,R?((k=new FileReader).onload=b(this._chunkLoaded,this),k.onerror=b(this._chunkError,this)):k=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var T=this._input,M=(this._config.chunkSize&&(M=Math.min(this._start+this._config.chunkSize,this._input.size),T=F.call(T,this._start,M)),k.readAsText(T,this._config.encoding));R||this._chunkLoaded({target:{result:M}})},this._chunkLoaded=function(T){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(T.target.result)},this._chunkError=function(){this._sendError(k.error)}}function f(S){var k;x.call(this,S=S||{}),this.stream=function(F){return k=F,this._nextChunk()},this._nextChunk=function(){var F,R;if(!this._finished)return F=this._config.chunkSize,k=F?(R=k.substring(0,F),k.substring(F)):(R=k,""),this._finished=!k,this.parseChunk(R)}}function g(S){x.call(this,S=S||{});var k=[],F=!0,R=!1;this.pause=function(){x.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){x.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(T){this._input=T,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){R&&k.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),k.length?this.parseChunk(k.shift()):F=!0},this._streamData=b(function(T){try{k.push(typeof T=="string"?T:T.toString(this._config.encoding)),F&&(F=!1,this._checkIsFinished(),this.parseChunk(k.shift()))}catch(M){this._streamError(M)}},this),this._streamError=b(function(T){this._streamCleanUp(),this._sendError(T)},this),this._streamEnd=b(function(){this._streamCleanUp(),R=!0,this._streamData("")},this),this._streamCleanUp=b(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function p(S){var k,F,R,T,M=Math.pow(2,53),X=-M,q=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,B=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,K=this,Q=0,_=0,ne=!1,ie=!1,A=[],P={data:[],errors:[],meta:{}};function O(se){return S.skipEmptyLines==="greedy"?se.join("").trim()==="":se.length===1&&se[0].length===0}function I(){if(P&&R&&(te("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+d.DefaultDelimiter+"'"),R=!1),S.skipEmptyLines&&(P.data=P.data.filter(function(be){return!O(be)})),J()){let be=function(H,De){C(S.transformHeader)&&(H=S.transformHeader(H,De)),A.push(H)};if(P)if(Array.isArray(P.data[0])){for(var se=0;J()&&se<P.data.length;se++)P.data[se].forEach(be);P.data.splice(0,1)}else P.data.forEach(be)}function le(be,H){for(var De=S.header?{}:[],re=0;re<be.length;re++){var Z=re,ee=be[re],ee=((ae,xe)=>(fe=>(S.dynamicTypingFunction&&S.dynamicTyping[fe]===void 0&&(S.dynamicTyping[fe]=S.dynamicTypingFunction(fe)),(S.dynamicTyping[fe]||S.dynamicTyping)===!0))(ae)?xe==="true"||xe==="TRUE"||xe!=="false"&&xe!=="FALSE"&&((fe=>{if(q.test(fe)&&(fe=parseFloat(fe),X<fe&&fe<M))return 1})(xe)?parseFloat(xe):B.test(xe)?new Date(xe):xe===""?null:xe):xe)(Z=S.header?re>=A.length?"__parsed_extra":A[re]:Z,ee=S.transform?S.transform(ee,Z):ee);Z==="__parsed_extra"?(De[Z]=De[Z]||[],De[Z].push(ee)):De[Z]=ee}return S.header&&(re>A.length?te("FieldMismatch","TooManyFields","Too many fields: expected "+A.length+" fields but parsed "+re,_+H):re<A.length&&te("FieldMismatch","TooFewFields","Too few fields: expected "+A.length+" fields but parsed "+re,_+H)),De}var ue;P&&(S.header||S.dynamicTyping||S.transform)&&(ue=1,!P.data.length||Array.isArray(P.data[0])?(P.data=P.data.map(le),ue=P.data.length):P.data=le(P.data,0),S.header&&P.meta&&(P.meta.fields=A),_+=ue)}function J(){return S.header&&A.length===0}function te(se,le,ue,be){se={type:se,code:le,message:ue},be!==void 0&&(se.row=be),P.errors.push(se)}C(S.step)&&(T=S.step,S.step=function(se){P=se,J()?I():(I(),P.data.length!==0&&(Q+=se.data.length,S.preview&&Q>S.preview?F.abort():(P.data=P.data[0],T(P,K))))}),this.parse=function(se,le,ue){var be=S.quoteChar||'"',be=(S.newline||(S.newline=this.guessLineEndings(se,be)),R=!1,S.delimiter?C(S.delimiter)&&(S.delimiter=S.delimiter(se),P.meta.delimiter=S.delimiter):((be=((H,De,re,Z,ee)=>{var ae,xe,fe,ve;ee=ee||[",","	","|",";",d.RECORD_SEP,d.UNIT_SEP];for(var Ae=0;Ae<ee.length;Ae++){for(var ye,He=ee[Ae],_e=0,Qe=0,Je=0,dt=(fe=void 0,new j({comments:Z,delimiter:He,newline:De,preview:10}).parse(H)),qe=0;qe<dt.data.length;qe++)re&&O(dt.data[qe])?Je++:(ye=dt.data[qe].length,Qe+=ye,fe===void 0?fe=ye:0<ye&&(_e+=Math.abs(ye-fe),fe=ye));0<dt.data.length&&(Qe/=dt.data.length-Je),(xe===void 0||_e<=xe)&&(ve===void 0||ve<Qe)&&1.99<Qe&&(xe=_e,ae=He,ve=Qe)}return{successful:!!(S.delimiter=ae),bestDelimiter:ae}})(se,S.newline,S.skipEmptyLines,S.comments,S.delimitersToGuess)).successful?S.delimiter=be.bestDelimiter:(R=!0,S.delimiter=d.DefaultDelimiter),P.meta.delimiter=S.delimiter),D(S));return S.preview&&S.header&&be.preview++,k=se,F=new j(be),P=F.parse(k,le,ue),I(),ne?{meta:{paused:!0}}:P||{meta:{paused:!1}}},this.paused=function(){return ne},this.pause=function(){ne=!0,F.abort(),k=C(S.chunk)?"":k.substring(F.getCharIndex())},this.resume=function(){K.streamer._halted?(ne=!1,K.streamer.parseChunk(k,!0)):setTimeout(K.resume,3)},this.aborted=function(){return ie},this.abort=function(){ie=!0,F.abort(),P.meta.aborted=!0,C(S.complete)&&S.complete(P),k=""},this.guessLineEndings=function(H,be){H=H.substring(0,1048576);var be=new RegExp(u(be)+"([^]*?)"+u(be),"gm"),ue=(H=H.replace(be,"")).split("\r"),be=H.split(`
`),H=1<be.length&&be[0].length<ue[0].length;if(ue.length===1||H)return`
`;for(var De=0,re=0;re<ue.length;re++)ue[re][0]===`
`&&De++;return De>=ue.length/2?`\r
`:"\r"}}function u(S){return S.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function j(S){var k=(S=S||{}).delimiter,F=S.newline,R=S.comments,T=S.step,M=S.preview,X=S.fastMode,q=null,B=!1,K=S.quoteChar==null?'"':S.quoteChar,Q=K;if(S.escapeChar!==void 0&&(Q=S.escapeChar),(typeof k!="string"||-1<d.BAD_DELIMITERS.indexOf(k))&&(k=","),R===k)throw new Error("Comment character same as delimiter");R===!0?R="#":(typeof R!="string"||-1<d.BAD_DELIMITERS.indexOf(R))&&(R=!1),F!==`
`&&F!=="\r"&&F!==`\r
`&&(F=`
`);var _=0,ne=!1;this.parse=function(ie,A,P){if(typeof ie!="string")throw new Error("Input must be a string");var O=ie.length,I=k.length,J=F.length,te=R.length,se=C(T),le=[],ue=[],be=[],H=_=0;if(!ie)return _e();if(X||X!==!1&&ie.indexOf(K)===-1){for(var De=ie.split(F),re=0;re<De.length;re++){if(be=De[re],_+=be.length,re!==De.length-1)_+=F.length;else if(P)return _e();if(!R||be.substring(0,te)!==R){if(se){if(le=[],ve(be.split(k)),Qe(),ne)return _e()}else ve(be.split(k));if(M&&M<=re)return le=le.slice(0,M),_e(!0)}}return _e()}for(var Z=ie.indexOf(k,_),ee=ie.indexOf(F,_),ae=new RegExp(u(Q)+u(K),"g"),xe=ie.indexOf(K,_);;)if(ie[_]===K)for(xe=_,_++;;){if((xe=ie.indexOf(K,xe+1))===-1)return P||ue.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:le.length,index:_}),ye();if(xe===O-1)return ye(ie.substring(_,xe).replace(ae,K));if(K===Q&&ie[xe+1]===Q)xe++;else if(K===Q||xe===0||ie[xe-1]!==Q){Z!==-1&&Z<xe+1&&(Z=ie.indexOf(k,xe+1));var fe=Ae((ee=ee!==-1&&ee<xe+1?ie.indexOf(F,xe+1):ee)===-1?Z:Math.min(Z,ee));if(ie.substr(xe+1+fe,I)===k){be.push(ie.substring(_,xe).replace(ae,K)),ie[_=xe+1+fe+I]!==K&&(xe=ie.indexOf(K,_)),Z=ie.indexOf(k,_),ee=ie.indexOf(F,_);break}if(fe=Ae(ee),ie.substring(xe+1+fe,xe+1+fe+J)===F){if(be.push(ie.substring(_,xe).replace(ae,K)),He(xe+1+fe+J),Z=ie.indexOf(k,_),xe=ie.indexOf(K,_),se&&(Qe(),ne))return _e();if(M&&le.length>=M)return _e(!0);break}ue.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:le.length,index:_}),xe++}}else if(R&&be.length===0&&ie.substring(_,_+te)===R){if(ee===-1)return _e();_=ee+J,ee=ie.indexOf(F,_),Z=ie.indexOf(k,_)}else if(Z!==-1&&(Z<ee||ee===-1))be.push(ie.substring(_,Z)),_=Z+I,Z=ie.indexOf(k,_);else{if(ee===-1)break;if(be.push(ie.substring(_,ee)),He(ee+J),se&&(Qe(),ne))return _e();if(M&&le.length>=M)return _e(!0)}return ye();function ve(Je){le.push(Je),H=_}function Ae(Je){var dt=0;return dt=Je!==-1&&(Je=ie.substring(xe+1,Je))&&Je.trim()===""?Je.length:dt}function ye(Je){return P||(Je===void 0&&(Je=ie.substring(_)),be.push(Je),_=O,ve(be),se&&Qe()),_e()}function He(Je){_=Je,ve(be),be=[],ee=ie.indexOf(F,_)}function _e(Je){if(S.header&&!A&&le.length&&!B){var dt=le[0],qe=Object.create(null),Ye=new Set(dt);let Be=!1;for(let et=0;et<dt.length;et++){let xt=dt[et];if(qe[xt=C(S.transformHeader)?S.transformHeader(xt,et):xt]){let it,As=qe[xt];for(;it=xt+"_"+As,As++,Ye.has(it););Ye.add(it),dt[et]=it,qe[xt]++,Be=!0,(q=q===null?{}:q)[it]=xt}else qe[xt]=1,dt[et]=xt;Ye.add(xt)}Be&&console.warn("Duplicate headers found and renamed."),B=!0}return{data:le,errors:ue,meta:{delimiter:k,linebreak:F,aborted:ne,truncated:!!Je,cursor:H+(A||0),renamedHeaders:q}}}function Qe(){T(_e()),le=[],ue=[]}},this.abort=function(){ne=!0},this.getCharIndex=function(){return _}}function y(S){var k=S.data,F=c[k.workerId],R=!1;if(k.error)F.userError(k.error,k.file);else if(k.results&&k.results.data){var T={abort:function(){R=!0,N(k.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:w,resume:w};if(C(F.userStep)){for(var M=0;M<k.results.data.length&&(F.userStep({data:k.results.data[M],errors:k.results.errors,meta:k.results.meta},T),!R);M++);delete k.results}else C(F.userChunk)&&(F.userChunk(k.results,T,k.file),delete k.results)}k.finished&&!R&&N(k.workerId,k.results)}function N(S,k){var F=c[S];C(F.userComplete)&&F.userComplete(k),F.terminate(),delete c[S]}function w(){throw new Error("Not implemented.")}function D(S){if(typeof S!="object"||S===null)return S;var k,F=Array.isArray(S)?[]:{};for(k in S)F[k]=D(S[k]);return F}function b(S,k){return function(){S.apply(k,arguments)}}function C(S){return typeof S=="function"}return d.parse=function(S,k){var F=(k=k||{}).dynamicTyping||!1;if(C(F)&&(k.dynamicTypingFunction=F,F={}),k.dynamicTyping=F,k.transform=!!C(k.transform)&&k.transform,!k.worker||!d.WORKERS_SUPPORTED)return F=null,d.NODE_STREAM_INPUT,typeof S=="string"?(S=(R=>R.charCodeAt(0)!==65279?R:R.slice(1))(S),F=new(k.download?m:f)(k)):S.readable===!0&&C(S.read)&&C(S.on)?F=new g(k):(n.File&&S instanceof File||S instanceof Object)&&(F=new h(k)),F.stream(S);(F=(()=>{var R;return!!d.WORKERS_SUPPORTED&&(R=(()=>{var T=n.URL||n.webkitURL||null,M=s.toString();return d.BLOB_URL||(d.BLOB_URL=T.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",M,")();"],{type:"text/javascript"})))})(),(R=new n.Worker(R)).onmessage=y,R.id=o++,c[R.id]=R)})()).userStep=k.step,F.userChunk=k.chunk,F.userComplete=k.complete,F.userError=k.error,k.step=C(k.step),k.chunk=C(k.chunk),k.complete=C(k.complete),k.error=C(k.error),delete k.worker,F.postMessage({input:S,config:k,workerId:F.id})},d.unparse=function(S,k){var F=!1,R=!0,T=",",M=`\r
`,X='"',q=X+X,B=!1,K=null,Q=!1,_=((()=>{if(typeof k=="object"){if(typeof k.delimiter!="string"||d.BAD_DELIMITERS.filter(function(A){return k.delimiter.indexOf(A)!==-1}).length||(T=k.delimiter),typeof k.quotes!="boolean"&&typeof k.quotes!="function"&&!Array.isArray(k.quotes)||(F=k.quotes),typeof k.skipEmptyLines!="boolean"&&typeof k.skipEmptyLines!="string"||(B=k.skipEmptyLines),typeof k.newline=="string"&&(M=k.newline),typeof k.quoteChar=="string"&&(X=k.quoteChar),typeof k.header=="boolean"&&(R=k.header),Array.isArray(k.columns)){if(k.columns.length===0)throw new Error("Option columns is empty");K=k.columns}k.escapeChar!==void 0&&(q=k.escapeChar+X),k.escapeFormulae instanceof RegExp?Q=k.escapeFormulae:typeof k.escapeFormulae=="boolean"&&k.escapeFormulae&&(Q=/^[=+\-@\t\r].*$/)}})(),new RegExp(u(X),"g"));if(typeof S=="string"&&(S=JSON.parse(S)),Array.isArray(S)){if(!S.length||Array.isArray(S[0]))return ne(null,S,B);if(typeof S[0]=="object")return ne(K||Object.keys(S[0]),S,B)}else if(typeof S=="object")return typeof S.data=="string"&&(S.data=JSON.parse(S.data)),Array.isArray(S.data)&&(S.fields||(S.fields=S.meta&&S.meta.fields||K),S.fields||(S.fields=Array.isArray(S.data[0])?S.fields:typeof S.data[0]=="object"?Object.keys(S.data[0]):[]),Array.isArray(S.data[0])||typeof S.data[0]=="object"||(S.data=[S.data])),ne(S.fields||[],S.data||[],B);throw new Error("Unable to serialize unrecognized input");function ne(A,P,O){var I="",J=(typeof A=="string"&&(A=JSON.parse(A)),typeof P=="string"&&(P=JSON.parse(P)),Array.isArray(A)&&0<A.length),te=!Array.isArray(P[0]);if(J&&R){for(var se=0;se<A.length;se++)0<se&&(I+=T),I+=ie(A[se],se);0<P.length&&(I+=M)}for(var le=0;le<P.length;le++){var ue=(J?A:P[le]).length,be=!1,H=J?Object.keys(P[le]).length===0:P[le].length===0;if(O&&!J&&(be=O==="greedy"?P[le].join("").trim()==="":P[le].length===1&&P[le][0].length===0),O==="greedy"&&J){for(var De=[],re=0;re<ue;re++){var Z=te?A[re]:re;De.push(P[le][Z])}be=De.join("").trim()===""}if(!be){for(var ee=0;ee<ue;ee++){0<ee&&!H&&(I+=T);var ae=J&&te?A[ee]:ee;I+=ie(P[le][ae],ee)}le<P.length-1&&(!O||0<ue&&!H)&&(I+=M)}}return I}function ie(A,P){var O,I;return A==null?"":A.constructor===Date?JSON.stringify(A).slice(1,25):(I=!1,Q&&typeof A=="string"&&Q.test(A)&&(A="'"+A,I=!0),O=A.toString().replace(_,q),(I=I||F===!0||typeof F=="function"&&F(A,P)||Array.isArray(F)&&F[P]||((J,te)=>{for(var se=0;se<te.length;se++)if(-1<J.indexOf(te[se]))return!0;return!1})(O,d.BAD_DELIMITERS)||-1<O.indexOf(T)||O.charAt(0)===" "||O.charAt(O.length-1)===" ")?X+O+X:O)}},d.RECORD_SEP="",d.UNIT_SEP="",d.BYTE_ORDER_MARK="\uFEFF",d.BAD_DELIMITERS=["\r",`
`,'"',d.BYTE_ORDER_MARK],d.WORKERS_SUPPORTED=!i&&!!n.Worker,d.NODE_STREAM_INPUT=1,d.LocalChunkSize=10485760,d.RemoteChunkSize=5242880,d.DefaultDelimiter=",",d.Parser=j,d.ParserHandle=p,d.NetworkStreamer=m,d.FileStreamer=h,d.StringStreamer=f,d.ReadableStreamStreamer=g,n.jQuery&&((r=n.jQuery).fn.parse=function(S){var k=S.config||{},F=[];return this.each(function(M){if(!(r(this).prop("tagName").toUpperCase()==="INPUT"&&r(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var X=0;X<this.files.length;X++)F.push({file:this.files[X],inputElem:this,instanceConfig:r.extend({},k)})}),R(),this;function R(){if(F.length===0)C(S.complete)&&S.complete();else{var M,X,q,B,K=F[0];if(C(S.before)){var Q=S.before(K.file,K.inputElem);if(typeof Q=="object"){if(Q.action==="abort")return M="AbortError",X=K.file,q=K.inputElem,B=Q.reason,void(C(S.error)&&S.error({name:M},X,q,B));if(Q.action==="skip")return void T();typeof Q.config=="object"&&(K.instanceConfig=r.extend(K.instanceConfig,Q.config))}else if(Q==="skip")return void T()}var _=K.instanceConfig.complete;K.instanceConfig.complete=function(ne){C(_)&&_(ne,K.file,K.inputElem),T()},d.parse(K.file,K.instanceConfig)}}function T(){F.splice(0,1),R()}}),l&&(n.onmessage=function(S){S=S.data,d.WORKER_ID===void 0&&S&&(d.WORKER_ID=S.workerId),typeof S.input=="string"?n.postMessage({workerId:d.WORKER_ID,results:d.parse(S.input,S.config),finished:!0}):(n.File&&S.input instanceof File||S.input instanceof Object)&&(S=d.parse(S.input,S.config))&&n.postMessage({workerId:d.WORKER_ID,results:S,finished:!0})}),(m.prototype=Object.create(x.prototype)).constructor=m,(h.prototype=Object.create(x.prototype)).constructor=h,(f.prototype=Object.create(f.prototype)).constructor=f,(g.prototype=Object.create(x.prototype)).constructor=g,d})})(sd);var Pu=sd.exports;const Pl=s0(Pu);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ad=1252,Lu=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ei={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Fi=function(t){Lu.indexOf(t)!=-1&&(ad=Ei[0]=t)};function Iu(){Fi(1252)}var Ns=function(t){Fi(t)};function rd(){Ns(1200),Iu()}function Ll(t){for(var a=[],s=0,n=t.length;s<n;++s)a[s]=t.charCodeAt(s);return a}function Ou(t){for(var a=[],s=0;s<t.length>>1;++s)a[s]=String.fromCharCode(t.charCodeAt(2*s)+(t.charCodeAt(2*s+1)<<8));return a.join("")}function nd(t){for(var a=[],s=0;s<t.length>>1;++s)a[s]=String.fromCharCode(t.charCodeAt(2*s+1)+(t.charCodeAt(2*s)<<8));return a.join("")}var Ja=function(t){var a=t.charCodeAt(0),s=t.charCodeAt(1);return a==255&&s==254?Ou(t.slice(2)):a==254&&s==255?nd(t.slice(2)):a==65279?t.slice(1):t},Or=function(a){return String.fromCharCode(a)},Il=function(a){return String.fromCharCode(a)},xr,Ks="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ol(t){for(var a="",s=0,n=0,r=0,i=0,l=0,c=0,o=0,d=0;d<t.length;)s=t.charCodeAt(d++),i=s>>2,n=t.charCodeAt(d++),l=(s&3)<<4|n>>4,r=t.charCodeAt(d++),c=(n&15)<<2|r>>6,o=r&63,isNaN(n)?c=o=64:isNaN(r)&&(o=64),a+=Ks.charAt(i)+Ks.charAt(l)+Ks.charAt(c)+Ks.charAt(o);return a}function os(t){var a="",s=0,n=0,r=0,i=0,l=0,c=0,o=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)i=Ks.indexOf(t.charAt(d++)),l=Ks.indexOf(t.charAt(d++)),s=i<<2|l>>4,a+=String.fromCharCode(s),c=Ks.indexOf(t.charAt(d++)),n=(l&15)<<4|c>>2,c!==64&&(a+=String.fromCharCode(n)),o=Ks.indexOf(t.charAt(d++)),r=(c&3)<<6|o,o!==64&&(a+=String.fromCharCode(r));return a}var We=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ba=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(a,s){return s?new Buffer(a,s):new Buffer(a)}:Buffer.from.bind(Buffer)}return function(){}}();function ta(t){return We?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Ml(t){return We?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var vs=function(a){return We?ba(a,"binary"):a.split("").map(function(s){return s.charCodeAt(0)&255})};function ja(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var a=[],s=0;s<t.length;++s)a[s]=String.fromCharCode(t[s]);return a.join("")}function Ti(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Ti(new Uint8Array(t));for(var a=new Array(t.length),s=0;s<t.length;++s)a[s]=t[s];return a}var Xs=We?function(t){return Buffer.concat(t.map(function(a){return Buffer.isBuffer(a)?a:ba(a)}))}:function(t){if(typeof Uint8Array<"u"){var a=0,s=0;for(a=0;a<t.length;++a)s+=t[a].length;var n=new Uint8Array(s),r=0;for(a=0,s=0;a<t.length;s+=r,++a)if(r=t[a].length,t[a]instanceof Uint8Array)n.set(t[a],s);else{if(typeof t[a]=="string")throw"wtf";n.set(new Uint8Array(t[a]),s)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Mu(t){for(var a=[],s=0,n=t.length+250,r=ta(t.length+255),i=0;i<t.length;++i){var l=t.charCodeAt(i);if(l<128)r[s++]=l;else if(l<2048)r[s++]=192|l>>6&31,r[s++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=t.charCodeAt(++i)&1023;r[s++]=240|l>>8&7,r[s++]=128|l>>2&63,r[s++]=128|c>>6&15|(l&3)<<4,r[s++]=128|c&63}else r[s++]=224|l>>12&15,r[s++]=128|l>>6&63,r[s++]=128|l&63;s>n&&(a.push(r.slice(0,s)),s=0,r=ta(65535),n=65530)}return a.push(r.slice(0,s)),Xs(a)}var Jt=/\u0000/g,Qa=/[\u0001-\u0006]/g;function Fa(t){for(var a="",s=t.length-1;s>=0;)a+=t.charAt(s--);return a}function ws(t,a){var s=""+t;return s.length>=a?s:pt("0",a-s.length)+s}function Di(t,a){var s=""+t;return s.length>=a?s:pt(" ",a-s.length)+s}function en(t,a){var s=""+t;return s.length>=a?s:s+pt(" ",a-s.length)}function $u(t,a){var s=""+Math.round(t);return s.length>=a?s:pt("0",a-s.length)+s}function Bu(t,a){var s=""+t;return s.length>=a?s:pt("0",a-s.length)+s}var $l=Math.pow(2,32);function Ca(t,a){if(t>$l||t<-$l)return $u(t,a);var s=Math.round(t);return Bu(s,a)}function tn(t,a){return a=a||0,t.length>=7+a&&(t.charCodeAt(a)|32)===103&&(t.charCodeAt(a+1)|32)===101&&(t.charCodeAt(a+2)|32)===110&&(t.charCodeAt(a+3)|32)===101&&(t.charCodeAt(a+4)|32)===114&&(t.charCodeAt(a+5)|32)===97&&(t.charCodeAt(a+6)|32)===108}var Bl=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],_n=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Uu(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "',t}var Me={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"ä¸Šåˆ/ä¸‹åˆ "hh"æ™‚"mm"åˆ†"ss"ç§’ "'},Ul={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},zu={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function sn(t,a,s){for(var n=t<0?-1:1,r=t*n,i=0,l=1,c=0,o=1,d=0,x=0,m=Math.floor(r);d<a&&(m=Math.floor(r),c=m*l+i,x=m*d+o,!(r-m<5e-8));)r=1/(r-m),i=l,l=c,o=d,d=x;if(x>a&&(d>a?(x=o,c=i):(x=d,c=l)),!s)return[0,n*c,x];var h=Math.floor(n*c/x);return[h,n*c-h*x,x]}function oa(t,a,s){if(t>2958465||t<0)return null;var n=t|0,r=Math.floor(86400*(t-n)),i=0,l=[],c={D:n,T:r,u:86400*(t-n)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),a&&a.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++r==86400&&(c.T=r=0,++n,++c.D)),n===60)l=s?[1317,10,29]:[1900,2,29],i=3;else if(n===0)l=s?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var o=new Date(1900,0,1);o.setDate(o.getDate()+n-1),l=[o.getFullYear(),o.getMonth()+1,o.getDate()],i=o.getDay(),n<60&&(i=(i+6)%7),s&&(i=Yu(o,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=r%60,r=Math.floor(r/60),c.M=r%60,r=Math.floor(r/60),c.H=r,c.q=i,c}var id=new Date(1899,11,31,0,0,0),Hu=id.getTime(),qu=new Date(1900,2,1,0,0,0);function ld(t,a){var s=t.getTime();return a?s-=1461*24*60*60*1e3:t>=qu&&(s+=24*60*60*1e3),(s-(Hu+(t.getTimezoneOffset()-id.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function _i(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Wu(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Vu(t){var a=t<0?12:11,s=_i(t.toFixed(12));return s.length<=a||(s=t.toPrecision(10),s.length<=a)?s:t.toExponential(5)}function Gu(t){var a=_i(t.toFixed(11));return a.length>(t<0?12:11)||a==="0"||a==="-0"?t.toPrecision(6):a}function mr(t){var a=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),s;return a>=-4&&a<=-1?s=t.toPrecision(10+a):Math.abs(a)<=9?s=Vu(t):a===10?s=t.toFixed(10).substr(0,12):s=Gu(t),_i(Wu(s.toUpperCase()))}function pa(t,a){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):mr(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return gs(14,ld(t,a&&a.date1904),a)}throw new Error("unsupported value in General format: "+t)}function Yu(t,a){a[0]-=581;var s=t.getDay();return t<60&&(s=(s+6)%7),s}function Xu(t,a,s,n){var r="",i=0,l=0,c=s.y,o,d=0;switch(t){case 98:c=s.y+543;case 121:switch(a.length){case 1:case 2:o=c%100,d=2;break;default:o=c%1e4,d=4;break}break;case 109:switch(a.length){case 1:case 2:o=s.m,d=a.length;break;case 3:return _n[s.m-1][1];case 5:return _n[s.m-1][0];default:return _n[s.m-1][2]}break;case 100:switch(a.length){case 1:case 2:o=s.d,d=a.length;break;case 3:return Bl[s.q][0];default:return Bl[s.q][1]}break;case 104:switch(a.length){case 1:case 2:o=1+(s.H+11)%12,d=a.length;break;default:throw"bad hour format: "+a}break;case 72:switch(a.length){case 1:case 2:o=s.H,d=a.length;break;default:throw"bad hour format: "+a}break;case 77:switch(a.length){case 1:case 2:o=s.M,d=a.length;break;default:throw"bad minute format: "+a}break;case 115:if(a!="s"&&a!="ss"&&a!=".0"&&a!=".00"&&a!=".000")throw"bad second format: "+a;return s.u===0&&(a=="s"||a=="ss")?ws(s.S,a.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,i=Math.round(l*(s.S+s.u)),i>=60*l&&(i=0),a==="s"?i===0?"0":""+i/l:(r=ws(i,2+n),a==="ss"?r.substr(0,2):"."+r.substr(2,a.length-1)));case 90:switch(a){case"[h]":case"[hh]":o=s.D*24+s.H;break;case"[m]":case"[mm]":o=(s.D*24+s.H)*60+s.M;break;case"[s]":case"[ss]":o=((s.D*24+s.H)*60+s.M)*60+Math.round(s.S+s.u);break;default:throw"bad abstime format: "+a}d=a.length===3?1:2;break;case 101:o=c,d=1;break}var x=d>0?ws(o,d):"";return x}function Js(t){var a=3;if(t.length<=a)return t;for(var s=t.length%a,n=t.substr(0,s);s!=t.length;s+=a)n+=(n.length>0?",":"")+t.substr(s,a);return n}var cd=/%/g;function Ku(t,a,s){var n=a.replace(cd,""),r=a.length-n.length;return Us(t,n,s*Math.pow(10,2*r))+pt("%",r)}function Ju(t,a,s){for(var n=a.length-1;a.charCodeAt(n-1)===44;)--n;return Us(t,a.substr(0,n),s/Math.pow(10,3*(a.length-n)))}function od(t,a){var s,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(a==0)return"0.0E+0";if(a<0)return"-"+od(t,-a);var r=t.indexOf(".");r===-1&&(r=t.indexOf("E"));var i=Math.floor(Math.log(a)*Math.LOG10E)%r;if(i<0&&(i+=r),s=(a/Math.pow(10,i)).toPrecision(n+1+(r+i)%r),s.indexOf("e")===-1){var l=Math.floor(Math.log(a)*Math.LOG10E);for(s.indexOf(".")===-1?s=s.charAt(0)+"."+s.substr(1)+"E+"+(l-s.length+i):s+="E+"+(l-i);s.substr(0,2)==="0.";)s=s.charAt(0)+s.substr(2,r)+"."+s.substr(2+r),s=s.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");s=s.replace(/\+-/,"-")}s=s.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,o,d,x){return o+d+x.substr(0,(r+i)%r)+"."+x.substr(i)+"E"})}else s=a.toExponential(n);return t.match(/E\+00$/)&&s.match(/e[+-]\d$/)&&(s=s.substr(0,s.length-1)+"0"+s.charAt(s.length-1)),t.match(/E\-/)&&s.match(/e\+/)&&(s=s.replace(/e\+/,"e")),s.replace("e","E")}var dd=/# (\?+)( ?)\/( ?)(\d+)/;function Qu(t,a,s){var n=parseInt(t[4],10),r=Math.round(a*n),i=Math.floor(r/n),l=r-i*n,c=n;return s+(i===0?"":""+i)+" "+(l===0?pt(" ",t[1].length+1+t[4].length):Di(l,t[1].length)+t[2]+"/"+t[3]+ws(c,t[4].length))}function Zu(t,a,s){return s+(a===0?"":""+a)+pt(" ",t[1].length+2+t[4].length)}var xd=/^#*0*\.([0#]+)/,md=/\).*[0#]/,hd=/\(###\) ###\\?-####/;function Yt(t){for(var a="",s,n=0;n!=t.length;++n)switch(s=t.charCodeAt(n)){case 35:break;case 63:a+=" ";break;case 48:a+="0";break;default:a+=String.fromCharCode(s)}return a}function zl(t,a){var s=Math.pow(10,a);return""+Math.round(t*s)/s}function Hl(t,a){var s=t-Math.floor(t),n=Math.pow(10,a);return a<(""+Math.round(s*n)).length?0:Math.round(s*n)}function ep(t,a){return a<(""+Math.round((t-Math.floor(t))*Math.pow(10,a))).length?1:0}function tp(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function us(t,a,s){if(t.charCodeAt(0)===40&&!a.match(md)){var n=a.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return s>=0?us("n",n,s):"("+us("n",n,-s)+")"}if(a.charCodeAt(a.length-1)===44)return Ju(t,a,s);if(a.indexOf("%")!==-1)return Ku(t,a,s);if(a.indexOf("E")!==-1)return od(a,s);if(a.charCodeAt(0)===36)return"$"+us(t,a.substr(a.charAt(1)==" "?2:1),s);var r,i,l,c,o=Math.abs(s),d=s<0?"-":"";if(a.match(/^00+$/))return d+Ca(o,a.length);if(a.match(/^[#?]+$/))return r=Ca(s,0),r==="0"&&(r=""),r.length>a.length?r:Yt(a.substr(0,a.length-r.length))+r;if(i=a.match(dd))return Qu(i,o,d);if(a.match(/^#+0+$/))return d+Ca(o,a.length-a.indexOf("0"));if(i=a.match(xd))return r=zl(s,i[1].length).replace(/^([^\.]+)$/,"$1."+Yt(i[1])).replace(/\.$/,"."+Yt(i[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+pt("0",Yt(i[1]).length-p.length)}),a.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(a=a.replace(/^#+([0.])/,"$1"),i=a.match(/^(0*)\.(#*)$/))return d+zl(o,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=a.match(/^#{1,3},##0(\.?)$/))return d+Js(Ca(o,0));if(i=a.match(/^#,##0\.([#0]*0)$/))return s<0?"-"+us(t,a,-s):Js(""+(Math.floor(s)+ep(s,i[1].length)))+"."+ws(Hl(s,i[1].length),i[1].length);if(i=a.match(/^#,#*,#0/))return us(t,a.replace(/^#,#*,/,""),s);if(i=a.match(/^([0#]+)(\\?-([0#]+))+$/))return r=Fa(us(t,a.replace(/[\\-]/g,""),s)),l=0,Fa(Fa(a.replace(/\\/g,"")).replace(/[0#]/g,function(g){return l<r.length?r.charAt(l++):g==="0"?"0":""}));if(a.match(hd))return r=us(t,"##########",s),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var x="";if(i=a.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),c=sn(o,Math.pow(10,l)-1,!1),r=""+d,x=Us("n",i[1],c[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),r+=x+i[2]+"/"+i[3],x=en(c[2],l),x.length<i[4].length&&(x=Yt(i[4].substr(i[4].length-x.length))+x),r+=x,r;if(i=a.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),c=sn(o,Math.pow(10,l)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Di(c[1],l)+i[2]+"/"+i[3]+en(c[2],l):pt(" ",2*l+1+i[2].length+i[3].length));if(i=a.match(/^[#0?]+$/))return r=Ca(s,0),a.length<=r.length?r:Yt(a.substr(0,a.length-r.length))+r;if(i=a.match(/^([#0?]+)\.([#0]+)$/)){r=""+s.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=r.indexOf(".");var m=a.indexOf(".")-l,h=a.length-r.length-m;return Yt(a.substr(0,m)+r+a.substr(a.length-h))}if(i=a.match(/^00,000\.([#0]*0)$/))return l=Hl(s,i[1].length),s<0?"-"+us(t,a,-s):Js(tp(s)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?ws(0,3-g.length):"")+g})+"."+ws(l,i[1].length);switch(a){case"###,##0.00":return us(t,"#,##0.00",s);case"###,###":case"##,###":case"#,###":var f=Js(Ca(o,0));return f!=="0"?d+f:"";case"###,###.00":return us(t,"###,##0.00",s).replace(/^0\./,".");case"#,###.00":return us(t,"#,##0.00",s).replace(/^0\./,".")}throw new Error("unsupported format |"+a+"|")}function sp(t,a,s){for(var n=a.length-1;a.charCodeAt(n-1)===44;)--n;return Us(t,a.substr(0,n),s/Math.pow(10,3*(a.length-n)))}function ap(t,a,s){var n=a.replace(cd,""),r=a.length-n.length;return Us(t,n,s*Math.pow(10,2*r))+pt("%",r)}function ud(t,a){var s,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(a==0)return"0.0E+0";if(a<0)return"-"+ud(t,-a);var r=t.indexOf(".");r===-1&&(r=t.indexOf("E"));var i=Math.floor(Math.log(a)*Math.LOG10E)%r;if(i<0&&(i+=r),s=(a/Math.pow(10,i)).toPrecision(n+1+(r+i)%r),!s.match(/[Ee]/)){var l=Math.floor(Math.log(a)*Math.LOG10E);s.indexOf(".")===-1?s=s.charAt(0)+"."+s.substr(1)+"E+"+(l-s.length+i):s+="E+"+(l-i),s=s.replace(/\+-/,"-")}s=s.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,o,d,x){return o+d+x.substr(0,(r+i)%r)+"."+x.substr(i)+"E"})}else s=a.toExponential(n);return t.match(/E\+00$/)&&s.match(/e[+-]\d$/)&&(s=s.substr(0,s.length-1)+"0"+s.charAt(s.length-1)),t.match(/E\-/)&&s.match(/e\+/)&&(s=s.replace(/e\+/,"e")),s.replace("e","E")}function Ts(t,a,s){if(t.charCodeAt(0)===40&&!a.match(md)){var n=a.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return s>=0?Ts("n",n,s):"("+Ts("n",n,-s)+")"}if(a.charCodeAt(a.length-1)===44)return sp(t,a,s);if(a.indexOf("%")!==-1)return ap(t,a,s);if(a.indexOf("E")!==-1)return ud(a,s);if(a.charCodeAt(0)===36)return"$"+Ts(t,a.substr(a.charAt(1)==" "?2:1),s);var r,i,l,c,o=Math.abs(s),d=s<0?"-":"";if(a.match(/^00+$/))return d+ws(o,a.length);if(a.match(/^[#?]+$/))return r=""+s,s===0&&(r=""),r.length>a.length?r:Yt(a.substr(0,a.length-r.length))+r;if(i=a.match(dd))return Zu(i,o,d);if(a.match(/^#+0+$/))return d+ws(o,a.length-a.indexOf("0"));if(i=a.match(xd))return r=(""+s).replace(/^([^\.]+)$/,"$1."+Yt(i[1])).replace(/\.$/,"."+Yt(i[1])),r=r.replace(/\.(\d*)$/,function(g,p){return"."+p+pt("0",Yt(i[1]).length-p.length)}),a.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(a=a.replace(/^#+([0.])/,"$1"),i=a.match(/^(0*)\.(#*)$/))return d+(""+o).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=a.match(/^#{1,3},##0(\.?)$/))return d+Js(""+o);if(i=a.match(/^#,##0\.([#0]*0)$/))return s<0?"-"+Ts(t,a,-s):Js(""+s)+"."+pt("0",i[1].length);if(i=a.match(/^#,#*,#0/))return Ts(t,a.replace(/^#,#*,/,""),s);if(i=a.match(/^([0#]+)(\\?-([0#]+))+$/))return r=Fa(Ts(t,a.replace(/[\\-]/g,""),s)),l=0,Fa(Fa(a.replace(/\\/g,"")).replace(/[0#]/g,function(g){return l<r.length?r.charAt(l++):g==="0"?"0":""}));if(a.match(hd))return r=Ts(t,"##########",s),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var x="";if(i=a.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),c=sn(o,Math.pow(10,l)-1,!1),r=""+d,x=Us("n",i[1],c[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),r+=x+i[2]+"/"+i[3],x=en(c[2],l),x.length<i[4].length&&(x=Yt(i[4].substr(i[4].length-x.length))+x),r+=x,r;if(i=a.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),c=sn(o,Math.pow(10,l)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Di(c[1],l)+i[2]+"/"+i[3]+en(c[2],l):pt(" ",2*l+1+i[2].length+i[3].length));if(i=a.match(/^[#0?]+$/))return r=""+s,a.length<=r.length?r:Yt(a.substr(0,a.length-r.length))+r;if(i=a.match(/^([#0]+)\.([#0]+)$/)){r=""+s.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=r.indexOf(".");var m=a.indexOf(".")-l,h=a.length-r.length-m;return Yt(a.substr(0,m)+r+a.substr(a.length-h))}if(i=a.match(/^00,000\.([#0]*0)$/))return s<0?"-"+Ts(t,a,-s):Js(""+s).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?ws(0,3-g.length):"")+g})+"."+ws(0,i[1].length);switch(a){case"###,###":case"##,###":case"#,###":var f=Js(""+o);return f!=="0"?d+f:"";default:if(a.match(/\.[0#?]*$/))return Ts(t,a.slice(0,a.lastIndexOf(".")),s)+Yt(a.slice(a.lastIndexOf(".")))}throw new Error("unsupported format |"+a+"|")}function Us(t,a,s){return(s|0)===s?Ts(t,a,s):us(t,a,s)}function rp(t){for(var a=[],s=!1,n=0,r=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:s=!s;break;case 95:case 42:case 92:++n;break;case 59:a[a.length]=t.substr(r,n-r),r=n+1}if(a[a.length]=t.substr(r),s===!0)throw new Error("Format |"+t+"| unterminated string ");return a}var pd=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ha(t){for(var a=0,s="",n="";a<t.length;)switch(s=t.charAt(a)){case"G":tn(t,a)&&(a+=6),a++;break;case'"':for(;t.charCodeAt(++a)!==34&&a<t.length;);++a;break;case"\\":a+=2;break;case"_":a+=2;break;case"@":++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"ä¸Š":if(t.substr(a,3).toUpperCase()==="A/P"||t.substr(a,5).toUpperCase()==="AM/PM"||t.substr(a,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ")return!0;++a;break;case"[":for(n=s;t.charAt(a++)!=="]"&&a<t.length;)n+=t.charAt(a);if(n.match(pd))return!0;break;case".":case"0":case"#":for(;a<t.length&&("0#?.,E+-%".indexOf(s=t.charAt(++a))>-1||s=="\\"&&t.charAt(a+1)=="-"&&"0#".indexOf(t.charAt(a+2))>-1););break;case"?":for(;t.charAt(++a)===s;);break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;);break;case" ":++a;break;default:++a;break}return!1}function np(t,a,s,n){for(var r=[],i="",l=0,c="",o="t",d,x,m,h="H";l<t.length;)switch(c=t.charAt(l)){case"G":if(!tn(t,l))throw new Error("unrecognized character "+c+" in "+t);r[r.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(m=t.charCodeAt(++l))!==34&&l<t.length;)i+=String.fromCharCode(m);r[r.length]={t:"t",v:i},++l;break;case"\\":var f=t.charAt(++l),g=f==="("||f===")"?f:"t";r[r.length]={t:g,v:f},++l;break;case"_":r[r.length]={t:"t",v:" "},l+=2;break;case"@":r[r.length]={t:"T",v:a},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(d==null&&(d=oa(a,s,t.charAt(l+1)==="2"),d==null))return"";r[r.length]={t:"X",v:t.substr(l,2)},o=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(a<0||d==null&&(d=oa(a,s),d==null))return"";for(i=c;++l<t.length&&t.charAt(l).toLowerCase()===c;)i+=c;c==="m"&&o.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=h),r[r.length]={t:c,v:i},o=c;break;case"A":case"a":case"ä¸Š":var p={t:c,v:c};if(d==null&&(d=oa(a,s)),t.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(p.v=d.H>=12?"P":"A"),p.t="T",h="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(p.v=d.H>=12?"PM":"AM"),p.t="T",l+=5,h="h"):t.substr(l,5).toUpperCase()==="ä¸Šåˆ/ä¸‹åˆ"?(d!=null&&(p.v=d.H>=12?"ä¸‹åˆ":"ä¸Šåˆ"),p.t="T",l+=5,h="h"):(p.t="t",++l),d==null&&p.t==="T")return"";r[r.length]=p,o=c;break;case"[":for(i=c;t.charAt(l++)!=="]"&&l<t.length;)i+=t.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(pd)){if(d==null&&(d=oa(a,s),d==null))return"";r[r.length]={t:"Z",v:i.toLowerCase()},o=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ha(t)||(r[r.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=c;++l<t.length&&(c=t.charAt(l))==="0";)i+=c;r[r.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++l<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(l))>-1;)i+=c;r[r.length]={t:"n",v:i};break;case"?":for(i=c;t.charAt(++l)===c;)i+=c;r[r.length]={t:c,v:i},o=c;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":r[r.length]={t:n===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)i+=t.charAt(l);r[r.length]={t:"D",v:i};break;case" ":r[r.length]={t:c,v:c},++l;break;case"$":r[r.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=â‚¬acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+t);r[r.length]={t:"t",v:c},++l;break}var u=0,j=0,y;for(l=r.length-1,o="t";l>=0;--l)switch(r[l].t){case"h":case"H":r[l].t=h,o="h",u<1&&(u=1);break;case"s":(y=r[l].v.match(/\.0+$/))&&(j=Math.max(j,y[0].length-1)),u<3&&(u=3);case"d":case"y":case"M":case"e":o=r[l].t;break;case"m":o==="s"&&(r[l].t="M",u<2&&(u=2));break;case"X":break;case"Z":u<1&&r[l].v.match(/[Hh]/)&&(u=1),u<2&&r[l].v.match(/[Mm]/)&&(u=2),u<3&&r[l].v.match(/[Ss]/)&&(u=3)}switch(u){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var N="",w;for(l=0;l<r.length;++l)switch(r[l].t){case"t":case"T":case" ":case"D":break;case"X":r[l].v="",r[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":r[l].v=Xu(r[l].t.charCodeAt(0),r[l].v,d,j),r[l].t="t";break;case"n":case"?":for(w=l+1;r[w]!=null&&((c=r[w].t)==="?"||c==="D"||(c===" "||c==="t")&&r[w+1]!=null&&(r[w+1].t==="?"||r[w+1].t==="t"&&r[w+1].v==="/")||r[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(r[w].v==="/"||r[w].v===" "&&r[w+1]!=null&&r[w+1].t=="?"));)r[l].v+=r[w].v,r[w]={v:"",t:";"},++w;N+=r[l].v,l=w-1;break;case"G":r[l].t="t",r[l].v=pa(a,s);break}var D="",b,C;if(N.length>0){N.charCodeAt(0)==40?(b=a<0&&N.charCodeAt(0)===45?-a:a,C=Us("n",N,b)):(b=a<0&&n>1?-a:a,C=Us("n",N,b),b<0&&r[0]&&r[0].t=="t"&&(C=C.substr(1),r[0].v="-"+r[0].v)),w=C.length-1;var S=r.length;for(l=0;l<r.length;++l)if(r[l]!=null&&r[l].t!="t"&&r[l].v.indexOf(".")>-1){S=l;break}var k=r.length;if(S===r.length&&C.indexOf("E")===-1){for(l=r.length-1;l>=0;--l)r[l]==null||"n?".indexOf(r[l].t)===-1||(w>=r[l].v.length-1?(w-=r[l].v.length,r[l].v=C.substr(w+1,r[l].v.length)):w<0?r[l].v="":(r[l].v=C.substr(0,w+1),w=-1),r[l].t="t",k=l);w>=0&&k<r.length&&(r[k].v=C.substr(0,w+1)+r[k].v)}else if(S!==r.length&&C.indexOf("E")===-1){for(w=C.indexOf(".")-1,l=S;l>=0;--l)if(!(r[l]==null||"n?".indexOf(r[l].t)===-1)){for(x=r[l].v.indexOf(".")>-1&&l===S?r[l].v.indexOf(".")-1:r[l].v.length-1,D=r[l].v.substr(x+1);x>=0;--x)w>=0&&(r[l].v.charAt(x)==="0"||r[l].v.charAt(x)==="#")&&(D=C.charAt(w--)+D);r[l].v=D,r[l].t="t",k=l}for(w>=0&&k<r.length&&(r[k].v=C.substr(0,w+1)+r[k].v),w=C.indexOf(".")+1,l=S;l<r.length;++l)if(!(r[l]==null||"n?(".indexOf(r[l].t)===-1&&l!==S)){for(x=r[l].v.indexOf(".")>-1&&l===S?r[l].v.indexOf(".")+1:0,D=r[l].v.substr(0,x);x<r[l].v.length;++x)w<C.length&&(D+=C.charAt(w++));r[l].v=D,r[l].t="t",k=l}}}for(l=0;l<r.length;++l)r[l]!=null&&"n?".indexOf(r[l].t)>-1&&(b=n>1&&a<0&&l>0&&r[l-1].v==="-"?-a:a,r[l].v=Us(r[l].t,r[l].v,b),r[l].t="t");var F="";for(l=0;l!==r.length;++l)r[l]!=null&&(F+=r[l].v);return F}var ql=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Wl(t,a){if(a==null)return!1;var s=parseFloat(a[2]);switch(a[1]){case"=":if(t==s)return!0;break;case">":if(t>s)return!0;break;case"<":if(t<s)return!0;break;case"<>":if(t!=s)return!0;break;case">=":if(t>=s)return!0;break;case"<=":if(t<=s)return!0;break}return!1}function ip(t,a){var s=rp(t),n=s.length,r=s[n-1].indexOf("@");if(n<4&&r>-1&&--n,s.length>4)throw new Error("cannot find right format for |"+s.join("|")+"|");if(typeof a!="number")return[4,s.length===4||r>-1?s[s.length-1]:"@"];switch(s.length){case 1:s=r>-1?["General","General","General",s[0]]:[s[0],s[0],s[0],"@"];break;case 2:s=r>-1?[s[0],s[0],s[0],s[1]]:[s[0],s[1],s[0],"@"];break;case 3:s=r>-1?[s[0],s[1],s[0],s[2]]:[s[0],s[1],s[2],"@"];break}var i=a>0?s[0]:a<0?s[1]:s[2];if(s[0].indexOf("[")===-1&&s[1].indexOf("[")===-1)return[n,i];if(s[0].match(/\[[=<>]/)!=null||s[1].match(/\[[=<>]/)!=null){var l=s[0].match(ql),c=s[1].match(ql);return Wl(a,l)?[n,s[0]]:Wl(a,c)?[n,s[1]]:[n,s[l!=null&&c!=null?2:1]]}return[n,i]}function gs(t,a,s){s==null&&(s={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&s.dateNF?n=s.dateNF:n=t;break;case"number":t==14&&s.dateNF?n=s.dateNF:n=(s.table!=null?s.table:Me)[t],n==null&&(n=s.table&&s.table[Ul[t]]||Me[Ul[t]]),n==null&&(n=zu[t]||"General");break}if(tn(n,0))return pa(a,s);a instanceof Date&&(a=ld(a,s.date1904));var r=ip(n,a);if(tn(r[1]))return pa(a,s);if(a===!0)a="TRUE";else if(a===!1)a="FALSE";else if(a===""||a==null)return"";return np(r[1],a,s,r[0])}function xa(t,a){if(typeof a!="number"){a=+a||-1;for(var s=0;s<392;++s){if(Me[s]==null){a<0&&(a=s);continue}if(Me[s]==t){a=s;break}}a<0&&(a=391)}return Me[a]=t,a}function fd(){Me=Uu()}var lp={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},gd=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function cp(t){var a=typeof t=="number"?Me[t]:t;return a=a.replace(gd,"(\\d+)"),new RegExp("^"+a+"$")}function op(t,a,s){var n=-1,r=-1,i=-1,l=-1,c=-1,o=-1;(a.match(gd)||[]).forEach(function(m,h){var f=parseInt(s[h+1],10);switch(m.toLowerCase().charAt(0)){case"y":n=f;break;case"d":i=f;break;case"h":l=f;break;case"s":o=f;break;case"m":l>=0?c=f:r=f;break}}),o>=0&&c==-1&&r>=0&&(c=r,r=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var x=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2);return l==-1&&c==-1&&o==-1?d:n==-1&&r==-1&&i==-1?x:d+"T"+x}var dp=function(){var t={};t.version="1.2.0";function a(){for(var C=0,S=new Array(256),k=0;k!=256;++k)C=k,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,S[k]=C;return typeof Int32Array<"u"?new Int32Array(S):S}var s=a();function n(C){var S=0,k=0,F=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(F=0;F!=256;++F)R[F]=C[F];for(F=0;F!=256;++F)for(k=C[F],S=256+F;S<4096;S+=256)k=R[S]=k>>>8^C[k&255];var T=[];for(F=1;F!=16;++F)T[F-1]=typeof Int32Array<"u"?R.subarray(F*256,F*256+256):R.slice(F*256,F*256+256);return T}var r=n(s),i=r[0],l=r[1],c=r[2],o=r[3],d=r[4],x=r[5],m=r[6],h=r[7],f=r[8],g=r[9],p=r[10],u=r[11],j=r[12],y=r[13],N=r[14];function w(C,S){for(var k=S^-1,F=0,R=C.length;F<R;)k=k>>>8^s[(k^C.charCodeAt(F++))&255];return~k}function D(C,S){for(var k=S^-1,F=C.length-15,R=0;R<F;)k=N[C[R++]^k&255]^y[C[R++]^k>>8&255]^j[C[R++]^k>>16&255]^u[C[R++]^k>>>24]^p[C[R++]]^g[C[R++]]^f[C[R++]]^h[C[R++]]^m[C[R++]]^x[C[R++]]^d[C[R++]]^o[C[R++]]^c[C[R++]]^l[C[R++]]^i[C[R++]]^s[C[R++]];for(F+=15;R<F;)k=k>>>8^s[(k^C[R++])&255];return~k}function b(C,S){for(var k=S^-1,F=0,R=C.length,T=0,M=0;F<R;)T=C.charCodeAt(F++),T<128?k=k>>>8^s[(k^T)&255]:T<2048?(k=k>>>8^s[(k^(192|T>>6&31))&255],k=k>>>8^s[(k^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,M=C.charCodeAt(F++)&1023,k=k>>>8^s[(k^(240|T>>8&7))&255],k=k>>>8^s[(k^(128|T>>2&63))&255],k=k>>>8^s[(k^(128|M>>6&15|(T&3)<<4))&255],k=k>>>8^s[(k^(128|M&63))&255]):(k=k>>>8^s[(k^(224|T>>12&15))&255],k=k>>>8^s[(k^(128|T>>6&63))&255],k=k>>>8^s[(k^(128|T&63))&255]);return~k}return t.table=s,t.bstr=w,t.buf=D,t.str=b,t}(),Ve=function(){var a={};a.version="1.2.1";function s(L,W){for(var U=L.split("/"),z=W.split("/"),V=0,G=0,oe=Math.min(U.length,z.length);V<oe;++V){if(G=U[V].length-z[V].length)return G;if(U[V]!=z[V])return U[V]<z[V]?-1:1}return U.length-z.length}function n(L){if(L.charAt(L.length-1)=="/")return L.slice(0,-1).indexOf("/")===-1?L:n(L.slice(0,-1));var W=L.lastIndexOf("/");return W===-1?L:L.slice(0,W+1)}function r(L){if(L.charAt(L.length-1)=="/")return r(L.slice(0,-1));var W=L.lastIndexOf("/");return W===-1?L:L.slice(W+1)}function i(L,W){typeof W=="string"&&(W=new Date(W));var U=W.getHours();U=U<<6|W.getMinutes(),U=U<<5|W.getSeconds()>>>1,L.write_shift(2,U);var z=W.getFullYear()-1980;z=z<<4|W.getMonth()+1,z=z<<5|W.getDate(),L.write_shift(2,z)}function l(L){var W=L.read_shift(2)&65535,U=L.read_shift(2)&65535,z=new Date,V=U&31;U>>>=5;var G=U&15;U>>>=4,z.setMilliseconds(0),z.setFullYear(U+1980),z.setMonth(G-1),z.setDate(V);var oe=W&31;W>>>=5;var ge=W&63;return W>>>=6,z.setHours(W),z.setMinutes(ge),z.setSeconds(oe<<1),z}function c(L){Pt(L,0);for(var W={},U=0;L.l<=L.length-4;){var z=L.read_shift(2),V=L.read_shift(2),G=L.l+V,oe={};switch(z){case 21589:U=L.read_shift(1),U&1&&(oe.mtime=L.read_shift(4)),V>5&&(U&2&&(oe.atime=L.read_shift(4)),U&4&&(oe.ctime=L.read_shift(4))),oe.mtime&&(oe.mt=new Date(oe.mtime*1e3));break}L.l=G,W[z]=oe}return W}var o;function d(){return o||(o={})}function x(L,W){if(L[0]==80&&L[1]==75)return il(L,W);if((L[0]|32)==109&&(L[1]|32)==105)return Yx(L,W);if(L.length<512)throw new Error("CFB file size "+L.length+" < 512");var U=3,z=512,V=0,G=0,oe=0,ge=0,ce=0,de=[],me=L.slice(0,512);Pt(me,0);var je=m(me);switch(U=je[0],U){case 3:z=512;break;case 4:z=4096;break;case 0:if(je[1]==0)return il(L,W);default:throw new Error("Major Version: Expected 3 or 4 saw "+U)}z!==512&&(me=L.slice(0,z),Pt(me,28));var ke=L.slice(0,z);h(me,U);var Ce=me.read_shift(4,"i");if(U===3&&Ce!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ce);me.l+=4,oe=me.read_shift(4,"i"),me.l+=4,me.chk("00100000","Mini Stream Cutoff Size: "),ge=me.read_shift(4,"i"),V=me.read_shift(4,"i"),ce=me.read_shift(4,"i"),G=me.read_shift(4,"i");for(var Ne=-1,Se=0;Se<109&&(Ne=me.read_shift(4,"i"),!(Ne<0));++Se)de[Se]=Ne;var Oe=f(L,z);u(ce,G,Oe,z,de);var mt=y(Oe,oe,de,z);mt[oe].name="!Directory",V>0&&ge!==M&&(mt[ge].name="!MiniFAT"),mt[de[0]].name="!FAT",mt.fat_addrs=de,mt.ssz=z;var ht={},Mt=[],Va=[],Ga=[];N(oe,mt,Oe,Mt,V,ht,Va,ge),g(Va,Ga,Mt),Mt.shift();var Ya={FileIndex:Va,FullPaths:Ga};return W&&W.raw&&(Ya.raw={header:ke,sectors:Oe}),Ya}function m(L){if(L[L.l]==80&&L[L.l+1]==75)return[0,0];L.chk(X,"Header Signature: "),L.l+=16;var W=L.read_shift(2,"u");return[L.read_shift(2,"u"),W]}function h(L,W){var U=9;switch(L.l+=2,U=L.read_shift(2)){case 9:if(W!=3)throw new Error("Sector Shift: Expected 9 saw "+U);break;case 12:if(W!=4)throw new Error("Sector Shift: Expected 12 saw "+U);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+U)}L.chk("0600","Mini Sector Shift: "),L.chk("000000000000","Reserved: ")}function f(L,W){for(var U=Math.ceil(L.length/W)-1,z=[],V=1;V<U;++V)z[V-1]=L.slice(V*W,(V+1)*W);return z[U-1]=L.slice(U*W),z}function g(L,W,U){for(var z=0,V=0,G=0,oe=0,ge=0,ce=U.length,de=[],me=[];z<ce;++z)de[z]=me[z]=z,W[z]=U[z];for(;ge<me.length;++ge)z=me[ge],V=L[z].L,G=L[z].R,oe=L[z].C,de[z]===z&&(V!==-1&&de[V]!==V&&(de[z]=de[V]),G!==-1&&de[G]!==G&&(de[z]=de[G])),oe!==-1&&(de[oe]=z),V!==-1&&z!=de[z]&&(de[V]=de[z],me.lastIndexOf(V)<ge&&me.push(V)),G!==-1&&z!=de[z]&&(de[G]=de[z],me.lastIndexOf(G)<ge&&me.push(G));for(z=1;z<ce;++z)de[z]===z&&(G!==-1&&de[G]!==G?de[z]=de[G]:V!==-1&&de[V]!==V&&(de[z]=de[V]));for(z=1;z<ce;++z)if(L[z].type!==0){if(ge=z,ge!=de[ge])do ge=de[ge],W[z]=W[ge]+"/"+W[z];while(ge!==0&&de[ge]!==-1&&ge!=de[ge]);de[z]=-1}for(W[0]+="/",z=1;z<ce;++z)L[z].type!==2&&(W[z]+="/")}function p(L,W,U){for(var z=L.start,V=L.size,G=[],oe=z;U&&V>0&&oe>=0;)G.push(W.slice(oe*T,oe*T+T)),V-=T,oe=ia(U,oe*4);return G.length===0?St(0):Xs(G).slice(0,L.size)}function u(L,W,U,z,V){var G=M;if(L===M){if(W!==0)throw new Error("DIFAT chain shorter than expected")}else if(L!==-1){var oe=U[L],ge=(z>>>2)-1;if(!oe)return;for(var ce=0;ce<ge&&(G=ia(oe,ce*4))!==M;++ce)V.push(G);u(ia(oe,z-4),W-1,U,z,V)}}function j(L,W,U,z,V){var G=[],oe=[];V||(V=[]);var ge=z-1,ce=0,de=0;for(ce=W;ce>=0;){V[ce]=!0,G[G.length]=ce,oe.push(L[ce]);var me=U[Math.floor(ce*4/z)];if(de=ce*4&ge,z<4+de)throw new Error("FAT boundary crossed: "+ce+" 4 "+z);if(!L[me])break;ce=ia(L[me],de)}return{nodes:G,data:tc([oe])}}function y(L,W,U,z){var V=L.length,G=[],oe=[],ge=[],ce=[],de=z-1,me=0,je=0,ke=0,Ce=0;for(me=0;me<V;++me)if(ge=[],ke=me+W,ke>=V&&(ke-=V),!oe[ke]){ce=[];var Ne=[];for(je=ke;je>=0;){Ne[je]=!0,oe[je]=!0,ge[ge.length]=je,ce.push(L[je]);var Se=U[Math.floor(je*4/z)];if(Ce=je*4&de,z<4+Ce)throw new Error("FAT boundary crossed: "+je+" 4 "+z);if(!L[Se]||(je=ia(L[Se],Ce),Ne[je]))break}G[ke]={nodes:ge,data:tc([ce])}}return G}function N(L,W,U,z,V,G,oe,ge){for(var ce=0,de=z.length?2:0,me=W[L].data,je=0,ke=0,Ce;je<me.length;je+=128){var Ne=me.slice(je,je+128);Pt(Ne,64),ke=Ne.read_shift(2),Ce=Oi(Ne,0,ke-de),z.push(Ce);var Se={name:Ce,type:Ne.read_shift(1),color:Ne.read_shift(1),L:Ne.read_shift(4,"i"),R:Ne.read_shift(4,"i"),C:Ne.read_shift(4,"i"),clsid:Ne.read_shift(16),state:Ne.read_shift(4,"i"),start:0,size:0},Oe=Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2);Oe!==0&&(Se.ct=w(Ne,Ne.l-8));var mt=Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2)+Ne.read_shift(2);mt!==0&&(Se.mt=w(Ne,Ne.l-8)),Se.start=Ne.read_shift(4,"i"),Se.size=Ne.read_shift(4,"i"),Se.size<0&&Se.start<0&&(Se.size=Se.type=0,Se.start=M,Se.name=""),Se.type===5?(ce=Se.start,V>0&&ce!==M&&(W[ce].name="!StreamData")):Se.size>=4096?(Se.storage="fat",W[Se.start]===void 0&&(W[Se.start]=j(U,Se.start,W.fat_addrs,W.ssz)),W[Se.start].name=Se.name,Se.content=W[Se.start].data.slice(0,Se.size)):(Se.storage="minifat",Se.size<0?Se.size=0:ce!==M&&Se.start!==M&&W[ce]&&(Se.content=p(Se,W[ce].data,(W[ge]||{}).data))),Se.content&&Pt(Se.content,0),G[Ce]=Se,oe.push(Se)}}function w(L,W){return new Date((rs(L,W+4)/1e7*Math.pow(2,32)+rs(L,W)/1e7-11644473600)*1e3)}function D(L,W){return d(),x(o.readFileSync(L),W)}function b(L,W){var U=W&&W.type;switch(U||We&&Buffer.isBuffer(L)&&(U="buffer"),U||"base64"){case"file":return D(L,W);case"base64":return x(vs(os(L)),W);case"binary":return x(vs(L),W)}return x(L,W)}function C(L,W){var U=W||{},z=U.root||"Root Entry";if(L.FullPaths||(L.FullPaths=[]),L.FileIndex||(L.FileIndex=[]),L.FullPaths.length!==L.FileIndex.length)throw new Error("inconsistent CFB structure");L.FullPaths.length===0&&(L.FullPaths[0]=z+"/",L.FileIndex[0]={name:z,type:5}),U.CLSID&&(L.FileIndex[0].clsid=U.CLSID),S(L)}function S(L){var W="Sh33tJ5";if(!Ve.find(L,"/"+W)){var U=St(4);U[0]=55,U[1]=U[3]=50,U[2]=54,L.FileIndex.push({name:W,type:2,content:U,size:4,L:69,R:69,C:69}),L.FullPaths.push(L.FullPaths[0]+W),k(L)}}function k(L,W){C(L);for(var U=!1,z=!1,V=L.FullPaths.length-1;V>=0;--V){var G=L.FileIndex[V];switch(G.type){case 0:z?U=!0:(L.FileIndex.pop(),L.FullPaths.pop());break;case 1:case 2:case 5:z=!0,isNaN(G.R*G.L*G.C)&&(U=!0),G.R>-1&&G.L>-1&&G.R==G.L&&(U=!0);break;default:U=!0;break}}if(!(!U&&!W)){var oe=new Date(1987,1,19),ge=0,ce=Object.create?Object.create(null):{},de=[];for(V=0;V<L.FullPaths.length;++V)ce[L.FullPaths[V]]=!0,L.FileIndex[V].type!==0&&de.push([L.FullPaths[V],L.FileIndex[V]]);for(V=0;V<de.length;++V){var me=n(de[V][0]);z=ce[me],z||(de.push([me,{name:r(me).replace("/",""),type:1,clsid:B,ct:oe,mt:oe,content:null}]),ce[me]=!0)}for(de.sort(function(Ce,Ne){return s(Ce[0],Ne[0])}),L.FullPaths=[],L.FileIndex=[],V=0;V<de.length;++V)L.FullPaths[V]=de[V][0],L.FileIndex[V]=de[V][1];for(V=0;V<de.length;++V){var je=L.FileIndex[V],ke=L.FullPaths[V];if(je.name=r(ke).replace("/",""),je.L=je.R=je.C=-(je.color=1),je.size=je.content?je.content.length:0,je.start=0,je.clsid=je.clsid||B,V===0)je.C=de.length>1?1:-1,je.size=0,je.type=5;else if(ke.slice(-1)=="/"){for(ge=V+1;ge<de.length&&n(L.FullPaths[ge])!=ke;++ge);for(je.C=ge>=de.length?-1:ge,ge=V+1;ge<de.length&&n(L.FullPaths[ge])!=n(ke);++ge);je.R=ge>=de.length?-1:ge,je.type=1}else n(L.FullPaths[V+1]||"")==n(ke)&&(je.R=V+1),je.type=2}}}function F(L,W){var U=W||{};if(U.fileType=="mad")return Xx(L,U);switch(k(L),U.fileType){case"zip":return zx(L,U)}var z=function(Ce){for(var Ne=0,Se=0,Oe=0;Oe<Ce.FileIndex.length;++Oe){var mt=Ce.FileIndex[Oe];if(mt.content){var ht=mt.content.length;ht>0&&(ht<4096?Ne+=ht+63>>6:Se+=ht+511>>9)}}for(var Mt=Ce.FullPaths.length+3>>2,Va=Ne+7>>3,Ga=Ne+127>>7,Ya=Va+Se+Mt+Ga,na=Ya+127>>7,Cn=na<=109?0:Math.ceil((na-109)/127);Ya+na+Cn+127>>7>na;)Cn=++na<=109?0:Math.ceil((na-109)/127);var $s=[1,Cn,na,Ga,Mt,Se,Ne,0];return Ce.FileIndex[0].size=Ne<<6,$s[7]=(Ce.FileIndex[0].start=$s[0]+$s[1]+$s[2]+$s[3]+$s[4]+$s[5])+($s[6]+7>>3),$s}(L),V=St(z[7]<<9),G=0,oe=0;{for(G=0;G<8;++G)V.write_shift(1,q[G]);for(G=0;G<8;++G)V.write_shift(2,0);for(V.write_shift(2,62),V.write_shift(2,3),V.write_shift(2,65534),V.write_shift(2,9),V.write_shift(2,6),G=0;G<3;++G)V.write_shift(2,0);for(V.write_shift(4,0),V.write_shift(4,z[2]),V.write_shift(4,z[0]+z[1]+z[2]+z[3]-1),V.write_shift(4,0),V.write_shift(4,4096),V.write_shift(4,z[3]?z[0]+z[1]+z[2]-1:M),V.write_shift(4,z[3]),V.write_shift(-4,z[1]?z[0]-1:M),V.write_shift(4,z[1]),G=0;G<109;++G)V.write_shift(-4,G<z[2]?z[1]+G:-1)}if(z[1])for(oe=0;oe<z[1];++oe){for(;G<236+oe*127;++G)V.write_shift(-4,G<z[2]?z[1]+G:-1);V.write_shift(-4,oe===z[1]-1?M:oe+1)}var ge=function(Ce){for(oe+=Ce;G<oe-1;++G)V.write_shift(-4,G+1);Ce&&(++G,V.write_shift(-4,M))};for(oe=G=0,oe+=z[1];G<oe;++G)V.write_shift(-4,K.DIFSECT);for(oe+=z[2];G<oe;++G)V.write_shift(-4,K.FATSECT);ge(z[3]),ge(z[4]);for(var ce=0,de=0,me=L.FileIndex[0];ce<L.FileIndex.length;++ce)me=L.FileIndex[ce],me.content&&(de=me.content.length,!(de<4096)&&(me.start=oe,ge(de+511>>9)));for(ge(z[6]+7>>3);V.l&511;)V.write_shift(-4,K.ENDOFCHAIN);for(oe=G=0,ce=0;ce<L.FileIndex.length;++ce)me=L.FileIndex[ce],me.content&&(de=me.content.length,!(!de||de>=4096)&&(me.start=oe,ge(de+63>>6)));for(;V.l&511;)V.write_shift(-4,K.ENDOFCHAIN);for(G=0;G<z[4]<<2;++G){var je=L.FullPaths[G];if(!je||je.length===0){for(ce=0;ce<17;++ce)V.write_shift(4,0);for(ce=0;ce<3;++ce)V.write_shift(4,-1);for(ce=0;ce<12;++ce)V.write_shift(4,0);continue}me=L.FileIndex[G],G===0&&(me.start=me.size?me.start-1:M);var ke=G===0&&U.root||me.name;if(de=2*(ke.length+1),V.write_shift(64,ke,"utf16le"),V.write_shift(2,de),V.write_shift(1,me.type),V.write_shift(1,me.color),V.write_shift(-4,me.L),V.write_shift(-4,me.R),V.write_shift(-4,me.C),me.clsid)V.write_shift(16,me.clsid,"hex");else for(ce=0;ce<4;++ce)V.write_shift(4,0);V.write_shift(4,me.state||0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,0),V.write_shift(4,me.start),V.write_shift(4,me.size),V.write_shift(4,0)}for(G=1;G<L.FileIndex.length;++G)if(me=L.FileIndex[G],me.size>=4096)if(V.l=me.start+1<<9,We&&Buffer.isBuffer(me.content))me.content.copy(V,V.l,0,me.size),V.l+=me.size+511&-512;else{for(ce=0;ce<me.size;++ce)V.write_shift(1,me.content[ce]);for(;ce&511;++ce)V.write_shift(1,0)}for(G=1;G<L.FileIndex.length;++G)if(me=L.FileIndex[G],me.size>0&&me.size<4096)if(We&&Buffer.isBuffer(me.content))me.content.copy(V,V.l,0,me.size),V.l+=me.size+63&-64;else{for(ce=0;ce<me.size;++ce)V.write_shift(1,me.content[ce]);for(;ce&63;++ce)V.write_shift(1,0)}if(We)V.l=V.length;else for(;V.l<V.length;)V.write_shift(1,0);return V}function R(L,W){var U=L.FullPaths.map(function(ce){return ce.toUpperCase()}),z=U.map(function(ce){var de=ce.split("/");return de[de.length-(ce.slice(-1)=="/"?2:1)]}),V=!1;W.charCodeAt(0)===47?(V=!0,W=U[0].slice(0,-1)+W):V=W.indexOf("/")!==-1;var G=W.toUpperCase(),oe=V===!0?U.indexOf(G):z.indexOf(G);if(oe!==-1)return L.FileIndex[oe];var ge=!G.match(Qa);for(G=G.replace(Jt,""),ge&&(G=G.replace(Qa,"!")),oe=0;oe<U.length;++oe)if((ge?U[oe].replace(Qa,"!"):U[oe]).replace(Jt,"")==G||(ge?z[oe].replace(Qa,"!"):z[oe]).replace(Jt,"")==G)return L.FileIndex[oe];return null}var T=64,M=-2,X="d0cf11e0a1b11ae1",q=[208,207,17,224,161,177,26,225],B="00000000000000000000000000000000",K={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:M,FREESECT:-1,HEADER_SIGNATURE:X,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:B,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Q(L,W,U){d();var z=F(L,U);o.writeFileSync(W,z)}function _(L){for(var W=new Array(L.length),U=0;U<L.length;++U)W[U]=String.fromCharCode(L[U]);return W.join("")}function ne(L,W){var U=F(L,W);switch(W&&W.type||"buffer"){case"file":return d(),o.writeFileSync(W.filename,U),U;case"binary":return typeof U=="string"?U:_(U);case"base64":return Ol(typeof U=="string"?U:_(U));case"buffer":if(We)return Buffer.isBuffer(U)?U:ba(U);case"array":return typeof U=="string"?vs(U):U}return U}var ie;function A(L){try{var W=L.InflateRaw,U=new W;if(U._processChunk(new Uint8Array([3,0]),U._finishFlushFlag),U.bytesRead)ie=L;else throw new Error("zlib does not expose bytesRead")}catch(z){console.error("cannot use native zlib: "+(z.message||z))}}function P(L,W){if(!ie)return rl(L,W);var U=ie.InflateRaw,z=new U,V=z._processChunk(L.slice(L.l),z._finishFlushFlag);return L.l+=z.bytesRead,V}function O(L){return ie?ie.deflateRawSync(L):Be(L)}var I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function se(L){var W=(L<<1|L<<11)&139536|(L<<5|L<<15)&558144;return(W>>16|W>>8|W)&255}for(var le=typeof Uint8Array<"u",ue=le?new Uint8Array(256):[],be=0;be<256;++be)ue[be]=se(be);function H(L,W){var U=ue[L&255];return W<=8?U>>>8-W:(U=U<<8|ue[L>>8&255],W<=16?U>>>16-W:(U=U<<8|ue[L>>16&255],U>>>24-W))}function De(L,W){var U=W&7,z=W>>>3;return(L[z]|(U<=6?0:L[z+1]<<8))>>>U&3}function re(L,W){var U=W&7,z=W>>>3;return(L[z]|(U<=5?0:L[z+1]<<8))>>>U&7}function Z(L,W){var U=W&7,z=W>>>3;return(L[z]|(U<=4?0:L[z+1]<<8))>>>U&15}function ee(L,W){var U=W&7,z=W>>>3;return(L[z]|(U<=3?0:L[z+1]<<8))>>>U&31}function ae(L,W){var U=W&7,z=W>>>3;return(L[z]|(U<=1?0:L[z+1]<<8))>>>U&127}function xe(L,W,U){var z=W&7,V=W>>>3,G=(1<<U)-1,oe=L[V]>>>z;return U<8-z||(oe|=L[V+1]<<8-z,U<16-z)||(oe|=L[V+2]<<16-z,U<24-z)||(oe|=L[V+3]<<24-z),oe&G}function fe(L,W,U){var z=W&7,V=W>>>3;return z<=5?L[V]|=(U&7)<<z:(L[V]|=U<<z&255,L[V+1]=(U&7)>>8-z),W+3}function ve(L,W,U){var z=W&7,V=W>>>3;return U=(U&1)<<z,L[V]|=U,W+1}function Ae(L,W,U){var z=W&7,V=W>>>3;return U<<=z,L[V]|=U&255,U>>>=8,L[V+1]=U,W+8}function ye(L,W,U){var z=W&7,V=W>>>3;return U<<=z,L[V]|=U&255,U>>>=8,L[V+1]=U&255,L[V+2]=U>>>8,W+16}function He(L,W){var U=L.length,z=2*U>W?2*U:W+5,V=0;if(U>=W)return L;if(We){var G=Ml(z);if(L.copy)L.copy(G);else for(;V<L.length;++V)G[V]=L[V];return G}else if(le){var oe=new Uint8Array(z);if(oe.set)oe.set(L);else for(;V<U;++V)oe[V]=L[V];return oe}return L.length=z,L}function _e(L){for(var W=new Array(L),U=0;U<L;++U)W[U]=0;return W}function Qe(L,W,U){var z=1,V=0,G=0,oe=0,ge=0,ce=L.length,de=le?new Uint16Array(32):_e(32);for(G=0;G<32;++G)de[G]=0;for(G=ce;G<U;++G)L[G]=0;ce=L.length;var me=le?new Uint16Array(ce):_e(ce);for(G=0;G<ce;++G)de[V=L[G]]++,z<V&&(z=V),me[G]=0;for(de[0]=0,G=1;G<=z;++G)de[G+16]=ge=ge+de[G-1]<<1;for(G=0;G<ce;++G)ge=L[G],ge!=0&&(me[G]=de[ge+16]++);var je=0;for(G=0;G<ce;++G)if(je=L[G],je!=0)for(ge=H(me[G],z)>>z-je,oe=(1<<z+4-je)-1;oe>=0;--oe)W[ge|oe<<je]=je&15|G<<4;return z}var Je=le?new Uint16Array(512):_e(512),dt=le?new Uint16Array(32):_e(32);if(!le){for(var qe=0;qe<512;++qe)Je[qe]=0;for(qe=0;qe<32;++qe)dt[qe]=0}(function(){for(var L=[],W=0;W<32;W++)L.push(5);Qe(L,dt,32);var U=[];for(W=0;W<=143;W++)U.push(8);for(;W<=255;W++)U.push(9);for(;W<=279;W++)U.push(7);for(;W<=287;W++)U.push(8);Qe(U,Je,288)})();var Ye=function(){for(var W=le?new Uint8Array(32768):[],U=0,z=0;U<te.length-1;++U)for(;z<te[U+1];++z)W[z]=U;for(;z<32768;++z)W[z]=29;var V=le?new Uint8Array(259):[];for(U=0,z=0;U<J.length-1;++U)for(;z<J[U+1];++z)V[z]=U;function G(ge,ce){for(var de=0;de<ge.length;){var me=Math.min(65535,ge.length-de),je=de+me==ge.length;for(ce.write_shift(1,+je),ce.write_shift(2,me),ce.write_shift(2,~me&65535);me-- >0;)ce[ce.l++]=ge[de++]}return ce.l}function oe(ge,ce){for(var de=0,me=0,je=le?new Uint16Array(32768):[];me<ge.length;){var ke=Math.min(65535,ge.length-me);if(ke<10){for(de=fe(ce,de,+(me+ke==ge.length)),de&7&&(de+=8-(de&7)),ce.l=de/8|0,ce.write_shift(2,ke),ce.write_shift(2,~ke&65535);ke-- >0;)ce[ce.l++]=ge[me++];de=ce.l*8;continue}de=fe(ce,de,+(me+ke==ge.length)+2);for(var Ce=0;ke-- >0;){var Ne=ge[me];Ce=(Ce<<5^Ne)&32767;var Se=-1,Oe=0;if((Se=je[Ce])&&(Se|=me&-32768,Se>me&&(Se-=32768),Se<me))for(;ge[Se+Oe]==ge[me+Oe]&&Oe<250;)++Oe;if(Oe>2){Ne=V[Oe],Ne<=22?de=Ae(ce,de,ue[Ne+1]>>1)-1:(Ae(ce,de,3),de+=5,Ae(ce,de,ue[Ne-23]>>5),de+=3);var mt=Ne<8?0:Ne-4>>2;mt>0&&(ye(ce,de,Oe-J[Ne]),de+=mt),Ne=W[me-Se],de=Ae(ce,de,ue[Ne]>>3),de-=3;var ht=Ne<4?0:Ne-2>>1;ht>0&&(ye(ce,de,me-Se-te[Ne]),de+=ht);for(var Mt=0;Mt<Oe;++Mt)je[Ce]=me&32767,Ce=(Ce<<5^ge[me])&32767,++me;ke-=Oe-1}else Ne<=143?Ne=Ne+48:de=ve(ce,de,1),de=Ae(ce,de,ue[Ne]),je[Ce]=me&32767,++me}de=Ae(ce,de,0)-1}return ce.l=(de+7)/8|0,ce.l}return function(ce,de){return ce.length<8?G(ce,de):oe(ce,de)}}();function Be(L){var W=St(50+Math.floor(L.length*1.1)),U=Ye(L,W);return W.slice(0,U)}var et=le?new Uint16Array(32768):_e(32768),xt=le?new Uint16Array(32768):_e(32768),it=le?new Uint16Array(128):_e(128),As=1,al=1;function $x(L,W){var U=ee(L,W)+257;W+=5;var z=ee(L,W)+1;W+=5;var V=Z(L,W)+4;W+=4;for(var G=0,oe=le?new Uint8Array(19):_e(19),ge=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ce=1,de=le?new Uint8Array(8):_e(8),me=le?new Uint8Array(8):_e(8),je=oe.length,ke=0;ke<V;++ke)oe[I[ke]]=G=re(L,W),ce<G&&(ce=G),de[G]++,W+=3;var Ce=0;for(de[0]=0,ke=1;ke<=ce;++ke)me[ke]=Ce=Ce+de[ke-1]<<1;for(ke=0;ke<je;++ke)(Ce=oe[ke])!=0&&(ge[ke]=me[Ce]++);var Ne=0;for(ke=0;ke<je;++ke)if(Ne=oe[ke],Ne!=0){Ce=ue[ge[ke]]>>8-Ne;for(var Se=(1<<7-Ne)-1;Se>=0;--Se)it[Ce|Se<<Ne]=Ne&7|ke<<3}var Oe=[];for(ce=1;Oe.length<U+z;)switch(Ce=it[ae(L,W)],W+=Ce&7,Ce>>>=3){case 16:for(G=3+De(L,W),W+=2,Ce=Oe[Oe.length-1];G-- >0;)Oe.push(Ce);break;case 17:for(G=3+re(L,W),W+=3;G-- >0;)Oe.push(0);break;case 18:for(G=11+ae(L,W),W+=7;G-- >0;)Oe.push(0);break;default:Oe.push(Ce),ce<Ce&&(ce=Ce);break}var mt=Oe.slice(0,U),ht=Oe.slice(U);for(ke=U;ke<286;++ke)mt[ke]=0;for(ke=z;ke<30;++ke)ht[ke]=0;return As=Qe(mt,et,286),al=Qe(ht,xt,30),W}function Bx(L,W){if(L[0]==3&&!(L[1]&3))return[ta(W),2];for(var U=0,z=0,V=Ml(W||1<<18),G=0,oe=V.length>>>0,ge=0,ce=0;!(z&1);){if(z=re(L,U),U+=3,z>>>1)z>>1==1?(ge=9,ce=5):(U=$x(L,U),ge=As,ce=al);else{U&7&&(U+=8-(U&7));var de=L[U>>>3]|L[(U>>>3)+1]<<8;if(U+=32,de>0)for(!W&&oe<G+de&&(V=He(V,G+de),oe=V.length);de-- >0;)V[G++]=L[U>>>3],U+=8;continue}for(;;){!W&&oe<G+32767&&(V=He(V,G+32767),oe=V.length);var me=xe(L,U,ge),je=z>>>1==1?Je[me]:et[me];if(U+=je&15,je>>>=4,!(je>>>8&255))V[G++]=je;else{if(je==256)break;je-=257;var ke=je<8?0:je-4>>2;ke>5&&(ke=0);var Ce=G+J[je];ke>0&&(Ce+=xe(L,U,ke),U+=ke),me=xe(L,U,ce),je=z>>>1==1?dt[me]:xt[me],U+=je&15,je>>>=4;var Ne=je<4?0:je-2>>1,Se=te[je];for(Ne>0&&(Se+=xe(L,U,Ne),U+=Ne),!W&&oe<Ce&&(V=He(V,Ce+100),oe=V.length);G<Ce;)V[G]=V[G-Se],++G}}}return W?[V,U+7>>>3]:[V.slice(0,G),U+7>>>3]}function rl(L,W){var U=L.slice(L.l||0),z=Bx(U,W);return L.l+=z[1],z[0]}function nl(L,W){if(L)typeof console<"u"&&console.error(W);else throw new Error(W)}function il(L,W){var U=L;Pt(U,0);var z=[],V=[],G={FileIndex:z,FullPaths:V};C(G,{root:W.root});for(var oe=U.length-4;(U[oe]!=80||U[oe+1]!=75||U[oe+2]!=5||U[oe+3]!=6)&&oe>=0;)--oe;U.l=oe+4,U.l+=4;var ge=U.read_shift(2);U.l+=6;var ce=U.read_shift(4);for(U.l=ce,oe=0;oe<ge;++oe){U.l+=20;var de=U.read_shift(4),me=U.read_shift(4),je=U.read_shift(2),ke=U.read_shift(2),Ce=U.read_shift(2);U.l+=8;var Ne=U.read_shift(4),Se=c(U.slice(U.l+je,U.l+je+ke));U.l+=je+ke+Ce;var Oe=U.l;U.l=Ne+4,Ux(U,de,me,G,Se),U.l=Oe}return G}function Ux(L,W,U,z,V){L.l+=2;var G=L.read_shift(2),oe=L.read_shift(2),ge=l(L);if(G&8257)throw new Error("Unsupported ZIP encryption");for(var ce=L.read_shift(4),de=L.read_shift(4),me=L.read_shift(4),je=L.read_shift(2),ke=L.read_shift(2),Ce="",Ne=0;Ne<je;++Ne)Ce+=String.fromCharCode(L[L.l++]);if(ke){var Se=c(L.slice(L.l,L.l+ke));(Se[21589]||{}).mt&&(ge=Se[21589].mt),((V||{})[21589]||{}).mt&&(ge=V[21589].mt)}L.l+=ke;var Oe=L.slice(L.l,L.l+de);switch(oe){case 8:Oe=P(L,me);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+oe)}var mt=!1;G&8&&(ce=L.read_shift(4),ce==134695760&&(ce=L.read_shift(4),mt=!0),de=L.read_shift(4),me=L.read_shift(4)),de!=W&&nl(mt,"Bad compressed size: "+W+" != "+de),me!=U&&nl(mt,"Bad uncompressed size: "+U+" != "+me),Sn(z,Ce,Oe,{unsafe:!0,mt:ge})}function zx(L,W){var U=W||{},z=[],V=[],G=St(1),oe=U.compression?8:0,ge=0,ce=0,de=0,me=0,je=0,ke=L.FullPaths[0],Ce=ke,Ne=L.FileIndex[0],Se=[],Oe=0;for(ce=1;ce<L.FullPaths.length;++ce)if(Ce=L.FullPaths[ce].slice(ke.length),Ne=L.FileIndex[ce],!(!Ne.size||!Ne.content||Ce=="Sh33tJ5")){var mt=me,ht=St(Ce.length);for(de=0;de<Ce.length;++de)ht.write_shift(1,Ce.charCodeAt(de)&127);ht=ht.slice(0,ht.l),Se[je]=dp.buf(Ne.content,0);var Mt=Ne.content;oe==8&&(Mt=O(Mt)),G=St(30),G.write_shift(4,67324752),G.write_shift(2,20),G.write_shift(2,ge),G.write_shift(2,oe),Ne.mt?i(G,Ne.mt):G.write_shift(4,0),G.write_shift(-4,Se[je]),G.write_shift(4,Mt.length),G.write_shift(4,Ne.content.length),G.write_shift(2,ht.length),G.write_shift(2,0),me+=G.length,z.push(G),me+=ht.length,z.push(ht),me+=Mt.length,z.push(Mt),G=St(46),G.write_shift(4,33639248),G.write_shift(2,0),G.write_shift(2,20),G.write_shift(2,ge),G.write_shift(2,oe),G.write_shift(4,0),G.write_shift(-4,Se[je]),G.write_shift(4,Mt.length),G.write_shift(4,Ne.content.length),G.write_shift(2,ht.length),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(4,0),G.write_shift(4,mt),Oe+=G.l,V.push(G),Oe+=ht.length,V.push(ht),++je}return G=St(22),G.write_shift(4,101010256),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,je),G.write_shift(2,je),G.write_shift(4,Oe),G.write_shift(4,me),G.write_shift(2,0),Xs([Xs(z),Xs(V),G])}var Rr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Hx(L,W){if(L.ctype)return L.ctype;var U=L.name||"",z=U.match(/\.([^\.]+)$/);return z&&Rr[z[1]]||W&&(z=(U=W).match(/[\.\\]([^\.\\])+$/),z&&Rr[z[1]])?Rr[z[1]]:"application/octet-stream"}function qx(L){for(var W=Ol(L),U=[],z=0;z<W.length;z+=76)U.push(W.slice(z,z+76));return U.join(`\r
`)+`\r
`}function Wx(L){var W=L.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(de){var me=de.charCodeAt(0).toString(16).toUpperCase();return"="+(me.length==1?"0"+me:me)});W=W.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),W.charAt(0)==`
`&&(W="=0D"+W.slice(1)),W=W.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var U=[],z=W.split(`\r
`),V=0;V<z.length;++V){var G=z[V];if(G.length==0){U.push("");continue}for(var oe=0;oe<G.length;){var ge=76,ce=G.slice(oe,oe+ge);ce.charAt(ge-1)=="="?ge--:ce.charAt(ge-2)=="="?ge-=2:ce.charAt(ge-3)=="="&&(ge-=3),ce=G.slice(oe,oe+ge),oe+=ge,oe<G.length&&(ce+="="),U.push(ce)}}return U.join(`\r
`)}function Vx(L){for(var W=[],U=0;U<L.length;++U){for(var z=L[U];U<=L.length&&z.charAt(z.length-1)=="=";)z=z.slice(0,z.length-1)+L[++U];W.push(z)}for(var V=0;V<W.length;++V)W[V]=W[V].replace(/[=][0-9A-Fa-f]{2}/g,function(G){return String.fromCharCode(parseInt(G.slice(1),16))});return vs(W.join(`\r
`))}function Gx(L,W,U){for(var z="",V="",G="",oe,ge=0;ge<10;++ge){var ce=W[ge];if(!ce||ce.match(/^\s*$/))break;var de=ce.match(/^(.*?):\s*([^\s].*)$/);if(de)switch(de[1].toLowerCase()){case"content-location":z=de[2].trim();break;case"content-type":G=de[2].trim();break;case"content-transfer-encoding":V=de[2].trim();break}}switch(++ge,V.toLowerCase()){case"base64":oe=vs(os(W.slice(ge).join("")));break;case"quoted-printable":oe=Vx(W.slice(ge));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+V)}var me=Sn(L,z.slice(U.length),oe,{unsafe:!0});G&&(me.ctype=G)}function Yx(L,W){if(_(L.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var U=W&&W.root||"",z=(We&&Buffer.isBuffer(L)?L.toString("binary"):_(L)).split(`\r
`),V=0,G="";for(V=0;V<z.length;++V)if(G=z[V],!!/^Content-Location:/i.test(G)&&(G=G.slice(G.indexOf("file")),U||(U=G.slice(0,G.lastIndexOf("/")+1)),G.slice(0,U.length)!=U))for(;U.length>0&&(U=U.slice(0,U.length-1),U=U.slice(0,U.lastIndexOf("/")+1),G.slice(0,U.length)!=U););var oe=(z[1]||"").match(/boundary="(.*?)"/);if(!oe)throw new Error("MAD cannot find boundary");var ge="--"+(oe[1]||""),ce=[],de=[],me={FileIndex:ce,FullPaths:de};C(me);var je,ke=0;for(V=0;V<z.length;++V){var Ce=z[V];Ce!==ge&&Ce!==ge+"--"||(ke++&&Gx(me,z.slice(je,V),U),je=V)}return me}function Xx(L,W){var U=W||{},z=U.boundary||"SheetJS";z="------="+z;for(var V=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+z.slice(2)+'"',"","",""],G=L.FullPaths[0],oe=G,ge=L.FileIndex[0],ce=1;ce<L.FullPaths.length;++ce)if(oe=L.FullPaths[ce].slice(G.length),ge=L.FileIndex[ce],!(!ge.size||!ge.content||oe=="Sh33tJ5")){oe=oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Oe){return"_x"+Oe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Oe){return"_u"+Oe.charCodeAt(0).toString(16)+"_"});for(var de=ge.content,me=We&&Buffer.isBuffer(de)?de.toString("binary"):_(de),je=0,ke=Math.min(1024,me.length),Ce=0,Ne=0;Ne<=ke;++Ne)(Ce=me.charCodeAt(Ne))>=32&&Ce<128&&++je;var Se=je>=ke*4/5;V.push(z),V.push("Content-Location: "+(U.root||"file:///C:/SheetJS/")+oe),V.push("Content-Transfer-Encoding: "+(Se?"quoted-printable":"base64")),V.push("Content-Type: "+Hx(ge,oe)),V.push(""),V.push(Se?Wx(me):qx(me))}return V.push(z+`--\r
`),V.join(`\r
`)}function Kx(L){var W={};return C(W,L),W}function Sn(L,W,U,z){var V=z&&z.unsafe;V||C(L);var G=!V&&Ve.find(L,W);if(!G){var oe=L.FullPaths[0];W.slice(0,oe.length)==oe?oe=W:(oe.slice(-1)!="/"&&(oe+="/"),oe=(oe+W).replace("//","/")),G={name:r(W),type:2},L.FileIndex.push(G),L.FullPaths.push(oe),V||Ve.utils.cfb_gc(L)}return G.content=U,G.size=U?U.length:0,z&&(z.CLSID&&(G.clsid=z.CLSID),z.mt&&(G.mt=z.mt),z.ct&&(G.ct=z.ct)),G}function Jx(L,W){C(L);var U=Ve.find(L,W);if(U){for(var z=0;z<L.FileIndex.length;++z)if(L.FileIndex[z]==U)return L.FileIndex.splice(z,1),L.FullPaths.splice(z,1),!0}return!1}function Qx(L,W,U){C(L);var z=Ve.find(L,W);if(z){for(var V=0;V<L.FileIndex.length;++V)if(L.FileIndex[V]==z)return L.FileIndex[V].name=r(U),L.FullPaths[V]=U,!0}return!1}function Zx(L){k(L,!0)}return a.find=R,a.read=b,a.parse=x,a.write=ne,a.writeFile=Q,a.utils={cfb_new:Kx,cfb_add:Sn,cfb_del:Jx,cfb_mov:Qx,cfb_gc:Zx,ReadShift:tr,CheckField:$d,prep_blob:Pt,bconcat:Xs,use_zlib:A,_deflateRaw:Be,_inflateRaw:rl,consts:K},a}();function xp(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(t);a.open("r"),a.encoding="binary";var s=a.read();return a.close(),s}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Ls(t){for(var a=Object.keys(t),s=[],n=0;n<a.length;++n)Object.prototype.hasOwnProperty.call(t,a[n])&&s.push(a[n]);return s}function Ri(t){for(var a=[],s=Ls(t),n=0;n!==s.length;++n)a[t[s[n]]]=s[n];return a}var an=new Date(1899,11,30,0,0,0);function Qt(t,a){var s=t.getTime(),n=an.getTime()+(t.getTimezoneOffset()-an.getTimezoneOffset())*6e4;return(s-n)/(24*60*60*1e3)}var yd=new Date,mp=an.getTime()+(yd.getTimezoneOffset()-an.getTimezoneOffset())*6e4,Vl=yd.getTimezoneOffset();function vn(t){var a=new Date;return a.setTime(t*24*60*60*1e3+mp),a.getTimezoneOffset()!==Vl&&a.setTime(a.getTime()+(a.getTimezoneOffset()-Vl)*6e4),a}function hp(t){var a=0,s=0,n=!1,r=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!r)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=r.length;++i)if(r[i]){switch(s=1,i>3&&(n=!0),r[i].slice(r[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+r[i].slice(r[i].length-1));case"D":s*=24;case"H":s*=60;case"M":if(n)s*=60;else throw new Error("Unsupported ISO Duration Field: M")}a+=s*parseInt(r[i],10)}return a}var Gl=new Date("2017-02-19T19:06:09.000Z"),bd=isNaN(Gl.getFullYear())?new Date("2/19/17"):Gl,up=bd.getFullYear()==2017;function Dt(t,a){var s=new Date(t);if(up)return a>0?s.setTime(s.getTime()+s.getTimezoneOffset()*60*1e3):a<0&&s.setTime(s.getTime()-s.getTimezoneOffset()*60*1e3),s;if(t instanceof Date)return t;if(bd.getFullYear()==1917&&!isNaN(s.getFullYear())){var n=s.getFullYear();return t.indexOf(""+n)>-1||s.setFullYear(s.getFullYear()+100),s}var r=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function fa(t,a){if(We&&Buffer.isBuffer(t)){if(a){if(t[0]==255&&t[1]==254)return er(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return er(nd(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(a){if(t[0]==255&&t[1]==254)return er(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return er(new TextDecoder("utf-16be").decode(t.slice(2)))}var s={"â‚¬":"Â€","â€š":"Â‚",Æ’:"Âƒ","â€ž":"Â„","â€¦":"Â…","â€ ":"Â†","â€¡":"Â‡","Ë†":"Âˆ","â€°":"Â‰",Å :"ÂŠ","â€¹":"Â‹",Å’:"ÂŒ",Å½:"ÂŽ","â€˜":"Â‘","â€™":"Â’","â€œ":"Â“","â€":"Â”","â€¢":"Â•","â€“":"Â–","â€”":"Â—","Ëœ":"Â˜","â„¢":"Â™",Å¡:"Âš","â€º":"Â›",Å“:"Âœ",Å¾:"Âž",Å¸:"ÂŸ"};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[â‚¬â€šÆ’â€žâ€¦â€ â€¡Ë†â€°Å â€¹Å’Å½â€˜â€™â€œâ€â€¢â€“â€”Ëœâ„¢Å¡â€ºÅ“Å¾Å¸]/g,function(i){return s[i]||i})}catch{}for(var n=[],r=0;r!=t.length;++r)n.push(String.fromCharCode(t[r]));return n.join("")}function It(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var a={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(a[s]=It(t[s]));return a}function pt(t,a){for(var s="";s.length<a;)s+=t;return s}function ks(t){var a=Number(t);if(!isNaN(a))return isFinite(a)?a:NaN;if(!/\d/.test(t))return a;var s=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return s*=100,""});return!isNaN(a=Number(n))||(n=n.replace(/[(](.*)[)]/,function(r,i){return s=-s,i}),!isNaN(a=Number(n)))?a/s:a}var pp=["january","february","march","april","may","june","july","august","september","october","november","december"];function Oa(t){var a=new Date(t),s=new Date(NaN),n=a.getYear(),r=a.getMonth(),i=a.getDate();if(isNaN(i))return s;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&pp.indexOf(l)==-1)return s}else if(l.match(/[a-z]/))return s;return n<0||n>8099?s:(r>0||i>1)&&n!=101?a:t.match(/[^-0-9:,\/\\]/)?s:a}var fp=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(s,n,r){if(t||typeof n=="string")return s.split(n);for(var i=s.split(n),l=[i[0]],c=1;c<i.length;++c)l.push(r),l.push(i[c]);return l}}();function jd(t){return t?t.content&&t.type?fa(t.content,!0):t.data?Ja(t.data):t.asNodeBuffer&&We?Ja(t.asNodeBuffer().toString("binary")):t.asBinary?Ja(t.asBinary()):t._data&&t._data.getContent?Ja(fa(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function vd(t){if(!t)return null;if(t.data)return Ll(t.data);if(t.asNodeBuffer&&We)return t.asNodeBuffer();if(t._data&&t._data.getContent){var a=t._data.getContent();return typeof a=="string"?Ll(a):Array.prototype.slice.call(a)}return t.content&&t.type?t.content:null}function gp(t){return t&&t.name.slice(-4)===".bin"?vd(t):jd(t)}function ps(t,a){for(var s=t.FullPaths||Ls(t.files),n=a.toLowerCase().replace(/[\/]/g,"\\"),r=n.replace(/\\/g,"/"),i=0;i<s.length;++i){var l=s[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||r==l)return t.files?t.files[s[i]]:t.FileIndex[i]}return null}function Pi(t,a){var s=ps(t,a);if(s==null)throw new Error("Cannot find file "+a+" in zip");return s}function vt(t,a,s){if(!s)return gp(Pi(t,a));if(!a)return null;try{return vt(t,a)}catch{return null}}function ns(t,a,s){if(!s)return jd(Pi(t,a));if(!a)return null;try{return ns(t,a)}catch{return null}}function yp(t,a,s){return vd(Pi(t,a))}function Yl(t){for(var a=t.FullPaths||Ls(t.files),s=[],n=0;n<a.length;++n)a[n].slice(-1)!="/"&&s.push(a[n].replace(/^Root Entry[\/]/,""));return s.sort()}function bp(t,a,s){if(t.FullPaths){if(typeof s=="string"){var n;return We?n=ba(s):n=Mu(s),Ve.utils.cfb_add(t,a,n)}Ve.utils.cfb_add(t,a,s)}else t.file(a,s)}function Nd(t,a){switch(a.type){case"base64":return Ve.read(t,{type:"base64"});case"binary":return Ve.read(t,{type:"binary"});case"buffer":case"array":return Ve.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+a.type)}function Za(t,a){if(t.charAt(0)=="/")return t.slice(1);var s=a.split("/");a.slice(-1)!="/"&&s.pop();for(var n=t.split("/");n.length!==0;){var r=n.shift();r===".."?s.pop():r!=="."&&s.push(r)}return s.join("/")}var wd=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,jp=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Xl=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,vp=/<[^>]*>/g,Gt=wd.match(Xl)?Xl:vp,Np=/<\w*:/,wp=/<(\/?)\w+:/;function Le(t,a,s){for(var n={},r=0,i=0;r!==t.length&&!((i=t.charCodeAt(r))===32||i===10||i===13);++r);if(a||(n[0]=t.slice(0,r)),r===t.length)return n;var l=t.match(jp),c=0,o="",d=0,x="",m="",h=1;if(l)for(d=0;d!=l.length;++d){for(m=l[d],i=0;i!=m.length&&m.charCodeAt(i)!==61;++i);for(x=m.slice(0,i).trim();m.charCodeAt(i+1)==32;)++i;for(h=(r=m.charCodeAt(i+1))==34||r==39?1:0,o=m.slice(i+1+h,m.length-h),c=0;c!=x.length&&x.charCodeAt(c)!==58;++c);if(c===x.length)x.indexOf("_")>0&&(x=x.slice(0,x.indexOf("_"))),n[x]=o,n[x.toLowerCase()]=o;else{var f=(c===5&&x.slice(0,5)==="xmlns"?"xmlns":"")+x.slice(c+1);if(n[f]&&x.slice(c-3,c)=="ext")continue;n[f]=o,n[f.toLowerCase()]=o}}return n}function Os(t){return t.replace(wp,"<$1")}var kd={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},kp=Ri(kd),Xe=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,a=/_x([\da-fA-F]{4})_/ig;return function s(n){var r=n+"",i=r.indexOf("<![CDATA[");if(i==-1)return r.replace(t,function(c,o){return kd[c]||String.fromCharCode(parseInt(o,c.indexOf("x")>-1?16:10))||c}).replace(a,function(c,o){return String.fromCharCode(parseInt(o,16))});var l=r.indexOf("]]>");return s(r.slice(0,i))+r.slice(i+9,l)+s(r.slice(l+3))}}(),Sp=/[&<>'"]/g,Cp=/[\u0000-\u001f]/g;function Li(t){var a=t+"";return a.replace(Sp,function(s){return kp[s]}).replace(/\n/g,"<br/>").replace(Cp,function(s){return"&#x"+("000"+s.charCodeAt(0).toString(16)).slice(-4)+";"})}var Kl=function(){var t=/&#(\d+);/g;function a(s,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,a)}}();function lt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Rn(t){for(var a="",s=0,n=0,r=0,i=0,l=0,c=0;s<t.length;){if(n=t.charCodeAt(s++),n<128){a+=String.fromCharCode(n);continue}if(r=t.charCodeAt(s++),n>191&&n<224){l=(n&31)<<6,l|=r&63,a+=String.fromCharCode(l);continue}if(i=t.charCodeAt(s++),n<240){a+=String.fromCharCode((n&15)<<12|(r&63)<<6|i&63);continue}l=t.charCodeAt(s++),c=((n&7)<<18|(r&63)<<12|(i&63)<<6|l&63)-65536,a+=String.fromCharCode(55296+(c>>>10&1023)),a+=String.fromCharCode(56320+(c&1023))}return a}function Jl(t){var a=ta(2*t.length),s,n,r=1,i=0,l=0,c;for(n=0;n<t.length;n+=r)r=1,(c=t.charCodeAt(n))<128?s=c:c<224?(s=(c&31)*64+(t.charCodeAt(n+1)&63),r=2):c<240?(s=(c&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),r=3):(r=4,s=(c&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),s-=65536,l=55296+(s>>>10&1023),s=56320+(s&1023)),l!==0&&(a[i++]=l&255,a[i++]=l>>>8,l=0),a[i++]=s%256,a[i++]=s>>>8;return a.slice(0,i).toString("ucs2")}function Ql(t){return ba(t,"binary").toString("utf8")}var Mr="foo bar bazÃ¢Â˜ÂƒÃ°ÂŸÂÂ£",nt=We&&(Ql(Mr)==Rn(Mr)&&Ql||Jl(Mr)==Rn(Mr)&&Jl)||Rn,er=We?function(t){return ba(t,"utf8").toString("binary")}:function(t){for(var a=[],s=0,n=0,r=0;s<t.length;)switch(n=t.charCodeAt(s++),!0){case n<128:a.push(String.fromCharCode(n));break;case n<2048:a.push(String.fromCharCode(192+(n>>6))),a.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,r=t.charCodeAt(s++)-56320+(n<<10),a.push(String.fromCharCode(240+(r>>18&7))),a.push(String.fromCharCode(144+(r>>12&63))),a.push(String.fromCharCode(128+(r>>6&63))),a.push(String.fromCharCode(128+(r&63)));break;default:a.push(String.fromCharCode(224+(n>>12))),a.push(String.fromCharCode(128+(n>>6&63))),a.push(String.fromCharCode(128+(n&63)))}return a.join("")},hr=function(){var t={};return function(s,n){var r=s+"|"+(n||"");return t[r]?t[r]:t[r]=new RegExp("<(?:\\w+:)?"+s+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+s+">",n||"")}}(),Sd=function(){var t=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(a){return[new RegExp("&"+a[0]+";","ig"),a[1]]});return function(s){for(var n=s.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),r=0;r<t.length;++r)n=n.replace(t[r][0],t[r][1]);return n}}(),Ap=function(){var t={};return function(s){return t[s]!==void 0?t[s]:t[s]=new RegExp("<(?:vt:)?"+s+">([\\s\\S]*?)</(?:vt:)?"+s+">","g")}}(),Ep=/<\/?(?:vt:)?variant>/g,Fp=/<(?:vt:)([^>]*)>([\s\S]*)</;function Zl(t,a){var s=Le(t),n=t.match(Ap(s.baseType))||[],r=[];if(n.length!=s.size){if(a.WTF)throw new Error("unexpected vector length "+n.length+" != "+s.size);return r}return n.forEach(function(i){var l=i.replace(Ep,"").match(Fp);l&&r.push({v:nt(l[2]),t:l[1]})}),r}var Tp=/(^\s|\s$|\n)/;function Dp(t){return Ls(t).map(function(a){return" "+a+'="'+t[a]+'"'}).join("")}function _p(t,a,s){return"<"+t+(s!=null?Dp(s):"")+(a!=null?(a.match(Tp)?' xml:space="preserve"':"")+">"+a+"</"+t:"/")+">"}function Ii(t){if(We&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return nt(ja(Ti(t)));throw new Error("Bad input format: expected Buffer or string")}var ur=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Rp={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},Pp=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function Lp(t,a){for(var s=1-2*(t[a+7]>>>7),n=((t[a+7]&127)<<4)+(t[a+6]>>>4&15),r=t[a+6]&15,i=5;i>=0;--i)r=r*256+t[a+i];return n==2047?r==0?s*(1/0):NaN:(n==0?n=-1022:(n-=1023,r+=Math.pow(2,52)),s*Math.pow(2,n-52)*r)}function Ip(t,a,s){var n=(a<0||1/a==-1/0?1:0)<<7,r=0,i=0,l=n?-a:a;isFinite(l)?l==0?r=i=0:(r=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-r),r<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?r=-1022:(i-=Math.pow(2,52),r+=1023)):(r=2047,i=isNaN(a)?26985:0);for(var c=0;c<=5;++c,i/=256)t[s+c]=i&255;t[s+6]=(r&15)<<4|i&15,t[s+7]=r>>4|n}var ec=function(t){for(var a=[],s=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var r=0,i=t[0][n].length;r<i;r+=s)a.push.apply(a,t[0][n].slice(r,r+s));return a},tc=We?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(a){return Buffer.isBuffer(a)?a:ba(a)})):ec(t)}:ec,sc=function(t,a,s){for(var n=[],r=a;r<s;r+=2)n.push(String.fromCharCode(Bs(t,r)));return n.join("").replace(Jt,"")},Oi=We?function(t,a,s){return Buffer.isBuffer(t)?t.toString("utf16le",a,s).replace(Jt,""):sc(t,a,s)}:sc,ac=function(t,a,s){for(var n=[],r=a;r<a+s;++r)n.push(("0"+t[r].toString(16)).slice(-2));return n.join("")},Cd=We?function(t,a,s){return Buffer.isBuffer(t)?t.toString("hex",a,a+s):ac(t,a,s)}:ac,rc=function(t,a,s){for(var n=[],r=a;r<s;r++)n.push(String.fromCharCode(Aa(t,r)));return n.join("")},Ar=We?function(a,s,n){return Buffer.isBuffer(a)?a.toString("utf8",s,n):rc(a,s,n)}:rc,Ad=function(t,a){var s=rs(t,a);return s>0?Ar(t,a+4,a+4+s-1):""},Ed=Ad,Fd=function(t,a){var s=rs(t,a);return s>0?Ar(t,a+4,a+4+s-1):""},Td=Fd,Dd=function(t,a){var s=2*rs(t,a);return s>0?Ar(t,a+4,a+4+s-1):""},_d=Dd,Rd=function(a,s){var n=rs(a,s);return n>0?Oi(a,s+4,s+4+n):""},Pd=Rd,Ld=function(t,a){var s=rs(t,a);return s>0?Ar(t,a+4,a+4+s):""},Id=Ld,Od=function(t,a){return Lp(t,a)},rn=Od,Md=function(a){return Array.isArray(a)||typeof Uint8Array<"u"&&a instanceof Uint8Array};We&&(Ed=function(a,s){if(!Buffer.isBuffer(a))return Ad(a,s);var n=a.readUInt32LE(s);return n>0?a.toString("utf8",s+4,s+4+n-1):""},Td=function(a,s){if(!Buffer.isBuffer(a))return Fd(a,s);var n=a.readUInt32LE(s);return n>0?a.toString("utf8",s+4,s+4+n-1):""},_d=function(a,s){if(!Buffer.isBuffer(a))return Dd(a,s);var n=2*a.readUInt32LE(s);return a.toString("utf16le",s+4,s+4+n-1)},Pd=function(a,s){if(!Buffer.isBuffer(a))return Rd(a,s);var n=a.readUInt32LE(s);return a.toString("utf16le",s+4,s+4+n)},Id=function(a,s){if(!Buffer.isBuffer(a))return Ld(a,s);var n=a.readUInt32LE(s);return a.toString("utf8",s+4,s+4+n)},rn=function(a,s){return Buffer.isBuffer(a)?a.readDoubleLE(s):Od(a,s)},Md=function(a){return Buffer.isBuffer(a)||Array.isArray(a)||typeof Uint8Array<"u"&&a instanceof Uint8Array});var Aa=function(t,a){return t[a]},Bs=function(t,a){return t[a+1]*256+t[a]},Op=function(t,a){var s=t[a+1]*256+t[a];return s<32768?s:(65535-s+1)*-1},rs=function(t,a){return t[a+3]*(1<<24)+(t[a+2]<<16)+(t[a+1]<<8)+t[a]},ia=function(t,a){return t[a+3]<<24|t[a+2]<<16|t[a+1]<<8|t[a]},Mp=function(t,a){return t[a]<<24|t[a+1]<<16|t[a+2]<<8|t[a+3]};function tr(t,a){var s="",n,r,i=[],l,c,o,d;switch(a){case"dbcs":if(d=this.l,We&&Buffer.isBuffer(this))s=this.slice(this.l,this.l+2*t).toString("utf16le");else for(o=0;o<t;++o)s+=String.fromCharCode(Bs(this,d)),d+=2;t*=2;break;case"utf8":s=Ar(this,this.l,this.l+t);break;case"utf16le":t*=2,s=Oi(this,this.l,this.l+t);break;case"wstr":return tr.call(this,t,"dbcs");case"lpstr-ansi":s=Ed(this,this.l),t=4+rs(this,this.l);break;case"lpstr-cp":s=Td(this,this.l),t=4+rs(this,this.l);break;case"lpwstr":s=_d(this,this.l),t=4+2*rs(this,this.l);break;case"lpp4":t=4+rs(this,this.l),s=Pd(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+rs(this,this.l),s=Id(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,s="";(l=Aa(this,this.l+t++))!==0;)i.push(Or(l));s=i.join("");break;case"_wstr":for(t=0,s="";(l=Bs(this,this.l+t))!==0;)i.push(Or(l)),t+=2;t+=2,s=i.join("");break;case"dbcs-cont":for(s="",d=this.l,o=0;o<t;++o){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Aa(this,d),this.l=d+1,c=tr.call(this,t-o,l?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(Or(Bs(this,d))),d+=2}s=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(s="",d=this.l,o=0;o!=t;++o){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Aa(this,d),this.l=d+1,c=tr.call(this,t-o,l?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(Or(Aa(this,d))),d+=1}s=i.join("");break;default:switch(t){case 1:return n=Aa(this,this.l),this.l++,n;case 2:return n=(a==="i"?Op:Bs)(this,this.l),this.l+=2,n;case 4:case-4:return a==="i"||!(this[this.l+3]&128)?(n=(t>0?ia:Mp)(this,this.l),this.l+=4,n):(r=rs(this,this.l),this.l+=4,r);case 8:case-8:if(a==="f")return t==8?r=rn(this,this.l):r=rn([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;t=8;case 16:s=Cd(this,this.l,t);break}}return this.l+=t,s}var $p=function(t,a,s){t[s]=a&255,t[s+1]=a>>>8&255,t[s+2]=a>>>16&255,t[s+3]=a>>>24&255},Bp=function(t,a,s){t[s]=a&255,t[s+1]=a>>8&255,t[s+2]=a>>16&255,t[s+3]=a>>24&255},Up=function(t,a,s){t[s]=a&255,t[s+1]=a>>>8&255};function zp(t,a,s){var n=0,r=0;if(s==="dbcs"){for(r=0;r!=a.length;++r)Up(this,a.charCodeAt(r),this.l+2*r);n=2*a.length}else if(s==="sbcs"){for(a=a.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=a.length;++r)this[this.l+r]=a.charCodeAt(r)&255;n=a.length}else if(s==="hex"){for(;r<t;++r)this[this.l++]=parseInt(a.slice(2*r,2*r+2),16)||0;return this}else if(s==="utf16le"){var i=Math.min(this.l+t,this.length);for(r=0;r<Math.min(a.length,t);++r){var l=a.charCodeAt(r);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=a&255;break;case 2:n=2,this[this.l]=a&255,a>>>=8,this[this.l+1]=a&255;break;case 3:n=3,this[this.l]=a&255,a>>>=8,this[this.l+1]=a&255,a>>>=8,this[this.l+2]=a&255;break;case 4:n=4,$p(this,a,this.l);break;case 8:if(n=8,s==="f"){Ip(this,a,this.l);break}case 16:break;case-4:n=4,Bp(this,a,this.l);break}return this.l+=n,this}function $d(t,a){var s=Cd(this,this.l,t.length>>1);if(s!==t)throw new Error(a+"Expected "+t+" saw "+s);this.l+=t.length>>1}function Pt(t,a){t.l=a,t.read_shift=tr,t.chk=$d,t.write_shift=zp}function Vt(t,a){t.l+=a}function St(t){var a=ta(t);return Pt(a,0),a}function Vs(t,a,s){if(t){var n,r,i;Pt(t,t.l||0);for(var l=t.length,c=0,o=0;t.l<l;){c=t.read_shift(1),c&128&&(c=(c&127)+((t.read_shift(1)&127)<<7));var d=xn[c]||xn[65535];for(n=t.read_shift(1),i=n&127,r=1;r<4&&n&128;++r)i+=((n=t.read_shift(1))&127)<<7*r;o=t.l+i;var x=d.f&&d.f(t,i,s);if(t.l=o,a(x,d,c))return}}}function si(){var t=[],a=We?256:2048,s=function(d){var x=St(d);return Pt(x,0),x},n=s(a),r=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(d){return n&&d<n.length-n.l?n:(r(),n=s(Math.max(d+1,a)))},l=function(){return r(),Xs(t)},c=function(d){r(),n=d,n.l==null&&(n.l=n.length),i(a)};return{next:i,push:c,end:l,_bufs:t}}function sr(t,a,s){var n=It(t);if(a.s?(n.cRel&&(n.c+=a.s.c),n.rRel&&(n.r+=a.s.r)):(n.cRel&&(n.c+=a.c),n.rRel&&(n.r+=a.r)),!s||s.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function nc(t,a,s){var n=It(t);return n.s=sr(n.s,a.s,s),n.e=sr(n.e,a.s,s),n}function ar(t,a){if(t.cRel&&t.c<0)for(t=It(t);t.c<0;)t.c+=a>8?16384:256;if(t.rRel&&t.r<0)for(t=It(t);t.r<0;)t.r+=a>8?1048576:a>5?65536:16384;var s=Ie(t);return!t.cRel&&t.cRel!=null&&(s=Wp(s)),!t.rRel&&t.rRel!=null&&(s=Hp(s)),s}function Pn(t,a){return t.s.r==0&&!t.s.rRel&&t.e.r==(a.biff>=12?1048575:a.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+At(t.s.c)+":"+(t.e.cRel?"":"$")+At(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(a.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Ot(t.s.r)+":"+(t.e.rRel?"":"$")+Ot(t.e.r):ar(t.s,a.biff)+":"+ar(t.e,a.biff)}function Mi(t){return parseInt(qp(t),10)-1}function Ot(t){return""+(t+1)}function Hp(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function qp(t){return t.replace(/\$(\d+)$/,"$1")}function $i(t){for(var a=Vp(t),s=0,n=0;n!==a.length;++n)s=26*s+a.charCodeAt(n)-64;return s-1}function At(t){if(t<0)throw new Error("invalid column "+t);var a="";for(++t;t;t=Math.floor((t-1)/26))a=String.fromCharCode((t-1)%26+65)+a;return a}function Wp(t){return t.replace(/^([A-Z])/,"$$$1")}function Vp(t){return t.replace(/^\$([A-Z])/,"$1")}function Gp(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Kt(t){for(var a=0,s=0,n=0;n<t.length;++n){var r=t.charCodeAt(n);r>=48&&r<=57?a=10*a+(r-48):r>=65&&r<=90&&(s=26*s+(r-64))}return{c:s-1,r:a-1}}function Ie(t){for(var a=t.c+1,s="";a;a=(a-1)/26|0)s=String.fromCharCode((a-1)%26+65)+s;return s+(t.r+1)}function qa(t){var a=t.indexOf(":");return a==-1?{s:Kt(t),e:Kt(t)}:{s:Kt(t.slice(0,a)),e:Kt(t.slice(a+1))}}function Ge(t,a){return typeof a>"u"||typeof a=="number"?Ge(t.s,t.e):(typeof t!="string"&&(t=Ie(t)),typeof a!="string"&&(a=Ie(a)),t==a?t:t+":"+a)}function gt(t){var a={s:{c:0,r:0},e:{c:0,r:0}},s=0,n=0,r=0,i=t.length;for(s=0;n<i&&!((r=t.charCodeAt(n)-64)<1||r>26);++n)s=26*s+r;for(a.s.c=--s,s=0;n<i&&!((r=t.charCodeAt(n)-48)<0||r>9);++n)s=10*s+r;if(a.s.r=--s,n===i||r!=10)return a.e.c=a.s.c,a.e.r=a.s.r,a;for(++n,s=0;n!=i&&!((r=t.charCodeAt(n)-64)<1||r>26);++n)s=26*s+r;for(a.e.c=--s,s=0;n!=i&&!((r=t.charCodeAt(n)-48)<0||r>9);++n)s=10*s+r;return a.e.r=--s,a}function ic(t,a){var s=t.t=="d"&&a instanceof Date;if(t.z!=null)try{return t.w=gs(t.z,s?Qt(a):a)}catch{}try{return t.w=gs((t.XF||{}).numFmtId||(s?14:0),s?Qt(a):a)}catch{return""+a}}function Ws(t,a,s){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&s&&s.dateNF&&(t.z=s.dateNF),t.t=="e"?wa[t.v]||t.v:a==null?ic(t,t.v):ic(t,a))}function ra(t,a){var s=a&&a.sheet?a.sheet:"Sheet1",n={};return n[s]=t,{SheetNames:[s],Sheets:n}}function Bd(t,a,s){var n=s||{},r=t?Array.isArray(t):n.dense,i=t||(r?[]:{}),l=0,c=0;if(i&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var o=typeof n.origin=="string"?Kt(n.origin):n.origin;l=o.r,c=o.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var x=gt(i["!ref"]);d.s.c=x.s.c,d.s.r=x.s.r,d.e.c=Math.max(d.e.c,x.e.c),d.e.r=Math.max(d.e.r,x.e.r),l==-1&&(d.e.r=l=x.e.r+1)}for(var m=0;m!=a.length;++m)if(a[m]){if(!Array.isArray(a[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=a[m].length;++h)if(!(typeof a[m][h]>"u")){var f={v:a[m][h]},g=l+m,p=c+h;if(d.s.r>g&&(d.s.r=g),d.s.c>p&&(d.s.c=p),d.e.r<g&&(d.e.r=g),d.e.c<p&&(d.e.c=p),a[m][h]&&typeof a[m][h]=="object"&&!Array.isArray(a[m][h])&&!(a[m][h]instanceof Date))f=a[m][h];else if(Array.isArray(f.v)&&(f.f=a[m][h][1],f.v=f.v[0]),f.v===null)if(f.f)f.t="n";else if(n.nullError)f.t="e",f.v=0;else if(n.sheetStubs)f.t="z";else continue;else typeof f.v=="number"?f.t="n":typeof f.v=="boolean"?f.t="b":f.v instanceof Date?(f.z=n.dateNF||Me[14],n.cellDates?(f.t="d",f.w=gs(f.z,Qt(f.v))):(f.t="n",f.v=Qt(f.v),f.w=gs(f.z,f.v))):f.t="s";if(r)i[g]||(i[g]=[]),i[g][p]&&i[g][p].z&&(f.z=i[g][p].z),i[g][p]=f;else{var u=Ie({c:p,r:g});i[u]&&i[u].z&&(f.z=i[u].z),i[u]=f}}}return d.s.c<1e7&&(i["!ref"]=Ge(d)),i}function Wa(t,a){return Bd(null,t,a)}function Yp(t){return t.read_shift(4,"i")}function Wt(t){var a=t.read_shift(4);return a===0?"":t.read_shift(a,"dbcs")}function Xp(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Bi(t,a){var s=t.l,n=t.read_shift(1),r=Wt(t),i=[],l={t:r,h:r};if(n&1){for(var c=t.read_shift(4),o=0;o!=c;++o)i.push(Xp(t));l.r=i}else l.r=[{ich:0,ifnt:0}];return t.l=s+a,l}var Kp=Bi;function ys(t){var a=t.read_shift(4),s=t.read_shift(2);return s+=t.read_shift(1)<<16,t.l++,{c:a,iStyleRef:s}}function va(t){var a=t.read_shift(2);return a+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:a}}var Jp=Wt;function Ui(t){var a=t.read_shift(4);return a===0||a===4294967295?"":t.read_shift(a,"dbcs")}var Qp=Wt,ai=Ui;function zi(t){var a=t.slice(t.l,t.l+4),s=a[0]&1,n=a[0]&2;t.l+=4;var r=n===0?rn([0,0,0,0,a[0]&252,a[1],a[2],a[3]],0):ia(a,0)>>2;return s?r/100:r}function Ud(t){var a={s:{},e:{}};return a.s.r=t.read_shift(4),a.e.r=t.read_shift(4),a.s.c=t.read_shift(4),a.e.c=t.read_shift(4),a}var Na=Ud;function Ht(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Zp(t){var a={},s=t.read_shift(1),n=s>>>1,r=t.read_shift(1),i=t.read_shift(2,"i"),l=t.read_shift(1),c=t.read_shift(1),o=t.read_shift(1);switch(t.l++,n){case 0:a.auto=1;break;case 1:a.index=r;var d=ma[r];d&&(a.rgb=fr(d));break;case 2:a.rgb=fr([l,c,o]);break;case 3:a.theme=r;break}return i!=0&&(a.tint=i>0?i/32767:i/32768),a}function ef(t){var a=t.read_shift(1);t.l++;var s={fBold:a&1,fItalic:a&2,fUnderline:a&4,fStrikeout:a&8,fOutline:a&16,fShadow:a&32,fCondense:a&64,fExtend:a&128};return s}function zd(t,a){var s={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return s[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,a==1?"lpstr":"lpwstr")}function tf(t){return zd(t,1)}function sf(t){return zd(t,2)}var Hi=2,Zt=3,$r=11,lc=12,nn=19,Br=64,af=65,rf=71,nf=4108,lf=4126,Ft=80,Hd=81,cf=[Ft,Hd],of={1:{n:"CodePage",t:Hi},2:{n:"Category",t:Ft},3:{n:"PresentationFormat",t:Ft},4:{n:"ByteCount",t:Zt},5:{n:"LineCount",t:Zt},6:{n:"ParagraphCount",t:Zt},7:{n:"SlideCount",t:Zt},8:{n:"NoteCount",t:Zt},9:{n:"HiddenCount",t:Zt},10:{n:"MultimediaClipCount",t:Zt},11:{n:"ScaleCrop",t:$r},12:{n:"HeadingPairs",t:nf},13:{n:"TitlesOfParts",t:lf},14:{n:"Manager",t:Ft},15:{n:"Company",t:Ft},16:{n:"LinksUpToDate",t:$r},17:{n:"CharacterCount",t:Zt},19:{n:"SharedDoc",t:$r},22:{n:"HyperlinksChanged",t:$r},23:{n:"AppVersion",t:Zt,p:"version"},24:{n:"DigSig",t:af},26:{n:"ContentType",t:Ft},27:{n:"ContentStatus",t:Ft},28:{n:"Language",t:Ft},29:{n:"Version",t:Ft},255:{},2147483648:{n:"Locale",t:nn},2147483651:{n:"Behavior",t:nn},1919054434:{}},df={1:{n:"CodePage",t:Hi},2:{n:"Title",t:Ft},3:{n:"Subject",t:Ft},4:{n:"Author",t:Ft},5:{n:"Keywords",t:Ft},6:{n:"Comments",t:Ft},7:{n:"Template",t:Ft},8:{n:"LastAuthor",t:Ft},9:{n:"RevNumber",t:Ft},10:{n:"EditTime",t:Br},11:{n:"LastPrinted",t:Br},12:{n:"CreatedDate",t:Br},13:{n:"ModifiedDate",t:Br},14:{n:"PageCount",t:Zt},15:{n:"WordCount",t:Zt},16:{n:"CharCount",t:Zt},17:{n:"Thumbnail",t:rf},18:{n:"Application",t:Ft},19:{n:"DocSecurity",t:Zt},255:{},2147483648:{n:"Locale",t:nn},2147483651:{n:"Behavior",t:nn},1919054434:{}},cc={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},xf=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function mf(t){return t.map(function(a){return[a>>16&255,a>>8&255,a&255]})}var hf=mf([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ma=It(hf),wa={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},qd={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},oc={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function uf(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function pf(t){var a=uf();if(!t||!t.match)return a;var s={};if((t.match(Gt)||[]).forEach(function(n){var r=Le(n);switch(r[0].replace(Np,"<")){case"<?xml":break;case"<Types":a.xmlns=r["xmlns"+(r[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":s[r.Extension]=r.ContentType;break;case"<Override":a[oc[r.ContentType]]!==void 0&&a[oc[r.ContentType]].push(r.PartName);break}}),a.xmlns!==Rp.CT)throw new Error("Unknown Namespace: "+a.xmlns);return a.calcchain=a.calcchains.length>0?a.calcchains[0]:"",a.sst=a.strs.length>0?a.strs[0]:"",a.style=a.styles.length>0?a.styles[0]:"",a.defaults=s,delete a.calcchains,a}var Ea={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ri(t){var a=t.lastIndexOf("/");return t.slice(0,a+1)+"_rels/"+t.slice(a+1)+".rels"}function rr(t,a){var s={"!id":{}};if(!t)return s;a.charAt(0)!=="/"&&(a="/"+a);var n={};return(t.match(Gt)||[]).forEach(function(r){var i=Le(r);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:Za(i.Target,a);s[c]=l,n[i.Id]=l}}),s["!id"]=n,s}var ff="application/vnd.oasis.opendocument.spreadsheet";function gf(t,a){for(var s=Ii(t),n,r;n=ur.exec(s);)switch(n[3]){case"manifest":break;case"file-entry":if(r=Le(n[0],!1),r.path=="/"&&r.type!==ff)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(a&&a.WTF)throw n}}var nr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],yf=function(){for(var t=new Array(nr.length),a=0;a<nr.length;++a){var s=nr[a],n="(?:"+s[0].slice(0,s[0].indexOf(":"))+":)"+s[0].slice(s[0].indexOf(":")+1);t[a]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function Wd(t){var a={};t=nt(t);for(var s=0;s<nr.length;++s){var n=nr[s],r=t.match(yf[s]);r!=null&&r.length>0&&(a[n[1]]=Xe(r[1])),n[2]==="date"&&a[n[1]]&&(a[n[1]]=Dt(a[n[1]]))}return a}var bf=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Vd(t,a,s,n){var r=[];if(typeof t=="string")r=Zl(t,n);else for(var i=0;i<t.length;++i)r=r.concat(t[i].map(function(x){return{v:x}}));var l=typeof a=="string"?Zl(a,n).map(function(x){return x.v}):a,c=0,o=0;if(l.length>0)for(var d=0;d!==r.length;d+=2){switch(o=+r[d+1].v,r[d].v){case"Worksheets":case"å·¥ä½œè¡¨":case"Ð›Ð¸ÑÑ‚Ñ‹":case"Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ø¹Ù…Ù„":case"ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆ":case"×’×œ×™×•× ×•×ª ×¢×‘×•×“×”":case"ArbeitsblÃ¤tter":case"Ã‡alÄ±ÅŸma SayfalarÄ±":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cÃ¡lculo":case"Planilhas":case"Regneark":case"Hojas de cÃ¡lculo":case"Werkbladen":s.Worksheets=o,s.SheetNames=l.slice(c,c+o);break;case"Named Ranges":case"Rangos con nombre":case"åå‰ä»˜ãä¸€è¦§":case"Benannte Bereiche":case"Navngivne omrÃ¥der":s.NamedRanges=o,s.DefinedNames=l.slice(c,c+o);break;case"Charts":case"Diagramme":s.Chartsheets=o,s.ChartNames=l.slice(c,c+o);break}c+=o}}function jf(t,a,s){var n={};return a||(a={}),t=nt(t),bf.forEach(function(r){var i=(t.match(hr(r[0]))||[])[1];switch(r[2]){case"string":i&&(a[r[1]]=Xe(i));break;case"bool":a[r[1]]=i==="true";break;case"raw":var l=t.match(new RegExp("<"+r[0]+"[^>]*>([\\s\\S]*?)</"+r[0]+">"));l&&l.length>0&&(n[r[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Vd(n.HeadingPairs,n.TitlesOfParts,a,s),a}var vf=/<[^>]+>[^<]*/g;function Nf(t,a){var s={},n="",r=t.match(vf);if(r)for(var i=0;i!=r.length;++i){var l=r[i],c=Le(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Xe(c.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var o=l.split(">"),d=o[0].slice(4),x=o[1];switch(d){case"lpstr":case"bstr":case"lpwstr":s[n]=Xe(x);break;case"bool":s[n]=lt(x);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":s[n]=parseInt(x,10);break;case"r4":case"r8":case"decimal":s[n]=parseFloat(x);break;case"filetime":case"date":s[n]=Dt(x);break;case"cy":case"error":s[n]=Xe(x);break;default:if(d.slice(-1)=="/")break;a.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,o)}}else if(l.slice(0,2)!=="</"){if(a.WTF)throw new Error(l)}}}return s}var wf={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ln;function kf(t,a,s){Ln||(Ln=Ri(wf)),a=Ln[a]||a,t[a]=s}function qi(t){var a=t.read_shift(4),s=t.read_shift(4);return new Date((s/1e7*Math.pow(2,32)+a/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Gd(t,a,s){var n=t.l,r=t.read_shift(0,"lpstr-cp");if(s)for(;t.l-n&3;)++t.l;return r}function Yd(t,a,s){var n=t.read_shift(0,"lpwstr");return n}function Xd(t,a,s){return a===31?Yd(t):Gd(t,a,s)}function ni(t,a,s){return Xd(t,a,s===!1?0:4)}function Sf(t,a){if(!a)throw new Error("VtUnalignedString must have positive length");return Xd(t,a,0)}function Cf(t){for(var a=t.read_shift(4),s=[],n=0;n!=a;++n){var r=t.l;s[n]=t.read_shift(0,"lpwstr").replace(Jt,""),t.l-r&2&&(t.l+=2)}return s}function Af(t){for(var a=t.read_shift(4),s=[],n=0;n!=a;++n)s[n]=t.read_shift(0,"lpstr-cp").replace(Jt,"");return s}function Ef(t){var a=t.l,s=ln(t,Hd);t[t.l]==0&&t[t.l+1]==0&&t.l-a&2&&(t.l+=2);var n=ln(t,Zt);return[s,n]}function Ff(t){for(var a=t.read_shift(4),s=[],n=0;n<a/2;++n)s.push(Ef(t));return s}function dc(t,a){for(var s=t.read_shift(4),n={},r=0;r!=s;++r){var i=t.read_shift(4),l=t.read_shift(4);n[i]=t.read_shift(l,a===1200?"utf16le":"utf8").replace(Jt,"").replace(Qa,"!"),a===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function Kd(t){var a=t.read_shift(4),s=t.slice(t.l,t.l+a);return t.l+=a,(a&3)>0&&(t.l+=4-(a&3)&3),s}function Tf(t){var a={};return a.Size=t.read_shift(4),t.l+=a.Size+3-(a.Size-1)%4,a}function ln(t,a,s){var n=t.read_shift(2),r,i=s||{};if(t.l+=2,a!==lc&&n!==a&&cf.indexOf(a)===-1&&!((a&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+a+" saw "+n);switch(a===lc?n:a){case 2:return r=t.read_shift(2,"i"),i.raw||(t.l+=2),r;case 3:return r=t.read_shift(4,"i"),r;case 11:return t.read_shift(4)!==0;case 19:return r=t.read_shift(4),r;case 30:return Gd(t,n,4).replace(Jt,"");case 31:return Yd(t);case 64:return qi(t);case 65:return Kd(t);case 71:return Tf(t);case 80:return ni(t,n,!i.raw).replace(Jt,"");case 81:return Sf(t,n).replace(Jt,"");case 4108:return Ff(t);case 4126:case 4127:return n==4127?Cf(t):Af(t);default:throw new Error("TypedPropertyValue unrecognized type "+a+" "+n)}}function xc(t,a){var s=t.l,n=t.read_shift(4),r=t.read_shift(4),i=[],l=0,c=0,o=-1,d={};for(l=0;l!=r;++l){var x=t.read_shift(4),m=t.read_shift(4);i[l]=[x,m+s]}i.sort(function(y,N){return y[1]-N[1]});var h={};for(l=0;l!=r;++l){if(t.l!==i[l][1]){var f=!0;if(l>0&&a)switch(a[i[l-1][0]].t){case 2:t.l+2===i[l][1]&&(t.l+=2,f=!1);break;case 80:t.l<=i[l][1]&&(t.l=i[l][1],f=!1);break;case 4108:t.l<=i[l][1]&&(t.l=i[l][1],f=!1);break}if((!a||l==0)&&t.l<=i[l][1]&&(f=!1,t.l=i[l][1]),f)throw new Error("Read Error: Expected address "+i[l][1]+" at "+t.l+" :"+l)}if(a){var g=a[i[l][0]];if(h[g.n]=ln(t,g.t,{raw:!0}),g.p==="version"&&(h[g.n]=String(h[g.n]>>16)+"."+("0000"+String(h[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(h[g.n]){case 0:h[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ns(c=h[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[g.n])}}else if(i[l][0]===1){if(c=h.CodePage=ln(t,Hi),Ns(c),o!==-1){var p=t.l;t.l=i[o][1],d=dc(t,c),t.l=p}}else if(i[l][0]===0){if(c===0){o=l,t.l=i[l+1][1];continue}d=dc(t,c)}else{var u=d[i[l][0]],j;switch(t[t.l]){case 65:t.l+=4,j=Kd(t);break;case 30:t.l+=4,j=ni(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,j=ni(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,j=t.read_shift(4,"i");break;case 19:t.l+=4,j=t.read_shift(4);break;case 5:t.l+=4,j=t.read_shift(8,"f");break;case 11:t.l+=4,j=yt(t,4);break;case 64:t.l+=4,j=Dt(qi(t));break;default:throw new Error("unparsed value: "+t[t.l])}h[u]=j}}return t.l=s+n,h}function mc(t,a,s){var n=t.content;if(!n)return{};Pt(n,0);var r,i,l,c,o=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),x=n.read_shift(16);if(x!==Ve.utils.consts.HEADER_CLSID&&x!==s)throw new Error("Bad PropertySet CLSID "+x);if(r=n.read_shift(4),r!==1&&r!==2)throw new Error("Unrecognized #Sets: "+r);if(i=n.read_shift(16),c=n.read_shift(4),r===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);r===2&&(l=n.read_shift(16),o=n.read_shift(4));var m=xc(n,a),h={SystemIdentifier:d};for(var f in m)h[f]=m[f];if(h.FMTID=i,r===1)return h;if(o-n.l==2&&(n.l+=2),n.l!==o)throw new Error("Length mismatch 2: "+n.l+" !== "+o);var g;try{g=xc(n,null)}catch{}for(f in g)h[f]=g[f];return h.FMTID=[i,l],h}function Gs(t,a){return t.read_shift(a),null}function Df(t,a,s){for(var n=[],r=t.l+a;t.l<r;)n.push(s(t,r-t.l));if(r!==t.l)throw new Error("Slurp error");return n}function yt(t,a){return t.read_shift(a)===1}function Nt(t){return t.read_shift(2,"u")}function Jd(t,a){return Df(t,a,Nt)}function _f(t){var a=t.read_shift(1),s=t.read_shift(1);return s===1?a:a===1}function Er(t,a,s){var n=t.read_shift(s&&s.biff>=12?2:1),r="sbcs-cont";if(s&&s.biff>=8,!s||s.biff==8){var i=t.read_shift(1);i&&(r="dbcs-cont")}else s.biff==12&&(r="wstr");s.biff>=2&&s.biff<=5&&(r="cpstr");var l=n?t.read_shift(n,r):"";return l}function Rf(t){var a=t.read_shift(2),s=t.read_shift(1),n=s&4,r=s&8,i=1+(s&1),l=0,c,o={};r&&(l=t.read_shift(2)),n&&(c=t.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",x=a===0?"":t.read_shift(a,d);return r&&(t.l+=4*l),n&&(t.l+=c),o.t=x,r||(o.raw="<t>"+o.t+"</t>",o.r=o.t),o}function ga(t,a,s){var n;if(s){if(s.biff>=2&&s.biff<=5)return t.read_shift(a,"cpstr");if(s.biff>=12)return t.read_shift(a,"dbcs-cont")}var r=t.read_shift(1);return r===0?n=t.read_shift(a,"sbcs-cont"):n=t.read_shift(a,"dbcs-cont"),n}function Fr(t,a,s){var n=t.read_shift(s&&s.biff==2?1:2);return n===0?(t.l++,""):ga(t,n,s)}function ka(t,a,s){if(s.biff>5)return Fr(t,a,s);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,s.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function Pf(t){var a=t.read_shift(1);t.l++;var s=t.read_shift(2);return t.l+=2,[a,s]}function Lf(t){var a=t.read_shift(4),s=t.l,n=!1;a>24&&(t.l+=a-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=s);var r=t.read_shift((n?a-24:a)>>1,"utf16le").replace(Jt,"");return n&&(t.l+=24),r}function If(t){for(var a=t.read_shift(2),s="";a-- >0;)s+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var r=t.read_shift(4);if(r===0)return s+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(i>>1,"utf16le").replace(Jt,"");return s+l}function Of(t,a){var s=t.read_shift(16);switch(s){case"e0c9ea79f9bace118c8200aa004ba90b":return Lf(t);case"0303000000000000c000000000000046":return If(t);default:throw new Error("Unsupported Moniker "+s)}}function Ur(t){var a=t.read_shift(4),s=a>0?t.read_shift(a,"utf16le").replace(Jt,""):"";return s}function Mf(t,a){var s=t.l+a,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var r=t.read_shift(2);t.l+=2;var i,l,c,o,d="",x,m;r&16&&(i=Ur(t,s-t.l)),r&128&&(l=Ur(t,s-t.l)),(r&257)===257&&(c=Ur(t,s-t.l)),(r&257)===1&&(o=Of(t,s-t.l)),r&8&&(d=Ur(t,s-t.l)),r&32&&(x=t.read_shift(16)),r&64&&(m=qi(t)),t.l=s;var h=l||c||o||"";h&&d&&(h+="#"+d),h||(h="#"+d),r&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var f={Target:h};return x&&(f.guid=x),m&&(f.time=m),i&&(f.Tooltip=i),f}function Qd(t){var a=t.read_shift(1),s=t.read_shift(1),n=t.read_shift(1),r=t.read_shift(1);return[a,s,n,r]}function Zd(t,a){var s=Qd(t);return s[3]=0,s}function Ms(t){var a=t.read_shift(2),s=t.read_shift(2),n=t.read_shift(2);return{r:a,c:s,ixfe:n}}function $f(t){var a=t.read_shift(2),s=t.read_shift(2);return t.l+=8,{type:a,flags:s}}function Bf(t,a,s){return a===0?"":ka(t,a,s)}function Uf(t,a,s){var n=s.biff>8?4:2,r=t.read_shift(n),i=t.read_shift(n,"i"),l=t.read_shift(n,"i");return[r,i,l]}function ex(t){var a=t.read_shift(2),s=zi(t);return[a,s]}function zf(t,a,s){t.l+=4,a-=4;var n=t.l+a,r=Er(t,a,s),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,r}function Nn(t){var a=t.read_shift(2),s=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2);return{s:{c:n,r:a},e:{c:r,r:s}}}function tx(t){var a=t.read_shift(2),s=t.read_shift(2),n=t.read_shift(1),r=t.read_shift(1);return{s:{c:n,r:a},e:{c:r,r:s}}}var Hf=tx;function sx(t){t.l+=4;var a=t.read_shift(2),s=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[s,a,n]}function qf(t){var a={};return t.l+=4,t.l+=16,a.fSharedNote=t.read_shift(2),t.l+=4,a}function Wf(t){var a={};return t.l+=4,t.cf=t.read_shift(2),a}function $t(t){t.l+=2,t.l+=t.read_shift(2)}var Vf={0:$t,4:$t,5:$t,6:$t,7:Wf,8:$t,9:$t,10:$t,11:$t,12:$t,13:qf,14:$t,15:$t,16:$t,17:$t,18:$t,19:$t,20:$t,21:sx};function Gf(t,a){for(var s=t.l+a,n=[];t.l<s;){var r=t.read_shift(2);t.l-=2;try{n.push(Vf[r](t,s-t.l))}catch{return t.l=s,n}}return t.l!=s&&(t.l=s),n}function zr(t,a){var s={BIFFVer:0,dt:0};switch(s.BIFFVer=t.read_shift(2),a-=2,a>=2&&(s.dt=t.read_shift(2),t.l-=2),s.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(a>6)throw new Error("Unexpected BIFF Ver "+s.BIFFVer)}return t.read_shift(a),s}function Yf(t,a){return a===0||t.read_shift(2),1200}function Xf(t,a,s){if(s.enc)return t.l+=a,"";var n=t.l,r=ka(t,0,s);return t.read_shift(a+n-t.l),r}function Kf(t,a,s){var n=s&&s.biff==8||a==2?t.read_shift(2):(t.l+=a,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Jf(t,a,s){var n=t.read_shift(4),r=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=Er(t,0,s);return l.length===0&&(l="Sheet1"),{pos:n,hs:r,dt:i,name:l}}function Qf(t,a){for(var s=t.l+a,n=t.read_shift(4),r=t.read_shift(4),i=[],l=0;l!=r&&t.l<s;++l)i.push(Rf(t));return i.Count=n,i.Unique=r,i}function Zf(t,a){var s={};return s.dsst=t.read_shift(2),t.l+=a-2,s}function eg(t){var a={};a.r=t.read_shift(2),a.c=t.read_shift(2),a.cnt=t.read_shift(2)-a.c;var s=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(a.level=n&7),n&32&&(a.hidden=!0),n&64&&(a.hpt=s/20),a}function tg(t){var a=$f(t);if(a.type!=2211)throw new Error("Invalid Future Record "+a.type);var s=t.read_shift(4);return s!==0}function sg(t){return t.read_shift(2),t.read_shift(4)}function hc(t,a,s){var n=0;s&&s.biff==2||(n=t.read_shift(2));var r=t.read_shift(2);s&&s.biff==2&&(n=1-(r>>15),r&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,r]}function ag(t){var a=t.read_shift(2),s=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2),o=t.read_shift(2),d=t.read_shift(2);return{Pos:[a,s],Dim:[n,r],Flags:i,CurTab:l,FirstTab:c,Selected:o,TabRatio:d}}function rg(t,a,s){if(s&&s.biff>=2&&s.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function ng(){}function ig(t,a,s){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(s&&s.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Er(t,0,s),n}function lg(t){var a=Ms(t);return a.isst=t.read_shift(4),a}function cg(t,a,s){s.biffguess&&s.biff==2&&(s.biff=5);var n=t.l+a,r=Ms(t);s.biff==2&&t.l++;var i=Fr(t,n-t.l,s);return r.val=i,r}function og(t,a,s){var n=t.read_shift(2),r=ka(t,0,s);return[n,r]}var dg=ka;function uc(t,a,s){var n=t.l+a,r=s.biff==8||!s.biff?4:2,i=t.read_shift(r),l=t.read_shift(r),c=t.read_shift(2),o=t.read_shift(2);return t.l=n,{s:{r:i,c},e:{r:l,c:o}}}function xg(t){var a=t.read_shift(2),s=t.read_shift(2),n=ex(t);return{r:a,c:s,ixfe:n[0],rknum:n[1]}}function mg(t,a){for(var s=t.l+a-2,n=t.read_shift(2),r=t.read_shift(2),i=[];t.l<s;)i.push(ex(t));if(t.l!==s)throw new Error("MulRK read error");var l=t.read_shift(2);if(i.length!=l-r+1)throw new Error("MulRK length mismatch");return{r:n,c:r,C:l,rkrec:i}}function hg(t,a){for(var s=t.l+a-2,n=t.read_shift(2),r=t.read_shift(2),i=[];t.l<s;)i.push(t.read_shift(2));if(t.l!==s)throw new Error("MulBlank read error");var l=t.read_shift(2);if(i.length!=l-r+1)throw new Error("MulBlank length mismatch");return{r:n,c:r,C:l,ixfe:i}}function ug(t,a,s,n){var r={},i=t.read_shift(4),l=t.read_shift(4),c=t.read_shift(4),o=t.read_shift(2);return r.patternType=xf[c>>26],n.cellStyles&&(r.alc=i&7,r.fWrap=i>>3&1,r.alcV=i>>4&7,r.fJustLast=i>>7&1,r.trot=i>>8&255,r.cIndent=i>>16&15,r.fShrinkToFit=i>>20&1,r.iReadOrder=i>>22&2,r.fAtrNum=i>>26&1,r.fAtrFnt=i>>27&1,r.fAtrAlc=i>>28&1,r.fAtrBdr=i>>29&1,r.fAtrPat=i>>30&1,r.fAtrProt=i>>31&1,r.dgLeft=l&15,r.dgRight=l>>4&15,r.dgTop=l>>8&15,r.dgBottom=l>>12&15,r.icvLeft=l>>16&127,r.icvRight=l>>23&127,r.grbitDiag=l>>30&3,r.icvTop=c&127,r.icvBottom=c>>7&127,r.icvDiag=c>>14&127,r.dgDiag=c>>21&15,r.icvFore=o&127,r.icvBack=o>>7&127,r.fsxButton=o>>14&1),r}function pg(t,a,s){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,a-=6,n.data=ug(t,a,n.fStyle,s),n}function fg(t){t.l+=4;var a=[t.read_shift(2),t.read_shift(2)];if(a[0]!==0&&a[0]--,a[1]!==0&&a[1]--,a[0]>7||a[1]>7)throw new Error("Bad Gutters: "+a.join("|"));return a}function pc(t,a,s){var n=Ms(t);(s.biff==2||a==9)&&++t.l;var r=_f(t);return n.val=r,n.t=r===!0||r===!1?"b":"e",n}function gg(t,a,s){s.biffguess&&s.biff==2&&(s.biff=5);var n=Ms(t),r=Ht(t);return n.val=r,n}var fc=Bf;function yg(t,a,s){var n=t.l+a,r=t.read_shift(2),i=t.read_shift(2);if(s.sbcch=i,i==1025||i==14849)return[i,r];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=ga(t,i),c=[];n>t.l;)c.push(Fr(t));return[i,r,l,c]}function gc(t,a,s){var n=t.read_shift(2),r,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return s.sbcch===14849&&(r=zf(t,a-2,s)),i.body=r||t.read_shift(a-2),typeof r=="string"&&(i.Name=r),i}var bg=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function yc(t,a,s){var n=t.l+a,r=t.read_shift(2),i=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(s&&s.biff==2?1:2),o=0;(!s||s.biff>=5)&&(s.biff!=5&&(t.l+=2),o=t.read_shift(2),s.biff==5&&(t.l+=2),t.l+=4);var d=ga(t,l,s);r&32&&(d=bg[d.charCodeAt(0)]);var x=n-t.l;s&&s.biff==2&&--x;var m=n==t.l||c===0||!(x>0)?[]:ev(t,x,s,c);return{chKey:i,Name:d,itab:o,rgce:m}}function ax(t,a,s){if(s.biff<8)return jg(t,a,s);for(var n=[],r=t.l+a,i=t.read_shift(s.biff>8?4:2);i--!==0;)n.push(Uf(t,s.biff>8?12:6,s));if(t.l!=r)throw new Error("Bad ExternSheet: "+t.l+" != "+r);return n}function jg(t,a,s){t[t.l+1]==3&&t[t.l]++;var n=Er(t,a,s);return n.charCodeAt(0)==3?n.slice(1):n}function vg(t,a,s){if(s.biff<8){t.l+=a;return}var n=t.read_shift(2),r=t.read_shift(2),i=ga(t,n,s),l=ga(t,r,s);return[i,l]}function Ng(t,a,s){var n=tx(t);t.l++;var r=t.read_shift(1);return a-=8,[tv(t,a,s),r,n]}function bc(t,a,s){var n=Hf(t);switch(s.biff){case 2:t.l++,a-=7;break;case 3:case 4:t.l+=2,a-=8;break;default:t.l+=6,a-=12}return[n,Qj(t,a,s)]}function wg(t){var a=t.read_shift(4)!==0,s=t.read_shift(4)!==0,n=t.read_shift(4);return[a,s,n]}function kg(t,a,s){if(!(s.biff<8)){var n=t.read_shift(2),r=t.read_shift(2),i=t.read_shift(2),l=t.read_shift(2),c=ka(t,0,s);return s.biff<8&&t.read_shift(1),[{r:n,c:r},c,l,i]}}function Sg(t,a,s){return kg(t,a,s)}function Cg(t,a){for(var s=[],n=t.read_shift(2);n--;)s.push(Nn(t));return s}function Ag(t,a,s){if(s&&s.biff<8)return Fg(t,a,s);var n=sx(t),r=Gf(t,a-22,n[1]);return{cmo:n,ft:r}}var Eg={8:function(t,a){var s=t.l+a;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var r=t.read_shift(1);return t.l+=r,t.l=s,{fmt:n}}};function Fg(t,a,s){t.l+=4;var n=t.read_shift(2),r=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,a-=36;var l=[];return l.push((Eg[n]||Vt)(t,a,s)),{cmo:[r,n,i],ft:l}}function Tg(t,a,s){var n=t.l,r="";try{t.l+=4;var i=(s.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:l=Pf(t,6,s);var c=t.read_shift(2);t.read_shift(2),Nt(t,2);var o=t.read_shift(2);t.l+=o;for(var d=1;d<t.lens.length-1;++d){if(t.l-n!=t.lens[d])throw new Error("TxO: bad continue record");var x=t[t.l],m=ga(t,t.lens[d+1]-t.lens[d]-1);if(r+=m,r.length>=(x?c:2*c))break}if(r.length!==c&&r.length!==c*2)throw new Error("cchText: "+c+" != "+r.length);return t.l=n+a,{t:r}}catch{return t.l=n+a,{t:r}}}function Dg(t,a){var s=Nn(t);t.l+=16;var n=Mf(t,a-24);return[s,n]}function _g(t,a){t.read_shift(2);var s=Nn(t),n=t.read_shift((a-10)/2,"dbcs-cont");return n=n.replace(Jt,""),[s,n]}function Rg(t){var a=[0,0],s;return s=t.read_shift(2),a[0]=cc[s]||s,s=t.read_shift(2),a[1]=cc[s]||s,a}function Pg(t){for(var a=t.read_shift(2),s=[];a-- >0;)s.push(Zd(t));return s}function Lg(t){for(var a=t.read_shift(2),s=[];a-- >0;)s.push(Zd(t));return s}function Ig(t){t.l+=2;var a={cxfs:0,crc:0};return a.cxfs=t.read_shift(2),a.crc=t.read_shift(4),a}function rx(t,a,s){if(!s.cellStyles)return Vt(t,a);var n=s&&s.biff>=12?4:2,r=t.read_shift(n),i=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(n),o=t.read_shift(2);n==2&&(t.l+=2);var d={s:r,e:i,w:l,ixfe:c,flags:o};return(s.biff>=5||!s.biff)&&(d.level=o>>8&7),d}function Og(t,a){var s={};return a<32||(t.l+=16,s.header=Ht(t),s.footer=Ht(t),t.l+=2),s}function Mg(t,a,s){var n={area:!1};if(s.biff!=5)return t.l+=a,n;var r=t.read_shift(1);return t.l+=3,r&16&&(n.area=!0),n}var $g=Ms,Bg=Jd,Ug=Fr;function zg(t){var a=t.read_shift(2),s=t.read_shift(2),n=t.read_shift(4),r={fmt:a,env:s,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,r}function Hg(t,a,s){s.biffguess&&s.biff==5&&(s.biff=2);var n=Ms(t);++t.l;var r=ka(t,a-7,s);return n.t="str",n.val=r,n}function qg(t){var a=Ms(t);++t.l;var s=Ht(t);return a.t="n",a.val=s,a}function Wg(t){var a=Ms(t);++t.l;var s=t.read_shift(2);return a.t="n",a.val=s,a}function Vg(t){var a=t.read_shift(1);return a===0?(t.l++,""):t.read_shift(a,"sbcs-cont")}function Gg(t,a){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=a-13}function Yg(t,a,s){var n=t.l+a,r=Ms(t),i=t.read_shift(2),l=ga(t,i,s);return t.l=n,r.t="str",r.val=l,r}var Xg=[2,3,48,49,131,139,140,245],jc=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},a=Ri({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function s(c,o){var d=[],x=ta(1);switch(o.type){case"base64":x=vs(os(c));break;case"binary":x=vs(c);break;case"buffer":case"array":x=c;break}Pt(x,0);var m=x.read_shift(1),h=!!(m&136),f=!1,g=!1;switch(m){case 2:break;case 3:break;case 48:f=!0,h=!0;break;case 49:f=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var p=0,u=521;m==2&&(p=x.read_shift(2)),x.l+=3,m!=2&&(p=x.read_shift(4)),p>1048576&&(p=1e6),m!=2&&(u=x.read_shift(2));var j=x.read_shift(2),y=o.codepage||1252;m!=2&&(x.l+=16,x.read_shift(1),x[x.l]!==0&&(y=t[x[x.l]]),x.l+=1,x.l+=2),g&&(x.l+=36);for(var N=[],w={},D=Math.min(x.length,m==2?521:u-10-(f?264:0)),b=g?32:11;x.l<D&&x[x.l]!=13;)switch(w={},w.name=xr.utils.decode(y,x.slice(x.l,x.l+b)).replace(/[\u0000\r\n].*$/g,""),x.l+=b,w.type=String.fromCharCode(x.read_shift(1)),m!=2&&!g&&(w.offset=x.read_shift(4)),w.len=x.read_shift(1),m==2&&(w.offset=x.read_shift(2)),w.dec=x.read_shift(1),w.name.length&&N.push(w),m!=2&&(x.l+=g?13:14),w.type){case"B":(!f||w.len!=8)&&o.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":o.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(x[x.l]!==13&&(x.l=u-1),x.read_shift(1)!==13)throw new Error("DBF Terminator not found "+x.l+" "+x[x.l]);x.l=u;var C=0,S=0;for(d[0]=[],S=0;S!=N.length;++S)d[0][S]=N[S].name;for(;p-- >0;){if(x[x.l]===42){x.l+=j;continue}for(++x.l,d[++C]=[],S=0,S=0;S!=N.length;++S){var k=x.slice(x.l,x.l+N[S].len);x.l+=N[S].len,Pt(k,0);var F=xr.utils.decode(y,k);switch(N[S].type){case"C":F.trim().length&&(d[C][S]=F.replace(/\s+$/,""));break;case"D":F.length===8?d[C][S]=new Date(+F.slice(0,4),+F.slice(4,6)-1,+F.slice(6,8)):d[C][S]=F;break;case"F":d[C][S]=parseFloat(F.trim());break;case"+":case"I":d[C][S]=g?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(F.trim().toUpperCase()){case"Y":case"T":d[C][S]=!0;break;case"N":case"F":d[C][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+F+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));d[C][S]="##MEMO##"+(g?parseInt(F.trim(),10):k.read_shift(4));break;case"N":F=F.replace(/\u0000/g,"").trim(),F&&F!="."&&(d[C][S]=+F||0);break;case"@":d[C][S]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":d[C][S]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":d[C][S]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[C][S]=-k.read_shift(-8,"f");break;case"B":if(f&&N[S].len==8){d[C][S]=k.read_shift(8,"f");break}case"G":case"P":k.l+=N[S].len;break;case"0":if(N[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[S].type)}}}if(m!=2&&x.l<x.length&&x[x.l++]!=26)throw new Error("DBF EOF Marker missing "+(x.l-1)+" of "+x.length+" "+x[x.l-1].toString(16));return o&&o.sheetRows&&(d=d.slice(0,o.sheetRows)),o.DBF=N,d}function n(c,o){var d=o||{};d.dateNF||(d.dateNF="yyyymmdd");var x=Wa(s(c,d),d);return x["!cols"]=d.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete d.DBF,x}function r(c,o){try{return ra(n(c,o),o)}catch(d){if(o&&o.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,o){var d=o||{};if(+d.codepage>=0&&Ns(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var x=si(),m=mi(c,{header:1,raw:!0,cellDates:!0}),h=m[0],f=m.slice(1),g=c["!cols"]||[],p=0,u=0,j=0,y=1;for(p=0;p<h.length;++p){if(((g[p]||{}).DBF||{}).name){h[p]=g[p].DBF.name,++j;continue}if(h[p]!=null){if(++j,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(u=0;u<1024;++u)if(h.indexOf(h[p]+"_"+u)==-1){h[p]+="_"+u;break}}}}var N=gt(c["!ref"]),w=[],D=[],b=[];for(p=0;p<=N.e.c-N.s.c;++p){var C="",S="",k=0,F=[];for(u=0;u<f.length;++u)f[u][p]!=null&&F.push(f[u][p]);if(F.length==0||h[p]==null){w[p]="?";continue}for(u=0;u<F.length;++u){switch(typeof F[u]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=F[u]instanceof Date?"D":"C";break;default:S="C"}k=Math.max(k,String(F[u]).length),C=C&&C!=S?"C":S}k>250&&(k=250),S=((g[p]||{}).DBF||{}).type,S=="C"&&g[p].DBF.len>k&&(k=g[p].DBF.len),C=="B"&&S=="N"&&(C="N",b[p]=g[p].DBF.dec,k=g[p].DBF.len),D[p]=C=="C"||S=="N"?k:i[C]||0,y+=D[p],w[p]=C}var R=x.next(32);for(R.write_shift(4,318902576),R.write_shift(4,f.length),R.write_shift(2,296+32*j),R.write_shift(2,y),p=0;p<4;++p)R.write_shift(4,0);for(R.write_shift(4,0|(+a[ad]||3)<<8),p=0,u=0;p<h.length;++p)if(h[p]!=null){var T=x.next(32),M=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,M,"sbcs"),T.write_shift(1,w[p]=="?"?"C":w[p],"sbcs"),T.write_shift(4,u),T.write_shift(1,D[p]||i[w[p]]||0),T.write_shift(1,b[p]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),u+=D[p]||i[w[p]]||0}var X=x.next(264);for(X.write_shift(4,13),p=0;p<65;++p)X.write_shift(4,0);for(p=0;p<f.length;++p){var q=x.next(y);for(q.write_shift(1,0),u=0;u<h.length;++u)if(h[u]!=null)switch(w[u]){case"L":q.write_shift(1,f[p][u]==null?63:f[p][u]?84:70);break;case"B":q.write_shift(8,f[p][u]||0,"f");break;case"N":var B="0";for(typeof f[p][u]=="number"&&(B=f[p][u].toFixed(b[u]||0)),j=0;j<D[u]-B.length;++j)q.write_shift(1,32);q.write_shift(1,B,"sbcs");break;case"D":f[p][u]?(q.write_shift(4,("0000"+f[p][u].getFullYear()).slice(-4),"sbcs"),q.write_shift(2,("00"+(f[p][u].getMonth()+1)).slice(-2),"sbcs"),q.write_shift(2,("00"+f[p][u].getDate()).slice(-2),"sbcs")):q.write_shift(8,"00000000","sbcs");break;case"C":var K=String(f[p][u]!=null?f[p][u]:"").slice(0,D[u]);for(q.write_shift(1,K,"sbcs"),j=0;j<D[u]-K.length;++j)q.write_shift(1,32);break}}return x.next(1).write_shift(1,26),x.end()}return{to_workbook:r,to_sheet:n,from_sheet:l}}(),Kg=function(){var t={AA:"Ã€",BA:"Ã",CA:"Ã‚",DA:195,HA:"Ã„",JA:197,AE:"Ãˆ",BE:"Ã‰",CE:"ÃŠ",HE:"Ã‹",AI:"ÃŒ",BI:"Ã",CI:"ÃŽ",HI:"Ã",AO:"Ã’",BO:"Ã“",CO:"Ã”",DO:213,HO:"Ã–",AU:"Ã™",BU:"Ãš",CU:"Ã›",HU:"Ãœ",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã‡",Kc:"Ã§",q:"Ã¦",z:"Å“",a:"Ã†",j:"Å’",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},a=new RegExp("\x1BN("+Ls(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),s=function(h,f){var g=t[f];return typeof g=="number"?Il(g):g},n=function(h,f,g){var p=f.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?h:Il(p)};t["|"]=254;function r(h,f){switch(f.type){case"base64":return i(os(h),f);case"binary":return i(h,f);case"buffer":return i(We&&Buffer.isBuffer(h)?h.toString("binary"):ja(h),f);case"array":return i(fa(h),f)}throw new Error("Unrecognized type "+f.type)}function i(h,f){var g=h.split(/[\n\r]+/),p=-1,u=-1,j=0,y=0,N=[],w=[],D=null,b={},C=[],S=[],k=[],F=0,R;for(+f.codepage>=0&&Ns(+f.codepage);j!==g.length;++j){F=0;var T=g[j].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(a,s),M=T.replace(/;;/g,"\0").split(";").map(function(I){return I.replace(/\u0000/g,";")}),X=M[0],q;if(T.length>0)switch(X){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":M[1].charAt(0)=="P"&&w.push(T.slice(3).replace(/;;/g,";"));break;case"C":var B=!1,K=!1,Q=!1,_=!1,ne=-1,ie=-1;for(y=1;y<M.length;++y)switch(M[y].charAt(0)){case"A":break;case"X":u=parseInt(M[y].slice(1))-1,K=!0;break;case"Y":for(p=parseInt(M[y].slice(1))-1,K||(u=0),R=N.length;R<=p;++R)N[R]=[];break;case"K":q=M[y].slice(1),q.charAt(0)==='"'?q=q.slice(1,q.length-1):q==="TRUE"?q=!0:q==="FALSE"?q=!1:isNaN(ks(q))?isNaN(Oa(q).getDate())||(q=Dt(q)):(q=ks(q),D!==null&&Ha(D)&&(q=vn(q))),B=!0;break;case"E":_=!0;var A=Ta(M[y].slice(1),{r:p,c:u});N[p][u]=[N[p][u],A];break;case"S":Q=!0,N[p][u]=[N[p][u],"S5S"];break;case"G":break;case"R":ne=parseInt(M[y].slice(1))-1;break;case"C":ie=parseInt(M[y].slice(1))-1;break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+T)}if(B&&(N[p][u]&&N[p][u].length==2?N[p][u][0]=q:N[p][u]=q,D=null),Q){if(_)throw new Error("SYLK shared formula cannot have own formula");var P=ne>-1&&N[ne][ie];if(!P||!P[1])throw new Error("SYLK shared formula cannot find base");N[p][u][1]=ux(P[1],{r:p-ne,c:u-ie})}break;case"F":var O=0;for(y=1;y<M.length;++y)switch(M[y].charAt(0)){case"X":u=parseInt(M[y].slice(1))-1,++O;break;case"Y":for(p=parseInt(M[y].slice(1))-1,R=N.length;R<=p;++R)N[R]=[];break;case"M":F=parseInt(M[y].slice(1))/20;break;case"F":break;case"G":break;case"P":D=w[parseInt(M[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=M[y].slice(1).split(" "),R=parseInt(k[0],10);R<=parseInt(k[1],10);++R)F=parseInt(k[2],10),S[R-1]=F===0?{hidden:!0}:{wch:F},Ma(S[R-1]);break;case"C":u=parseInt(M[y].slice(1))-1,S[u]||(S[u]={});break;case"R":p=parseInt(M[y].slice(1))-1,C[p]||(C[p]={}),F>0?(C[p].hpt=F,C[p].hpx=gr(F)):F===0&&(C[p].hidden=!0);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+T)}O<1&&(D=null);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+T)}}return C.length>0&&(b["!rows"]=C),S.length>0&&(b["!cols"]=S),f&&f.sheetRows&&(N=N.slice(0,f.sheetRows)),[N,b]}function l(h,f){var g=r(h,f),p=g[0],u=g[1],j=Wa(p,f);return Ls(u).forEach(function(y){j[y]=u[y]}),j}function c(h,f){return ra(l(h,f),f)}function o(h,f,g,p){var u="C;Y"+(g+1)+";X"+(p+1)+";K";switch(h.t){case"n":u+=h.v||0,h.f&&!h.F&&(u+=";E"+Ib(h.f,{r:g,c:p}));break;case"b":u+=h.v?"TRUE":"FALSE";break;case"e":u+=h.w||h.v;break;case"d":u+='"'+(h.w||h.v)+'"';break;case"s":u+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return u}function d(h,f){f.forEach(function(g,p){var u="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?u+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=on(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=dn(g.wpx)),typeof g.wch=="number"&&(u+=Math.round(g.wch))),u.charAt(u.length-1)!=" "&&h.push(u)})}function x(h,f){f.forEach(function(g,p){var u="F;";g.hidden?u+="M0;":g.hpt?u+="M"+20*g.hpt+";":g.hpx&&(u+="M"+20*xx(g.hpx)+";"),u.length>2&&h.push(u+"R"+(p+1))})}function m(h,f){var g=["ID;PWXL;N;E"],p=[],u=gt(h["!ref"]),j,y=Array.isArray(h),N=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),h["!cols"]&&d(g,h["!cols"]),h["!rows"]&&x(g,h["!rows"]),g.push("B;Y"+(u.e.r-u.s.r+1)+";X"+(u.e.c-u.s.c+1)+";D"+[u.s.c,u.s.r,u.e.c,u.e.r].join(" "));for(var w=u.s.r;w<=u.e.r;++w)for(var D=u.s.c;D<=u.e.c;++D){var b=Ie({r:w,c:D});j=y?(h[w]||[])[D]:h[b],!(!j||j.v==null&&(!j.f||j.F))&&p.push(o(j,h,w,D))}return g.join(N)+N+p.join(N)+N+"E"+N}return{to_workbook:c,to_sheet:l,from_sheet:m}}(),Jg=function(){function t(i,l){switch(l.type){case"base64":return a(os(i),l);case"binary":return a(i,l);case"buffer":return a(We&&Buffer.isBuffer(i)?i.toString("binary"):ja(i),l);case"array":return a(fa(i),l)}throw new Error("Unrecognized type "+l.type)}function a(i,l){for(var c=i.split(`
`),o=-1,d=-1,x=0,m=[];x!==c.length;++x){if(c[x].trim()==="BOT"){m[++o]=[],d=0;continue}if(!(o<0)){var h=c[x].trim().split(","),f=h[0],g=h[1];++x;for(var p=c[x]||"";(p.match(/["]/g)||[]).length&1&&x<c.length-1;)p+=`
`+c[++x];switch(p=p.trim(),+f){case-1:if(p==="BOT"){m[++o]=[],d=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?m[o][d]=!0:p==="FALSE"?m[o][d]=!1:isNaN(ks(g))?isNaN(Oa(g).getDate())?m[o][d]=g:m[o][d]=Dt(g):m[o][d]=ks(g),++d;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),m[o][d++]=p!==""?p:null;break}if(p==="EOD")break}}return l&&l.sheetRows&&(m=m.slice(0,l.sheetRows)),m}function s(i,l){return Wa(t(i,l),l)}function n(i,l){return ra(s(i,l),l)}var r=function(){var i=function(o,d,x,m,h){o.push(d),o.push(x+","+m),o.push('"'+h.replace(/"/g,'""')+'"')},l=function(o,d,x,m){o.push(d+","+x),o.push(d==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(o){var d=[],x=gt(o["!ref"]),m,h=Array.isArray(o);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,x.e.r-x.s.r+1,""),i(d,"TUPLES",0,x.e.c-x.s.c+1,""),i(d,"DATA",0,0,"");for(var f=x.s.r;f<=x.e.r;++f){l(d,-1,0,"BOT");for(var g=x.s.c;g<=x.e.c;++g){var p=Ie({r:f,c:g});if(m=h?(o[f]||[])[g]:o[p],!m){l(d,1,0,"");continue}switch(m.t){case"n":var u=m.w;!u&&m.v!=null&&(u=m.v),u==null?m.f&&!m.F?l(d,1,0,"="+m.f):l(d,1,0,""):l(d,0,u,"V");break;case"b":l(d,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=gs(m.z||Me[14],Qt(Dt(m.v)))),l(d,0,m.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var j=`\r
`,y=d.join(j);return y}}();return{to_workbook:n,to_sheet:s,from_sheet:r}}(),Qg=function(){function t(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function a(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function s(m,h){for(var f=m.split(`
`),g=-1,p=-1,u=0,j=[];u!==f.length;++u){var y=f[u].trim().split(":");if(y[0]==="cell"){var N=Kt(y[1]);if(j.length<=N.r)for(g=j.length;g<=N.r;++g)j[g]||(j[g]=[]);switch(g=N.r,p=N.c,y[2]){case"t":j[g][p]=t(y[3]);break;case"v":j[g][p]=+y[3];break;case"vtf":var w=y[y.length-1];case"vtc":switch(y[3]){case"nl":j[g][p]=!!+y[4];break;default:j[g][p]=+y[4];break}y[2]=="vtf"&&(j[g][p]=[j[g][p],w])}}}return h&&h.sheetRows&&(j=j.slice(0,h.sheetRows)),j}function n(m,h){return Wa(s(m,h),h)}function r(m,h){return ra(n(m,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),o="--SocialCalcSpreadsheetControlSave--";function d(m){if(!m||!m["!ref"])return"";for(var h=[],f=[],g,p="",u=qa(m["!ref"]),j=Array.isArray(m),y=u.s.r;y<=u.e.r;++y)for(var N=u.s.c;N<=u.e.c;++N)if(p=Ie({r:y,c:N}),g=j?(m[y]||[])[N]:m[p],!(!g||g.v==null||g.t==="z")){switch(f=["cell",p,"t"],g.t){case"s":case"str":f.push(a(g.v));break;case"n":g.f?(f[2]="vtf",f[3]="n",f[4]=g.v,f[5]=a(g.f)):(f[2]="v",f[3]=g.v);break;case"b":f[2]="vt"+(g.f?"f":"c"),f[3]="nl",f[4]=g.v?"1":"0",f[5]=a(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var w=Qt(Dt(g.v));f[2]="vtc",f[3]="nd",f[4]=""+w,f[5]=g.w||gs(g.z||Me[14],w);break;case"e":continue}h.push(f.join(":"))}return h.push("sheet:c:"+(u.e.c-u.s.c+1)+":r:"+(u.e.r-u.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function x(m){return[i,l,c,l,d(m),o].join(`
`)}return{to_workbook:r,to_sheet:n,from_sheet:x}}(),pr=function(){function t(x,m,h,f,g){g.raw?m[h][f]=x:x===""||(x==="TRUE"?m[h][f]=!0:x==="FALSE"?m[h][f]=!1:isNaN(ks(x))?isNaN(Oa(x).getDate())?m[h][f]=x:m[h][f]=Dt(x):m[h][f]=ks(x))}function a(x,m){var h=m||{},f=[];if(!x||x.length===0)return f;for(var g=x.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var u=10,j=0,y=0;y<=p;++y)j=g[y].indexOf(" "),j==-1?j=g[y].length:j++,u=Math.max(u,j);for(y=0;y<=p;++y){f[y]=[];var N=0;for(t(g[y].slice(0,u).trim(),f,y,N,h),N=1;N<=(g[y].length-u)/10+1;++N)t(g[y].slice(u+(N-1)*10,u+N*10).trim(),f,y,N,h)}return h.sheetRows&&(f=f.slice(0,h.sheetRows)),f}var s={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function r(x){for(var m={},h=!1,f=0,g=0;f<x.length;++f)(g=x.charCodeAt(f))==34?h=!h:!h&&g in s&&(m[g]=(m[g]||0)+1);g=[];for(f in m)Object.prototype.hasOwnProperty.call(m,f)&&g.push([m[f],f]);if(!g.length){m=n;for(f in m)Object.prototype.hasOwnProperty.call(m,f)&&g.push([m[f],f])}return g.sort(function(p,u){return p[0]-u[0]||n[p[1]]-n[u[1]]}),s[g.pop()[1]]||44}function i(x,m){var h=m||{},f="",g=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};x.slice(0,4)=="sep="?x.charCodeAt(5)==13&&x.charCodeAt(6)==10?(f=x.charAt(4),x=x.slice(7)):x.charCodeAt(5)==13||x.charCodeAt(5)==10?(f=x.charAt(4),x=x.slice(6)):f=r(x.slice(0,1024)):h&&h.FS?f=h.FS:f=r(x.slice(0,1024));var u=0,j=0,y=0,N=0,w=0,D=f.charCodeAt(0),b=!1,C=0,S=x.charCodeAt(0);x=x.replace(/\r\n/mg,`
`);var k=h.dateNF!=null?cp(h.dateNF):null;function F(){var R=x.slice(N,w),T={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)T.t="z";else if(h.raw)T.t="s",T.v=R;else if(R.trim().length===0)T.t="s",T.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(T.t="s",T.v=R.slice(2,-1).replace(/""/g,'"')):Mb(R)?(T.t="n",T.f=R.slice(1)):(T.t="s",T.v=R);else if(R=="TRUE")T.t="b",T.v=!0;else if(R=="FALSE")T.t="b",T.v=!1;else if(!isNaN(y=ks(R)))T.t="n",h.cellText!==!1&&(T.w=R),T.v=y;else if(!isNaN(Oa(R).getDate())||k&&R.match(k)){T.z=h.dateNF||Me[14];var M=0;k&&R.match(k)&&(R=op(R,h.dateNF,R.match(k)||[]),M=1),h.cellDates?(T.t="d",T.v=Dt(R,M)):(T.t="n",T.v=Qt(Dt(R,M))),h.cellText!==!1&&(T.w=gs(T.z,T.v instanceof Date?Qt(T.v):T.v)),h.cellNF||delete T.z}else T.t="s",T.v=R;if(T.t=="z"||(h.dense?(g[u]||(g[u]=[]),g[u][j]=T):g[Ie({c:j,r:u})]=T),N=w+1,S=x.charCodeAt(N),p.e.c<j&&(p.e.c=j),p.e.r<u&&(p.e.r=u),C==D)++j;else if(j=0,++u,h.sheetRows&&h.sheetRows<=u)return!0}e:for(;w<x.length;++w)switch(C=x.charCodeAt(w)){case 34:S===34&&(b=!b);break;case D:case 10:case 13:if(!b&&F())break e;break}return w-N>0&&F(),g["!ref"]=Ge(p),g}function l(x,m){return!(m&&m.PRN)||m.FS||x.slice(0,4)=="sep="||x.indexOf("	")>=0||x.indexOf(",")>=0||x.indexOf(";")>=0?i(x,m):Wa(a(x,m),m)}function c(x,m){var h="",f=m.type=="string"?[0,0,0,0]:Qi(x,m);switch(m.type){case"base64":h=os(x);break;case"binary":h=x;break;case"buffer":m.codepage==65001?h=x.toString("utf8"):m.codepage&&typeof xr<"u"||(h=We&&Buffer.isBuffer(x)?x.toString("binary"):ja(x));break;case"array":h=fa(x);break;case"string":h=x;break;default:throw new Error("Unrecognized type "+m.type)}return f[0]==239&&f[1]==187&&f[2]==191?h=nt(h.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?h=nt(h):m.type=="binary"&&typeof xr<"u",h.slice(0,19)=="socialcalc:version:"?Qg.to_sheet(m.type=="string"?h:nt(h),m):l(h,m)}function o(x,m){return ra(c(x,m),m)}function d(x){for(var m=[],h=gt(x["!ref"]),f,g=Array.isArray(x),p=h.s.r;p<=h.e.r;++p){for(var u=[],j=h.s.c;j<=h.e.c;++j){var y=Ie({r:p,c:j});if(f=g?(x[p]||[])[j]:x[y],!f||f.v==null){u.push("          ");continue}for(var N=(f.w||(Ws(f),f.w)||"").slice(0,10);N.length<10;)N+=" ";u.push(N+(j===0?" ":""))}m.push(u.join(""))}return m.join(`
`)}return{to_workbook:o,to_sheet:c,from_sheet:d}}();function Zg(t,a){var s=a||{},n=!!s.WTF;s.WTF=!0;try{var r=Kg.to_workbook(t,s);return s.WTF=n,r}catch(i){if(s.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return pr.to_workbook(t,a)}}var ir=function(){function t(A,P,O){if(A){Pt(A,A.l||0);for(var I=O.Enum||ne;A.l<A.length;){var J=A.read_shift(2),te=I[J]||I[65535],se=A.read_shift(2),le=A.l+se,ue=te.f&&te.f(A,se,O);if(A.l=le,P(ue,te,J))return}}}function a(A,P){switch(P.type){case"base64":return s(vs(os(A)),P);case"binary":return s(vs(A),P);case"buffer":case"array":return s(A,P)}throw"Unsupported type "+P.type}function s(A,P){if(!A)return A;var O=P||{},I=O.dense?[]:{},J="Sheet1",te="",se=0,le={},ue=[],be=[],H={s:{r:0,c:0},e:{r:0,c:0}},De=O.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)O.Enum=ne,t(A,function(ae,xe,fe){switch(fe){case 0:O.vers=ae,ae>=4096&&(O.qpro=!0);break;case 6:H=ae;break;case 204:ae&&(te=ae);break;case 222:te=ae;break;case 15:case 51:O.qpro||(ae[1].v=ae[1].v.slice(1));case 13:case 14:case 16:fe==14&&(ae[2]&112)==112&&(ae[2]&15)>1&&(ae[2]&15)<15&&(ae[1].z=O.dateNF||Me[14],O.cellDates&&(ae[1].t="d",ae[1].v=vn(ae[1].v))),O.qpro&&ae[3]>se&&(I["!ref"]=Ge(H),le[J]=I,ue.push(J),I=O.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},se=ae[3],J=te||"Sheet"+(se+1),te="");var ve=O.dense?(I[ae[0].r]||[])[ae[0].c]:I[Ie(ae[0])];if(ve){ve.t=ae[1].t,ve.v=ae[1].v,ae[1].z!=null&&(ve.z=ae[1].z),ae[1].f!=null&&(ve.f=ae[1].f);break}O.dense?(I[ae[0].r]||(I[ae[0].r]=[]),I[ae[0].r][ae[0].c]=ae[1]):I[Ie(ae[0])]=ae[1];break}},O);else if(A[2]==26||A[2]==14)O.Enum=ie,A[2]==14&&(O.qpro=!0,A.l=0),t(A,function(ae,xe,fe){switch(fe){case 204:J=ae;break;case 22:ae[1].v=ae[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ae[3]>se&&(I["!ref"]=Ge(H),le[J]=I,ue.push(J),I=O.dense?[]:{},H={s:{r:0,c:0},e:{r:0,c:0}},se=ae[3],J="Sheet"+(se+1)),De>0&&ae[0].r>=De)break;O.dense?(I[ae[0].r]||(I[ae[0].r]=[]),I[ae[0].r][ae[0].c]=ae[1]):I[Ie(ae[0])]=ae[1],H.e.c<ae[0].c&&(H.e.c=ae[0].c),H.e.r<ae[0].r&&(H.e.r=ae[0].r);break;case 27:ae[14e3]&&(be[ae[14e3][0]]=ae[14e3][1]);break;case 1537:be[ae[0]]=ae[1],ae[0]==se&&(J=ae[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(I["!ref"]=Ge(H),le[te||J]=I,ue.push(te||J),!be.length)return{SheetNames:ue,Sheets:le};for(var re={},Z=[],ee=0;ee<be.length;++ee)le[ue[ee]]?(Z.push(be[ee]||ue[ee]),re[be[ee]]=le[be[ee]]||le[ue[ee]]):(Z.push(be[ee]),re[be[ee]]={"!ref":"A1"});return{SheetNames:Z,Sheets:re}}function n(A,P){var O=P||{};if(+O.codepage>=0&&Ns(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var I=si(),J=gt(A["!ref"]),te=Array.isArray(A),se=[];js(I,0,i(1030)),js(I,6,o(J));for(var le=Math.min(J.e.r,8191),ue=J.s.r;ue<=le;++ue)for(var be=Ot(ue),H=J.s.c;H<=J.e.c;++H){ue===J.s.r&&(se[H]=At(H));var De=se[H]+be,re=te?(A[ue]||[])[H]:A[De];if(!(!re||re.t=="z"))if(re.t=="n")(re.v|0)==re.v&&re.v>=-32768&&re.v<=32767?js(I,13,f(ue,H,re.v)):js(I,14,p(ue,H,re.v));else{var Z=Ws(re);js(I,15,m(ue,H,Z.slice(0,239)))}}return js(I,1),I.end()}function r(A,P){var O=P||{};if(+O.codepage>=0&&Ns(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var I=si();js(I,0,l(A));for(var J=0,te=0;J<A.SheetNames.length;++J)(A.Sheets[A.SheetNames[J]]||{})["!ref"]&&js(I,27,_(A.SheetNames[J],te++));var se=0;for(J=0;J<A.SheetNames.length;++J){var le=A.Sheets[A.SheetNames[J]];if(!(!le||!le["!ref"])){for(var ue=gt(le["!ref"]),be=Array.isArray(le),H=[],De=Math.min(ue.e.r,8191),re=ue.s.r;re<=De;++re)for(var Z=Ot(re),ee=ue.s.c;ee<=ue.e.c;++ee){re===ue.s.r&&(H[ee]=At(ee));var ae=H[ee]+Z,xe=be?(le[re]||[])[ee]:le[ae];if(!(!xe||xe.t=="z"))if(xe.t=="n")js(I,23,F(re,ee,se,xe.v));else{var fe=Ws(xe);js(I,22,C(re,ee,se,fe.slice(0,239)))}}++se}}return js(I,1),I.end()}function i(A){var P=St(2);return P.write_shift(2,A),P}function l(A){var P=St(26);P.write_shift(2,4096),P.write_shift(2,4),P.write_shift(4,0);for(var O=0,I=0,J=0,te=0;te<A.SheetNames.length;++te){var se=A.SheetNames[te],le=A.Sheets[se];if(!(!le||!le["!ref"])){++J;var ue=qa(le["!ref"]);O<ue.e.r&&(O=ue.e.r),I<ue.e.c&&(I=ue.e.c)}}return O>8191&&(O=8191),P.write_shift(2,O),P.write_shift(1,J),P.write_shift(1,I),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(1,1),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(4,0),P}function c(A,P,O){var I={s:{c:0,r:0},e:{c:0,r:0}};return P==8&&O.qpro?(I.s.c=A.read_shift(1),A.l++,I.s.r=A.read_shift(2),I.e.c=A.read_shift(1),A.l++,I.e.r=A.read_shift(2),I):(I.s.c=A.read_shift(2),I.s.r=A.read_shift(2),P==12&&O.qpro&&(A.l+=2),I.e.c=A.read_shift(2),I.e.r=A.read_shift(2),P==12&&O.qpro&&(A.l+=2),I.s.c==65535&&(I.s.c=I.e.c=I.s.r=I.e.r=0),I)}function o(A){var P=St(8);return P.write_shift(2,A.s.c),P.write_shift(2,A.s.r),P.write_shift(2,A.e.c),P.write_shift(2,A.e.r),P}function d(A,P,O){var I=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(I[0].c=A.read_shift(1),I[3]=A.read_shift(1),I[0].r=A.read_shift(2),A.l+=2):(I[2]=A.read_shift(1),I[0].c=A.read_shift(2),I[0].r=A.read_shift(2)),I}function x(A,P,O){var I=A.l+P,J=d(A,P,O);if(J[1].t="s",O.vers==20768){A.l++;var te=A.read_shift(1);return J[1].v=A.read_shift(te,"utf8"),J}return O.qpro&&A.l++,J[1].v=A.read_shift(I-A.l,"cstr"),J}function m(A,P,O){var I=St(7+O.length);I.write_shift(1,255),I.write_shift(2,P),I.write_shift(2,A),I.write_shift(1,39);for(var J=0;J<I.length;++J){var te=O.charCodeAt(J);I.write_shift(1,te>=128?95:te)}return I.write_shift(1,0),I}function h(A,P,O){var I=d(A,P,O);return I[1].v=A.read_shift(2,"i"),I}function f(A,P,O){var I=St(7);return I.write_shift(1,255),I.write_shift(2,P),I.write_shift(2,A),I.write_shift(2,O,"i"),I}function g(A,P,O){var I=d(A,P,O);return I[1].v=A.read_shift(8,"f"),I}function p(A,P,O){var I=St(13);return I.write_shift(1,255),I.write_shift(2,P),I.write_shift(2,A),I.write_shift(8,O,"f"),I}function u(A,P,O){var I=A.l+P,J=d(A,P,O);if(J[1].v=A.read_shift(8,"f"),O.qpro)A.l=I;else{var te=A.read_shift(2);w(A.slice(A.l,A.l+te),J),A.l+=te}return J}function j(A,P,O){var I=P&32768;return P&=-32769,P=(I?A:0)+(P>=8192?P-16384:P),(I?"":"$")+(O?At(P):Ot(P))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(A,P){Pt(A,0);for(var O=[],I=0,J="",te="",se="",le="";A.l<A.length;){var ue=A[A.l++];switch(ue){case 0:O.push(A.read_shift(8,"f"));break;case 1:te=j(P[0].c,A.read_shift(2),!0),J=j(P[0].r,A.read_shift(2),!1),O.push(te+J);break;case 2:{var be=j(P[0].c,A.read_shift(2),!0),H=j(P[0].r,A.read_shift(2),!1);te=j(P[0].c,A.read_shift(2),!0),J=j(P[0].r,A.read_shift(2),!1),O.push(be+H+":"+te+J)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(A.read_shift(2));break;case 6:{for(var De="";ue=A[A.l++];)De+=String.fromCharCode(ue);O.push('"'+De.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:le=O.pop(),se=O.pop(),O.push(["AND","OR"][ue-20]+"("+se+","+le+")");break;default:if(ue<32&&N[ue])le=O.pop(),se=O.pop(),O.push(se+N[ue]+le);else if(y[ue]){if(I=y[ue][1],I==69&&(I=A[A.l++]),I>O.length){console.error("WK1 bad formula parse 0x"+ue.toString(16)+":|"+O.join("|")+"|");return}var re=O.slice(-I);O.length-=I,O.push(y[ue][0]+"("+re.join(",")+")")}else return ue<=7?console.error("WK1 invalid opcode "+ue.toString(16)):ue<=24?console.error("WK1 unsupported op "+ue.toString(16)):ue<=30?console.error("WK1 invalid opcode "+ue.toString(16)):ue<=115?console.error("WK1 unsupported function opcode "+ue.toString(16)):console.error("WK1 unrecognized opcode "+ue.toString(16))}}O.length==1?P[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function D(A){var P=[{c:0,r:0},{t:"n",v:0},0];return P[0].r=A.read_shift(2),P[3]=A[A.l++],P[0].c=A[A.l++],P}function b(A,P){var O=D(A);return O[1].t="s",O[1].v=A.read_shift(P-4,"cstr"),O}function C(A,P,O,I){var J=St(6+I.length);J.write_shift(2,A),J.write_shift(1,O),J.write_shift(1,P),J.write_shift(1,39);for(var te=0;te<I.length;++te){var se=I.charCodeAt(te);J.write_shift(1,se>=128?95:se)}return J.write_shift(1,0),J}function S(A,P){var O=D(A);O[1].v=A.read_shift(2);var I=O[1].v>>1;if(O[1].v&1)switch(I&7){case 0:I=(I>>3)*5e3;break;case 1:I=(I>>3)*500;break;case 2:I=(I>>3)/20;break;case 3:I=(I>>3)/200;break;case 4:I=(I>>3)/2e3;break;case 5:I=(I>>3)/2e4;break;case 6:I=(I>>3)/16;break;case 7:I=(I>>3)/64;break}return O[1].v=I,O}function k(A,P){var O=D(A),I=A.read_shift(4),J=A.read_shift(4),te=A.read_shift(2);if(te==65535)return I===0&&J===3221225472?(O[1].t="e",O[1].v=15):I===0&&J===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var se=te&32768;return te=(te&32767)-16446,O[1].v=(1-se*2)*(J*Math.pow(2,te+32)+I*Math.pow(2,te)),O}function F(A,P,O,I){var J=St(14);if(J.write_shift(2,A),J.write_shift(1,O),J.write_shift(1,P),I==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var te=0,se=0,le=0,ue=0;return I<0&&(te=1,I=-I),se=Math.log2(I)|0,I/=Math.pow(2,se-31),ue=I>>>0,ue&2147483648||(I/=2,++se,ue=I>>>0),I-=ue,ue|=2147483648,ue>>>=0,I*=Math.pow(2,32),le=I>>>0,J.write_shift(4,le),J.write_shift(4,ue),se+=16383+(te?32768:0),J.write_shift(2,se),J}function R(A,P){var O=k(A);return A.l+=P-14,O}function T(A,P){var O=D(A),I=A.read_shift(4);return O[1].v=I>>6,O}function M(A,P){var O=D(A),I=A.read_shift(8,"f");return O[1].v=I,O}function X(A,P){var O=M(A);return A.l+=P-10,O}function q(A,P){return A[A.l+P-1]==0?A.read_shift(P,"cstr"):""}function B(A,P){var O=A[A.l++];O>P-1&&(O=P-1);for(var I="";I.length<O;)I+=String.fromCharCode(A[A.l++]);return I}function K(A,P,O){if(!(!O.qpro||P<21)){var I=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var J=A.read_shift(P-21,"cstr");return[I,J]}}function Q(A,P){for(var O={},I=A.l+P;A.l<I;){var J=A.read_shift(2);if(J==14e3){for(O[J]=[0,""],O[J][0]=A.read_shift(2);A[A.l];)O[J][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return O}function _(A,P){var O=St(5+A.length);O.write_shift(2,14e3),O.write_shift(2,P);for(var I=0;I<A.length;++I){var J=A.charCodeAt(I);O[O.l++]=J>127?95:J}return O[O.l++]=0,O}var ne={0:{n:"BOF",f:Nt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:x},16:{n:"FORMULA",f:u},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:q},222:{n:"SHEETNAMELP",f:B},65535:{n:""}},ie={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:b},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:M},40:{n:"FORMULA28",f:X},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:K},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:r,to_workbook:a}}();function ey(t){var a={},s=t.match(Gt),n=0,r=!1;if(s)for(;n!=s.length;++n){var i=Le(s[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":a.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;a.cp=Ei[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":a.outline=1;break;case"</outline>":break;case"<rFont":a.name=i.val;break;case"<sz":a.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":a.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":a.uval="double";break;case"singleAccounting":a.uval="single-accounting";break;case"doubleAccounting":a.uval="double-accounting";break}case"<u>":case"<u/>":a.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":a.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":a.i=1;break;case"</i>":break;case"<color":i.rgb&&(a.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":a.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":a.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(i[0].charCodeAt(1)!==47&&!r)throw new Error("Unrecognized rich format "+i[0])}}return a}var ty=function(){var t=hr("t"),a=hr("rPr");function s(i){var l=i.match(t);if(!l)return{t:"s",v:""};var c={t:"s",v:Xe(l[1])},o=i.match(a);return o&&(c.s=ey(o[1])),c}var n=/<(?:\w+:)?r>/g,r=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(r).map(s).filter(function(c){return c.v})}}(),sy=function(){var a=/(\r\n|\n)/g;function s(r,i,l){var c=[];r.u&&c.push("text-decoration: underline;"),r.uval&&c.push("text-underline-style:"+r.uval+";"),r.sz&&c.push("font-size:"+r.sz+"pt;"),r.outline&&c.push("text-effect: outline;"),r.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),r.b&&(i.push("<b>"),l.push("</b>")),r.i&&(i.push("<i>"),l.push("</i>")),r.strike&&(i.push("<s>"),l.push("</s>"));var o=r.valign||"";return o=="superscript"||o=="super"?o="sup":o=="subscript"&&(o="sub"),o!=""&&(i.push("<"+o+">"),l.push("</"+o+">")),l.push("</span>"),r}function n(r){var i=[[],r.v,[]];return r.v?(r.s&&s(r.s,i[0],i[2]),i[0].join("")+i[1].replace(a,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),ay=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,ry=/<(?:\w+:)?r>/,ny=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Wi(t,a){var s=a?a.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Xe(nt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=nt(t),s&&(n.h=Li(n.t))):t.match(ry)&&(n.r=nt(t),n.t=Xe(nt((t.replace(ny,"").match(ay)||[]).join("").replace(Gt,""))),s&&(n.h=sy(ty(n.r)))),n):{t:""}}var iy=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,ly=/<(?:\w+:)?(?:si|sstItem)>/g,cy=/<\/(?:\w+:)?(?:si|sstItem)>/;function oy(t,a){var s=[],n="";if(!t)return s;var r=t.match(iy);if(r){n=r[2].replace(ly,"").split(cy);for(var i=0;i!=n.length;++i){var l=Wi(n[i].trim(),a);l!=null&&(s[s.length]=l)}r=Le(r[1]),s.Count=r.count,s.Unique=r.uniqueCount}return s}function dy(t){return[t.read_shift(4),t.read_shift(4)]}function xy(t,a){var s=[],n=!1;return Vs(t,function(i,l,c){switch(c){case 159:s.Count=i[0],s.Unique=i[1];break;case 19:s.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),s}function nx(t){for(var a=[],s=t.split(""),n=0;n<s.length;++n)a[n]=s[n].charCodeAt(0);return a}function zs(t,a){var s={};return s.Major=t.read_shift(2),s.Minor=t.read_shift(2),a>=4&&(t.l+=a-4),s}function my(t){var a={};return a.id=t.read_shift(0,"lpp4"),a.R=zs(t,4),a.U=zs(t,4),a.W=zs(t,4),a}function hy(t){for(var a=t.read_shift(4),s=t.l+a-4,n={},r=t.read_shift(4),i=[];r-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=s)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+s);return n}function uy(t){var a=[];t.l+=4;for(var s=t.read_shift(4);s-- >0;)a.push(hy(t));return a}function py(t){var a=[];t.l+=4;for(var s=t.read_shift(4);s-- >0;)a.push(t.read_shift(0,"lpp4"));return a}function fy(t){var a={};return t.read_shift(4),t.l+=4,a.id=t.read_shift(0,"lpp4"),a.name=t.read_shift(0,"lpp4"),a.R=zs(t,4),a.U=zs(t,4),a.W=zs(t,4),a}function gy(t){var a=fy(t);if(a.ename=t.read_shift(0,"8lpp4"),a.blksz=t.read_shift(4),a.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return a}function ix(t,a){var s=t.l+a,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var r=!1;switch(n.AlgID){case 26126:case 26127:case 26128:r=n.Flags==36;break;case 26625:r=n.Flags==4;break;case 0:r=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!r)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(s-t.l>>1,"utf16le"),t.l=s,n}function lx(t,a){var s={},n=t.l+a;return t.l+=4,s.Salt=t.slice(t.l,t.l+16),t.l+=16,s.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),s.VerifierHash=t.slice(t.l,n),t.l=n,s}function yy(t){var a=zs(t);switch(a.Minor){case 2:return[a.Minor,by(t)];case 3:return[a.Minor,jy()];case 4:return[a.Minor,vy(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+a.Minor)}function by(t){var a=t.read_shift(4);if((a&63)!=36)throw new Error("EncryptionInfo mismatch");var s=t.read_shift(4),n=ix(t,s),r=lx(t,t.length-t.l);return{t:"Std",h:n,v:r}}function jy(){throw new Error("File is password-protected: ECMA-376 Extensible")}function vy(t){var a=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var s=t.read_shift(t.length-t.l,"utf8"),n={};return s.replace(Gt,function(i){var l=Le(i);switch(Os(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":a.forEach(function(c){n[c]=l[c]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function Ny(t,a){var s={},n=s.EncryptionVersionInfo=zs(t,4);if(a-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);s.Flags=t.read_shift(4),a-=4;var r=t.read_shift(4);return a-=4,s.EncryptionHeader=ix(t,r),a-=r,s.EncryptionVerifier=lx(t,a),s}function wy(t){var a={},s=a.EncryptionVersionInfo=zs(t,4);if(s.Major!=1||s.Minor!=1)throw"unrecognized version code "+s.Major+" : "+s.Minor;return a.Salt=t.read_shift(16),a.EncryptedVerifier=t.read_shift(16),a.EncryptedVerifierHash=t.read_shift(16),a}function ky(t){var a=0,s,n=nx(t),r=n.length+1,i,l,c,o,d;for(s=ta(r),s[0]=n.length,i=1;i!=r;++i)s[i]=n[i-1];for(i=r-1;i>=0;--i)l=s[i],c=a&16384?1:0,o=a<<1&32767,d=c|o,a=d^l;return a^52811}var cx=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],a=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],s=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},r=function(l,c){return n(l^c)},i=function(l){for(var c=a[l.length-1],o=104,d=l.length-1;d>=0;--d)for(var x=l[d],m=0;m!=7;++m)x&64&&(c^=s[o]),x*=2,--o;return c};return function(l){for(var c=nx(l),o=i(c),d=c.length,x=ta(16),m=0;m!=16;++m)x[m]=0;var h,f,g;for((d&1)===1&&(h=o>>8,x[d]=r(t[0],h),--d,h=o&255,f=c[c.length-1],x[d]=r(f,h));d>0;)--d,h=o>>8,x[d]=r(c[d],h),--d,h=o&255,x[d]=r(c[d],h);for(d=15,g=15-c.length;g>0;)h=o>>8,x[d]=r(t[g],h),--d,--g,h=o&255,x[d]=r(c[d],h),--d,--g;return x}}(),Sy=function(t,a,s,n,r){r||(r=a),n||(n=cx(t));var i,l;for(i=0;i!=a.length;++i)l=a[i],l^=n[s],l=(l>>5|l<<3)&255,r[i]=l,++s;return[r,s,n]},Cy=function(t){var a=0,s=cx(t);return function(n){var r=Sy("",n,a,s);return a=r[1],r[0]}};function Ay(t,a,s,n){var r={key:Nt(t),verificationBytes:Nt(t)};return s.password&&(r.verifier=ky(s.password)),n.valid=r.verificationBytes===r.verifier,n.valid&&(n.insitu=Cy(s.password)),r}function Ey(t,a,s){var n=s||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=wy(t):n.Data=Ny(t,a),n}function Fy(t,a,s){var n={Type:s.biff>=8?t.read_shift(2):0};return n.Type?Ey(t,a-2,n):Ay(t,s.biff>=8?a:a-2,s,n),n}var Ty=function(){function t(r,i){switch(i.type){case"base64":return a(os(r),i);case"binary":return a(r,i);case"buffer":return a(We&&Buffer.isBuffer(r)?r.toString("binary"):ja(r),i);case"array":return a(fa(r),i)}throw new Error("Unrecognized type "+i.type)}function a(r,i){var l=i||{},c=l.dense?[]:{},o=r.match(/\\trowd.*?\\row\b/g);if(!o.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:o.length-1}};return o.forEach(function(x,m){Array.isArray(c)&&(c[m]=[]);for(var h=/\\\w+\b/g,f=0,g,p=-1;g=h.exec(x);){switch(g[0]){case"\\cell":var u=x.slice(f,h.lastIndex-g[0].length);if(u[0]==" "&&(u=u.slice(1)),++p,u.length){var j={v:u,t:"s"};Array.isArray(c)?c[m][p]=j:c[Ie({r:m,c:p})]=j}break}f=h.lastIndex}p>d.e.c&&(d.e.c=p)}),c["!ref"]=Ge(d),c}function s(r,i){return ra(t(r,i),i)}function n(r){for(var i=["{\\rtf1\\ansi"],l=gt(r["!ref"]),c,o=Array.isArray(r),d=l.s.r;d<=l.e.r;++d){i.push("\\trowd\\trautofit1");for(var x=l.s.c;x<=l.e.c;++x)i.push("\\cellx"+(x+1));for(i.push("\\pard\\intbl"),x=l.s.c;x<=l.e.c;++x){var m=Ie({r:d,c:x});c=o?(r[d]||[])[x]:r[m],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(Ws(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:s,to_sheet:t,from_sheet:n}}();function Dy(t){var a=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(a.slice(0,2),16),parseInt(a.slice(2,4),16),parseInt(a.slice(4,6),16)]}function fr(t){for(var a=0,s=1;a!=3;++a)s=s*256+(t[a]>255?255:t[a]<0?0:t[a]);return s.toString(16).toUpperCase().slice(1)}function _y(t){var a=t[0]/255,s=t[1]/255,n=t[2]/255,r=Math.max(a,s,n),i=Math.min(a,s,n),l=r-i;if(l===0)return[0,0,a];var c=0,o=0,d=r+i;switch(o=l/(d>1?2-d:d),r){case a:c=((s-n)/l+6)%6;break;case s:c=(n-a)/l+2;break;case n:c=(a-s)/l+4;break}return[c/6,o,d/2]}function Ry(t){var a=t[0],s=t[1],n=t[2],r=s*2*(n<.5?n:1-n),i=n-r/2,l=[i,i,i],c=6*a,o;if(s!==0)switch(c|0){case 0:case 6:o=r*c,l[0]+=r,l[1]+=o;break;case 1:o=r*(2-c),l[0]+=o,l[1]+=r;break;case 2:o=r*(c-2),l[1]+=r,l[2]+=o;break;case 3:o=r*(4-c),l[1]+=o,l[2]+=r;break;case 4:o=r*(c-4),l[2]+=r,l[0]+=o;break;case 5:o=r*(6-c),l[2]+=o,l[0]+=r;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function cn(t,a){if(a===0)return t;var s=_y(Dy(t));return a<0?s[2]=s[2]*(1+a):s[2]=1-(1-s[2])*(1-a),fr(Ry(s))}var ox=6,Py=15,Ly=1,Xt=ox;function on(t){return Math.floor((t+Math.round(128/Xt)/256)*Xt)}function dn(t){return Math.floor((t-5)/Xt*100+.5)/100}function ii(t){return Math.round((t*Xt+5)/Xt*256)/256}function In(t){return ii(dn(on(t)))}function Vi(t){var a=Math.abs(t-In(t)),s=Xt;if(a>.005)for(Xt=Ly;Xt<Py;++Xt)Math.abs(t-In(t))<=a&&(a=Math.abs(t-In(t)),s=Xt);Xt=s}function Ma(t){t.width?(t.wpx=on(t.width),t.wch=dn(t.wpx),t.MDW=Xt):t.wpx?(t.wch=dn(t.wpx),t.width=ii(t.wch),t.MDW=Xt):typeof t.wch=="number"&&(t.width=ii(t.wch),t.wpx=on(t.width),t.MDW=Xt),t.customWidth&&delete t.customWidth}var Iy=96,dx=Iy;function xx(t){return t*96/dx}function gr(t){return t*dx/96}var Oy={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function My(t,a,s,n){a.Borders=[];var r={},i=!1;(t[0].match(Gt)||[]).forEach(function(l){var c=Le(l);switch(Os(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":r={},c.diagonalUp&&(r.diagonalUp=lt(c.diagonalUp)),c.diagonalDown&&(r.diagonalDown=lt(c.diagonalDown)),a.Borders.push(r);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function $y(t,a,s,n){a.Fills=[];var r={},i=!1;(t[0].match(Gt)||[]).forEach(function(l){var c=Le(l);switch(Os(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":r={},a.Fills.push(r);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":a.Fills.push(r),r={};break;case"<patternFill":case"<patternFill>":c.patternType&&(r.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":r.bgColor||(r.bgColor={}),c.indexed&&(r.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(r.bgColor.theme=parseInt(c.theme,10)),c.tint&&(r.bgColor.tint=parseFloat(c.tint)),c.rgb&&(r.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":r.fgColor||(r.fgColor={}),c.theme&&(r.fgColor.theme=parseInt(c.theme,10)),c.tint&&(r.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(r.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function By(t,a,s,n){a.Fonts=[];var r={},i=!1;(t[0].match(Gt)||[]).forEach(function(l){var c=Le(l);switch(Os(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":a.Fonts.push(r),r={};break;case"<name":c.val&&(r.name=nt(c.val));break;case"<name/>":case"</name>":break;case"<b":r.bold=c.val?lt(c.val):1;break;case"<b/>":r.bold=1;break;case"<i":r.italic=c.val?lt(c.val):1;break;case"<i/>":r.italic=1;break;case"<u":switch(c.val){case"none":r.underline=0;break;case"single":r.underline=1;break;case"double":r.underline=2;break;case"singleAccounting":r.underline=33;break;case"doubleAccounting":r.underline=34;break}break;case"<u/>":r.underline=1;break;case"<strike":r.strike=c.val?lt(c.val):1;break;case"<strike/>":r.strike=1;break;case"<outline":r.outline=c.val?lt(c.val):1;break;case"<outline/>":r.outline=1;break;case"<shadow":r.shadow=c.val?lt(c.val):1;break;case"<shadow/>":r.shadow=1;break;case"<condense":r.condense=c.val?lt(c.val):1;break;case"<condense/>":r.condense=1;break;case"<extend":r.extend=c.val?lt(c.val):1;break;case"<extend/>":r.extend=1;break;case"<sz":c.val&&(r.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(r.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(r.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(r.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=Ei[parseInt(c.val,10)];break;case"<color":if(r.color||(r.color={}),c.auto&&(r.color.auto=lt(c.auto)),c.rgb)r.color.rgb=c.rgb.slice(-6);else if(c.indexed){r.color.index=parseInt(c.indexed,10);var o=ma[r.color.index];r.color.index==81&&(o=ma[1]),o||(o=ma[1]),r.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else c.theme&&(r.color.theme=parseInt(c.theme,10),c.tint&&(r.color.tint=parseFloat(c.tint)),c.theme&&s.themeElements&&s.themeElements.clrScheme&&(r.color.rgb=cn(s.themeElements.clrScheme[r.color.theme].rgb,r.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function Uy(t,a,s){a.NumberFmt=[];for(var n=Ls(Me),r=0;r<n.length;++r)a.NumberFmt[n[r]]=Me[n[r]];var i=t[0].match(Gt);if(i)for(r=0;r<i.length;++r){var l=Le(i[r]);switch(Os(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Xe(nt(l.formatCode)),o=parseInt(l.numFmtId,10);if(a.NumberFmt[o]=c,o>0){if(o>392){for(o=392;o>60&&a.NumberFmt[o]!=null;--o);a.NumberFmt[o]=c}xa(c,o)}}break;case"</numFmt>":break;default:if(s.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var Hr=["numFmtId","fillId","fontId","borderId","xfId"],qr=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function zy(t,a,s){a.CellXf=[];var n,r=!1;(t[0].match(Gt)||[]).forEach(function(i){var l=Le(i),c=0;switch(Os(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],c=0;c<Hr.length;++c)n[Hr[c]]&&(n[Hr[c]]=parseInt(n[Hr[c]],10));for(c=0;c<qr.length;++c)n[qr[c]]&&(n[qr[c]]=lt(n[qr[c]]));if(a.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(a.NumberFmt[n.numFmtId]==a.NumberFmt[c]){n.numFmtId=c;break}}a.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var o={};l.vertical&&(o.vertical=l.vertical),l.horizontal&&(o.horizontal=l.horizontal),l.textRotation!=null&&(o.textRotation=l.textRotation),l.indent&&(o.indent=l.indent),l.wrapText&&(o.wrapText=lt(l.wrapText)),n.alignment=o;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":r=!0;break;case"</AlternateContent>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(s&&s.WTF&&!r)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var Hy=function(){var a=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,s=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,r=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,o,d){var x={};if(!c)return x;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=c.match(a))&&Uy(m,x,d),(m=c.match(r))&&By(m,x,o,d),(m=c.match(n))&&$y(m,x,o,d),(m=c.match(i))&&My(m,x,o,d),(m=c.match(s))&&zy(m,x,d),x}}();function qy(t,a){var s=t.read_shift(2),n=Wt(t);return[s,n]}function Wy(t,a,s){var n={};n.sz=t.read_shift(2)/20;var r=ef(t);r.fItalic&&(n.italic=1),r.fCondense&&(n.condense=1),r.fExtend&&(n.extend=1),r.fShadow&&(n.shadow=1),r.fOutline&&(n.outline=1),r.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(n.underline=l);var c=t.read_shift(1);c>0&&(n.family=c);var o=t.read_shift(1);switch(o>0&&(n.charset=o),t.l++,n.color=Zp(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Wt(t),n}var Vy=Vt;function Gy(t,a){var s=t.l+a,n=t.read_shift(2),r=t.read_shift(2);return t.l=s,{ixfe:n,numFmtId:r}}var Yy=Vt;function Xy(t,a,s){var n={};n.NumberFmt=[];for(var r in Me)n.NumberFmt[r]=Me[r];n.CellXf=[],n.Fonts=[];var i=[],l=!1;return Vs(t,function(o,d,x){switch(x){case 44:n.NumberFmt[o[0]]=o[1],xa(o[1],o[0]);break;case 43:n.Fonts.push(o),o.color.theme!=null&&a&&a.themeElements&&a.themeElements.clrScheme&&(o.color.rgb=cn(a.themeElements.clrScheme[o.color.theme].rgb,o.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(o);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(x),l=!0;break;case 38:i.pop(),l=!1;break;default:if(d.T>0)i.push(x);else if(d.T<0)i.pop();else if(!l||s.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+x.toString(16))}}),n}var Ky=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Jy(t,a,s){a.themeElements.clrScheme=[];var n={};(t[0].match(Gt)||[]).forEach(function(r){var i=Le(r);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(a.themeElements.clrScheme[Ky.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(s&&s.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function Qy(){}function Zy(){}var eb=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,tb=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,sb=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function ab(t,a,s){a.themeElements={};var n;[["clrScheme",eb,Jy],["fontScheme",tb,Qy],["fmtScheme",sb,Zy]].forEach(function(r){if(!(n=t.match(r[1])))throw new Error(r[0]+" not found in themeElements");r[2](n,a,s)})}var rb=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function mx(t,a){(!t||t.length===0)&&(t=nb());var s,n={};if(!(s=t.match(rb)))throw new Error("themeElements not found in theme");return ab(s[0],n,a),n.raw=t,n}function nb(t,a){var s=[wd];return s[s.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',s[s.length]="<a:themeElements>",s[s.length]='<a:clrScheme name="Office">',s[s.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',s[s.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',s[s.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',s[s.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',s[s.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',s[s.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',s[s.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',s[s.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',s[s.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',s[s.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',s[s.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',s[s.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',s[s.length]="</a:clrScheme>",s[s.length]='<a:fontScheme name="Office">',s[s.length]="<a:majorFont>",s[s.length]='<a:latin typeface="Cambria"/>',s[s.length]='<a:ea typeface=""/>',s[s.length]='<a:cs typeface=""/>',s[s.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',s[s.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',s[s.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',s[s.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',s[s.length]='<a:font script="Arab" typeface="Times New Roman"/>',s[s.length]='<a:font script="Hebr" typeface="Times New Roman"/>',s[s.length]='<a:font script="Thai" typeface="Tahoma"/>',s[s.length]='<a:font script="Ethi" typeface="Nyala"/>',s[s.length]='<a:font script="Beng" typeface="Vrinda"/>',s[s.length]='<a:font script="Gujr" typeface="Shruti"/>',s[s.length]='<a:font script="Khmr" typeface="MoolBoran"/>',s[s.length]='<a:font script="Knda" typeface="Tunga"/>',s[s.length]='<a:font script="Guru" typeface="Raavi"/>',s[s.length]='<a:font script="Cans" typeface="Euphemia"/>',s[s.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',s[s.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',s[s.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',s[s.length]='<a:font script="Thaa" typeface="MV Boli"/>',s[s.length]='<a:font script="Deva" typeface="Mangal"/>',s[s.length]='<a:font script="Telu" typeface="Gautami"/>',s[s.length]='<a:font script="Taml" typeface="Latha"/>',s[s.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',s[s.length]='<a:font script="Orya" typeface="Kalinga"/>',s[s.length]='<a:font script="Mlym" typeface="Kartika"/>',s[s.length]='<a:font script="Laoo" typeface="DokChampa"/>',s[s.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',s[s.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',s[s.length]='<a:font script="Viet" typeface="Times New Roman"/>',s[s.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',s[s.length]='<a:font script="Geor" typeface="Sylfaen"/>',s[s.length]="</a:majorFont>",s[s.length]="<a:minorFont>",s[s.length]='<a:latin typeface="Calibri"/>',s[s.length]='<a:ea typeface=""/>',s[s.length]='<a:cs typeface=""/>',s[s.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã‚´ã‚·ãƒƒã‚¯"/>',s[s.length]='<a:font script="Hang" typeface="ë§‘ì€ ê³ ë”•"/>',s[s.length]='<a:font script="Hans" typeface="å®‹ä½“"/>',s[s.length]='<a:font script="Hant" typeface="æ–°ç´°æ˜Žé«”"/>',s[s.length]='<a:font script="Arab" typeface="Arial"/>',s[s.length]='<a:font script="Hebr" typeface="Arial"/>',s[s.length]='<a:font script="Thai" typeface="Tahoma"/>',s[s.length]='<a:font script="Ethi" typeface="Nyala"/>',s[s.length]='<a:font script="Beng" typeface="Vrinda"/>',s[s.length]='<a:font script="Gujr" typeface="Shruti"/>',s[s.length]='<a:font script="Khmr" typeface="DaunPenh"/>',s[s.length]='<a:font script="Knda" typeface="Tunga"/>',s[s.length]='<a:font script="Guru" typeface="Raavi"/>',s[s.length]='<a:font script="Cans" typeface="Euphemia"/>',s[s.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',s[s.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',s[s.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',s[s.length]='<a:font script="Thaa" typeface="MV Boli"/>',s[s.length]='<a:font script="Deva" typeface="Mangal"/>',s[s.length]='<a:font script="Telu" typeface="Gautami"/>',s[s.length]='<a:font script="Taml" typeface="Latha"/>',s[s.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',s[s.length]='<a:font script="Orya" typeface="Kalinga"/>',s[s.length]='<a:font script="Mlym" typeface="Kartika"/>',s[s.length]='<a:font script="Laoo" typeface="DokChampa"/>',s[s.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',s[s.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',s[s.length]='<a:font script="Viet" typeface="Arial"/>',s[s.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',s[s.length]='<a:font script="Geor" typeface="Sylfaen"/>',s[s.length]="</a:minorFont>",s[s.length]="</a:fontScheme>",s[s.length]='<a:fmtScheme name="Office">',s[s.length]="<a:fillStyleLst>",s[s.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:lin ang="16200000" scaled="1"/>',s[s.length]="</a:gradFill>",s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:lin ang="16200000" scaled="0"/>',s[s.length]="</a:gradFill>",s[s.length]="</a:fillStyleLst>",s[s.length]="<a:lnStyleLst>",s[s.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',s[s.length]="</a:lnStyleLst>",s[s.length]="<a:effectStyleLst>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]="</a:effectStyle>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]="</a:effectStyle>",s[s.length]="<a:effectStyle>",s[s.length]="<a:effectLst>",s[s.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',s[s.length]="</a:effectLst>",s[s.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',s[s.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',s[s.length]="</a:effectStyle>",s[s.length]="</a:effectStyleLst>",s[s.length]="<a:bgFillStyleLst>",s[s.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',s[s.length]="</a:gradFill>",s[s.length]='<a:gradFill rotWithShape="1">',s[s.length]="<a:gsLst>",s[s.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',s[s.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',s[s.length]="</a:gsLst>",s[s.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',s[s.length]="</a:gradFill>",s[s.length]="</a:bgFillStyleLst>",s[s.length]="</a:fmtScheme>",s[s.length]="</a:themeElements>",s[s.length]="<a:objectDefaults>",s[s.length]="<a:spDef>",s[s.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',s[s.length]="</a:spDef>",s[s.length]="<a:lnDef>",s[s.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',s[s.length]="</a:lnDef>",s[s.length]="</a:objectDefaults>",s[s.length]="<a:extraClrSchemeLst/>",s[s.length]="</a:theme>",s.join("")}function ib(t,a,s){var n=t.l+a,r=t.read_shift(4);if(r!==124226){if(!s.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var l;try{l=Nd(i,{type:"array"})}catch{return}var c=ns(l,"theme/theme/theme1.xml",!0);if(c)return mx(c,s)}}function lb(t){return t.read_shift(4)}function cb(t){var a={};switch(a.xclrType=t.read_shift(2),a.nTintShade=t.read_shift(2),a.xclrType){case 0:t.l+=4;break;case 1:a.xclrValue=ob(t,4);break;case 2:a.xclrValue=Qd(t);break;case 3:a.xclrValue=lb(t);break;case 4:t.l+=4;break}return t.l+=8,a}function ob(t,a){return Vt(t,a)}function db(t,a){return Vt(t,a)}function xb(t){var a=t.read_shift(2),s=t.read_shift(2)-4,n=[a];switch(a){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=cb(t);break;case 6:n[1]=db(t,s);break;case 14:case 15:n[1]=t.read_shift(s===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+a+" "+s)}return n}function mb(t,a){var s=t.l+a;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var r=t.read_shift(2),i=[];r-- >0;)i.push(xb(t,s-t.l));return{ixfe:n,ext:i}}function hb(t,a){a.forEach(function(s){switch(s[0]){}})}function ub(t,a){return{flags:t.read_shift(4),version:t.read_shift(4),name:Wt(t)}}function pb(t){for(var a=[],s=t.read_shift(4);s-- >0;)a.push([t.read_shift(4),t.read_shift(4)]);return a}function fb(t){return t.l+=4,t.read_shift(4)!=0}function gb(t,a,s){var n={Types:[],Cell:[],Value:[]},r=s||{},i=[],l=!1,c=2;return Vs(t,function(o,d,x){switch(x){case 335:n.Types.push({name:o.name});break;case 51:o.forEach(function(m){c==1?n.Cell.push({type:n.Types[m[0]-1].name,index:m[1]}):c==0&&n.Value.push({type:n.Types[m[0]-1].name,index:m[1]})});break;case 337:c=o?1:0;break;case 338:c=2;break;case 35:i.push(x),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!d.T){if(!l||r.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}}),n}function yb(t,a,s){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var r=!1,i=2,l;return t.replace(Gt,function(c){var o=Le(c);switch(Os(o[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:o.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==o.name&&(l=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[o.t-1].name,index:+o.v}):i==0&&n.Value.push({type:n.Types[o.t-1].name,index:+o.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+o.i);break;default:if(!r&&s.WTF)throw new Error("unrecognized "+o[0]+" in metadata")}return c}),n}function bb(t){var a=[];if(!t)return a;var s=1;return(t.match(Gt)||[]).forEach(function(n){var r=Le(n);switch(r[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete r[0],r.i?s=r.i:r.i=s,a.push(r);break}}),a}function jb(t){var a={};a.i=t.read_shift(4);var s={};s.r=t.read_shift(4),s.c=t.read_shift(4),a.r=Ie(s);var n=t.read_shift(1);return n&2&&(a.l="1"),n&8&&(a.a="1"),a}function vb(t,a,s){var n=[];return Vs(t,function(i,l,c){switch(c){case 63:n.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function Nb(t,a,s,n){if(!t)return t;var r=n||{},i=!1;Vs(t,function(c,o,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!o.T){if(!i||r.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},r)}function wb(t,a){if(!t)return"??";var s=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return a["!id"][s].Target}function vc(t,a,s,n){var r=Array.isArray(t),i;a.forEach(function(l){var c=Kt(l.ref);if(r?(t[c.r]||(t[c.r]=[]),i=t[c.r][c.c]):i=t[l.ref],!i){i={t:"z"},r?t[c.r][c.c]=i:t[l.ref]=i;var o=gt(t["!ref"]||"BDWGO1000001:A1");o.s.r>c.r&&(o.s.r=c.r),o.e.r<c.r&&(o.e.r=c.r),o.s.c>c.c&&(o.s.c=c.c),o.e.c<c.c&&(o.e.c=c.c);var d=Ge(o);d!==t["!ref"]&&(t["!ref"]=d)}i.c||(i.c=[]);var x={a:l.author,t:l.t,r:l.r,T:s};l.h&&(x.h=l.h);for(var m=i.c.length-1;m>=0;--m){if(!s&&i.c[m].T)return;s&&!i.c[m].T&&i.c.splice(m,1)}if(s&&n){for(m=0;m<n.length;++m)if(x.a==n[m].id){x.a=n[m].name||x.a;break}}i.c.push(x)})}function kb(t,a){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var s=[],n=[],r=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);r&&r[1]&&r[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&s.push(c[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var o=Le(c[0]),d={author:o.authorId&&s[o.authorId]||"sheetjsghost",ref:o.ref,guid:o.guid},x=Kt(o.ref);if(!(a.sheetRows&&a.sheetRows<=x.r)){var m=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!m&&!!m[1]&&Wi(m[1])||{r:"",t:"",h:""};d.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),d.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),a.cellHTML&&(d.h=h.h),n.push(d)}}}}),n}function Sb(t,a){var s=[],n=!1,r={},i=0;return t.replace(Gt,function(c,o){var d=Le(c);switch(Os(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":r={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":r.t!=null&&s.push(r);break;case"<text>":case"<text":i=o+c.length;break;case"</text>":r.t=t.slice(i,o).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&a.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return c}),s}function Cb(t,a){var s=[],n=!1;return t.replace(Gt,function(i){var l=Le(i);switch(Os(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":s.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&a.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),s}function Ab(t){var a={};a.iauthor=t.read_shift(4);var s=Na(t);return a.rfx=s.s,a.ref=Ie(s.s),t.l+=16,a}var Eb=Wt;function Fb(t,a){var s=[],n=[],r={},i=!1;return Vs(t,function(c,o,d){switch(d){case 632:n.push(c);break;case 635:r=c;break;case 637:r.t=c.t,r.h=c.h,r.r=c.r;break;case 636:if(r.author=n[r.iauthor],delete r.iauthor,a.sheetRows&&r.rfx&&a.sheetRows<=r.rfx.r)break;r.t||(r.t=""),delete r.rfx,s.push(r);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!o.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),s}var Tb="application/vnd.ms-office.vbaProject";function Db(t){var a=Ve.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(s,n){if(!(s.slice(-1)==="/"||!s.match(/_VBA_PROJECT_CUR/))){var r=s.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ve.utils.cfb_add(a,r,t.FileIndex[n].content)}}),Ve.write(a)}function _b(){return{"!type":"dialog"}}function Rb(){return{"!type":"dialog"}}function Pb(){return{"!type":"macro"}}function Lb(){return{"!type":"macro"}}var Ta=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,a={r:0,c:0};function s(n,r,i,l){var c=!1,o=!1;i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,x=l.length>0?parseInt(l,10)|0:0;return c?x+=a.c:--x,o?d+=a.r:--d,r+(c?"":"$")+At(x)+(o?"":"$")+Ot(d)}return function(r,i){return a=i,r.replace(t,s)}}(),hx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Ib=function(){return function(a,s){return a.replace(hx,function(n,r,i,l,c,o){var d=$i(l)-(i?0:s.c),x=Mi(o)-(c?0:s.r),m=x==0?"":c?x+1:"["+x+"]",h=d==0?"":i?d+1:"["+d+"]";return r+"R"+m+"C"+h})}}();function ux(t,a){return t.replace(hx,function(s,n,r,i,l,c){return n+(r=="$"?r+i:At($i(i)+a.c))+(l=="$"?l+c:Ot(Mi(c)+a.r))})}function Ob(t,a,s){var n=qa(a),r=n.s,i=Kt(s),l={r:i.r-r.r,c:i.c-r.c};return ux(t,l)}function Mb(t){return t.length!=1}function Nc(t){return t.replace(/_xlfn\./g,"")}function jt(t){t.l+=1}function sa(t,a){var s=t.read_shift(2);return[s&16383,s>>14&1,s>>15&1]}function px(t,a,s){var n=2;if(s){if(s.biff>=2&&s.biff<=5)return fx(t);s.biff==12&&(n=4)}var r=t.read_shift(n),i=t.read_shift(n),l=sa(t),c=sa(t);return{s:{r,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function fx(t){var a=sa(t),s=sa(t),n=t.read_shift(1),r=t.read_shift(1);return{s:{r:a[0],c:n,cRel:a[1],rRel:a[2]},e:{r:s[0],c:r,cRel:s[1],rRel:s[2]}}}function $b(t,a,s){if(s.biff<8)return fx(t);var n=t.read_shift(s.biff==12?4:2),r=t.read_shift(s.biff==12?4:2),i=sa(t),l=sa(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r,c:l[0],cRel:l[1],rRel:l[2]}}}function gx(t,a,s){if(s&&s.biff>=2&&s.biff<=5)return Bb(t);var n=t.read_shift(s&&s.biff==12?4:2),r=sa(t);return{r:n,c:r[0],cRel:r[1],rRel:r[2]}}function Bb(t){var a=sa(t),s=t.read_shift(1);return{r:a[0],c:s,cRel:a[1],rRel:a[2]}}function Ub(t){var a=t.read_shift(2),s=t.read_shift(2);return{r:a,c:s&255,fQuoted:!!(s&16384),cRel:s>>15,rRel:s>>15}}function zb(t,a,s){var n=s&&s.biff?s.biff:8;if(n>=2&&n<=5)return Hb(t);var r=t.read_shift(n>=12?4:2),i=t.read_shift(2),l=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;r>524287;)r-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r,c:i,cRel:l,rRel:c}}function Hb(t){var a=t.read_shift(2),s=t.read_shift(1),n=(a&32768)>>15,r=(a&16384)>>14;return a&=16383,n==1&&a>=8192&&(a=a-16384),r==1&&s>=128&&(s=s-256),{r:a,c:s,cRel:r,rRel:n}}function qb(t,a,s){var n=(t[t.l++]&96)>>5,r=px(t,s.biff>=2&&s.biff<=5?6:8,s);return[n,r]}function Wb(t,a,s){var n=(t[t.l++]&96)>>5,r=t.read_shift(2,"i"),i=8;if(s)switch(s.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var l=px(t,i,s);return[n,r,l]}function Vb(t,a,s){var n=(t[t.l++]&96)>>5;return t.l+=s&&s.biff>8?12:s.biff<8?6:8,[n]}function Gb(t,a,s){var n=(t[t.l++]&96)>>5,r=t.read_shift(2),i=8;if(s)switch(s.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,r]}function Yb(t,a,s){var n=(t[t.l++]&96)>>5,r=$b(t,a-1,s);return[n,r]}function Xb(t,a,s){var n=(t[t.l++]&96)>>5;return t.l+=s.biff==2?6:s.biff==12?14:7,[n]}function wc(t){var a=t[t.l+1]&1,s=1;return t.l+=4,[a,s]}function Kb(t,a,s){t.l+=2;for(var n=t.read_shift(s&&s.biff==2?1:2),r=[],i=0;i<=n;++i)r.push(t.read_shift(s&&s.biff==2?1:2));return r}function Jb(t,a,s){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(s&&s.biff==2?1:2)]}function Qb(t,a,s){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(s&&s.biff==2?1:2)]}function Zb(t){var a=t[t.l+1]&255?1:0;return t.l+=2,[a,t.read_shift(2)]}function ej(t,a,s){var n=t[t.l+1]&255?1:0;return t.l+=s&&s.biff==2?3:4,[n]}function yx(t){var a=t.read_shift(1),s=t.read_shift(1);return[a,s]}function tj(t){return t.read_shift(2),yx(t)}function sj(t){return t.read_shift(2),yx(t)}function aj(t,a,s){var n=(t[t.l]&96)>>5;t.l+=1;var r=gx(t,0,s);return[n,r]}function rj(t,a,s){var n=(t[t.l]&96)>>5;t.l+=1;var r=zb(t,0,s);return[n,r]}function nj(t,a,s){var n=(t[t.l]&96)>>5;t.l+=1;var r=t.read_shift(2);s&&s.biff==5&&(t.l+=12);var i=gx(t,0,s);return[n,r,i]}function ij(t,a,s){var n=(t[t.l]&96)>>5;t.l+=1;var r=t.read_shift(s&&s.biff<=3?1:2);return[lv[r],vx[r],n]}function lj(t,a,s){var n=t[t.l++],r=t.read_shift(1),i=s&&s.biff<=3?[n==88?-1:0,t.read_shift(1)]:cj(t);return[r,(i[0]===0?vx:iv)[i[1]]]}function cj(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function oj(t,a,s){t.l+=s&&s.biff==2?3:4}function dj(t,a,s){if(t.l++,s&&s.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),r=t.read_shift(s&&s.biff==2?1:2);return[n,r]}function xj(t){return t.l++,wa[t.read_shift(1)]}function mj(t){return t.l++,t.read_shift(2)}function hj(t){return t.l++,t.read_shift(1)!==0}function uj(t){return t.l++,Ht(t)}function pj(t,a,s){return t.l++,Er(t,a-1,s)}function fj(t,a){var s=[t.read_shift(1)];if(a==12)switch(s[0]){case 2:s[0]=4;break;case 4:s[0]=16;break;case 0:s[0]=1;break;case 1:s[0]=2;break}switch(s[0]){case 4:s[1]=yt(t,1)?"TRUE":"FALSE",a!=12&&(t.l+=7);break;case 37:case 16:s[1]=wa[t[t.l]],t.l+=a==12?4:8;break;case 0:t.l+=8;break;case 1:s[1]=Ht(t);break;case 2:s[1]=ka(t,0,{biff:a>0&&a<8?2:a});break;default:throw new Error("Bad SerAr: "+s[0])}return s}function gj(t,a,s){for(var n=t.read_shift(s.biff==12?4:2),r=[],i=0;i!=n;++i)r.push((s.biff==12?Na:Nn)(t));return r}function yj(t,a,s){var n=0,r=0;s.biff==12?(n=t.read_shift(4),r=t.read_shift(4)):(r=1+t.read_shift(1),n=1+t.read_shift(2)),s.biff>=2&&s.biff<8&&(--n,--r==0&&(r=256));for(var i=0,l=[];i!=n&&(l[i]=[]);++i)for(var c=0;c!=r;++c)l[i][c]=fj(t,s.biff);return l}function bj(t,a,s){var n=t.read_shift(1)>>>5&3,r=!s||s.biff>=8?4:2,i=t.read_shift(r);switch(s.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function jj(t,a,s){if(s.biff==5)return vj(t);var n=t.read_shift(1)>>>5&3,r=t.read_shift(2),i=t.read_shift(4);return[n,r,i]}function vj(t){var a=t.read_shift(1)>>>5&3,s=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[a,s,n]}function Nj(t,a,s){var n=t.read_shift(1)>>>5&3;t.l+=s&&s.biff==2?3:4;var r=t.read_shift(s&&s.biff==2?1:2);return[n,r]}function wj(t,a,s){var n=t.read_shift(1)>>>5&3,r=t.read_shift(s&&s.biff==2?1:2);return[n,r]}function kj(t,a,s){var n=t.read_shift(1)>>>5&3;return t.l+=4,s.biff<8&&t.l--,s.biff==12&&(t.l+=2),[n]}function Sj(t,a,s){var n=(t[t.l++]&96)>>5,r=t.read_shift(2),i=4;if(s)switch(s.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,r]}var Cj=Vt,Aj=Vt,Ej=Vt;function Tr(t,a,s){return t.l+=2,[Ub(t)]}function Gi(t){return t.l+=6,[]}var Fj=Tr,Tj=Gi,Dj=Gi,_j=Tr;function bx(t){return t.l+=2,[Nt(t),t.read_shift(2)&1]}var Rj=Tr,Pj=bx,Lj=Gi,Ij=Tr,Oj=Tr,Mj=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function $j(t){t.l+=2;var a=t.read_shift(2),s=t.read_shift(2),n=t.read_shift(4),r=t.read_shift(2),i=t.read_shift(2),l=Mj[s>>2&31];return{ixti:a,coltype:s&3,rt:l,idx:n,c:r,C:i}}function Bj(t){return t.l+=2,[t.read_shift(4)]}function Uj(t,a,s){return t.l+=5,t.l+=2,t.l+=s.biff==2?1:4,["PTGSHEET"]}function zj(t,a,s){return t.l+=s.biff==2?4:5,["PTGENDSHEET"]}function Hj(t){var a=t.read_shift(1)>>>5&3,s=t.read_shift(2);return[a,s]}function qj(t){var a=t.read_shift(1)>>>5&3,s=t.read_shift(2);return[a,s]}function Wj(t){return t.l+=4,[0,0]}var kc={1:{n:"PtgExp",f:dj},2:{n:"PtgTbl",f:Ej},3:{n:"PtgAdd",f:jt},4:{n:"PtgSub",f:jt},5:{n:"PtgMul",f:jt},6:{n:"PtgDiv",f:jt},7:{n:"PtgPower",f:jt},8:{n:"PtgConcat",f:jt},9:{n:"PtgLt",f:jt},10:{n:"PtgLe",f:jt},11:{n:"PtgEq",f:jt},12:{n:"PtgGe",f:jt},13:{n:"PtgGt",f:jt},14:{n:"PtgNe",f:jt},15:{n:"PtgIsect",f:jt},16:{n:"PtgUnion",f:jt},17:{n:"PtgRange",f:jt},18:{n:"PtgUplus",f:jt},19:{n:"PtgUminus",f:jt},20:{n:"PtgPercent",f:jt},21:{n:"PtgParen",f:jt},22:{n:"PtgMissArg",f:jt},23:{n:"PtgStr",f:pj},26:{n:"PtgSheet",f:Uj},27:{n:"PtgEndSheet",f:zj},28:{n:"PtgErr",f:xj},29:{n:"PtgBool",f:hj},30:{n:"PtgInt",f:mj},31:{n:"PtgNum",f:uj},32:{n:"PtgArray",f:Xb},33:{n:"PtgFunc",f:ij},34:{n:"PtgFuncVar",f:lj},35:{n:"PtgName",f:bj},36:{n:"PtgRef",f:aj},37:{n:"PtgArea",f:qb},38:{n:"PtgMemArea",f:Nj},39:{n:"PtgMemErr",f:Cj},40:{n:"PtgMemNoMem",f:Aj},41:{n:"PtgMemFunc",f:wj},42:{n:"PtgRefErr",f:kj},43:{n:"PtgAreaErr",f:Vb},44:{n:"PtgRefN",f:rj},45:{n:"PtgAreaN",f:Yb},46:{n:"PtgMemAreaN",f:Hj},47:{n:"PtgMemNoMemN",f:qj},57:{n:"PtgNameX",f:jj},58:{n:"PtgRef3d",f:nj},59:{n:"PtgArea3d",f:Wb},60:{n:"PtgRefErr3d",f:Sj},61:{n:"PtgAreaErr3d",f:Gb},255:{}},Vj={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Gj={1:{n:"PtgElfLel",f:bx},2:{n:"PtgElfRw",f:Ij},3:{n:"PtgElfCol",f:Fj},6:{n:"PtgElfRwV",f:Oj},7:{n:"PtgElfColV",f:_j},10:{n:"PtgElfRadical",f:Rj},11:{n:"PtgElfRadicalS",f:Lj},13:{n:"PtgElfColS",f:Tj},15:{n:"PtgElfColSV",f:Dj},16:{n:"PtgElfRadicalLel",f:Pj},25:{n:"PtgList",f:$j},29:{n:"PtgSxName",f:Bj},255:{}},Yj={0:{n:"PtgAttrNoop",f:Wj},1:{n:"PtgAttrSemi",f:ej},2:{n:"PtgAttrIf",f:Qb},4:{n:"PtgAttrChoose",f:Kb},8:{n:"PtgAttrGoto",f:Jb},16:{n:"PtgAttrSum",f:oj},32:{n:"PtgAttrBaxcel",f:wc},33:{n:"PtgAttrBaxcel",f:wc},64:{n:"PtgAttrSpace",f:tj},65:{n:"PtgAttrSpaceSemi",f:sj},128:{n:"PtgAttrIfError",f:Zb},255:{}};function Dr(t,a,s,n){if(n.biff<8)return Vt(t,a);for(var r=t.l+a,i=[],l=0;l!==s.length;++l)switch(s[l][0]){case"PtgArray":s[l][1]=yj(t,0,n),i.push(s[l][1]);break;case"PtgMemArea":s[l][2]=gj(t,s[l][1],n),i.push(s[l][2]);break;case"PtgExp":n&&n.biff==12&&(s[l][1][1]=t.read_shift(4),i.push(s[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+s[l][0]}return a=r-t.l,a!==0&&i.push(Vt(t,a)),i}function _r(t,a,s){for(var n=t.l+a,r,i,l=[];n!=t.l;)a=n-t.l,i=t[t.l],r=kc[i]||kc[Vj[i]],(i===24||i===25)&&(r=(i===24?Gj:Yj)[t[t.l+1]]),!r||!r.f?Vt(t,a):l.push([r.n,r.f(t,a,s)]);return l}function Xj(t){for(var a=[],s=0;s<t.length;++s){for(var n=t[s],r=[],i=0;i<n.length;++i){var l=n[i];if(l)switch(l[0]){case 2:r.push('"'+l[1].replace(/"/g,'""')+'"');break;default:r.push(l[1])}else r.push("")}a.push(r.join(","))}return a.join(";")}var Kj={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Jj(t,a){if(!t&&!(a&&a.biff<=5&&a.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function jx(t,a,s){if(!t)return"SH33TJSERR0";if(s.biff>8&&(!t.XTI||!t.XTI[a]))return t.SheetNames[a];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[a];if(s.biff<8)return a>1e4&&(a-=65536),a<0&&(a=-a),a==0?"":t.XTI[a-1];if(!n)return"SH33TJSERR1";var r="";if(s.biff>8)switch(t[n[0]][0]){case 357:return r=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?r:r+":"+t.SheetNames[n[2]];case 358:return s.SID!=null?t.SheetNames[s.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return r=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?r:r+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(r=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?r:r+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Sc(t,a,s){var n=jx(t,a,s);return n=="#REF"?n:Jj(n,s)}function Bt(t,a,s,n,r){var i=r&&r.biff||8,l={s:{c:0,r:0}},c=[],o,d,x,m=0,h=0,f,g="";if(!t[0]||!t[0][0])return"";for(var p=-1,u="",j=0,y=t[0].length;j<y;++j){var N=t[0][j];switch(N[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(o=c.pop(),d=c.pop(),p>=0){switch(t[0][p][1][0]){case 0:u=pt(" ",t[0][p][1][1]);break;case 1:u=pt("\r",t[0][p][1][1]);break;default:if(u="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}d=d+u,p=-1}c.push(d+Kj[N[0]]+o);break;case"PtgIsect":o=c.pop(),d=c.pop(),c.push(d+" "+o);break;case"PtgUnion":o=c.pop(),d=c.pop(),c.push(d+","+o);break;case"PtgRange":o=c.pop(),d=c.pop(),c.push(d+":"+o);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":x=sr(N[1][1],l,r),c.push(ar(x,i));break;case"PtgRefN":x=s?sr(N[1][1],s,r):N[1][1],c.push(ar(x,i));break;case"PtgRef3d":m=N[1][1],x=sr(N[1][2],l,r),g=Sc(n,m,r),c.push(g+"!"+ar(x,i));break;case"PtgFunc":case"PtgFuncVar":var w=N[1][0],D=N[1][1];w||(w=0),w&=127;var b=w==0?[]:c.slice(-w);c.length-=w,D==="User"&&(D=b.shift()),c.push(D+"("+b.join(",")+")");break;case"PtgBool":c.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(N[1]);break;case"PtgNum":c.push(String(N[1]));break;case"PtgStr":c.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(N[1]);break;case"PtgAreaN":f=nc(N[1][1],s?{s}:l,r),c.push(Pn(f,r));break;case"PtgArea":f=nc(N[1][1],l,r),c.push(Pn(f,r));break;case"PtgArea3d":m=N[1][1],f=N[1][2],g=Sc(n,m,r),c.push(g+"!"+Pn(f,r));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=N[1][2];var C=(n.names||[])[h-1]||(n[0]||[])[h],S=C?C.Name:"SH33TJSNAME"+String(h);S&&S.slice(0,6)=="_xlfn."&&!r.xlfn&&(S=S.slice(6)),c.push(S);break;case"PtgNameX":var k=N[1][1];h=N[1][2];var F;if(r.biff<=5)k<0&&(k=-k),n[k]&&(F=n[k][h]);else{var R="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][h]&&n[k][h].itab>0&&(R=n.SheetNames[n[k][h].itab-1]+"!"):R=n.SheetNames[h-1]+"!"),n[k]&&n[k][h])R+=n[k][h].Name;else if(n[0]&&n[0][h])R+=n[0][h].Name;else{var T=(jx(n,k,r)||"").split(";;");T[h-1]?R=T[h-1]:R+="SH33TJSERRX"}c.push(R);break}F||(F={Name:"SH33TJSERRY"}),c.push(F.Name);break;case"PtgParen":var M="(",X=")";if(p>=0){switch(u="",t[0][p][1][0]){case 2:M=pt(" ",t[0][p][1][1])+M;break;case 3:M=pt("\r",t[0][p][1][1])+M;break;case 4:X=pt(" ",t[0][p][1][1])+X;break;case 5:X=pt("\r",t[0][p][1][1])+X;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}p=-1}c.push(M+c.pop()+X);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":x={c:N[1][1],r:N[1][0]};var q={c:s.c,r:s.r};if(n.sharedf[Ie(x)]){var B=n.sharedf[Ie(x)];c.push(Bt(B,l,q,n,r))}else{var K=!1;for(o=0;o!=n.arrayf.length;++o)if(d=n.arrayf[o],!(x.c<d[0].s.c||x.c>d[0].e.c)&&!(x.r<d[0].s.r||x.r>d[0].e.r)){c.push(Bt(d[1],l,q,n,r)),K=!0;break}K||c.push(N[1])}break;case"PtgArray":c.push("{"+Xj(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=j;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var Q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(r.biff!=3&&p>=0&&Q.indexOf(t[0][j][0])==-1){N=t[0][p];var _=!0;switch(N[1][0]){case 4:_=!1;case 0:u=pt(" ",N[1][1]);break;case 5:_=!1;case 1:u=pt("\r",N[1][1]);break;default:if(u="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}c.push((_?u:"")+c.pop()+(_?"":u)),p=-1}}if(c.length>1&&r.WTF)throw new Error("bad formula stack");return c[0]}function Qj(t,a,s){var n=t.l+a,r=s.biff==2?1:2,i,l=t.read_shift(r);if(l==65535)return[[],Vt(t,a-2)];var c=_r(t,l,s);return a!==l+r&&(i=Dr(t,a-l-r,c,s)),t.l=n,[c,i]}function Zj(t,a,s){var n=t.l+a,r=s.biff==2?1:2,i,l=t.read_shift(r);if(l==65535)return[[],Vt(t,a-2)];var c=_r(t,l,s);return a!==l+r&&(i=Dr(t,a-l-r,c,s)),t.l=n,[c,i]}function ev(t,a,s,n){var r=t.l+a,i=_r(t,n,s),l;return r!==t.l&&(l=Dr(t,r-t.l,i,s)),[i,l]}function tv(t,a,s){var n=t.l+a,r,i=t.read_shift(2),l=_r(t,i,s);return i==65535?[[],Vt(t,a-2)]:(a!==i+2&&(r=Dr(t,n-i-2,l,s)),[l,r])}function sv(t){var a;if(Bs(t,t.l+6)!==65535)return[Ht(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return a=t[t.l+2]===1,t.l+=8,[a,"b"];case 2:return a=t[t.l+2],t.l+=8,[a,"e"];case 3:return t.l+=8,["","s"]}return[]}function On(t,a,s){var n=t.l+a,r=Ms(t);s.biff==2&&++t.l;var i=sv(t),l=t.read_shift(1);s.biff!=2&&(t.read_shift(1),s.biff>=5&&t.read_shift(4));var c=Zj(t,n-t.l,s);return{cell:r,val:i[0],formula:c,shared:l>>3&1,tt:i[1]}}function wn(t,a,s){var n=t.read_shift(4),r=_r(t,n,s),i=t.read_shift(4),l=i>0?Dr(t,i,r,s):null;return[r,l]}var av=wn,kn=wn,rv=wn,nv=wn,iv={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},vx={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},lv={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Cc(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(a,s){return s.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Mn(t){var a=t.split(":"),s=a[0].split(".")[0];return[s,a[0].split(".")[1]+(a.length>1?":"+(a[1].split(".")[1]||a[1].split(".")[0]):"")]}var lr={},Da={};function cr(t,a){if(t){var s=[.7,.7,.75,.75,.3,.3];a=="xlml"&&(s=[1,1,1,1,.5,.5]),t.left==null&&(t.left=s[0]),t.right==null&&(t.right=s[1]),t.top==null&&(t.top=s[2]),t.bottom==null&&(t.bottom=s[3]),t.header==null&&(t.header=s[4]),t.footer==null&&(t.footer=s[5])}}function Nx(t,a,s,n,r,i){try{n.cellNF&&(t.z=Me[a])}catch(c){if(n.WTF)throw c}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Dt(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Me[a]==null&&xa(lp[a]||"General",a),t.t==="e")t.w=t.w||wa[t.v];else if(a===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=mr(t.v);else if(t.t==="d"){var l=Qt(t.v);(l|0)===l?t.w=l.toString(10):t.w=mr(l)}else{if(t.v===void 0)return"";t.w=pa(t.v,Da)}else t.t==="d"?t.w=gs(a,Qt(t.v),Da):t.w=gs(a,t.v,Da)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&s!=null)try{t.s=i.Fills[s],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=cn(r.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=r.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=cn(r.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=r.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&i.Fills)throw c}}}function cv(t,a){var s=gt(a);s.s.r<=s.e.r&&s.s.c<=s.e.c&&s.s.r>=0&&s.s.c>=0&&(t["!ref"]=Ge(s))}var ov=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,dv=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,xv=/<(?:\w:)?hyperlink [^>]*>/mg,mv=/"(\w*:\w*)"/,hv=/<(?:\w:)?col\b[^>]*[\/]?>/g,uv=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,pv=/<(?:\w:)?pageMargins[^>]*\/>/g,wx=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,fv=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,gv=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function yv(t,a,s,n,r,i,l){if(!t)return t;n||(n={"!id":{}});var c=a.dense?[]:{},o={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",x="",m=t.match(dv);m?(d=t.slice(0,m.index),x=t.slice(m.index+m[0].length)):d=x=t;var h=d.match(wx);h?Yi(h[0],c,r,s):(h=d.match(fv))&&bv(h[0],h[1]||"",c,r,s);var f=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var g=d.slice(f,f+50).match(mv);g&&cv(c,g[1])}var p=d.match(gv);p&&p[1]&&Sv(p[1],r);var u=[];if(a.cellStyles){var j=d.match(hv);j&&Nv(u,j)}m&&Cv(m[1],c,a,o,i,l);var y=x.match(uv);y&&(c["!autofilter"]=wv(y[0]));var N=[],w=x.match(ov);if(w)for(f=0;f!=w.length;++f)N[f]=gt(w[f].slice(w[f].indexOf('"')+1));var D=x.match(xv);D&&jv(c,D,n);var b=x.match(pv);if(b&&(c["!margins"]=vv(Le(b[0]))),!c["!ref"]&&o.e.c>=o.s.c&&o.e.r>=o.s.r&&(c["!ref"]=Ge(o)),a.sheetRows>0&&c["!ref"]){var C=gt(c["!ref"]);a.sheetRows<=+C.e.r&&(C.e.r=a.sheetRows-1,C.e.r>o.e.r&&(C.e.r=o.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>o.e.c&&(C.e.c=o.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ge(C))}return u.length>0&&(c["!cols"]=u),N.length>0&&(c["!merges"]=N),c}function Yi(t,a,s,n){var r=Le(t);s.Sheets[n]||(s.Sheets[n]={}),r.codeName&&(s.Sheets[n].CodeName=Xe(nt(r.codeName)))}function bv(t,a,s,n,r){Yi(t.slice(0,t.indexOf(">")),s,n,r)}function jv(t,a,s){for(var n=Array.isArray(t),r=0;r!=a.length;++r){var i=Le(nt(a[r]),!0);if(!i.ref)return;var l=((s||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+Xe(i.location))):(i.Target="#"+Xe(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=gt(i.ref),o=c.s.r;o<=c.e.r;++o)for(var d=c.s.c;d<=c.e.c;++d){var x=Ie({c:d,r:o});n?(t[o]||(t[o]=[]),t[o][d]||(t[o][d]={t:"z",v:void 0}),t[o][d].l=i):(t[x]||(t[x]={t:"z",v:void 0}),t[x].l=i)}}}function vv(t){var a={};return["left","right","top","bottom","header","footer"].forEach(function(s){t[s]&&(a[s]=parseFloat(t[s]))}),a}function Nv(t,a){for(var s=!1,n=0;n!=a.length;++n){var r=Le(a[n],!0);r.hidden&&(r.hidden=lt(r.hidden));var i=parseInt(r.min,10)-1,l=parseInt(r.max,10)-1;for(r.outlineLevel&&(r.level=+r.outlineLevel||0),delete r.min,delete r.max,r.width=+r.width,!s&&r.width&&(s=!0,Vi(r.width)),Ma(r);i<=l;)t[i++]=It(r)}}function wv(t){var a={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return a}var kv=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Sv(t,a){a.Views||(a.Views=[{}]),(t.match(kv)||[]).forEach(function(s,n){var r=Le(s);a.Views[n]||(a.Views[n]={}),+r.zoomScale&&(a.Views[n].zoom=+r.zoomScale),lt(r.rightToLeft)&&(a.Views[n].RTL=!0)})}var Cv=function(){var t=/<(?:\w+:)?c[ \/>]/,a=/<\/(?:\w+:)?row>/,s=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,r=/ref=["']([^"']*)["']/,i=hr("v"),l=hr("f");return function(o,d,x,m,h,f){for(var g=0,p="",u=[],j=[],y=0,N=0,w=0,D="",b,C,S=0,k=0,F,R,T=0,M=0,X=Array.isArray(f.CellXf),q,B=[],K=[],Q=Array.isArray(d),_=[],ne={},ie=!1,A=!!x.sheetStubs,P=o.split(a),O=0,I=P.length;O!=I;++O){p=P[O].trim();var J=p.length;if(J!==0){var te=0;e:for(g=0;g<J;++g)switch(p[g]){case">":if(p[g-1]!="/"){++g;break e}if(x&&x.cellStyles){if(C=Le(p.slice(te,g),!0),S=C.r!=null?parseInt(C.r,10):S+1,k=-1,x.sheetRows&&x.sheetRows<S)continue;ne={},ie=!1,C.ht&&(ie=!0,ne.hpt=parseFloat(C.ht),ne.hpx=gr(ne.hpt)),C.hidden=="1"&&(ie=!0,ne.hidden=!0),C.outlineLevel!=null&&(ie=!0,ne.level=+C.outlineLevel),ie&&(_[S-1]=ne)}break;case"<":te=g;break}if(te>=g)break;if(C=Le(p.slice(te,g),!0),S=C.r!=null?parseInt(C.r,10):S+1,k=-1,!(x.sheetRows&&x.sheetRows<S)){m.s.r>S-1&&(m.s.r=S-1),m.e.r<S-1&&(m.e.r=S-1),x&&x.cellStyles&&(ne={},ie=!1,C.ht&&(ie=!0,ne.hpt=parseFloat(C.ht),ne.hpx=gr(ne.hpt)),C.hidden=="1"&&(ie=!0,ne.hidden=!0),C.outlineLevel!=null&&(ie=!0,ne.level=+C.outlineLevel),ie&&(_[S-1]=ne)),u=p.slice(g).split(t);for(var se=0;se!=u.length&&u[se].trim().charAt(0)=="<";++se);for(u=u.slice(se),g=0;g!=u.length;++g)if(p=u[g].trim(),p.length!==0){if(j=p.match(s),y=g,N=0,w=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,j!=null&&j.length===2){for(y=0,D=j[1],N=0;N!=D.length&&!((w=D.charCodeAt(N)-64)<1||w>26);++N)y=26*y+w;--y,k=y}else++k;for(N=0;N!=p.length&&p.charCodeAt(N)!==62;++N);if(++N,C=Le(p.slice(0,N),!0),C.r||(C.r=Ie({r:S-1,c:k})),D=p.slice(N),b={t:""},(j=D.match(i))!=null&&j[1]!==""&&(b.v=Xe(j[1])),x.cellFormula){if((j=D.match(l))!=null&&j[1]!==""){if(b.f=Xe(nt(j[1])).replace(/\r\n/g,`
`),x.xlfn||(b.f=Nc(b.f)),j[0].indexOf('t="array"')>-1)b.F=(D.match(r)||[])[1],b.F.indexOf(":")>-1&&B.push([gt(b.F),b.F]);else if(j[0].indexOf('t="shared"')>-1){R=Le(j[0]);var le=Xe(nt(j[1]));x.xlfn||(le=Nc(le)),K[parseInt(R.si,10)]=[R,le,C.r]}}else(j=D.match(/<f[^>]*\/>/))&&(R=Le(j[0]),K[R.si]&&(b.f=Ob(K[R.si][1],K[R.si][2],C.r)));var ue=Kt(C.r);for(N=0;N<B.length;++N)ue.r>=B[N][0].s.r&&ue.r<=B[N][0].e.r&&ue.c>=B[N][0].s.c&&ue.c<=B[N][0].e.c&&(b.F=B[N][1])}if(C.t==null&&b.v===void 0)if(b.f||b.F)b.v=0,b.t="n";else if(A)b.t="z";else continue;else b.t=C.t||"n";switch(m.s.c>k&&(m.s.c=k),m.e.c<k&&(m.e.c=k),b.t){case"n":if(b.v==""||b.v==null){if(!A)continue;b.t="z"}else b.v=parseFloat(b.v);break;case"s":if(typeof b.v>"u"){if(!A)continue;b.t="z"}else F=lr[parseInt(b.v,10)],b.v=F.t,b.r=F.r,x.cellHTML&&(b.h=F.h);break;case"str":b.t="s",b.v=b.v!=null?nt(b.v):"",x.cellHTML&&(b.h=Li(b.v));break;case"inlineStr":j=D.match(n),b.t="s",j!=null&&(F=Wi(j[1]))?(b.v=F.t,x.cellHTML&&(b.h=F.h)):b.v="";break;case"b":b.v=lt(b.v);break;case"d":x.cellDates?b.v=Dt(b.v,1):(b.v=Qt(Dt(b.v,1)),b.t="n");break;case"e":(!x||x.cellText!==!1)&&(b.w=b.v),b.v=qd[b.v];break}if(T=M=0,q=null,X&&C.s!==void 0&&(q=f.CellXf[C.s],q!=null&&(q.numFmtId!=null&&(T=q.numFmtId),x.cellStyles&&q.fillId!=null&&(M=q.fillId))),Nx(b,T,M,x,h,f),x.cellDates&&X&&b.t=="n"&&Ha(Me[T])&&(b.t="d",b.v=vn(b.v)),C.cm&&x.xlmeta){var be=(x.xlmeta.Cell||[])[+C.cm-1];be&&be.type=="XLDAPR"&&(b.D=!0)}if(Q){var H=Kt(C.r);d[H.r]||(d[H.r]=[]),d[H.r][H.c]=b}else d[C.r]=b}}}}_.length>0&&(d["!rows"]=_)}}();function Av(t,a){var s={},n=t.l+a;s.r=t.read_shift(4),t.l+=4;var r=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(s.level=i&7),i&16&&(s.hidden=!0),i&32&&(s.hpt=r/20),s}var Ev=Na;function Fv(){}function Tv(t,a){var s={},n=t[t.l];return++t.l,s.above=!(n&64),s.left=!(n&128),t.l+=18,s.name=Jp(t),s}function Dv(t){var a=ys(t);return[a]}function _v(t){var a=va(t);return[a]}function Rv(t){var a=ys(t),s=t.read_shift(1);return[a,s,"b"]}function Pv(t){var a=va(t),s=t.read_shift(1);return[a,s,"b"]}function Lv(t){var a=ys(t),s=t.read_shift(1);return[a,s,"e"]}function Iv(t){var a=va(t),s=t.read_shift(1);return[a,s,"e"]}function Ov(t){var a=ys(t),s=t.read_shift(4);return[a,s,"s"]}function Mv(t){var a=va(t),s=t.read_shift(4);return[a,s,"s"]}function $v(t){var a=ys(t),s=Ht(t);return[a,s,"n"]}function kx(t){var a=va(t),s=Ht(t);return[a,s,"n"]}function Bv(t){var a=ys(t),s=zi(t);return[a,s,"n"]}function Uv(t){var a=va(t),s=zi(t);return[a,s,"n"]}function zv(t){var a=ys(t),s=Bi(t);return[a,s,"is"]}function Hv(t){var a=ys(t),s=Wt(t);return[a,s,"str"]}function qv(t){var a=va(t),s=Wt(t);return[a,s,"str"]}function Wv(t,a,s){var n=t.l+a,r=ys(t);r.r=s["!row"];var i=t.read_shift(1),l=[r,i,"b"];if(s.cellFormula){t.l+=2;var c=kn(t,n-t.l,s);l[3]=Bt(c,null,r,s.supbooks,s)}else t.l=n;return l}function Vv(t,a,s){var n=t.l+a,r=ys(t);r.r=s["!row"];var i=t.read_shift(1),l=[r,i,"e"];if(s.cellFormula){t.l+=2;var c=kn(t,n-t.l,s);l[3]=Bt(c,null,r,s.supbooks,s)}else t.l=n;return l}function Gv(t,a,s){var n=t.l+a,r=ys(t);r.r=s["!row"];var i=Ht(t),l=[r,i,"n"];if(s.cellFormula){t.l+=2;var c=kn(t,n-t.l,s);l[3]=Bt(c,null,r,s.supbooks,s)}else t.l=n;return l}function Yv(t,a,s){var n=t.l+a,r=ys(t);r.r=s["!row"];var i=Wt(t),l=[r,i,"str"];if(s.cellFormula){t.l+=2;var c=kn(t,n-t.l,s);l[3]=Bt(c,null,r,s.supbooks,s)}else t.l=n;return l}var Xv=Na;function Kv(t,a){var s=t.l+a,n=Na(t),r=Ui(t),i=Wt(t),l=Wt(t),c=Wt(t);t.l=s;var o={rfx:n,relId:r,loc:i,display:c};return l&&(o.Tooltip=l),o}function Jv(){}function Qv(t,a,s){var n=t.l+a,r=Ud(t),i=t.read_shift(1),l=[r];if(l[2]=i,s.cellFormula){var c=av(t,n-t.l,s);l[1]=c}else t.l=n;return l}function Zv(t,a,s){var n=t.l+a,r=Na(t),i=[r];if(s.cellFormula){var l=nv(t,n-t.l,s);i[1]=l,t.l=n}else t.l=n;return i}var eN=["left","right","top","bottom","header","footer"];function tN(t){var a={};return eN.forEach(function(s){a[s]=Ht(t)}),a}function sN(t){var a=t.read_shift(2);return t.l+=28,{RTL:a&32}}function aN(){}function rN(){}function nN(t,a,s,n,r,i,l){if(!t)return t;var c=a||{};n||(n={"!id":{}});var o=c.dense?[]:{},d,x={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,h=!1,f,g,p,u,j,y,N,w,D,b=[];c.biff=12,c["!row"]=0;var C=0,S=!1,k=[],F={},R=c.supbooks||r.supbooks||[[]];if(R.sharedf=F,R.arrayf=k,R.SheetNames=r.SheetNames||r.Sheets.map(function(Q){return Q.name}),!c.supbooks&&(c.supbooks=R,r.Names))for(var T=0;T<r.Names.length;++T)R[0][T+1]=r.Names[T];var M=[],X=[],q=!1;xn[16]={n:"BrtShortReal",f:kx};var B;if(Vs(t,function(_,ne,ie){if(!h)switch(ie){case 148:d=_;break;case 0:f=_,c.sheetRows&&c.sheetRows<=f.r&&(h=!0),w=Ot(u=f.r),c["!row"]=f.r,(_.hidden||_.hpt||_.level!=null)&&(_.hpt&&(_.hpx=gr(_.hpt)),X[_.r]=_);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:_[2]},_[2]){case"n":g.v=_[1];break;case"s":N=lr[_[1]],g.v=N.t,g.r=N.r;break;case"b":g.v=!!_[1];break;case"e":g.v=_[1],c.cellText!==!1&&(g.w=wa[g.v]);break;case"str":g.t="s",g.v=_[1];break;case"is":g.t="s",g.v=_[1].t;break}if((p=l.CellXf[_[0].iStyleRef])&&Nx(g,p.numFmtId,null,c,i,l),j=_[0].c==-1?j+1:_[0].c,c.dense?(o[u]||(o[u]=[]),o[u][j]=g):o[At(j)+w]=g,c.cellFormula){for(S=!1,C=0;C<k.length;++C){var A=k[C];f.r>=A[0].s.r&&f.r<=A[0].e.r&&j>=A[0].s.c&&j<=A[0].e.c&&(g.F=Ge(A[0]),S=!0)}!S&&_.length>3&&(g.f=_[3])}if(x.s.r>f.r&&(x.s.r=f.r),x.s.c>j&&(x.s.c=j),x.e.r<f.r&&(x.e.r=f.r),x.e.c<j&&(x.e.c=j),c.cellDates&&p&&g.t=="n"&&Ha(Me[p.numFmtId])){var P=oa(g.v);P&&(g.t="d",g.v=new Date(P.y,P.m-1,P.d,P.H,P.M,P.S,P.u))}B&&(B.type=="XLDAPR"&&(g.D=!0),B=void 0);break;case 1:case 12:if(!c.sheetStubs||m)break;g={t:"z",v:void 0},j=_[0].c==-1?j+1:_[0].c,c.dense?(o[u]||(o[u]=[]),o[u][j]=g):o[At(j)+w]=g,x.s.r>f.r&&(x.s.r=f.r),x.s.c>j&&(x.s.c=j),x.e.r<f.r&&(x.e.r=f.r),x.e.c<j&&(x.e.c=j),B&&(B.type=="XLDAPR"&&(g.D=!0),B=void 0);break;case 176:b.push(_);break;case 49:B=((c.xlmeta||{}).Cell||[])[_-1];break;case 494:var O=n["!id"][_.relId];for(O?(_.Target=O.Target,_.loc&&(_.Target+="#"+_.loc),_.Rel=O):_.relId==""&&(_.Target="#"+_.loc),u=_.rfx.s.r;u<=_.rfx.e.r;++u)for(j=_.rfx.s.c;j<=_.rfx.e.c;++j)c.dense?(o[u]||(o[u]=[]),o[u][j]||(o[u][j]={t:"z",v:void 0}),o[u][j].l=_):(y=Ie({c:j,r:u}),o[y]||(o[y]={t:"z",v:void 0}),o[y].l=_);break;case 426:if(!c.cellFormula)break;k.push(_),D=c.dense?o[u][j]:o[At(j)+w],D.f=Bt(_[1],x,{r:f.r,c:j},R,c),D.F=Ge(_[0]);break;case 427:if(!c.cellFormula)break;F[Ie(_[0].s)]=_[1],D=c.dense?o[u][j]:o[At(j)+w],D.f=Bt(_[1],x,{r:f.r,c:j},R,c);break;case 60:if(!c.cellStyles)break;for(;_.e>=_.s;)M[_.e--]={width:_.w/256,hidden:!!(_.flags&1),level:_.level},q||(q=!0,Vi(_.w/256)),Ma(M[_.e+1]);break;case 161:o["!autofilter"]={ref:Ge(_)};break;case 476:o["!margins"]=_;break;case 147:r.Sheets[s]||(r.Sheets[s]={}),_.name&&(r.Sheets[s].CodeName=_.name),(_.above||_.left)&&(o["!outline"]={above:_.above,left:_.left});break;case 137:r.Views||(r.Views=[{}]),r.Views[0]||(r.Views[0]={}),_.RTL&&(r.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!ne.T){if(!m||c.WTF)throw new Error("Unexpected record 0x"+ie.toString(16))}}},c),delete c.supbooks,delete c["!row"],!o["!ref"]&&(x.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(o["!ref"]=Ge(d||x)),c.sheetRows&&o["!ref"]){var K=gt(o["!ref"]);c.sheetRows<=+K.e.r&&(K.e.r=c.sheetRows-1,K.e.r>x.e.r&&(K.e.r=x.e.r),K.e.r<K.s.r&&(K.s.r=K.e.r),K.e.c>x.e.c&&(K.e.c=x.e.c),K.e.c<K.s.c&&(K.s.c=K.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ge(K))}return b.length>0&&(o["!merges"]=b),M.length>0&&(o["!cols"]=M),X.length>0&&(o["!rows"]=X),o}function iN(t){var a=[],s=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(a[+l[1]]=s?+l[2]:l[2])});var r=Xe((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[a,r,n]}function lN(t,a,s,n,r,i){var l=i||{"!type":"chart"};if(!t)return i;var c=0,o=0,d="A",x={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var h=iN(m);x.s.r=x.s.c=0,x.e.c=c,d=At(c),h[0].forEach(function(f,g){l[d+Ot(g)]={t:"n",v:f,z:h[1]},o=g}),x.e.r<o&&(x.e.r=o),++c}),c>0&&(l["!ref"]=Ge(x)),l}function cN(t,a,s,n,r){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,c=t.match(wx);return c&&Yi(c[0],i,r,s),(l=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function oN(t,a){t.l+=10;var s=Wt(t);return{name:s}}function dN(t,a,s,n,r){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Vs(t,function(o,d,x){switch(x){case 550:i["!rel"]=o;break;case 651:r.Sheets[s]||(r.Sheets[s]={}),o.name&&(r.Sheets[s].CodeName=o.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||a.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}},a),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Sx=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],xN=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],mN=[],hN=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Ac(t,a){for(var s=0;s!=t.length;++s)for(var n=t[s],r=0;r!=a.length;++r){var i=a[r];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=lt(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function Ec(t,a){for(var s=0;s!=a.length;++s){var n=a[s];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=lt(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function Cx(t){Ec(t.WBProps,Sx),Ec(t.CalcPr,hN),Ac(t.WBView,xN),Ac(t.Sheets,mN),Da.date1904=lt(t.WBProps.date1904)}var uN="][*?/\\".split("");function pN(t,a){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var s=!0;return uN.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),s}var fN=/<\w+:workbook/;function gN(t,a){if(!t)throw new Error("Could not find file");var s={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,r="xmlns",i={},l=0;if(t.replace(Gt,function(o,d){var x=Le(o);switch(Os(x[0])){case"<?xml":break;case"<workbook":o.match(fN)&&(r="xmlns"+o.match(/<(\w+):/)[1]),s.xmlns=x[r];break;case"</workbook>":break;case"<fileVersion":delete x[0],s.AppVersion=x;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Sx.forEach(function(m){if(x[m[0]]!=null)switch(m[2]){case"bool":s.WBProps[m[0]]=lt(x[m[0]]);break;case"int":s.WBProps[m[0]]=parseInt(x[m[0]],10);break;default:s.WBProps[m[0]]=x[m[0]]}}),x.codeName&&(s.WBProps.CodeName=nt(x.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete x[0],s.WBView.push(x);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(x.state){case"hidden":x.Hidden=1;break;case"veryHidden":x.Hidden=2;break;default:x.Hidden=0}delete x.state,x.name=Xe(nt(x.name)),delete x[0],s.Sheets.push(x);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=nt(x.name),x.comment&&(i.Comment=x.comment),x.localSheetId&&(i.Sheet=+x.localSheetId),lt(x.hidden||"0")&&(i.Hidden=!0),l=d+o.length;break;case"</definedName>":i.Ref=Xe(nt(t.slice(l,d))),s.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete x[0],s.CalcPr=x;break;case"<calcPr/>":delete x[0],s.CalcPr=x;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&a.WTF)throw new Error("unrecognized "+x[0]+" in workbook")}return o}),Pp.indexOf(s.xmlns)===-1)throw new Error("Unknown Namespace: "+s.xmlns);return Cx(s),s}function yN(t,a){var s={};return s.Hidden=t.read_shift(4),s.iTabID=t.read_shift(4),s.strRelID=ai(t),s.name=Wt(t),s}function bN(t,a){var s={},n=t.read_shift(4);s.defaultThemeVersion=t.read_shift(4);var r=a>8?Wt(t):"";return r.length>0&&(s.CodeName=r),s.autoCompressPictures=!!(n&65536),s.backupFile=!!(n&64),s.checkCompatibility=!!(n&4096),s.date1904=!!(n&1),s.filterPrivacy=!!(n&8),s.hidePivotFieldList=!!(n&1024),s.promptedSolutions=!!(n&16),s.publishItems=!!(n&2048),s.refreshAllConnections=!!(n&262144),s.saveExternalLinkValues=!!(n&128),s.showBorderUnselectedTables=!!(n&4),s.showInkAnnotation=!!(n&32),s.showObjects=["all","placeholders","none"][n>>13&3],s.showPivotChartFilter=!!(n&32768),s.updateLinks=["userSet","never","always"][n>>8&3],s}function jN(t,a){var s={};return t.read_shift(4),s.ArchID=t.read_shift(4),t.l+=a-8,s}function vN(t,a,s){var n=t.l+a;t.l+=4,t.l+=1;var r=t.read_shift(4),i=Qp(t),l=rv(t,0,s),c=Ui(t);t.l=n;var o={Name:i,Ptg:l};return r<268435455&&(o.Sheet=r),c&&(o.Comment=c),o}function NN(t,a){var s={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],r=!1;a||(a={}),a.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],xn[16]={n:"BrtFRTArchID$",f:jN},Vs(t,function(o,d,x){switch(x){case 156:l.SheetNames.push(o.name),s.Sheets.push(o);break;case 153:s.WBProps=o;break;case 39:o.Sheet!=null&&(a.SID=o.Sheet),o.Ref=Bt(o.Ptg,null,null,l,a),delete a.SID,delete o.Ptg,i.push(o);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([x,o]):l[0]=[x,o],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(o),l.XTI=l.XTI.concat(o);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(x),r=!0;break;case 36:n.pop(),r=!1;break;case 37:n.push(x),r=!0;break;case 38:n.pop(),r=!1;break;case 16:break;default:if(!d.T){if(!r||a.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}},a),Cx(s),s.Names=i,s.supbooks=l,s}function wN(t,a,s){return a.slice(-4)===".bin"?NN(t,s):gN(t,s)}function kN(t,a,s,n,r,i,l,c){return a.slice(-4)===".bin"?nN(t,n,s,r,i,l,c):yv(t,n,s,r,i,l,c)}function SN(t,a,s,n,r,i,l,c){return a.slice(-4)===".bin"?dN(t,n,s,r,i):cN(t,n,s,r,i)}function CN(t,a,s,n,r,i,l,c){return a.slice(-4)===".bin"?Pb():Lb()}function AN(t,a,s,n,r,i,l,c){return a.slice(-4)===".bin"?_b():Rb()}function EN(t,a,s,n){return a.slice(-4)===".bin"?Xy(t,s,n):Hy(t,s,n)}function FN(t,a,s){return mx(t,s)}function TN(t,a,s){return a.slice(-4)===".bin"?xy(t,s):oy(t,s)}function DN(t,a,s){return a.slice(-4)===".bin"?Fb(t,s):kb(t,s)}function _N(t,a,s){return a.slice(-4)===".bin"?vb(t):bb(t)}function RN(t,a,s,n){return s.slice(-4)===".bin"?Nb(t,a,s,n):void 0}function PN(t,a,s){return a.slice(-4)===".bin"?gb(t,a,s):yb(t,a,s)}var Ax=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Ex=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function bs(t,a){var s=t.split(/\s+/),n=[];if(n[0]=s[0],s.length===1)return n;var r=t.match(Ax),i,l,c,o;if(r)for(o=0;o!=r.length;++o)i=r[o].match(Ex),(l=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(l+1),n[c]=i[2].slice(1,i[2].length-1));return n}function LN(t){var a=t.split(/\s+/),s={};if(a.length===1)return s;var n=t.match(Ax),r,i,l,c;if(n)for(c=0;c!=n.length;++c)r=n[c].match(Ex),(i=r[1].indexOf(":"))===-1?s[r[1]]=r[2].slice(1,r[2].length-1):(r[1].slice(0,6)==="xmlns:"?l="xmlns"+r[1].slice(6):l=r[1].slice(i+1),s[l]=r[2].slice(1,r[2].length-1));return s}var or;function IN(t,a){var s=or[t]||Xe(t);return s==="General"?pa(a):gs(s,a)}function ON(t,a,s,n){var r=n;switch((s[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":r=lt(n);break;case"i2":case"int":r=parseInt(n,10);break;case"r4":case"float":r=parseFloat(n);break;case"date":case"dateTime.tz":r=Dt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+s[0])}t[Xe(a)]=r}function MN(t,a,s){if(t.t!=="z"){if(!s||s.cellText!==!1)try{t.t==="e"?t.w=t.w||wa[t.v]:a==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=mr(t.v):t.w=pa(t.v):t.w=IN(a||"General",t.v)}catch(i){if(s.WTF)throw i}try{var n=or[a]||a||"General";if(s.cellNF&&(t.z=n),s.cellDates&&t.t=="n"&&Ha(n)){var r=oa(t.v);r&&(t.t="d",t.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u))}}catch(i){if(s.WTF)throw i}}}function $N(t,a,s){if(s.cellStyles&&a.Interior){var n=a.Interior;n.Pattern&&(n.patternType=Oy[n.Pattern]||n.Pattern)}t[a.ID]=a}function BN(t,a,s,n,r,i,l,c,o,d){var x="General",m=n.StyleID,h={};d=d||{};var f=[],g=0;for(m===void 0&&c&&(m=c.StyleID),m===void 0&&l&&(m=l.StyleID);i[m]!==void 0&&(i[m].nf&&(x=i[m].nf),i[m].Interior&&f.push(i[m].Interior),!!i[m].Parent);)m=i[m].Parent;switch(s.Type){case"Boolean":n.t="b",n.v=lt(t);break;case"String":n.t="s",n.r=Kl(Xe(t)),n.v=t.indexOf("<")>-1?Xe(a||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Dt(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Xe(t):n.v<60&&(n.v=n.v-1),(!x||x=="General")&&(x="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=qd[t],d.cellText!==!1&&(n.w=t);break;default:t==""&&a==""?n.t="z":(n.t="s",n.v=Kl(a||t));break}if(MN(n,x,d),d.cellFormula!==!1)if(n.Formula){var p=Xe(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=Ta(p,r),delete n.Formula,n.ArrayRange=="RC"?n.F=Ta("RC:RC",r):n.ArrayRange&&(n.F=Ta(n.ArrayRange,r),o.push([gt(n.F),n.F]))}else for(g=0;g<o.length;++g)r.r>=o[g][0].s.r&&r.r<=o[g][0].e.r&&r.c>=o[g][0].s.c&&r.c<=o[g][0].e.c&&(n.F=o[g][1]);d.cellStyles&&(f.forEach(function(u){!h.patternType&&u.patternType&&(h.patternType=u.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function UN(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function $n(t,a){var s=a||{};fd();var n=Ja(Ii(t));(s.type=="binary"||s.type=="array"||s.type=="base64")&&(n=nt(n));var r=n.slice(0,1024).toLowerCase(),i=!1;if(r=r.replace(/".*?"/g,""),(r.indexOf(">")&1023)>Math.min(r.indexOf(",")&1023,r.indexOf(";")&1023)){var l=It(s);return l.type="string",pr.to_workbook(n,l)}if(r.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(xe){r.indexOf("<"+xe)>=0&&(i=!0)}),i)return KN(n,s);or={"General Number":"General","General Date":Me[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Me[15],"Short Date":Me[14],"Long Time":Me[19],"Medium Time":Me[18],"Short Time":Me[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Me[2],Standard:Me[4],Percent:Me[10],Scientific:Me[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,o=[],d,x={},m=[],h=s.dense?[]:{},f="",g={},p={},u=bs('<Data ss:Type="String">'),j=0,y=0,N=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},D={},b={},C="",S=0,k=[],F={},R={},T=0,M=[],X=[],q={},B=[],K,Q=!1,_=[],ne=[],ie={},A=0,P=0,O={Sheets:[],WBProps:{date1904:!1}},I={};ur.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";c=ur.exec(n);)switch(c[3]=(J=c[3]).toLowerCase()){case"data":if(J=="data"){if(c[1]==="/"){if((d=o.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&o.push([c[3],!0]);break}if(o[o.length-1][1])break;c[1]==="/"?BN(n.slice(j,c.index),C,u,o[o.length-1][0]=="comment"?q:g,{c:y,r:N},D,B[y],p,_,s):(C="",u=bs(c[0]),j=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(X.length>0&&(g.c=X),(!s.sheetRows||s.sheetRows>N)&&g.v!==void 0&&(s.dense?(h[N]||(h[N]=[]),h[N][y]=g):h[At(y)+Ot(N)]=g),g.HRef&&(g.l={Target:Xe(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(A=y+(parseInt(g.MergeAcross,10)|0),P=N+(parseInt(g.MergeDown,10)|0),k.push({s:{c:y,r:N},e:{c:A,r:P}})),!s.sheetStubs)g.MergeAcross?y=A+1:++y;else if(g.MergeAcross||g.MergeDown){for(var te=y;te<=A;++te)for(var se=N;se<=P;++se)(te>y||se>N)&&(s.dense?(h[se]||(h[se]=[]),h[se][te]={t:"z"}):h[At(te)+Ot(se)]={t:"z"});y=A+1}else++y;else g=LN(c[0]),g.Index&&(y=+g.Index-1),y<w.s.c&&(w.s.c=y),y>w.e.c&&(w.e.c=y),c[0].slice(-2)==="/>"&&++y,X=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(N<w.s.r&&(w.s.r=N),N>w.e.r&&(w.e.r=N),c[0].slice(-2)==="/>"&&(p=bs(c[0]),p.Index&&(N=+p.Index-1)),y=0,++N):(p=bs(c[0]),p.Index&&(N=+p.Index-1),ie={},(p.AutoFitHeight=="0"||p.Height)&&(ie.hpx=parseInt(p.Height,10),ie.hpt=xx(ie.hpx),ne[N]=ie),p.Hidden=="1"&&(ie.hidden=!0,ne[N]=ie));break;case"worksheet":if(c[1]==="/"){if((d=o.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));m.push(f),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(h["!ref"]=Ge(w),s.sheetRows&&s.sheetRows<=w.e.r&&(h["!fullref"]=h["!ref"],w.e.r=s.sheetRows-1,h["!ref"]=Ge(w))),k.length&&(h["!merges"]=k),B.length>0&&(h["!cols"]=B),ne.length>0&&(h["!rows"]=ne),x[f]=h}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},N=y=0,o.push([c[3],!1]),d=bs(c[0]),f=Xe(d.Name),h=s.dense?[]:{},k=[],_=[],ne=[],I={name:f,Hidden:0},O.Sheets.push(I);break;case"table":if(c[1]==="/"){if((d=o.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else{if(c[0].slice(-2)=="/>")break;o.push([c[3],!1]),B=[],Q=!1}break;case"style":c[1]==="/"?$N(D,b,s):b=bs(c[0]);break;case"numberformat":b.nf=Xe(bs(c[0]).Format||"General"),or[b.nf]&&(b.nf=or[b.nf]);for(var le=0;le!=392&&Me[le]!=b.nf;++le);if(le==392){for(le=57;le!=392;++le)if(Me[le]==null){xa(b.nf,le);break}}break;case"column":if(o[o.length-1][0]!=="table")break;if(K=bs(c[0]),K.Hidden&&(K.hidden=!0,delete K.Hidden),K.Width&&(K.wpx=parseInt(K.Width,10)),!Q&&K.wpx>10){Q=!0,Xt=ox;for(var ue=0;ue<B.length;++ue)B[ue]&&Ma(B[ue])}Q&&Ma(K),B[K.Index-1||B.length]=K;for(var be=0;be<+K.Span;++be)B[B.length]=It(K);break;case"namedrange":if(c[1]==="/")break;O.Names||(O.Names=[]);var H=Le(c[0]),De={Name:H.Name,Ref:Ta(H.RefersTo.slice(1),{r:0,c:0})};O.Sheets.length>0&&(De.Sheet=O.Sheets.length-1),O.Names.push(De);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?C+=n.slice(S,c.index):S=c.index+c[0].length;break;case"interior":if(!s.cellStyles)break;b.Interior=bs(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?kf(F,J,n.slice(T,c.index)):T=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((d=o.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else o.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((d=o.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));UN(q),X.push(q)}else o.push([c[3],!1]),d=bs(c[0]),q={a:d.Author};break;case"autofilter":if(c[1]==="/"){if((d=o.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var re=bs(c[0]);h["!autofilter"]={ref:Ta(re.Range).replace(/\$/g,"")},o.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((d=o.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&o.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((d=o.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&o.push([c[3],!0]);break;case"null":break;default:if(o.length==0&&c[3]=="document"||o.length==0&&c[3]=="uof")return Pc(n,s);var Z=!0;switch(o[o.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Z=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Z=!1}break;case"excelworkbook":switch(c[3]){case"date1904":O.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Z=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Z=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(T,c.index)){case"SheetHidden":I.Hidden=1;break;case"SheetVeryHidden":I.Hidden=2;break}else T=c.index+c[0].length;break;case"header":h["!margins"]||cr(h["!margins"]={},"xlml"),isNaN(+Le(c[0]).Margin)||(h["!margins"].header=+Le(c[0]).Margin);break;case"footer":h["!margins"]||cr(h["!margins"]={},"xlml"),isNaN(+Le(c[0]).Margin)||(h["!margins"].footer=+Le(c[0]).Margin);break;case"pagemargins":var ee=Le(c[0]);h["!margins"]||cr(h["!margins"]={},"xlml"),isNaN(+ee.Top)||(h["!margins"].top=+ee.Top),isNaN(+ee.Left)||(h["!margins"].left=+ee.Left),isNaN(+ee.Right)||(h["!margins"].right=+ee.Right),isNaN(+ee.Bottom)||(h["!margins"].bottom=+ee.Bottom);break;case"displayrighttoleft":O.Views||(O.Views=[]),O.Views[0]||(O.Views[0]={}),O.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Z=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Z=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Z=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Z=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Z=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Z=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Z=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Z=!1}break;case"smarttags":break;default:Z=!1;break}if(Z||c[3].match(/!\[CDATA/))break;if(!o[o.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+o.join("|");if(o[o.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?ON(R,J,M,n.slice(T,c.index)):(M=c,T=c.index+c[0].length);break}if(s.WTF)throw"Unrecognized tag: "+c[3]+"|"+o.join("|")}var ae={};return!s.bookSheets&&!s.bookProps&&(ae.Sheets=x),ae.SheetNames=m,ae.Workbook=O,ae.SSF=It(Me),ae.Props=F,ae.Custprops=R,ae}function li(t,a){switch(Ji(a=a||{}),a.type||"base64"){case"base64":return $n(os(t),a);case"binary":case"buffer":case"file":return $n(t,a);case"array":return $n(ja(t),a)}}function zN(t){var a={},s=t.content;if(s.l=28,a.AnsiUserType=s.read_shift(0,"lpstr-ansi"),a.AnsiClipboardFormat=tf(s),s.length-s.l<=4)return a;var n=s.read_shift(4);if(n==0||n>40||(s.l-=4,a.Reserved1=s.read_shift(0,"lpstr-ansi"),s.length-s.l<=4)||(n=s.read_shift(4),n!==1907505652)||(a.UnicodeClipboardFormat=sf(s),n=s.read_shift(4),n==0||n>40))return a;s.l-=4,a.Reserved2=s.read_shift(0,"lpwstr")}var HN=[60,1084,2066,2165,2175];function qN(t,a,s,n,r){var i=n,l=[],c=s.slice(s.l,s.l+i);if(r&&r.enc&&r.enc.insitu&&c.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:r.enc.insitu(c)}l.push(c),s.l+=i;for(var o=Bs(s,s.l),d=ci[o],x=0;d!=null&&HN.indexOf(o)>-1;)i=Bs(s,s.l+2),x=s.l+4,o==2066?x+=4:(o==2165||o==2175)&&(x+=12),c=s.slice(x,s.l+4+i),l.push(c),s.l+=4+i,d=ci[o=Bs(s,s.l)];var m=Xs(l);Pt(m,0);var h=0;m.lens=[];for(var f=0;f<l.length;++f)m.lens.push(h),h+=l[f].length;if(m.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+m.length+" < "+n;return a.f(m,m.length,r)}function Fs(t,a,s){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,a.cellNF&&(t.z=Me[n])}catch(i){if(a.WTF)throw i}if(!a||a.cellText!==!1)try{t.t==="e"?t.w=t.w||wa[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=mr(t.v):t.w=pa(t.v):t.w=gs(n,t.v,{date1904:!!s,dateNF:a&&a.dateNF})}catch(i){if(a.WTF)throw i}if(a.cellDates&&n&&t.t=="n"&&Ha(Me[n]||String(n))){var r=oa(t.v);r&&(t.t="d",t.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u))}}}function Wr(t,a,s){return{v:t,ixfe:a,t:s}}function WN(t,a){var s={opts:{}},n={},r=a.dense?[]:{},i={},l={},c=null,o=[],d="",x={},m,h="",f,g,p,u,j={},y=[],N,w,D=[],b=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},k=function(Be){return Be<8?ma[Be]:Be<64&&b[Be-8]||ma[Be]},F=function(Be,et,xt){var it=et.XF.data;if(!(!it||!it.patternType||!xt||!xt.cellStyles)){et.s={},et.s.patternType=it.patternType;var As;(As=fr(k(it.icvFore)))&&(et.s.fgColor={rgb:As}),(As=fr(k(it.icvBack)))&&(et.s.bgColor={rgb:As})}},R=function(Be,et,xt){if(!(ie>1)&&!(xt.sheetRows&&Be.r>=xt.sheetRows)){if(xt.cellStyles&&et.XF&&et.XF.data&&F(Be,et,xt),delete et.ixfe,delete et.XF,m=Be,h=Ie(Be),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),Be.r<l.s.r&&(l.s.r=Be.r),Be.c<l.s.c&&(l.s.c=Be.c),Be.r+1>l.e.r&&(l.e.r=Be.r+1),Be.c+1>l.e.c&&(l.e.c=Be.c+1),xt.cellFormula&&et.f){for(var it=0;it<y.length;++it)if(!(y[it][0].s.c>Be.c||y[it][0].s.r>Be.r)&&!(y[it][0].e.c<Be.c||y[it][0].e.r<Be.r)){et.F=Ge(y[it][0]),(y[it][0].s.c!=Be.c||y[it][0].s.r!=Be.r)&&delete et.f,et.f&&(et.f=""+Bt(y[it][1],l,Be,_,T));break}}xt.dense?(r[Be.r]||(r[Be.r]=[]),r[Be.r][Be.c]=et):r[h]=et}},T={enc:!1,sbcch:0,snames:[],sharedf:j,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!a&&!!a.cellStyles,WTF:!!a&&!!a.wtf};a.password&&(T.password=a.password);var M,X=[],q=[],B=[],K=[],Q=!1,_=[];_.SheetNames=T.snames,_.sharedf=T.sharedf,_.arrayf=T.arrayf,_.names=[],_.XTI=[];var ne=0,ie=0,A=0,P=[],O=[],I;T.codepage=1200,Ns(1200);for(var J=!1;t.l<t.length-1;){var te=t.l,se=t.read_shift(2);if(se===0&&ne===10)break;var le=t.l===t.length?0:t.read_shift(2),ue=ci[se];if(ue&&ue.f){if(a.bookSheets&&ne===133&&se!==133)break;if(ne=se,ue.r===2||ue.r==12){var be=t.read_shift(2);if(le-=2,!T.enc&&be!==se&&((be&255)<<8|be>>8)!==se)throw new Error("rt mismatch: "+be+"!="+se);ue.r==12&&(t.l+=10,le-=10)}var H={};if(se===10?H=ue.f(t,le,T):H=qN(se,ue,t,le,T),ie==0&&[9,521,1033,2057].indexOf(ne)===-1)continue;switch(se){case 34:s.opts.Date1904=C.WBProps.date1904=H;break;case 134:s.opts.WriteProtect=!0;break;case 47:if(T.enc||(t.l=0),T.enc=H,!a.password)throw new Error("File is password-protected");if(H.valid==null)throw new Error("Encryption scheme unsupported");if(!H.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=H;break;case 66:var De=Number(H);switch(De){case 21010:De=1200;break;case 32768:De=1e4;break;case 32769:De=1252;break}Ns(T.codepage=De),J=!0;break;case 317:T.rrtabid=H;break;case 25:T.winlocked=H;break;case 439:s.opts.RefreshAll=H;break;case 12:s.opts.CalcCount=H;break;case 16:s.opts.CalcDelta=H;break;case 17:s.opts.CalcIter=H;break;case 13:s.opts.CalcMode=H;break;case 14:s.opts.CalcPrecision=H;break;case 95:s.opts.CalcSaveRecalc=H;break;case 15:T.CalcRefMode=H;break;case 2211:s.opts.FullCalc=H;break;case 129:H.fDialog&&(r["!type"]="dialog"),H.fBelow||((r["!outline"]||(r["!outline"]={})).above=!0),H.fRight||((r["!outline"]||(r["!outline"]={})).left=!0);break;case 224:D.push(H);break;case 430:_.push([H]),_[_.length-1].XTI=[];break;case 35:case 547:_[_.length-1].push(H);break;case 24:case 536:I={Name:H.Name,Ref:Bt(H.rgce,l,null,_,T)},H.itab>0&&(I.Sheet=H.itab-1),_.names.push(I),_[0]||(_[0]=[],_[0].XTI=[]),_[_.length-1].push(H),H.Name=="_xlnm._FilterDatabase"&&H.itab>0&&H.rgce&&H.rgce[0]&&H.rgce[0][0]&&H.rgce[0][0][0]=="PtgArea3d"&&(O[H.itab-1]={ref:Ge(H.rgce[0][0][1][2])});break;case 22:T.ExternCount=H;break;case 23:_.length==0&&(_[0]=[],_[0].XTI=[]),_[_.length-1].XTI=_[_.length-1].XTI.concat(H),_.XTI=_.XTI.concat(H);break;case 2196:if(T.biff<8)break;I!=null&&(I.Comment=H[1]);break;case 18:r["!protect"]=H;break;case 19:H!==0&&T.WTF&&console.error("Password verifier: "+H);break;case 133:i[H.pos]=H,T.snames.push(H.name);break;case 10:{if(--ie)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,r["!ref"]=Ge(l),a.sheetRows&&a.sheetRows<=l.e.r){var re=l.e.r;l.e.r=a.sheetRows-1,r["!fullref"]=r["!ref"],r["!ref"]=Ge(l),l.e.r=re}l.e.r++,l.e.c++}X.length>0&&(r["!merges"]=X),q.length>0&&(r["!objects"]=q),B.length>0&&(r["!cols"]=B),K.length>0&&(r["!rows"]=K),C.Sheets.push(S)}d===""?x=r:n[d]=r,r=a.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[se]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[H.BIFFVer]||8),T.biffguess=H.BIFFVer==0,H.BIFFVer==0&&H.dt==4096&&(T.biff=5,J=!0,Ns(T.codepage=28591)),T.biff==8&&H.BIFFVer==0&&H.dt==16&&(T.biff=2),ie++)break;if(r=a.dense?[]:{},T.biff<8&&!J&&(J=!0,Ns(T.codepage=a.codepage||1252)),T.biff<5||H.BIFFVer==0&&H.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Z={pos:t.l-le,name:d};i[Z.pos]=Z,T.snames.push(d)}else d=(i[te]||{name:""}).name;H.dt==32&&(r["!type"]="chart"),H.dt==64&&(r["!type"]="macro"),X=[],q=[],T.arrayf=y=[],B=[],K=[],Q=!1,S={Hidden:(i[te]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:r["!type"]=="chart"&&(a.dense?(r[H.r]||[])[H.c]:r[Ie({c:H.c,r:H.r})])&&++H.c,N={ixfe:H.ixfe,XF:D[H.ixfe]||{},v:H.val,t:"n"},A>0&&(N.z=P[N.ixfe>>8&63]),Fs(N,a,s.opts.Date1904),R({c:H.c,r:H.r},N,a);break;case 5:case 517:N={ixfe:H.ixfe,XF:D[H.ixfe],v:H.val,t:H.t},A>0&&(N.z=P[N.ixfe>>8&63]),Fs(N,a,s.opts.Date1904),R({c:H.c,r:H.r},N,a);break;case 638:N={ixfe:H.ixfe,XF:D[H.ixfe],v:H.rknum,t:"n"},A>0&&(N.z=P[N.ixfe>>8&63]),Fs(N,a,s.opts.Date1904),R({c:H.c,r:H.r},N,a);break;case 189:for(var ee=H.c;ee<=H.C;++ee){var ae=H.rkrec[ee-H.c][0];N={ixfe:ae,XF:D[ae],v:H.rkrec[ee-H.c][1],t:"n"},A>0&&(N.z=P[N.ixfe>>8&63]),Fs(N,a,s.opts.Date1904),R({c:ee,r:H.r},N,a)}break;case 6:case 518:case 1030:{if(H.val=="String"){c=H;break}if(N=Wr(H.val,H.cell.ixfe,H.tt),N.XF=D[N.ixfe],a.cellFormula){var xe=H.formula;if(xe&&xe[0]&&xe[0][0]&&xe[0][0][0]=="PtgExp"){var fe=xe[0][0][1][0],ve=xe[0][0][1][1],Ae=Ie({r:fe,c:ve});j[Ae]?N.f=""+Bt(H.formula,l,H.cell,_,T):N.F=((a.dense?(r[fe]||[])[ve]:r[Ae])||{}).F}else N.f=""+Bt(H.formula,l,H.cell,_,T)}A>0&&(N.z=P[N.ixfe>>8&63]),Fs(N,a,s.opts.Date1904),R(H.cell,N,a),c=H}break;case 7:case 519:if(c)c.val=H,N=Wr(H,c.cell.ixfe,"s"),N.XF=D[N.ixfe],a.cellFormula&&(N.f=""+Bt(c.formula,l,c.cell,_,T)),A>0&&(N.z=P[N.ixfe>>8&63]),Fs(N,a,s.opts.Date1904),R(c.cell,N,a),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(H);var ye=Ie(H[0].s);if(f=a.dense?(r[H[0].s.r]||[])[H[0].s.c]:r[ye],a.cellFormula&&f){if(!c||!ye||!f)break;f.f=""+Bt(H[1],l,H[0],_,T),f.F=Ge(H[0])}}break;case 1212:{if(!a.cellFormula)break;if(h){if(!c)break;j[Ie(c.cell)]=H[0],f=a.dense?(r[c.cell.r]||[])[c.cell.c]:r[Ie(c.cell)],(f||{}).f=""+Bt(H[0],l,m,_,T)}}break;case 253:N=Wr(o[H.isst].t,H.ixfe,"s"),o[H.isst].h&&(N.h=o[H.isst].h),N.XF=D[N.ixfe],A>0&&(N.z=P[N.ixfe>>8&63]),Fs(N,a,s.opts.Date1904),R({c:H.c,r:H.r},N,a);break;case 513:a.sheetStubs&&(N={ixfe:H.ixfe,XF:D[H.ixfe],t:"z"},A>0&&(N.z=P[N.ixfe>>8&63]),Fs(N,a,s.opts.Date1904),R({c:H.c,r:H.r},N,a));break;case 190:if(a.sheetStubs)for(var He=H.c;He<=H.C;++He){var _e=H.ixfe[He-H.c];N={ixfe:_e,XF:D[_e],t:"z"},A>0&&(N.z=P[N.ixfe>>8&63]),Fs(N,a,s.opts.Date1904),R({c:He,r:H.r},N,a)}break;case 214:case 516:case 4:N=Wr(H.val,H.ixfe,"s"),N.XF=D[N.ixfe],A>0&&(N.z=P[N.ixfe>>8&63]),Fs(N,a,s.opts.Date1904),R({c:H.c,r:H.r},N,a);break;case 0:case 512:ie===1&&(l=H);break;case 252:o=H;break;case 1054:if(T.biff==4){P[A++]=H[1];for(var Qe=0;Qe<A+163&&Me[Qe]!=H[1];++Qe);Qe>=163&&xa(H[1],A+163)}else xa(H[1],H[0]);break;case 30:{P[A++]=H;for(var Je=0;Je<A+163&&Me[Je]!=H;++Je);Je>=163&&xa(H,A+163)}break;case 229:X=X.concat(H);break;case 93:q[H.cmo[0]]=T.lastobj=H;break;case 438:T.lastobj.TxO=H;break;case 127:T.lastobj.ImData=H;break;case 440:for(u=H[0].s.r;u<=H[0].e.r;++u)for(p=H[0].s.c;p<=H[0].e.c;++p)f=a.dense?(r[u]||[])[p]:r[Ie({c:p,r:u})],f&&(f.l=H[1]);break;case 2048:for(u=H[0].s.r;u<=H[0].e.r;++u)for(p=H[0].s.c;p<=H[0].e.c;++p)f=a.dense?(r[u]||[])[p]:r[Ie({c:p,r:u})],f&&f.l&&(f.l.Tooltip=H[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;f=a.dense?(r[H[0].r]||[])[H[0].c]:r[Ie(H[0])];var dt=q[H[2]];f||(a.dense?(r[H[0].r]||(r[H[0].r]=[]),f=r[H[0].r][H[0].c]={t:"z"}):f=r[Ie(H[0])]={t:"z"},l.e.r=Math.max(l.e.r,H[0].r),l.s.r=Math.min(l.s.r,H[0].r),l.e.c=Math.max(l.e.c,H[0].c),l.s.c=Math.min(l.s.c,H[0].c)),f.c||(f.c=[]),g={a:H[1],t:dt.TxO.t},f.c.push(g)}break;case 2173:hb(D[H.ixfe],H.ext);break;case 125:{if(!T.cellStyles)break;for(;H.e>=H.s;)B[H.e--]={width:H.w/256,level:H.level||0,hidden:!!(H.flags&1)},Q||(Q=!0,Vi(H.w/256)),Ma(B[H.e+1])}break;case 520:{var qe={};H.level!=null&&(K[H.r]=qe,qe.level=H.level),H.hidden&&(K[H.r]=qe,qe.hidden=!0),H.hpt&&(K[H.r]=qe,qe.hpt=H.hpt,qe.hpx=gr(H.hpt))}break;case 38:case 39:case 40:case 41:r["!margins"]||cr(r["!margins"]={}),r["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[se]]=H;break;case 161:r["!margins"]||cr(r["!margins"]={}),r["!margins"].header=H.header,r["!margins"].footer=H.footer;break;case 574:H.RTL&&(C.Views[0].RTL=!0);break;case 146:b=H;break;case 2198:M=H;break;case 140:w=H;break;case 442:d?S.CodeName=H||S.name:C.WBProps.CodeName=H||"ThisWorkbook";break}}else ue||console.error("Missing Info for XLS Record 0x"+se.toString(16)),t.l+=le}return s.SheetNames=Ls(i).sort(function(Ye,Be){return Number(Ye)-Number(Be)}).map(function(Ye){return i[Ye].name}),a.bookSheets||(s.Sheets=n),!s.SheetNames.length&&x["!ref"]?(s.SheetNames.push("Sheet1"),s.Sheets&&(s.Sheets.Sheet1=x)):s.Preamble=x,s.Sheets&&O.forEach(function(Ye,Be){s.Sheets[s.SheetNames[Be]]["!autofilter"]=Ye}),s.Strings=o,s.SSF=It(Me),T.enc&&(s.Encryption=T.enc),M&&(s.Themes=M),s.Metadata={},w!==void 0&&(s.Metadata.Country=w),_.names.length>0&&(C.Names=_.names),s.Workbook=C,s}var Fc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function VN(t,a,s){var n=Ve.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var r=mc(n,of,Fc.DSI);for(var i in r)a[i]=r[i]}catch(d){if(s.WTF)throw d}var l=Ve.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var c=mc(l,df,Fc.SI);for(var o in c)a[o]==null&&(a[o]=c[o])}catch(d){if(s.WTF)throw d}a.HeadingPairs&&a.TitlesOfParts&&(Vd(a.HeadingPairs,a.TitlesOfParts,a,s),delete a.HeadingPairs,delete a.TitlesOfParts)}function Fx(t,a){a||(a={}),Ji(a),rd(),a.codepage&&Fi(a.codepage);var s,n;if(t.FullPaths){if(Ve.find(t,"/encryption"))throw new Error("File is password-protected");s=Ve.find(t,"!CompObj"),n=Ve.find(t,"/Workbook")||Ve.find(t,"/Book")}else{switch(a.type){case"base64":t=vs(os(t));break;case"binary":t=vs(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Pt(t,0),n={content:t}}var r,i;if(s&&zN(s),a.bookProps&&!a.bookSheets)r={};else{var l=We?"buffer":"array";if(n&&n.content)r=WN(n.content,a);else if((i=Ve.find(t,"PerfectOffice_MAIN"))&&i.content)r=ir.to_workbook(i.content,(a.type=l,a));else if((i=Ve.find(t,"NativeContent_MAIN"))&&i.content)r=ir.to_workbook(i.content,(a.type=l,a));else throw(i=Ve.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");a.bookVBA&&t.FullPaths&&Ve.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(r.vbaraw=Db(t))}var c={};return t.FullPaths&&VN(t,c,a),r.Props=r.Custprops=c,a.bookFiles&&(r.cfb=t),r}var xn={0:{f:Av},1:{f:Dv},2:{f:Bv},3:{f:Lv},4:{f:Rv},5:{f:$v},6:{f:Hv},7:{f:Ov},8:{f:Yv},9:{f:Gv},10:{f:Wv},11:{f:Vv},12:{f:_v},13:{f:Uv},14:{f:Iv},15:{f:Pv},16:{f:kx},17:{f:qv},18:{f:Mv},19:{f:Bi},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:vN},40:{},42:{},43:{f:Wy},44:{f:qy},45:{f:Vy},46:{f:Yy},47:{f:Gy},48:{},49:{f:Yp},50:{},51:{f:pb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:rx},62:{f:zv},63:{f:jb},64:{f:aN},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Vt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:sN},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Tv},148:{f:Ev,p:16},151:{f:Jv},152:{},153:{f:bN},154:{},155:{},156:{f:yN},157:{},158:{},159:{T:1,f:dy},160:{T:-1},161:{T:1,f:Na},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Xv},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:ub},336:{T:-1},337:{f:fb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ai},357:{},358:{},359:{},360:{T:1},361:{},362:{f:ax},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Qv},427:{f:Zv},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:tN},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Fv},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Kv},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ai},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Eb},633:{T:1},634:{T:-1},635:{T:1,f:Ab},636:{T:-1},637:{f:Kp},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:oN},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:rN},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ci={6:{f:On},10:{f:Gs},12:{f:Nt},13:{f:Nt},14:{f:yt},15:{f:yt},16:{f:Ht},17:{f:yt},18:{f:yt},19:{f:Nt},20:{f:fc},21:{f:fc},23:{f:ax},24:{f:yc},25:{f:yt},26:{},27:{},28:{f:Sg},29:{},34:{f:yt},35:{f:gc},38:{f:Ht},39:{f:Ht},40:{f:Ht},41:{f:Ht},42:{f:yt},43:{f:yt},47:{f:Fy},49:{f:ig},51:{f:Nt},60:{},61:{f:ag},64:{f:yt},65:{f:ng},66:{f:Nt},77:{},80:{},81:{},82:{},85:{f:Nt},89:{},90:{},91:{},92:{f:Xf},93:{f:Ag},94:{},95:{f:yt},96:{},97:{},99:{f:yt},125:{f:rx},128:{f:fg},129:{f:Kf},130:{f:Nt},131:{f:yt},132:{f:yt},133:{f:Jf},134:{},140:{f:Rg},141:{f:Nt},144:{},146:{f:Lg},151:{},152:{},153:{},154:{},155:{},156:{f:Nt},157:{},158:{},160:{f:Bg},161:{f:Og},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:mg},190:{f:hg},193:{f:Gs},197:{},198:{},199:{},200:{},201:{},202:{f:yt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Nt},220:{},221:{f:yt},222:{},224:{f:pg},225:{f:Yf},226:{f:Gs},227:{},229:{f:Cg},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Qf},253:{f:lg},255:{f:Zf},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Jd},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:yt},353:{f:Gs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:yg},431:{f:yt},432:{},433:{},434:{},437:{},438:{f:Tg},439:{f:yt},440:{f:Dg},441:{},442:{f:Fr},443:{},444:{f:Nt},445:{},446:{},448:{f:Gs},449:{f:sg,r:2},450:{f:Gs},512:{f:uc},513:{f:$g},515:{f:gg},516:{f:cg},517:{f:pc},519:{f:Ug},520:{f:eg},523:{},545:{f:bc},549:{f:hc},566:{},574:{f:rg},638:{f:xg},659:{},1048:{},1054:{f:og},1084:{},1212:{f:Ng},2048:{f:_g},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:zr},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Gs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Ig,r:12},2173:{f:mb,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:yt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:vg,r:12},2197:{},2198:{f:ib,r:12},2199:{},2200:{},2201:{},2202:{f:wg,r:12},2203:{f:Gs},2204:{},2205:{},2206:{},2207:{},2211:{f:tg},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Nt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Mg},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Pg},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:uc},1:{},2:{f:Wg},3:{f:qg},4:{f:Hg},5:{f:pc},7:{f:Vg},8:{},9:{f:zr},11:{},22:{f:Nt},30:{f:dg},31:{},32:{},33:{f:bc},36:{},37:{f:hc},50:{f:Gg},62:{},52:{},67:{},68:{f:Nt},69:{},86:{},126:{},127:{f:zg},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Yg},223:{},234:{},354:{},421:{},518:{f:On},521:{f:zr},536:{f:yc},547:{f:gc},561:{},579:{},1030:{f:On},1033:{f:zr},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function js(t,a,s,n){var r=a;if(!isNaN(r)){var i=(s||[]).length||0,l=t.next(4);l.write_shift(2,r),l.write_shift(2,i),i>0&&Md(s)&&t.push(s)}}function Tc(t,a){var s=a||{},n=s.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var r=t.match(/<table/i);if(!r)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),l=r.index,c=i&&i.index||t.length,o=fp(t.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,x=0,m=0,h=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(l=0;l<o.length;++l){var p=o[l].trim(),u=p.slice(0,3).toLowerCase();if(u=="<tr"){if(++d,s.sheetRows&&s.sheetRows<=d){--d;break}x=0;continue}if(!(u!="<td"&&u!="<th")){var j=p.split(/<\/t[dh]>/i);for(c=0;c<j.length;++c){var y=j[c].trim();if(y.match(/<t[dh]/i)){for(var N=y,w=0;N.charAt(0)=="<"&&(w=N.indexOf(">"))>-1;)N=N.slice(w+1);for(var D=0;D<g.length;++D){var b=g[D];b.s.c==x&&b.s.r<d&&d<=b.e.r&&(x=b.e.c+1,D=-1)}var C=Le(y.slice(0,y.indexOf(">")));h=C.colspan?+C.colspan:1,((m=+C.rowspan)>1||h>1)&&g.push({s:{r:d,c:x},e:{r:d+(m||1)-1,c:x+h-1}});var S=C.t||C["data-t"]||"";if(!N.length){x+=h;continue}if(N=Sd(N),f.s.r>d&&(f.s.r=d),f.e.r<d&&(f.e.r=d),f.s.c>x&&(f.s.c=x),f.e.c<x&&(f.e.c=x),!N.length){x+=h;continue}var k={t:"s",v:N};s.raw||!N.trim().length||S=="s"||(N==="TRUE"?k={t:"b",v:!0}:N==="FALSE"?k={t:"b",v:!1}:isNaN(ks(N))?isNaN(Oa(N).getDate())||(k={t:"d",v:Dt(N)},s.cellDates||(k={t:"n",v:Qt(k.v)}),k.z=s.dateNF||Me[14]):k={t:"n",v:ks(N)}),s.dense?(n[d]||(n[d]=[]),n[d][x]=k):n[Ie({r:d,c:x})]=k,x+=h}}}}return n["!ref"]=Ge(f),g.length&&(n["!merges"]=g),n}function GN(t,a,s,n){for(var r=t["!merges"]||[],i=[],l=a.s.c;l<=a.e.c;++l){for(var c=0,o=0,d=0;d<r.length;++d)if(!(r[d].s.r>s||r[d].s.c>l)&&!(r[d].e.r<s||r[d].e.c<l)){if(r[d].s.r<s||r[d].s.c<l){c=-1;break}c=r[d].e.r-r[d].s.r+1,o=r[d].e.c-r[d].s.c+1;break}if(!(c<0)){var x=Ie({r:s,c:l}),m=n.dense?(t[s]||[])[l]:t[x],h=m&&m.v!=null&&(m.h||Li(m.w||(Ws(m),m.w)||""))||"",f={};c>1&&(f.rowspan=c),o>1&&(f.colspan=o),n.editable?h='<span contenteditable="true">'+h+"</span>":m&&(f["data-t"]=m&&m.t||"z",m.v!=null&&(f["data-v"]=m.v),m.z!=null&&(f["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+m.l.Target+'">'+h+"</a>")),f.id=(n.id||"sjs")+"-"+x,i.push(_p("td",h,f))}}var g="<tr>";return g+i.join("")+"</tr>"}var YN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',XN="</body></html>";function KN(t,a){var s=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!s||s.length==0)throw new Error("Invalid HTML: could not find <table>");if(s.length==1)return ra(Tc(s[0],a),a);var n=Zi();return s.forEach(function(r,i){el(n,Tc(r,a),"Sheet"+(i+1))}),n}function JN(t,a,s){var n=[];return n.join("")+"<table"+(s&&s.id?' id="'+s.id+'"':"")+">"}function QN(t,a){var s=a||{},n=s.header!=null?s.header:YN,r=s.footer!=null?s.footer:XN,i=[n],l=qa(t["!ref"]);s.dense=Array.isArray(t),i.push(JN(t,l,s));for(var c=l.s.r;c<=l.e.r;++c)i.push(GN(t,l,c,s));return i.push("</table>"+r),i.join("")}function Tx(t,a,s){var n=s||{},r=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")r=n.origin;else{var l=typeof n.origin=="string"?Kt(n.origin):n.origin;r=l.r,i=l.c}var c=a.getElementsByTagName("tr"),o=Math.min(n.sheetRows||1e7,c.length),d={s:{r:0,c:0},e:{r,c:i}};if(t["!ref"]){var x=qa(t["!ref"]);d.s.r=Math.min(d.s.r,x.s.r),d.s.c=Math.min(d.s.c,x.s.c),d.e.r=Math.max(d.e.r,x.e.r),d.e.c=Math.max(d.e.c,x.e.c),r==-1&&(d.e.r=r=x.e.r+1)}var m=[],h=0,f=t["!rows"]||(t["!rows"]=[]),g=0,p=0,u=0,j=0,y=0,N=0;for(t["!cols"]||(t["!cols"]=[]);g<c.length&&p<o;++g){var w=c[g];if(Dc(w)){if(n.display)continue;f[p]={hidden:!0}}var D=w.children;for(u=j=0;u<D.length;++u){var b=D[u];if(!(n.display&&Dc(b))){var C=b.hasAttribute("data-v")?b.getAttribute("data-v"):b.hasAttribute("v")?b.getAttribute("v"):Sd(b.innerHTML),S=b.getAttribute("data-z")||b.getAttribute("z");for(h=0;h<m.length;++h){var k=m[h];k.s.c==j+i&&k.s.r<p+r&&p+r<=k.e.r&&(j=k.e.c+1-i,h=-1)}N=+b.getAttribute("colspan")||1,((y=+b.getAttribute("rowspan")||1)>1||N>1)&&m.push({s:{r:p+r,c:j+i},e:{r:p+r+(y||1)-1,c:j+i+(N||1)-1}});var F={t:"s",v:C},R=b.getAttribute("data-t")||b.getAttribute("t")||"";C!=null&&(C.length==0?F.t=R||"z":n.raw||C.trim().length==0||R=="s"||(C==="TRUE"?F={t:"b",v:!0}:C==="FALSE"?F={t:"b",v:!1}:isNaN(ks(C))?isNaN(Oa(C).getDate())||(F={t:"d",v:Dt(C)},n.cellDates||(F={t:"n",v:Qt(F.v)}),F.z=n.dateNF||Me[14]):F={t:"n",v:ks(C)})),F.z===void 0&&S!=null&&(F.z=S);var T="",M=b.getElementsByTagName("A");if(M&&M.length)for(var X=0;X<M.length&&!(M[X].hasAttribute("href")&&(T=M[X].getAttribute("href"),T.charAt(0)!="#"));++X);T&&T.charAt(0)!="#"&&(F.l={Target:T}),n.dense?(t[p+r]||(t[p+r]=[]),t[p+r][j+i]=F):t[Ie({c:j+i,r:p+r})]=F,d.e.c<j+i&&(d.e.c=j+i),j+=N}}++p}return m.length&&(t["!merges"]=(t["!merges"]||[]).concat(m)),d.e.r=Math.max(d.e.r,p-1+r),t["!ref"]=Ge(d),p>=o&&(t["!fullref"]=Ge((d.e.r=c.length-g+p-1+r,d))),t}function Dx(t,a){var s=a||{},n=s.dense?[]:{};return Tx(n,t,a)}function ZN(t,a){return ra(Dx(t,a),a)}function Dc(t){var a="",s=ew(t);return s&&(a=s(t).getPropertyValue("display")),a||(a=t.style&&t.style.display),a==="none"}function ew(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function tw(t){var a=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,r){return Array(parseInt(r,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),s=Xe(a.replace(/<[^>]*>/g,""));return[s]}var _c={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function _x(t,a){var s=a||{},n=Ii(t),r=[],i,l,c={name:""},o="",d=0,x,m,h={},f=[],g=s.dense?[]:{},p,u,j={value:""},y="",N=0,w=[],D=-1,b=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,k={},F=[],R={},T=0,M=0,X=[],q=1,B=1,K=[],Q={Names:[]},_={},ne=["",""],ie=[],A={},P="",O=0,I=!1,J=!1,te=0;for(ur.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=ur.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"å·¥ä½œè¡¨":p[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?g["!ref"]=Ge(C):g["!ref"]="A1:A1",s.sheetRows>0&&s.sheetRows<=C.e.r&&(g["!fullref"]=g["!ref"],C.e.r=s.sheetRows-1,g["!ref"]=Ge(C)),F.length&&(g["!merges"]=F),X.length&&(g["!rows"]=X),x.name=x.åç§°||x.name,typeof JSON<"u"&&JSON.stringify(x),f.push(x.name),h[x.name]=g,J=!1):p[0].charAt(p[0].length-2)!=="/"&&(x=Le(p[0],!1),D=b=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,g=s.dense?[]:{},F=[],X=[],J=!0);break;case"table-row-group":p[1]==="/"?--S:++S;break;case"table-row":case"è¡Œ":if(p[1]==="/"){D+=q,q=1;break}if(m=Le(p[0],!1),m.è¡Œå·?D=m.è¡Œå·-1:D==-1&&(D=0),q=+m["number-rows-repeated"]||1,q<10)for(te=0;te<q;++te)S>0&&(X[D+te]={level:S});b=-1;break;case"covered-table-cell":p[1]!=="/"&&++b,s.sheetStubs&&(s.dense?(g[D]||(g[D]=[]),g[D][b]={t:"z"}):g[Ie({r:D,c:b})]={t:"z"}),y="",w=[];break;case"table-cell":case"æ•°æ®":if(p[0].charAt(p[0].length-2)==="/")++b,j=Le(p[0],!1),B=parseInt(j["number-columns-repeated"]||"1",10),u={t:"z",v:null},j.formula&&s.cellFormula!=!1&&(u.f=Cc(Xe(j.formula))),(j.æ•°æ®ç±»åž‹||j["value-type"])=="string"&&(u.t="s",u.v=Xe(j["string-value"]||""),s.dense?(g[D]||(g[D]=[]),g[D][b]=u):g[Ie({r:D,c:b})]=u),b+=B-1;else if(p[1]!=="/"){++b,y="",N=0,w=[],B=1;var se=q?D+q-1:D;if(b>C.e.c&&(C.e.c=b),b<C.s.c&&(C.s.c=b),D<C.s.r&&(C.s.r=D),se>C.e.r&&(C.e.r=se),j=Le(p[0],!1),ie=[],A={},u={t:j.æ•°æ®ç±»åž‹||j["value-type"],v:null},s.cellFormula)if(j.formula&&(j.formula=Xe(j.formula)),j["number-matrix-columns-spanned"]&&j["number-matrix-rows-spanned"]&&(T=parseInt(j["number-matrix-rows-spanned"],10)||0,M=parseInt(j["number-matrix-columns-spanned"],10)||0,R={s:{r:D,c:b},e:{r:D+T-1,c:b+M-1}},u.F=Ge(R),K.push([R,u.F])),j.formula)u.f=Cc(j.formula);else for(te=0;te<K.length;++te)D>=K[te][0].s.r&&D<=K[te][0].e.r&&b>=K[te][0].s.c&&b<=K[te][0].e.c&&(u.F=K[te][1]);switch((j["number-columns-spanned"]||j["number-rows-spanned"])&&(T=parseInt(j["number-rows-spanned"],10)||0,M=parseInt(j["number-columns-spanned"],10)||0,R={s:{r:D,c:b},e:{r:D+T-1,c:b+M-1}},F.push(R)),j["number-columns-repeated"]&&(B=parseInt(j["number-columns-repeated"],10)),u.t){case"boolean":u.t="b",u.v=lt(j["boolean-value"]);break;case"float":u.t="n",u.v=parseFloat(j.value);break;case"percentage":u.t="n",u.v=parseFloat(j.value);break;case"currency":u.t="n",u.v=parseFloat(j.value);break;case"date":u.t="d",u.v=Dt(j["date-value"]),s.cellDates||(u.t="n",u.v=Qt(u.v)),u.z="m/d/yy";break;case"time":u.t="n",u.v=hp(j["time-value"])/86400,s.cellDates&&(u.t="d",u.v=vn(u.v)),u.z="HH:MM:SS";break;case"number":u.t="n",u.v=parseFloat(j.æ•°æ®æ•°å€¼);break;default:if(u.t==="string"||u.t==="text"||!u.t)u.t="s",j["string-value"]!=null&&(y=Xe(j["string-value"]),w=[]);else throw new Error("Unsupported value type "+u.t)}}else{if(I=!1,u.t==="s"&&(u.v=y||"",w.length&&(u.R=w),I=N==0),_.Target&&(u.l=_),ie.length>0&&(u.c=ie,ie=[]),y&&s.cellText!==!1&&(u.w=y),I&&(u.t="z",delete u.v),(!I||s.sheetStubs)&&!(s.sheetRows&&s.sheetRows<=D))for(var le=0;le<q;++le){if(B=parseInt(j["number-columns-repeated"]||"1",10),s.dense)for(g[D+le]||(g[D+le]=[]),g[D+le][b]=le==0?u:It(u);--B>0;)g[D+le][b+B]=It(u);else for(g[Ie({r:D+le,c:b})]=u;--B>0;)g[Ie({r:D+le,c:b+B})]=It(u);C.e.c<=b&&(C.e.c=b)}B=parseInt(j["number-columns-repeated"]||"1",10),b+=B-1,B=0,u={},y="",w=[]}_={};break;case"document":case"document-content":case"ç”µå­è¡¨æ ¼æ–‡æ¡£":case"spreadsheet":case"ä¸»ä½“":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=r.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&r.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=r.pop())[0]!==p[3])throw"Bad state: "+i;A.t=y,w.length&&(A.R=w),A.a=P,ie.push(A)}else p[0].charAt(p[0].length-2)!=="/"&&r.push([p[3],!1]);P="",O=0,y="",N=0,w=[];break;case"creator":p[1]==="/"?P=n.slice(O,p.index):O=p.index+p[0].length;break;case"meta":case"å…ƒæ•°æ®":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=r.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&r.push([p[3],!1]);y="",N=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(k[c.name]=o,(i=r.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(o="",c=Le(p[0],!1),r.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(r[r.length-1][0]){case"time-style":case"date-style":l=Le(p[0],!1),o+=_c[p[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(r[r.length-1][0]){case"time-style":case"date-style":l=Le(p[0],!1),o+=_c[p[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(r[r.length-1][0]){case"number-style":case"date-style":case"time-style":o+=n.slice(d,p.index);break}else d=p.index+p[0].length;break;case"named-range":l=Le(p[0],!1),ne=Mn(l["cell-range-address"]);var ue={Name:l.name,Ref:ne[0]+"!"+ne[1]};J&&(ue.Sheet=f.length),Q.Names.push(ue);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"ç”µå­è¡¨æ ¼":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"æ–‡æœ¬ä¸²":if(["master-styles"].indexOf(r[r.length-1][0])>-1)break;if(p[1]==="/"&&(!j||!j["string-value"])){var be=tw(n.slice(N,p.index));y=(y.length>0?y+`
`:"")+be[0]}else Le(p[0],!1),N=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{ne=Mn(Le(p[0])["target-range-address"]),h[ne[0]]["!autofilter"]={ref:ne[1]}}catch{}break;case"date":break;case"object":break;case"title":case"æ ‡é¢˜":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(_=Le(p[0],!1),!_.href)break;_.Target=Xe(_.href),delete _.href,_.Target.charAt(0)=="#"&&_.Target.indexOf(".")>-1?(ne=Mn(_.Target.slice(1)),_.Target="#"+ne[0]+"!"+ne[1]):_.Target.match(/^\.\.[\\\/]/)&&(_.Target=_.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"è¡¨:":case"å­—:":break;default:if(s.WTF)throw new Error(p)}}var H={Sheets:h,SheetNames:f,Workbook:Q};return s.bookSheets&&delete H.Sheets,H}function Rc(t,a){a=a||{},ps(t,"META-INF/manifest.xml")&&gf(vt(t,"META-INF/manifest.xml"),a);var s=ns(t,"content.xml");if(!s)throw new Error("Missing content.xml in ODS / UOF file");var n=_x(nt(s),a);return ps(t,"meta.xml")&&(n.Props=Wd(vt(t,"meta.xml"))),n}function Pc(t,a){return _x(t,a)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Xi(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function oi(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):nt(ja(t))}function di(t){var a=t.reduce(function(r,i){return r+i.length},0),s=new Uint8Array(a),n=0;return t.forEach(function(r){s.set(r,n),n+=r.length}),s}function Lc(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function sw(t,a){for(var s=(t[a+15]&127)<<7|t[a+14]>>1,n=t[a+14]&1,r=a+13;r>=a;--r)n=n*256+t[r];return(t[a+15]&128?-n:n)*Math.pow(10,s-6176)}function yr(t,a){var s=a?a[0]:0,n=t[s]&127;e:if(t[s++]>=128&&(n|=(t[s]&127)<<7,t[s++]<128||(n|=(t[s]&127)<<14,t[s++]<128)||(n|=(t[s]&127)<<21,t[s++]<128)||(n+=(t[s]&127)*Math.pow(2,28),++s,t[s++]<128)||(n+=(t[s]&127)*Math.pow(2,35),++s,t[s++]<128)||(n+=(t[s]&127)*Math.pow(2,42),++s,t[s++]<128)))break e;return a&&(a[0]=s),n}function Et(t){var a=0,s=t[a]&127;e:if(t[a++]>=128){if(s|=(t[a]&127)<<7,t[a++]<128||(s|=(t[a]&127)<<14,t[a++]<128)||(s|=(t[a]&127)<<21,t[a++]<128))break e;s|=(t[a]&127)<<28}return s}function qt(t){for(var a=[],s=[0];s[0]<t.length;){var n=s[0],r=yr(t,s),i=r&7;r=Math.floor(r/8);var l=0,c;if(r==0)break;switch(i){case 0:{for(var o=s[0];t[s[0]++]>=128;);c=t.slice(o,s[0])}break;case 5:l=4,c=t.slice(s[0],s[0]+l),s[0]+=l;break;case 1:l=8,c=t.slice(s[0],s[0]+l),s[0]+=l;break;case 2:l=yr(t,s),c=t.slice(s[0],s[0]+l),s[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(r," at offset ").concat(n))}var d={data:c,type:i};a[r]==null?a[r]=[d]:a[r].push(d)}return a}function Ki(t,a){return(t==null?void 0:t.map(function(s){return a(s.data)}))||[]}function aw(t){for(var a,s=[],n=[0];n[0]<t.length;){var r=yr(t,n),i=qt(t.slice(n[0],n[0]+r));n[0]+=r;var l={id:Et(i[1][0].data),messages:[]};i[2].forEach(function(c){var o=qt(c.data),d=Et(o[3][0].data);l.messages.push({meta:o,data:t.slice(n[0],n[0]+d)}),n[0]+=d}),(a=i[3])!=null&&a[0]&&(l.merge=Et(i[3][0].data)>>>0>0),s.push(l)}return s}function rw(t,a){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var s=[0],n=yr(a,s),r=[];s[0]<a.length;){var i=a[s[0]]&3;if(i==0){var l=a[s[0]++]>>2;if(l<60)++l;else{var c=l-59;l=a[s[0]],c>1&&(l|=a[s[0]+1]<<8),c>2&&(l|=a[s[0]+2]<<16),c>3&&(l|=a[s[0]+3]<<24),l>>>=0,l++,s[0]+=c}r.push(a.slice(s[0],s[0]+l)),s[0]+=l;continue}else{var o=0,d=0;if(i==1?(d=(a[s[0]]>>2&7)+4,o=(a[s[0]++]&224)<<3,o|=a[s[0]++]):(d=(a[s[0]++]>>2)+1,i==2?(o=a[s[0]]|a[s[0]+1]<<8,s[0]+=2):(o=(a[s[0]]|a[s[0]+1]<<8|a[s[0]+2]<<16|a[s[0]+3]<<24)>>>0,s[0]+=4)),r=[di(r)],o==0)throw new Error("Invalid offset 0");if(o>r[0].length)throw new Error("Invalid offset beyond length");if(d>=o)for(r.push(r[0].slice(-o)),d-=o;d>=r[r.length-1].length;)r.push(r[r.length-1]),d-=r[r.length-1].length;r.push(r[0].slice(-o,-o+d))}}var x=di(r);if(x.length!=n)throw new Error("Unexpected length: ".concat(x.length," != ").concat(n));return x}function nw(t){for(var a=[],s=0;s<t.length;){var n=t[s++],r=t[s]|t[s+1]<<8|t[s+2]<<16;s+=3,a.push(rw(n,t.slice(s,s+r))),s+=r}if(s!==t.length)throw new Error("data is not a valid framed stream!");return di(a)}function iw(t,a,s,n){var r=Xi(t),i=r.getUint32(4,!0),l=(n>1?12:8)+Lc(i&(n>1?3470:398))*4,c=-1,o=-1,d=NaN,x=new Date(2001,0,1);i&512&&(c=r.getUint32(l,!0),l+=4),l+=Lc(i&(n>1?12288:4096))*4,i&16&&(o=r.getUint32(l,!0),l+=4),i&32&&(d=r.getFloat64(l,!0),l+=8),i&64&&(x.setTime(x.getTime()+r.getFloat64(l,!0)*1e3),l+=8);var m;switch(t[2]){case 0:break;case 2:m={t:"n",v:d};break;case 3:m={t:"s",v:a[o]};break;case 5:m={t:"d",v:x};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(c>-1)m={t:"s",v:s[c]};else if(o>-1)m={t:"s",v:a[o]};else if(!isNaN(d))m={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return m}function lw(t,a,s){var n=Xi(t),r=n.getUint32(8,!0),i=12,l=-1,c=-1,o=NaN,d=NaN,x=new Date(2001,0,1);r&1&&(o=sw(t,i),i+=16),r&2&&(d=n.getFloat64(i,!0),i+=8),r&4&&(x.setTime(x.getTime()+n.getFloat64(i,!0)*1e3),i+=8),r&8&&(c=n.getUint32(i,!0),i+=4),r&16&&(l=n.getUint32(i,!0),i+=4);var m;switch(t[1]){case 0:break;case 2:m={t:"n",v:o};break;case 3:m={t:"s",v:a[c]};break;case 5:m={t:"d",v:x};break;case 6:m={t:"b",v:d>0};break;case 7:m={t:"n",v:d/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:s[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(r&31," : ").concat(t.slice(0,4)));break;case 10:m={t:"n",v:o};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(r&31," : ").concat(t.slice(0,4)))}return m}function cw(t,a,s){switch(t[0]){case 0:case 1:case 2:case 3:return iw(t,a,s,t[0]);case 5:return lw(t,a,s);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Qs(t){var a=qt(t);return yr(a[1][0].data)}function Ic(t,a){var s=qt(a.data),n=Et(s[1][0].data),r=s[3],i=[];return(r||[]).forEach(function(l){var c=qt(l.data),o=Et(c[1][0].data)>>>0;switch(n){case 1:i[o]=oi(c[3][0].data);break;case 8:{var d=t[Qs(c[9][0].data)][0],x=qt(d.data),m=t[Qs(x[1][0].data)][0],h=Et(m.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var f=qt(m.data);i[o]=f[3].map(function(g){return oi(g.data)}).join("")}break}}),i}function ow(t,a){var s,n,r,i,l,c,o,d,x,m,h,f,g,p,u=qt(t),j=Et(u[1][0].data)>>>0,y=Et(u[2][0].data)>>>0,N=((n=(s=u[8])==null?void 0:s[0])==null?void 0:n.data)&&Et(u[8][0].data)>0||!1,w,D;if((i=(r=u[7])==null?void 0:r[0])!=null&&i.data&&a!=0)w=(c=(l=u[7])==null?void 0:l[0])==null?void 0:c.data,D=(d=(o=u[6])==null?void 0:o[0])==null?void 0:d.data;else if((m=(x=u[4])==null?void 0:x[0])!=null&&m.data&&a!=1)w=(f=(h=u[4])==null?void 0:h[0])==null?void 0:f.data,D=(p=(g=u[3])==null?void 0:g[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(a," cell storage");for(var b=N?4:1,C=Xi(w),S=[],k=0;k<w.length/2;++k){var F=C.getUint16(k*2,!0);F<65535&&S.push([k,F])}if(S.length!=y)throw"Expected ".concat(y," cells, found ").concat(S.length);var R=[];for(k=0;k<S.length-1;++k)R[S[k][0]]=D.subarray(S[k][1]*b,S[k+1][1]*b);return S.length>=1&&(R[S[S.length-1][0]]=D.subarray(S[S.length-1][1]*b)),{R:j,cells:R}}function dw(t,a){var s,n=qt(a.data),r=(s=n==null?void 0:n[7])!=null&&s[0]?Et(n[7][0].data)>>>0>0?1:0:-1,i=Ki(n[5],function(l){return ow(l,r)});return{nrows:Et(n[4][0].data)>>>0,data:i.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(o,d){if(l[c.R][d])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(d));l[c.R][d]=o}),l},[])}}function xw(t,a,s){var n,r=qt(a.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(Et(r[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(r[6][0].data));if(i.e.c=(Et(r[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(r[7][0].data));s["!ref"]=Ge(i);var l=qt(r[4][0].data),c=Ic(t,t[Qs(l[4][0].data)][0]),o=(n=l[17])!=null&&n[0]?Ic(t,t[Qs(l[17][0].data)][0]):[],d=qt(l[3][0].data),x=0;d[1].forEach(function(m){var h=qt(m.data),f=t[Qs(h[2][0].data)][0],g=Et(f.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var p=dw(t,f);p.data.forEach(function(u,j){u.forEach(function(y,N){var w=Ie({r:x+j,c:N}),D=cw(y,c,o);D&&(s[w]=D)})}),x+=p.nrows})}function mw(t,a){var s=qt(a.data),n={"!ref":"A1"},r=t[Qs(s[2][0].data)],i=Et(r[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return xw(t,r[0],n),n}function hw(t,a){var s,n=qt(a.data),r={name:(s=n[1])!=null&&s[0]?oi(n[1][0].data):"",sheets:[]},i=Ki(n[2],Qs);return i.forEach(function(l){t[l].forEach(function(c){var o=Et(c.meta[1][0].data);o==6e3&&r.sheets.push(mw(t,c))})}),r}function uw(t,a){var s=Zi(),n=qt(a.data),r=Ki(n[1],Qs);if(r.forEach(function(i){t[i].forEach(function(l){var c=Et(l.meta[1][0].data);if(c==2){var o=hw(t,l);o.sheets.forEach(function(d,x){el(s,d,x==0?o.name:o.name+"_"+x,!0)})}})}),s.SheetNames.length==0)throw new Error("Empty NUMBERS file");return s}function Bn(t){var a,s,n,r,i={},l=[];if(t.FullPaths.forEach(function(o){if(o.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(o){if(o.name.match(/\.iwa$/)){var d;try{d=nw(o.content)}catch(m){return console.log("?? "+o.content.length+" "+(m.message||m))}var x;try{x=aw(d)}catch(m){return console.log("## "+(m.message||m))}x.forEach(function(m){i[m.id]=m.messages,l.push(m.id)})}}),!l.length)throw new Error("File has no messages");var c=((r=(n=(s=(a=i==null?void 0:i[1])==null?void 0:a[0])==null?void 0:s.meta)==null?void 0:n[1])==null?void 0:r[0].data)&&Et(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||l.forEach(function(o){i[o].forEach(function(d){var x=Et(d.meta[1][0].data)>>>0;if(x==1)if(!c)c=d;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return uw(i,c)}function pw(t){return function(s){for(var n=0;n!=t.length;++n){var r=t[n];s[r[0]]===void 0&&(s[r[0]]=r[1]),r[2]==="n"&&(s[r[0]]=Number(s[r[0]]))}}}function Ji(t){pw([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function fw(t){return Ea.WS.indexOf(t)>-1?"sheet":t==Ea.CS?"chart":t==Ea.DS?"dialog":t==Ea.MS?"macro":t&&t.length?t:"sheet"}function gw(t,a){if(!t)return 0;try{t=a.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,fw(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function yw(t,a,s,n,r,i,l,c,o,d,x,m){try{i[n]=rr(ns(t,s,!0),a);var h=vt(t,a),f;switch(c){case"sheet":f=kN(h,a,r,o,i[n],d,x,m);break;case"chart":if(f=SN(h,a,r,o,i[n],d,x,m),!f||!f["!drawel"])break;var g=Za(f["!drawel"].Target,a),p=ri(g),u=wb(ns(t,g,!0),rr(ns(t,p,!0),g)),j=Za(u,g),y=ri(j);f=lN(ns(t,j,!0),j,o,rr(ns(t,y,!0),j),d,f);break;case"macro":f=CN(h,a,r,o,i[n],d,x,m);break;case"dialog":f=AN(h,a,r,o,i[n],d,x,m);break;default:throw new Error("Unrecognized sheet type "+c)}l[n]=f;var N=[];i&&i[n]&&Ls(i[n]).forEach(function(w){var D="";if(i[n][w].Type==Ea.CMNT){D=Za(i[n][w].Target,a);var b=DN(vt(t,D,!0),D,o);if(!b||!b.length)return;vc(f,b,!1)}i[n][w].Type==Ea.TCMNT&&(D=Za(i[n][w].Target,a),N=N.concat(Sb(vt(t,D,!0),o)))}),N&&N.length&&vc(f,N,!0,o.people||[])}catch(w){if(o.WTF)throw w}}function hs(t){return t.charAt(0)=="/"?t.slice(1):t}function bw(t,a){if(fd(),a=a||{},Ji(a),ps(t,"META-INF/manifest.xml")||ps(t,"objectdata.xml"))return Rc(t,a);if(ps(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Bn<"u"){if(t.FileIndex)return Bn(t);var s=Ve.utils.cfb_new();return Yl(t).forEach(function(X){bp(s,X,yp(t,X))}),Bn(s)}throw new Error("Unsupported NUMBERS file")}if(!ps(t,"[Content_Types].xml"))throw ps(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ps(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Yl(t),r=pf(ns(t,"[Content_Types].xml")),i=!1,l,c;if(r.workbooks.length===0&&(c="xl/workbook.xml",vt(t,c,!0)&&r.workbooks.push(c)),r.workbooks.length===0){if(c="xl/workbook.bin",!vt(t,c,!0))throw new Error("Could not find workbook");r.workbooks.push(c),i=!0}r.workbooks[0].slice(-3)=="bin"&&(i=!0);var o={},d={};if(!a.bookSheets&&!a.bookProps){if(lr=[],r.sst)try{lr=TN(vt(t,hs(r.sst)),r.sst,a)}catch(X){if(a.WTF)throw X}a.cellStyles&&r.themes.length&&(o=FN(ns(t,r.themes[0].replace(/^\//,""),!0)||"",r.themes[0],a)),r.style&&(d=EN(vt(t,hs(r.style)),r.style,o,a))}r.links.map(function(X){try{var q=rr(ns(t,ri(hs(X))),X);return RN(vt(t,hs(X)),q,X,a)}catch{}});var x=wN(vt(t,hs(r.workbooks[0])),r.workbooks[0],a),m={},h="";r.coreprops.length&&(h=vt(t,hs(r.coreprops[0]),!0),h&&(m=Wd(h)),r.extprops.length!==0&&(h=vt(t,hs(r.extprops[0]),!0),h&&jf(h,m,a)));var f={};(!a.bookSheets||a.bookProps)&&r.custprops.length!==0&&(h=ns(t,hs(r.custprops[0]),!0),h&&(f=Nf(h,a)));var g={};if((a.bookSheets||a.bookProps)&&(x.Sheets?l=x.Sheets.map(function(q){return q.name}):m.Worksheets&&m.SheetNames.length>0&&(l=m.SheetNames),a.bookProps&&(g.Props=m,g.Custprops=f),a.bookSheets&&typeof l<"u"&&(g.SheetNames=l),a.bookSheets?g.SheetNames:a.bookProps))return g;l={};var p={};a.bookDeps&&r.calcchain&&(p=_N(vt(t,hs(r.calcchain)),r.calcchain));var u=0,j={},y,N;{var w=x.Sheets;m.Worksheets=w.length,m.SheetNames=[];for(var D=0;D!=w.length;++D)m.SheetNames[D]=w[D].name}var b=i?"bin":"xml",C=r.workbooks[0].lastIndexOf("/"),S=(r.workbooks[0].slice(0,C+1)+"_rels/"+r.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");ps(t,S)||(S="xl/_rels/workbook."+b+".rels");var k=rr(ns(t,S,!0),S.replace(/_rels.*/,"s5s"));(r.metadata||[]).length>=1&&(a.xlmeta=PN(vt(t,hs(r.metadata[0])),r.metadata[0],a)),(r.people||[]).length>=1&&(a.people=Cb(vt(t,hs(r.people[0])),a)),k&&(k=gw(k,x.Sheets));var F=vt(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(u=0;u!=m.Worksheets;++u){var R="sheet";if(k&&k[u]?(y="xl/"+k[u][1].replace(/[\/]?xl\//,""),ps(t,y)||(y=k[u][1]),ps(t,y)||(y=S.replace(/_rels\/.*$/,"")+k[u][1]),R=k[u][2]):(y="xl/worksheets/sheet"+(u+1-F)+"."+b,y=y.replace(/sheet0\./,"sheet.")),N=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),a&&a.sheets!=null)switch(typeof a.sheets){case"number":if(u!=a.sheets)continue e;break;case"string":if(m.SheetNames[u].toLowerCase()!=a.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(a.sheets)){for(var T=!1,M=0;M!=a.sheets.length;++M)typeof a.sheets[M]=="number"&&a.sheets[M]==u&&(T=1),typeof a.sheets[M]=="string"&&a.sheets[M].toLowerCase()==m.SheetNames[u].toLowerCase()&&(T=1);if(!T)continue e}}yw(t,y,N,m.SheetNames[u],u,j,l,R,a,x,o,d)}return g={Directory:r,Workbook:x,Props:m,Custprops:f,Deps:p,Sheets:l,SheetNames:m.SheetNames,Strings:lr,Styles:d,Themes:o,SSF:It(Me)},a&&a.bookFiles&&(t.files?(g.keys=n,g.files=t.files):(g.keys=[],g.files={},t.FullPaths.forEach(function(X,q){X=X.replace(/^Root Entry[\/]/,""),g.keys.push(X),g.files[X]=t.FileIndex[q]}))),a&&a.bookVBA&&(r.vba.length>0?g.vbaraw=vt(t,hs(r.vba[0]),!0):r.defaults&&r.defaults.bin===Tb&&(g.vbaraw=vt(t,"xl/vbaProject.bin",!0))),g}function jw(t,a){var s=a||{},n="Workbook",r=Ve.find(t,n);try{if(n="/!DataSpaces/Version",r=Ve.find(t,n),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(my(r.content),n="/!DataSpaces/DataSpaceMap",r=Ve.find(t,n),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=uy(r.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",r=Ve.find(t,n),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=py(r.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",r=Ve.find(t,n),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+n);gy(r.content)}catch{}if(n="/EncryptionInfo",r=Ve.find(t,n),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=yy(r.content);if(n="/EncryptedPackage",r=Ve.find(t,n),!r||!r.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],r.content,s.password||"",s);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],r.content,s.password||"",s);throw new Error("File is password-protected")}function Qi(t,a){var s="";switch((a||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":s=os(t.slice(0,12));break;case"binary":s=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(a&&a.type||"undefined"))}return[s.charCodeAt(0),s.charCodeAt(1),s.charCodeAt(2),s.charCodeAt(3),s.charCodeAt(4),s.charCodeAt(5),s.charCodeAt(6),s.charCodeAt(7)]}function vw(t,a){return Ve.find(t,"EncryptedPackage")?jw(t,a):Fx(t,a)}function Nw(t,a){var s,n=t,r=a||{};return r.type||(r.type=We&&Buffer.isBuffer(t)?"buffer":"base64"),s=Nd(n,r),bw(s,r)}function Rx(t,a){var s=0;e:for(;s<t.length;)switch(t.charCodeAt(s)){case 10:case 13:case 32:++s;break;case 60:return li(t.slice(s),a);default:break e}return pr.to_workbook(t,a)}function ww(t,a){var s="",n=Qi(t,a);switch(a.type){case"base64":s=os(t);break;case"binary":s=t;break;case"buffer":s=t.toString("binary");break;case"array":s=fa(t);break;default:throw new Error("Unrecognized type "+a.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(s=nt(s)),a.type="binary",Rx(s,a)}function kw(t,a){var s=t;return a.type=="base64"&&(s=os(s)),s=xr.utils.decode(1200,s.slice(2),"str"),a.type="binary",Rx(s,a)}function Sw(t){return t.match(/[^\x00-\x7F]/)?er(t):t}function Un(t,a,s,n){return n?(s.type="string",pr.to_workbook(t,s)):pr.to_workbook(a,s)}function xi(t,a){rd();var s=a||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return xi(new Uint8Array(t),(s=It(s),s.type="array",s));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!s.type&&(s.type=typeof Deno<"u"?"buffer":"array");var n=t,r=[0,0,0,0],i=!1;if(s.cellStyles&&(s.cellNF=!0,s.sheetStubs=!0),Da={},s.dateNF&&(Da.dateNF=s.dateNF),s.type||(s.type=We&&Buffer.isBuffer(t)?"buffer":"base64"),s.type=="file"&&(s.type=We?"buffer":"binary",n=xp(t),typeof Uint8Array<"u"&&!We&&(s.type="array")),s.type=="string"&&(i=!0,s.type="binary",s.codepage=65001,n=Sw(t)),s.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return s=It(s),s.type="array",xi(Ti(n),s)}switch((r=Qi(n,s))[0]){case 208:if(r[1]===207&&r[2]===17&&r[3]===224&&r[4]===161&&r[5]===177&&r[6]===26&&r[7]===225)return vw(Ve.read(n,s),s);break;case 9:if(r[1]<=8)return Fx(n,s);break;case 60:return li(n,s);case 73:if(r[1]===73&&r[2]===42&&r[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(r[1]===68)return Zg(n,s);break;case 84:if(r[1]===65&&r[2]===66&&r[3]===76)return Jg.to_workbook(n,s);break;case 80:return r[1]===75&&r[2]<9&&r[3]<9?Nw(n,s):Un(t,n,s,i);case 239:return r[3]===60?li(n,s):Un(t,n,s,i);case 255:if(r[1]===254)return kw(n,s);if(r[1]===0&&r[2]===2&&r[3]===0)return ir.to_workbook(n,s);break;case 0:if(r[1]===0&&(r[2]>=2&&r[3]===0||r[2]===0&&(r[3]===8||r[3]===9)))return ir.to_workbook(n,s);break;case 3:case 131:case 139:case 140:return jc.to_workbook(n,s);case 123:if(r[1]===92&&r[2]===114&&r[3]===116)return Ty.to_workbook(n,s);break;case 10:case 13:case 32:return ww(n,s);case 137:if(r[1]===80&&r[2]===78&&r[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Xg.indexOf(r[0])>-1&&r[2]<=12&&r[3]<=31?jc.to_workbook(n,s):Un(t,n,s,i)}function Cw(t,a,s,n,r,i,l,c){var o=Ot(s),d=c.defval,x=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),m=!0,h=r===1?[]:{};if(r!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:s,enumerable:!1})}catch{h.__rowNum__=s}else h.__rowNum__=s;if(!l||t[s])for(var f=a.s.c;f<=a.e.c;++f){var g=l?t[s][f]:t[n[f]+o];if(g===void 0||g.t===void 0){if(d===void 0)continue;i[f]!=null&&(h[i[f]]=d);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(i[f]!=null){if(p==null)if(g.t=="e"&&p===null)h[i[f]]=null;else if(d!==void 0)h[i[f]]=d;else if(x&&p===null)h[i[f]]=null;else continue;else h[i[f]]=x&&(g.t!=="n"||g.t==="n"&&c.rawNumbers!==!1)?p:Ws(g,p,c);p!=null&&(m=!1)}}return{row:h,isempty:m}}function mi(t,a){if(t==null||t["!ref"]==null)return[];var s={t:"n",v:0},n=0,r=1,i=[],l=0,c="",o={s:{r:0,c:0},e:{r:0,c:0}},d=a||{},x=d.range!=null?d.range:t["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof x){case"string":o=gt(x);break;case"number":o=gt(t["!ref"]),o.s.r=x;break;default:o=x}n>0&&(r=0);var m=Ot(o.s.r),h=[],f=[],g=0,p=0,u=Array.isArray(t),j=o.s.r,y=0,N={};u&&!t[j]&&(t[j]=[]);var w=d.skipHidden&&t["!cols"]||[],D=d.skipHidden&&t["!rows"]||[];for(y=o.s.c;y<=o.e.c;++y)if(!(w[y]||{}).hidden)switch(h[y]=At(y),s=u?t[j][y]:t[h[y]+m],n){case 1:i[y]=y-o.s.c;break;case 2:i[y]=h[y];break;case 3:i[y]=d.header[y-o.s.c];break;default:if(s==null&&(s={w:"__EMPTY",t:"s"}),c=l=Ws(s,null,d),p=N[l]||0,!p)N[l]=1;else{do c=l+"_"+p++;while(N[c]);N[l]=p,N[c]=1}i[y]=c}for(j=o.s.r+r;j<=o.e.r;++j)if(!(D[j]||{}).hidden){var b=Cw(t,o,j,h,n,i,u,d);(b.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(f[g++]=b.row)}return f.length=g,f}var Oc=/"/g;function Aw(t,a,s,n,r,i,l,c){for(var o=!0,d=[],x="",m=Ot(s),h=a.s.c;h<=a.e.c;++h)if(n[h]){var f=c.dense?(t[s]||[])[h]:t[n[h]+m];if(f==null)x="";else if(f.v!=null){o=!1,x=""+(c.rawNumbers&&f.t=="n"?f.v:Ws(f,null,c));for(var g=0,p=0;g!==x.length;++g)if((p=x.charCodeAt(g))===r||p===i||p===34||c.forceQuotes){x='"'+x.replace(Oc,'""')+'"';break}x=="ID"&&(x='"ID"')}else f.f!=null&&!f.F?(o=!1,x="="+f.f,x.indexOf(",")>=0&&(x='"'+x.replace(Oc,'""')+'"')):x="";d.push(x)}return c.blankrows===!1&&o?null:d.join(l)}function Px(t,a){var s=[],n=a??{};if(t==null||t["!ref"]==null)return"";var r=gt(t["!ref"]),i=n.FS!==void 0?n.FS:",",l=i.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,o=c.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),x="",m=[];n.dense=Array.isArray(t);for(var h=n.skipHidden&&t["!cols"]||[],f=n.skipHidden&&t["!rows"]||[],g=r.s.c;g<=r.e.c;++g)(h[g]||{}).hidden||(m[g]=At(g));for(var p=0,u=r.s.r;u<=r.e.r;++u)(f[u]||{}).hidden||(x=Aw(t,r,u,m,l,o,i,n),x!=null&&(n.strip&&(x=x.replace(d,"")),(x||n.blankrows!==!1)&&s.push((p++?c:"")+x)));return delete n.dense,s.join("")}function Ew(t,a){a||(a={}),a.FS="	",a.RS=`
`;var s=Px(t,a);return s}function Fw(t){var a="",s,n="";if(t==null||t["!ref"]==null)return[];var r=gt(t["!ref"]),i="",l=[],c,o=[],d=Array.isArray(t);for(c=r.s.c;c<=r.e.c;++c)l[c]=At(c);for(var x=r.s.r;x<=r.e.r;++x)for(i=Ot(x),c=r.s.c;c<=r.e.c;++c)if(a=l[c]+i,s=d?(t[x]||[])[c]:t[a],n="",s!==void 0){if(s.F!=null){if(a=s.F,!s.f)continue;n=s.f,a.indexOf(":")==-1&&(a=a+":"+a)}if(s.f!=null)n=s.f;else{if(s.t=="z")continue;if(s.t=="n"&&s.v!=null)n=""+s.v;else if(s.t=="b")n=s.v?"TRUE":"FALSE";else if(s.w!==void 0)n="'"+s.w;else{if(s.v===void 0)continue;s.t=="s"?n="'"+s.v:n=""+s.v}}o[o.length]=a+"="+n}return o}function Lx(t,a,s){var n=s||{},r=+!n.skipHeader,i=t||{},l=0,c=0;if(i&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var o=typeof n.origin=="string"?Kt(n.origin):n.origin;l=o.r,c=o.c}var d,x={s:{c:0,r:0},e:{c,r:l+a.length-1+r}};if(i["!ref"]){var m=gt(i["!ref"]);x.e.c=Math.max(x.e.c,m.e.c),x.e.r=Math.max(x.e.r,m.e.r),l==-1&&(l=m.e.r+1,x.e.r=l+a.length-1+r)}else l==-1&&(l=0,x.e.r=a.length-1+r);var h=n.header||[],f=0;a.forEach(function(p,u){Ls(p).forEach(function(j){(f=h.indexOf(j))==-1&&(h[f=h.length]=j);var y=p[j],N="z",w="",D=Ie({c:c+f,r:l+u+r});d=br(i,D),y&&typeof y=="object"&&!(y instanceof Date)?i[D]=y:(typeof y=="number"?N="n":typeof y=="boolean"?N="b":typeof y=="string"?N="s":y instanceof Date?(N="d",n.cellDates||(N="n",y=Qt(y)),w=n.dateNF||Me[14]):y===null&&n.nullError&&(N="e",y=0),d?(d.t=N,d.v=y,delete d.w,delete d.R,w&&(d.z=w)):i[D]=d={t:N,v:y},w&&(d.z=w))})}),x.e.c=Math.max(x.e.c,c+h.length-1);var g=Ot(l);if(r)for(f=0;f<h.length;++f)i[At(f+c)+g]={t:"s",v:h[f]};return i["!ref"]=Ge(x),i}function Tw(t,a){return Lx(null,t,a)}function br(t,a,s){if(typeof a=="string"){if(Array.isArray(t)){var n=Kt(a);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[a]||(t[a]={t:"z"})}return typeof a!="number"?br(t,Ie(a)):br(t,Ie({r:a,c:s||0}))}function Dw(t,a){if(typeof a=="number"){if(a>=0&&t.SheetNames.length>a)return a;throw new Error("Cannot find sheet # "+a)}else if(typeof a=="string"){var s=t.SheetNames.indexOf(a);if(s>-1)return s;throw new Error("Cannot find sheet name |"+a+"|")}else throw new Error("Cannot find sheet |"+a+"|")}function Zi(){return{SheetNames:[],Sheets:{}}}function el(t,a,s,n){var r=1;if(!s)for(;r<=65535&&t.SheetNames.indexOf(s="Sheet"+r)!=-1;++r,s=void 0);if(!s||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(s)>=0){var i=s.match(/(^.*?)(\d+)$/);r=i&&+i[2]||0;var l=i&&i[1]||s;for(++r;r<=65535&&t.SheetNames.indexOf(s=l+r)!=-1;++r);}if(pN(s),t.SheetNames.indexOf(s)>=0)throw new Error("Worksheet with name |"+s+"| already exists!");return t.SheetNames.push(s),t.Sheets[s]=a,s}function _w(t,a,s){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=Dw(t,a);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),s){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+s)}t.Workbook.Sheets[n].Hidden=s}function Rw(t,a){return t.z=a,t}function Ix(t,a,s){return a?(t.l={Target:a},s&&(t.l.Tooltip=s)):delete t.l,t}function Pw(t,a,s){return Ix(t,"#"+a,s)}function Lw(t,a,s){t.c||(t.c=[]),t.c.push({t:a,a:s||"SheetJS"})}function Iw(t,a,s,n){for(var r=typeof a!="string"?a:gt(a),i=typeof a=="string"?a:Ge(a),l=r.s.r;l<=r.e.r;++l)for(var c=r.s.c;c<=r.e.c;++c){var o=br(t,l,c);o.t="n",o.F=i,delete o.v,l==r.s.r&&c==r.s.c&&(o.f=s,n&&(o.D=!0))}return t}var Ow={encode_col:At,encode_row:Ot,encode_cell:Ie,encode_range:Ge,decode_col:$i,decode_row:Mi,split_cell:Gp,decode_cell:Kt,decode_range:qa,format_cell:Ws,sheet_add_aoa:Bd,sheet_add_json:Lx,sheet_add_dom:Tx,aoa_to_sheet:Wa,json_to_sheet:Tw,table_to_sheet:Dx,table_to_book:ZN,sheet_to_csv:Px,sheet_to_txt:Ew,sheet_to_json:mi,sheet_to_html:QN,sheet_to_formulae:Fw,sheet_to_row_object_array:mi,sheet_get_cell:br,book_new:Zi,book_append_sheet:el,book_set_sheet_visibility:_w,cell_set_number_format:Rw,cell_set_hyperlink:Ix,cell_set_internal_link:Pw,cell_add_comment:Lw,sheet_set_array_formula:Iw,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Mw=()=>{const[t,a]=v.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>a(!0),className:"fixed bottom-6 right-6 bg-primary-600 hover:bg-primary-700 text-white p-4 rounded-full shadow-lg z-50 transition-all",title:"Help & Guide",children:e.jsx(m0,{size:24})}),t&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-900 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-dark-900 border-b border-gray-700 p-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Bulk Upload Guide"}),e.jsx("button",{onClick:()=>a(!1),className:"p-2 hover:bg-dark-800 rounded-lg",children:e.jsx(Ee,{size:24,className:"text-gray-400"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Quick Start"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-gray-300",children:[e.jsx("li",{children:'Download the template using the "Download Template" button'}),e.jsx("li",{children:"Fill in your employee data following the format"}),e.jsx("li",{children:"Upload the file or paste Google Sheets URL"}),e.jsx("li",{children:'Click "Validate" to check for errors'}),e.jsx("li",{children:"Review validation results and fix any errors"}),e.jsx("li",{children:'Click "Upload Employees" to complete the import'})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Required Fields"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"bg-dark-800 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(we,{size:20,className:"text-green-500 mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"firstName"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Employee's first name"})]})]})}),e.jsx("div",{className:"bg-dark-800 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(we,{size:20,className:"text-green-500 mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"lastName"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Employee's last name"})]})]})}),e.jsx("div",{className:"bg-dark-800 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(we,{size:20,className:"text-green-500 mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"email"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Must be unique (e.g., john@example.com)"})]})]})}),e.jsx("div",{className:"bg-dark-800 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(we,{size:20,className:"text-green-500 mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"phone"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"10-15 digits (e.g., 1234567890)"})]})]})}),e.jsx("div",{className:"bg-dark-800 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(we,{size:20,className:"text-green-500 mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"department"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Department name or ID"})]})]})}),e.jsx("div",{className:"bg-dark-800 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(we,{size:20,className:"text-green-500 mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"designation"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Job title/position"})]})]})}),e.jsx("div",{className:"bg-dark-800 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(we,{size:20,className:"text-green-500 mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:"joiningDate"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Format: YYYY-MM-DD (e.g., 2024-01-01)"})]})]})})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Data Format Examples"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-dark-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-white font-medium mb-2",children:"Date Format"}),e.jsx("code",{className:"text-green-400",children:"YYYY-MM-DD"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Example: 2024-01-15, 1990-05-20"})]}),e.jsxs("div",{className:"bg-dark-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-white font-medium mb-2",children:"Gender"}),e.jsx("code",{className:"text-green-400",children:"male, female, other"})]}),e.jsxs("div",{className:"bg-dark-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-white font-medium mb-2",children:"Blood Group"}),e.jsx("code",{className:"text-green-400",children:"A+, A-, B+, B-, AB+, AB-, O+, O-"})]}),e.jsxs("div",{className:"bg-dark-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-white font-medium mb-2",children:"Employment Type"}),e.jsx("code",{className:"text-green-400",children:"full-time, part-time, contract, intern"})]}),e.jsxs("div",{className:"bg-dark-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-white font-medium mb-2",children:"Status"}),e.jsx("code",{className:"text-green-400",children:"active, inactive, terminated, on-leave"})]})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Common Errors & Solutions"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"bg-red-900/20 border border-red-500/50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(st,{size:20,className:"text-red-400 mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-red-400 font-medium",children:"Email already exists"}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Check for duplicate emails in your file and database"})]})]})}),e.jsx("div",{className:"bg-red-900/20 border border-red-500/50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(st,{size:20,className:"text-red-400 mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-red-400 font-medium",children:"Department not found"}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Create the department first or use exact department name"})]})]})}),e.jsx("div",{className:"bg-red-900/20 border border-red-500/50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(st,{size:20,className:"text-red-400 mt-1 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-red-400 font-medium",children:"Invalid date format"}),e.jsx("p",{className:"text-gray-300 text-sm",children:"Use YYYY-MM-DD format (e.g., 2024-01-01)"})]})]})})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Google Sheets Integration"}),e.jsxs("div",{className:"bg-blue-900/20 border border-blue-500/50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-white font-medium mb-2",children:"For Public Sheets:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-gray-300 text-sm",children:[e.jsx("li",{children:"Open your Google Sheet"}),e.jsx("li",{children:"Click Share â†’ Get link"}),e.jsx("li",{children:'Set to "Anyone with the link can view"'}),e.jsx("li",{children:"Copy and paste the URL in the bulk upload page"})]})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-4",children:"Best Practices"}),e.jsxs("ul",{className:"space-y-2 text-gray-300",children:[e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(we,{size:20,className:"text-green-500 mt-1 flex-shrink-0"}),e.jsx("span",{children:"Start with a small batch (5-10 records) to test"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(we,{size:20,className:"text-green-500 mt-1 flex-shrink-0"}),e.jsx("span",{children:"Ensure all departments exist before uploading"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(we,{size:20,className:"text-green-500 mt-1 flex-shrink-0"}),e.jsx("span",{children:"Use consistent date and phone formats throughout"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(we,{size:20,className:"text-green-500 mt-1 flex-shrink-0"}),e.jsx("span",{children:"Always validate before uploading"})]}),e.jsxs("li",{className:"flex items-start space-x-2",children:[e.jsx(we,{size:20,className:"text-green-500 mt-1 flex-shrink-0"}),e.jsx("span",{children:"Keep a backup of your original data"})]})]})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-dark-900 border-t border-gray-700 p-6",children:e.jsx("button",{onClick:()=>a(!1),className:"btn-primary w-full",children:"Got it!"})})]})})]})},$w=()=>{const t=Ke(),[a,s]=v.useState("file"),[n,r]=v.useState(null),[i,l]=v.useState(""),[c,o]=v.useState([]),[d,x]=v.useState(null),[m,h]=v.useState(!1),[f,g]=v.useState(!1),[p,u]=v.useState(0),j=async()=>{try{const k=(await Y.get("/employees/bulk/template")).data.data,F=Pl.unparse(k),R=new Blob([F],{type:"text/csv;charset=utf-8;"}),T=document.createElement("a"),M=URL.createObjectURL(R);T.setAttribute("href",M),T.setAttribute("download","employee_bulk_upload_template.csv"),T.style.visibility="hidden",document.body.appendChild(T),T.click(),document.body.removeChild(T),E.success("Template downloaded successfully")}catch(S){E.error("Failed to download template"),console.error("Template download error:",S)}},y=S=>{const k=S.target.files[0];if(k){const F=k.name.split(".").pop().toLowerCase();if(!["csv","xlsx","xls"].includes(F)){E.error("Please upload a CSV or Excel file");return}r(k),N(k)}},N=S=>{h(!0);const k=S.name.split(".").pop().toLowerCase();if(k==="csv")Pl.parse(S,{header:!0,skipEmptyLines:!0,complete:F=>{o(F.data),h(!1),E.success(`Parsed ${F.data.length} records from CSV`)},error:F=>{E.error("Failed to parse CSV file"),console.error("CSV parse error:",F),h(!1)}});else if(["xlsx","xls"].includes(k)){const F=new FileReader;F.onload=R=>{try{const T=new Uint8Array(R.target.result),M=xi(T,{type:"array"}),X=M.Sheets[M.SheetNames[0]],q=Ow.sheet_to_json(X);o(q),h(!1),E.success(`Parsed ${q.length} records from Excel`)}catch(T){E.error("Failed to parse Excel file"),console.error("Excel parse error:",T),h(!1)}},F.readAsArrayBuffer(S)}},w=S=>{const k=S.match(/\/spreadsheets\/d\/([a-zA-Z0-9-_]+)/);return k?k[1]:null},D=async()=>{var k,F,R;if(!i){E.error("Please enter a Google Sheets URL");return}const S=w(i);if(!S){E.error("Invalid Google Sheets URL");return}h(!0);try{const T=await Y.post("/employees/google-sheets/fetch",{spreadsheetId:S,range:"Sheet1!A:AG"});o(T.data.data.employees),E.success(`Fetched ${T.data.data.total} records from Google Sheets`)}catch(T){((k=T.response)==null?void 0:k.status)===403?E.error("Sheet is private. Please make it public or use OAuth authentication."):E.error(((R=(F=T.response)==null?void 0:F.data)==null?void 0:R.message)||"Failed to fetch Google Sheets data"),console.error("Google Sheets fetch error:",T)}finally{h(!1)}},b=async()=>{if(c.length===0){E.error("No data to validate");return}h(!0);try{const S=await Y.post("/employees/bulk/validate",{employees:c});x(S.data.data),S.data.data.invalid===0?E.success(`All ${S.data.data.valid} records are valid!`):E.error(`${S.data.data.invalid} records have validation errors`)}catch(S){E.error("Validation failed"),console.error("Validation error:",S)}finally{h(!1)}},C=async()=>{var S,k;if(c.length===0){E.error("No data to upload");return}g(!0),u(0);try{const F=setInterval(()=>{u(T=>T>=90?(clearInterval(F),T):T+10)},200),R=await Y.post("/employees/bulk/create",{employees:c});clearInterval(F),u(100),E.success(R.data.message),setTimeout(()=>{t("/employees")},2e3)}catch(F){E.error(((k=(S=F.response)==null?void 0:S.data)==null?void 0:k.message)||"Upload failed"),console.error("Upload error:",F)}finally{g(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>t("/employees"),className:"p-2 hover:bg-dark-800 rounded-lg",children:e.jsx(wt,{size:20,className:"text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Bulk Employee Upload"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Import employees from CSV, Excel, or Google Sheets"})]})]}),e.jsxs("button",{onClick:j,className:"btn-outline flex items-center space-x-2",children:[e.jsx(_t,{size:20}),e.jsx("span",{children:"Download Template"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex space-x-4 border-b border-gray-700 pb-4",children:[e.jsxs("button",{onClick:()=>s("file"),className:`px-4 py-2 rounded-lg flex items-center space-x-2 ${a==="file"?"bg-primary-600 text-white":"bg-dark-800 text-gray-400 hover:bg-dark-700"}`,children:[e.jsx(es,{size:20}),e.jsx("span",{children:"Upload File"})]}),e.jsxs("button",{onClick:()=>s("google-sheets"),className:`px-4 py-2 rounded-lg flex items-center space-x-2 ${a==="google-sheets"?"bg-primary-600 text-white":"bg-dark-800 text-gray-400 hover:bg-dark-700"}`,children:[e.jsx(la,{size:20}),e.jsx("span",{children:"Google Sheets"})]})]}),a==="file"&&e.jsx("div",{className:"mt-6 space-y-4",children:e.jsxs("div",{className:"border-2 border-dashed border-gray-600 rounded-lg p-8 text-center",children:[e.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",onChange:y,className:"hidden",id:"file-upload"}),e.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[e.jsx(es,{size:48,className:"mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"text-white mb-2",children:n?n.name:"Click to upload or drag and drop"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"CSV, XLSX, or XLS files supported"})]})]})}),a==="google-sheets"&&e.jsx("div",{className:"mt-6 space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Google Sheets URL"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(h0,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:i,onChange:S=>l(S.target.value),placeholder:"https://docs.google.com/spreadsheets/d/...",className:"input-field pl-10"})]}),e.jsx("button",{onClick:D,disabled:m,className:"btn-primary",children:m?"Fetching...":"Fetch Data"})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Note: The Google Sheet must be publicly accessible or you need to authenticate"})]})})]}),c.length>0&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white",children:["Data Preview (",c.length," records)"]}),e.jsx("div",{className:"flex space-x-2",children:e.jsx("button",{onClick:b,disabled:m,className:"btn-outline flex items-center space-x-2",children:m?e.jsxs(e.Fragment,{children:[e.jsx(aa,{size:20,className:"animate-spin"}),e.jsx("span",{children:"Validating..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(st,{size:20}),e.jsx("span",{children:"Validate"})]})})})]}),d&&e.jsxs("div",{className:"mb-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-dark-800 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(we,{size:20,className:"text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Valid Records"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:d.valid})]})]})}),e.jsx("div",{className:"bg-dark-800 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ze,{size:20,className:"text-red-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Invalid Records"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:d.invalid})]})]})}),e.jsx("div",{className:"bg-dark-800 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(la,{size:20,className:"text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Total Records"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:d.total})]})]})})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"text-left py-3 px-4 text-gray-400 font-medium",children:"Row"}),e.jsx("th",{className:"text-left py-3 px-4 text-gray-400 font-medium",children:"Name"}),e.jsx("th",{className:"text-left py-3 px-4 text-gray-400 font-medium",children:"Email"}),e.jsx("th",{className:"text-left py-3 px-4 text-gray-400 font-medium",children:"Phone"}),e.jsx("th",{className:"text-left py-3 px-4 text-gray-400 font-medium",children:"Department"}),e.jsx("th",{className:"text-left py-3 px-4 text-gray-400 font-medium",children:"Status"})]})}),e.jsx("tbody",{children:c.slice(0,10).map((S,k)=>{var T;const F=(T=d==null?void 0:d.results)==null?void 0:T.find(M=>M.row===k+1),R=(F==null?void 0:F.isValid)!==!1;return e.jsxs("tr",{className:`border-b border-gray-800 ${R?"":"bg-red-900/20"}`,children:[e.jsx("td",{className:"py-3 px-4 text-gray-300",children:k+1}),e.jsxs("td",{className:"py-3 px-4 text-white",children:[S.firstName," ",S.lastName]}),e.jsx("td",{className:"py-3 px-4 text-gray-300",children:S.email}),e.jsx("td",{className:"py-3 px-4 text-gray-300",children:S.phone}),e.jsx("td",{className:"py-3 px-4 text-gray-300",children:S.department}),e.jsx("td",{className:"py-3 px-4",children:F?R?e.jsxs("span",{className:"flex items-center space-x-1 text-green-500",children:[e.jsx(we,{size:16}),e.jsx("span",{children:"Valid"})]}):e.jsxs("span",{className:"flex items-center space-x-1 text-red-500",children:[e.jsx(ze,{size:16}),e.jsx("span",{children:"Invalid"})]}):e.jsx("span",{className:"text-gray-400",children:"Not validated"})})]},k)})})]}),c.length>10&&e.jsxs("p",{className:"text-gray-400 text-sm mt-2 text-center",children:["Showing first 10 of ",c.length," records"]})]}),d&&d.invalid>0&&e.jsxs("div",{className:"mt-4 bg-red-900/20 border border-red-500/50 rounded-lg p-4",children:[e.jsxs("h3",{className:"text-red-400 font-semibold mb-2 flex items-center space-x-2",children:[e.jsx(st,{size:20}),e.jsx("span",{children:"Validation Errors"})]}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:d.results.filter(S=>!S.isValid).map((S,k)=>e.jsxs("div",{className:"text-sm",children:[e.jsxs("p",{className:"text-white font-medium",children:["Row ",S.row,":"]}),e.jsx("ul",{className:"list-disc list-inside text-red-300 ml-4",children:S.errors.map((F,R)=>e.jsx("li",{children:F},R))})]},k))})]})]}),f&&e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-white font-semibold mb-4",children:"Upload Progress"}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-4",children:e.jsx("div",{className:"bg-primary-600 h-4 rounded-full transition-all duration-300",style:{width:`${p}%`}})}),e.jsxs("p",{className:"text-gray-400 text-sm mt-2 text-center",children:[p,"%"]})]}),c.length>0&&e.jsxs("div",{className:"flex items-center justify-end space-x-4",children:[e.jsx("button",{onClick:()=>{o([]),x(null),r(null),l("")},className:"btn-outline",children:"Clear Data"}),e.jsxs("button",{onClick:C,disabled:f||d&&d.invalid>0,className:"btn-primary flex items-center space-x-2",children:[e.jsx(es,{size:20}),e.jsx("span",{children:f?"Uploading...":"Upload Employees"})]})]}),e.jsx(Mw,{})]})},Bw=()=>{const{user:t}=kt(),[a,s]=v.useState([]),[n,r]=v.useState(!0),[i,l]=v.useState("all");v.useEffect(()=>{c()},[]);const c=async()=>{try{const g=await Y.get("/leave");s(g.data.data)}catch{E.error("Failed to load leaves")}finally{r(!1)}},o=async g=>{try{await Y.put(`/leave/${g}/approve`),E.success("Leave approved successfully"),c()}catch{E.error("Failed to approve leave")}},d=async g=>{const p=prompt("Enter rejection reason:");if(p)try{await Y.put(`/leave/${g}/reject`,{rejectionReason:p}),E.success("Leave rejected"),c()}catch{E.error("Failed to reject leave")}},x=a.filter(g=>i==="all"||g.status===i),m=g=>({pending:"badge-warning",approved:"badge-success",rejected:"badge-danger",cancelled:"badge-default"})[g]||"badge-default",h=g=>({sick:"badge-danger",casual:"badge-info",earned:"badge-success",maternity:"badge-warning",paternity:"badge-warning",unpaid:"badge-default"})[g]||"badge-default",f=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="hr";return n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Leave Management"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage leave requests"})]}),e.jsxs(Ut,{to:"/leave/apply",className:"btn-primary flex items-center space-x-2",children:[e.jsx(Pe,{size:20}),e.jsx("span",{children:"Apply Leave"})]})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("select",{value:i,onChange:g=>l(g.target.value),className:"input-field w-48",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})})}),e.jsx("div",{className:"card p-0",children:e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Employee"}),e.jsx("th",{children:"Leave Type"}),e.jsx("th",{children:"Start Date"}),e.jsx("th",{children:"End Date"}),e.jsx("th",{children:"Days"}),e.jsx("th",{children:"Reason"}),e.jsx("th",{children:"Status"}),f&&e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:x.map(g=>{var p,u,j;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-white",children:[(p=g.employee)==null?void 0:p.firstName," ",(u=g.employee)==null?void 0:u.lastName]}),e.jsx("p",{className:"text-sm text-gray-400",children:(j=g.employee)==null?void 0:j.employeeCode})]})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${h(g.leaveType)}`,children:g.leaveType})}),e.jsx("td",{children:new Date(g.startDate).toLocaleDateString()}),e.jsx("td",{children:new Date(g.endDate).toLocaleDateString()}),e.jsx("td",{children:g.numberOfDays}),e.jsx("td",{className:"max-w-xs truncate",children:g.reason}),e.jsx("td",{children:e.jsx("span",{className:`badge ${m(g.status)}`,children:g.status})}),f&&e.jsx("td",{children:g.status==="pending"&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>o(g._id),className:"p-2 text-green-400 hover:bg-dark-800 rounded",title:"Approve",children:e.jsx(Pa,{size:16})}),e.jsx("button",{onClick:()=>d(g._id),className:"p-2 text-red-400 hover:bg-dark-800 rounded",title:"Reject",children:e.jsx(Ee,{size:16})})]})})]},g._id)})})]})})}),x.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-400",children:"No leave requests found"})})]})},Uw=()=>{const t=Ke(),{user:a}=kt(),[s,n]=v.useState(!1),[r,i]=v.useState({leaveType:"casual",startDate:"",endDate:"",reason:""}),l=d=>{i({...r,[d.target.name]:d.target.value})},c=()=>{if(r.startDate&&r.endDate){const d=new Date(r.startDate),x=new Date(r.endDate),m=Math.abs(x-d);return Math.ceil(m/(1e3*60*60*24))+1}return 0},o=async d=>{var m,h;d.preventDefault(),n(!0);const x=c();if(x<=0){E.error("Invalid date range"),n(!1);return}try{await Y.post("/leave",{...r,numberOfDays:x,employee:a.employeeId}),E.success("Leave application submitted successfully"),t("/leave")}catch(f){E.error(((h=(m=f.response)==null?void 0:m.data)==null?void 0:h.message)||"Failed to apply leave")}finally{n(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>t("/leave"),className:"p-2 hover:bg-dark-800 rounded-lg",children:e.jsx(wt,{size:20,className:"text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Apply for Leave"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Submit your leave request"})]})]}),e.jsx("form",{onSubmit:o,className:"max-w-2xl",children:e.jsxs("div",{className:"card space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Leave Type *"}),e.jsxs("select",{name:"leaveType",value:r.leaveType,onChange:l,className:"input-field",required:!0,children:[e.jsx("option",{value:"casual",children:"Casual Leave"}),e.jsx("option",{value:"sick",children:"Sick Leave"}),e.jsx("option",{value:"earned",children:"Earned Leave"}),e.jsx("option",{value:"maternity",children:"Maternity Leave"}),e.jsx("option",{value:"paternity",children:"Paternity Leave"}),e.jsx("option",{value:"unpaid",children:"Unpaid Leave"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Date *"}),e.jsx("input",{type:"date",name:"startDate",value:r.startDate,onChange:l,className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"End Date *"}),e.jsx("input",{type:"date",name:"endDate",value:r.endDate,onChange:l,className:"input-field",min:r.startDate,required:!0})]})]}),r.startDate&&r.endDate&&e.jsx("div",{className:"bg-primary-600/10 border border-primary-600/30 rounded-lg p-4",children:e.jsxs("p",{className:"text-primary-400",children:["Total Days: ",e.jsx("span",{className:"font-bold",children:c()})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Reason *"}),e.jsx("textarea",{name:"reason",value:r.reason,onChange:l,rows:"4",className:"input-field",placeholder:"Enter reason for leave...",required:!0})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>t("/leave"),className:"btn-outline",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:s,className:"btn-primary flex items-center space-x-2",children:[e.jsx(ds,{size:20}),e.jsx("span",{children:s?"Submitting...":"Submit Application"})]})]})]})})]})},zw=()=>{const t=[{type:"Casual Leave",total:12,used:5,remaining:7,color:"bg-blue-500"},{type:"Sick Leave",total:10,used:2,remaining:8,color:"bg-red-500"},{type:"Earned Leave",total:15,used:8,remaining:7,color:"bg-green-500"},{type:"Maternity Leave",total:90,used:0,remaining:90,color:"bg-purple-500"},{type:"Paternity Leave",total:15,used:0,remaining:15,color:"bg-yellow-500"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Leave Balance"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"View your leave balance and history"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Total Leaves"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:"142"})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center",children:e.jsx(Fe,{size:24,className:"text-white"})})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Used Leaves"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:"15"})]}),e.jsx("div",{className:"w-12 h-12 bg-red-500 rounded-lg flex items-center justify-center",children:e.jsx(Ss,{size:24,className:"text-white"})})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Remaining Leaves"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:"127"})]}),e.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-lg flex items-center justify-center",children:e.jsx(Fe,{size:24,className:"text-white"})})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-6",children:"Leave Balance by Type"}),e.jsx("div",{className:"space-y-6",children:t.map((a,s)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-white font-medium",children:a.type}),e.jsxs("span",{className:"text-gray-400 text-sm",children:[a.used," / ",a.total," days used"]})]}),e.jsx("div",{className:"w-full bg-dark-800 rounded-full h-3",children:e.jsx("div",{className:`${a.color} h-3 rounded-full transition-all duration-300`,style:{width:`${a.used/a.total*100}%`}})}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["Remaining: ",a.remaining," days"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[Math.round(a.remaining/a.total*100),"% available"]})]})]},s))})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Recent Leave History"}),e.jsx("div",{className:"space-y-4",children:[{type:"Casual Leave",dates:"Jan 15 - Jan 17, 2024",days:3,status:"Approved"},{type:"Sick Leave",dates:"Dec 20 - Dec 21, 2023",days:2,status:"Approved"},{type:"Earned Leave",dates:"Nov 10 - Nov 15, 2023",days:6,status:"Approved"}].map((a,s)=>e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-dark-800 last:border-0",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:a.type}),e.jsx("p",{className:"text-sm text-gray-400",children:a.dates})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-white",children:[a.days," days"]}),e.jsx("span",{className:"badge badge-success text-xs",children:a.status})]})]},s))})]})]})},Hw=()=>{const[t,a]=v.useState(new Date),[s,n]=v.useState({}),[r,i]=v.useState(!0),[l,c]=v.useState(null),[o,d]=v.useState({department:"",leaveType:""}),[x,m]=v.useState([]),[h,f]=v.useState(!1),g=["Personal Leave","Sick Leave","Casual Leave","Comp Offs","Floater Leave","Marriage Leave","Maternity Leave","Paternity Leave","Unpaid Leave"];v.useEffect(()=>{p(),u()},[t,o]);const p=async()=>{try{const S=await Y.get("/departments");m(S.data.data||[])}catch(S){console.error("Error fetching departments:",S)}},u=async()=>{var S;try{i(!0);const k=t.getFullYear(),F=t.getMonth(),R=new Date(k,F,1).toISOString(),T=new Date(k,F+1,0).toISOString(),M={startDate:R,endDate:T,...o.department&&{department:o.department},...o.leaveType&&{leaveType:o.leaveType}},X=await Y.get("/dashboard/leave-calendar",{params:M});n(((S=X.data.data)==null?void 0:S.calendar)||{})}catch(k){console.error("Error fetching leave calendar:",k),E.error("Failed to load leave calendar")}finally{i(!1)}},j=()=>{const S=t.getFullYear(),k=t.getMonth(),F=new Date(S,k,1),T=new Date(S,k+1,0).getDate(),M=F.getDay(),X=[];for(let q=0;q<M;q++)X.push(null);for(let q=1;q<=T;q++)X.push(new Date(S,k,q));return X},y=S=>{if(!S)return[];const k=S.toISOString().split("T")[0];return s[k]||[]},N=S=>{a(k=>{const F=new Date(k);return S==="prev"?F.setMonth(F.getMonth()-1):F.setMonth(F.getMonth()+1),F})},w=S=>S.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),D=S=>{if(!S)return!1;const k=new Date;return S.toDateString()===k.toDateString()},b=j(),C=l?y(l):[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Leave Calendar"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"View employees on leave by date"})]}),e.jsxs("button",{onClick:()=>f(!h),className:"btn-outline flex items-center space-x-2",children:[e.jsx(xs,{size:18}),e.jsx("span",{children:"Filters"})]})]}),h&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Filters"}),e.jsx("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:20})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Department"}),e.jsxs("select",{value:o.department,onChange:S=>d({...o,department:S.target.value}),className:"input-field",children:[e.jsx("option",{value:"",children:"All Departments"}),x.map(S=>e.jsx("option",{value:S._id,children:S.name},S._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Leave Type"}),e.jsxs("select",{value:o.leaveType,onChange:S=>d({...o,leaveType:S.target.value}),className:"input-field",children:[e.jsx("option",{value:"",children:"All Leave Types"}),g.map(S=>e.jsx("option",{value:S,children:S},S))]})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("button",{onClick:()=>N("prev"),className:"p-2 hover:bg-dark-800 rounded-lg transition-colors",children:e.jsx(vi,{size:20,className:"text-gray-400"})}),e.jsx("h2",{className:"text-xl font-bold text-white",children:t.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),e.jsx("button",{onClick:()=>N("next"),className:"p-2 hover:bg-dark-800 rounded-lg transition-colors",children:e.jsx(jr,{size:20,className:"text-gray-400"})})]}),r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-7 gap-2 mb-4",children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(S=>e.jsx("div",{className:"text-center text-sm font-semibold text-gray-400 py-2",children:S},S)),b.map((S,k)=>{const F=y(S),R=D(S);return e.jsx("div",{onClick:()=>S&&c(S),className:`
                      min-h-[80px] p-2 rounded-lg border transition-all cursor-pointer
                      ${S?"border-dark-800 hover:border-primary-600":"border-transparent"}
                      ${R?"bg-primary-600/20 border-primary-600":"bg-dark-800/50"}
                      ${l&&S&&S.toDateString()===l.toDateString()?"ring-2 ring-primary-600":""}
                    `,children:S&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`text-sm font-medium mb-1 ${R?"text-primary-400":"text-gray-300"}`,children:S.getDate()}),F.length>0&&e.jsxs("div",{className:"space-y-1",children:[F.slice(0,2).map((T,M)=>e.jsx("div",{className:"text-xs px-1 py-0.5 rounded bg-yellow-500/20 text-yellow-400 truncate",title:`${T.employeeName} - ${T.leaveType}`,children:T.employeeName.split(" ")[0]},M)),F.length>2&&e.jsxs("div",{className:"text-xs text-gray-400",children:["+",F.length-2," more"]})]})]})},k)})]}),l&&C.length>0&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-dark-800",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4",children:["Leaves on ",w(l)]}),e.jsx("div",{className:"space-y-3",children:C.map(S=>e.jsx("div",{className:"bg-dark-800/50 rounded-lg p-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Re,{size:16,className:"text-gray-400"}),e.jsx("h4",{className:"font-semibold text-white",children:S.employeeName}),S.employeeCode&&e.jsxs("span",{className:"text-xs text-gray-400",children:["(",S.employeeCode,")"]})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{className:"text-gray-400",children:[e.jsx("span",{className:"text-white font-medium",children:"Leave Type:"})," ",S.leaveType]}),e.jsxs("p",{className:"text-gray-400",children:[e.jsx("span",{className:"text-white font-medium",children:"Duration:"})," ",new Date(S.startDate).toLocaleDateString()," - ",new Date(S.endDate).toLocaleDateString()," ","(",S.numberOfDays," day",S.numberOfDays!==1?"s":"",")"]}),S.reason&&e.jsxs("p",{className:"text-gray-400",children:[e.jsx("span",{className:"text-white font-medium",children:"Reason:"})," ",S.reason]})]})]})})},S.id))})]})]})]})]})},Mc=()=>{const[t,a]=v.useState([]),[s,n]=v.useState(!0),[r,i]=v.useState(""),[l,c]=v.useState("");v.useEffect(()=>{o()},[]);const o=async()=>{try{const x={};r&&(x.startDate=r),l&&(x.endDate=l);const m=await Y.get("/attendance",{params:x});a(m.data.data)}catch{E.error("Failed to load attendance")}finally{n(!1)}},d=x=>({present:"badge-success",absent:"badge-danger","half-day":"badge-warning","on-leave":"badge-info",holiday:"badge-default",weekend:"badge-default"})[x]||"badge-default";return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Attendance"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"View attendance records"})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:r,onChange:x=>i(x.target.value),className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:l,onChange:x=>c(x.target.value),className:"input-field"})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:o,className:"btn-primary w-full",children:[e.jsx(rt,{size:20,className:"inline mr-2"}),"Search"]})})]})}),e.jsx("div",{className:"card p-0",children:e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Employee"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Check In"}),e.jsx("th",{children:"Check Out"}),e.jsx("th",{children:"Work Hours"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Location"})]})}),e.jsx("tbody",{children:t.map(x=>{var m,h,f;return e.jsxs("tr",{children:[e.jsxs("td",{children:[(m=x.employee)==null?void 0:m.firstName," ",(h=x.employee)==null?void 0:h.lastName]}),e.jsx("td",{children:new Date(x.date).toLocaleDateString()}),e.jsx("td",{children:x.checkIn?new Date(x.checkIn).toLocaleTimeString():"-"}),e.jsx("td",{children:x.checkOut?new Date(x.checkOut).toLocaleTimeString():"-"}),e.jsxs("td",{children:[((f=x.workHours)==null?void 0:f.toFixed(2))||0," hrs"]}),e.jsx("td",{children:e.jsx("span",{className:`badge ${d(x.status)}`,children:x.status})}),e.jsx("td",{className:"capitalize",children:x.location})]},x._id)})})]})})})]})},qw=()=>{const[t,a]=v.useState([]),[s,n]=v.useState(!1),[r,i]=v.useState(new Date().toISOString().split("T")[0]),[l,c]=v.useState([]);v.useEffect(()=>{o()},[]);const o=async()=>{try{const m=await Y.get("/employees?status=active");a(m.data.data),c(m.data.data.map(h=>({employee:h._id,status:"present",checkIn:"09:00",checkOut:"18:00",location:"office"})))}catch{E.error("Failed to load employees")}},d=(m,h,f)=>{const g=[...l];g[m][h]=f,c(g)},x=async m=>{m.preventDefault(),n(!0);try{const h=l.map(f=>Y.post("/attendance",{...f,date:r,checkIn:`${r}T${f.checkIn}`,checkOut:`${r}T${f.checkOut}`}));await Promise.all(h),E.success("Attendance marked successfully")}catch{E.error("Failed to mark attendance")}finally{n(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Mark Attendance"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Mark daily attendance for employees"})]}),e.jsxs("form",{onSubmit:x,children:[e.jsxs("div",{className:"card mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Date"}),e.jsx("input",{type:"date",value:r,onChange:m=>i(m.target.value),className:"input-field max-w-xs",required:!0})]}),e.jsx("div",{className:"card p-0",children:e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Employee"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Check In"}),e.jsx("th",{children:"Check Out"}),e.jsx("th",{children:"Location"})]})}),e.jsx("tbody",{children:t.map((m,h)=>{var f,g,p,u;return e.jsxs("tr",{children:[e.jsxs("td",{children:[m.firstName," ",m.lastName]}),e.jsx("td",{children:e.jsxs("select",{value:(f=l[h])==null?void 0:f.status,onChange:j=>d(h,"status",j.target.value),className:"input-field",children:[e.jsx("option",{value:"present",children:"Present"}),e.jsx("option",{value:"absent",children:"Absent"}),e.jsx("option",{value:"half-day",children:"Half Day"}),e.jsx("option",{value:"on-leave",children:"On Leave"})]})}),e.jsx("td",{children:e.jsx("input",{type:"time",value:(g=l[h])==null?void 0:g.checkIn,onChange:j=>d(h,"checkIn",j.target.value),className:"input-field"})}),e.jsx("td",{children:e.jsx("input",{type:"time",value:(p=l[h])==null?void 0:p.checkOut,onChange:j=>d(h,"checkOut",j.target.value),className:"input-field"})}),e.jsx("td",{children:e.jsxs("select",{value:(u=l[h])==null?void 0:u.location,onChange:j=>d(h,"location",j.target.value),className:"input-field",children:[e.jsx("option",{value:"office",children:"Office"}),e.jsx("option",{value:"remote",children:"Remote"}),e.jsx("option",{value:"field",children:"Field"})]})})]},m._id)})})]})})}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsxs("button",{type:"submit",disabled:s,className:"btn-primary flex items-center space-x-2",children:[e.jsx(ds,{size:20}),e.jsx("span",{children:s?"Saving...":"Save Attendance"})]})})]})]})},Ww=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Attendance Reports"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"View and download attendance reports"})]}),e.jsxs("button",{className:"btn-primary flex items-center space-x-2",children:[e.jsx(_t,{size:20}),e.jsx("span",{children:"Export Report"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Average Attendance"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:"92.5%"})]}),e.jsxs("div",{className:"card",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Total Present"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:"1,850"})]}),e.jsxs("div",{className:"card",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Total Absent"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:"150"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center space-x-2",children:[e.jsx(u0,{size:20}),e.jsx("span",{children:"Monthly Attendance Trend"})]}),e.jsx("div",{className:"h-64 flex items-center justify-center text-gray-400",children:"Chart visualization would go here"})]})]}),$c=()=>{const[t,a]=v.useState([]),[s,n]=v.useState(!0);v.useEffect(()=>{r()},[]);const r=async()=>{try{const l=await Y.get("/payroll");a(l.data.data)}catch{E.error("Failed to load payroll")}finally{n(!1)}},i=l=>({pending:"badge-warning",processing:"badge-info",paid:"badge-success",failed:"badge-danger"})[l]||"badge-default";return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Payroll"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage employee payroll"})]}),e.jsxs(Ut,{to:"/payroll/generate",className:"btn-primary flex items-center space-x-2",children:[e.jsx(Pe,{size:20}),e.jsx("span",{children:"Generate Payroll"})]})]}),e.jsx("div",{className:"card p-0",children:e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Employee"}),e.jsx("th",{children:"Month/Year"}),e.jsx("th",{children:"Basic Salary"}),e.jsx("th",{children:"Total Earnings"}),e.jsx("th",{children:"Deductions"}),e.jsx("th",{children:"Net Salary"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:t.map(l=>{var c,o;return e.jsxs("tr",{children:[e.jsxs("td",{children:[(c=l.employee)==null?void 0:c.firstName," ",(o=l.employee)==null?void 0:o.lastName]}),e.jsxs("td",{children:[l.month,"/",l.year]}),e.jsxs("td",{children:["$",l.basicSalary]}),e.jsxs("td",{children:["$",l.totalEarnings]}),e.jsxs("td",{children:["$",l.totalDeductions]}),e.jsxs("td",{className:"font-bold",children:["$",l.netSalary]}),e.jsx("td",{children:e.jsx("span",{className:`badge ${i(l.paymentStatus)}`,children:l.paymentStatus})})]},l._id)})})]})})})]})},Vw=()=>{var x,m,h;const t=Ke(),[a,s]=v.useState(new Date().getMonth()+1),[n,r]=v.useState(new Date().getFullYear()),[i,l]=v.useState(!1),[c,o]=v.useState(null),d=async()=>{var f,g;if(!a||!n){E.error("Please select month and year");return}l(!0),o(null);try{const p=await Y.post("/payroll/bulk-generate",{month:parseInt(a),year:parseInt(n)});p.data.success&&(E.success(p.data.message),o(p.data.data))}catch(p){E.error(((g=(f=p==null?void 0:p.response)==null?void 0:f.data)==null?void 0:g.message)||"Failed to generate payroll")}finally{l(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>t("/payroll"),className:"p-2 hover:bg-dark-800 rounded-lg",children:e.jsx(wt,{size:20,className:"text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Generate Payroll"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Generate payroll for selected period"})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Month"}),e.jsx("select",{value:a,onChange:f=>s(f.target.value),className:"input-field",disabled:i,children:Array.from({length:12},(f,g)=>e.jsx("option",{value:g+1,children:new Date(2024,g).toLocaleString("default",{month:"long"})},g+1))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Year"}),e.jsx("input",{type:"number",value:n,onChange:f=>r(f.target.value),className:"input-field",disabled:i,min:"2020",max:"2099"})]})]}),e.jsxs("button",{onClick:d,className:"btn-primary mt-6 flex items-center space-x-2",disabled:i,children:[i&&e.jsx(cs,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:i?"Generating...":"Generate Payroll"})]}),c&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-800 rounded-lg",children:[e.jsx("h3",{className:"text-white font-semibold mb-3",children:"Generation Results"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Created"}),e.jsx("p",{className:"text-green-400 font-bold text-xl",children:((x=c.created)==null?void 0:x.length)||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Skipped"}),e.jsx("p",{className:"text-yellow-400 font-bold text-xl",children:((m=c.skipped)==null?void 0:m.length)||0})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Errors"}),e.jsx("p",{className:"text-red-400 font-bold text-xl",children:((h=c.errors)==null?void 0:h.length)||0})]})]}),c.errors&&c.errors.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-red-400 text-sm font-semibold mb-2",children:"Errors:"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-400",children:c.errors.map((f,g)=>e.jsxs("li",{children:[f.employee,": ",f.error]},g))})]})]})]})]})},Gw=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Salary Slips"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Download your salary slips"})]}),e.jsx("div",{className:"card",children:e.jsx("p",{className:"text-gray-400",children:"Salary slips will be available here for download"})})]}),Yw=()=>{const[t,a]=v.useState([]),[s,n]=v.useState(!0);v.useEffect(()=>{r()},[]);const r=async()=>{try{const i=await Y.get("/departments");a(i.data.data)}catch{E.error("Failed to load departments")}finally{n(!1)}};return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Departments"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage organization departments"})]}),e.jsxs("button",{className:"btn-primary flex items-center space-x-2",children:[e.jsx(Pe,{size:20}),e.jsx("span",{children:"Add Department"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(i=>e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:i.name}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:i.code}),e.jsx("p",{className:"text-sm text-gray-300",children:i.description||"No description"}),i.head&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-dark-800",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Department Head"}),e.jsxs("p",{className:"text-sm text-white",children:[i.head.firstName," ",i.head.lastName]})]})]},i._id))})]})},Ka={getRoleConfigs:()=>Y.get("/tenant/roles/configs"),createEmployeeRole:t=>Y.post("/tenant/roles",t),getRolesAndUsers:t=>Y.get("/tenant/roles",{params:{clientId:t}}),updateUserStatus:(t,a)=>Y.put(`/tenant/roles/users/${t}/status`,{...a,clientId:"6914486fef016d63d6ac03ce"}),resetUserPassword:t=>Y.put(`/tenant/roles/users/${t}/reset-password`,{clientId:"6914486fef016d63d6ac03ce"}),tenantLogin:t=>Y.post("/tenant/auth/login",{...t,clientId:"6914486fef016d63d6ac03ce"}),changePassword:t=>Y.put("/tenant/auth/change-password",t),getProfile:()=>Y.get("/tenant/auth/profile"),updateProfile:t=>Y.put("/tenant/auth/profile",t),getEmployeeDashboard:()=>Y.get("/tenant/employee/dashboard"),getNavigationMenu:()=>Y.get("/tenant/employee/navigation")},Xw=()=>{const[t,a]=v.useState("create"),[s,n]=v.useState([]),[r,i]=v.useState({roles:[],users:[],summary:{}}),[l,c]=v.useState(!1),[o,d]=v.useState(""),[x,m]=v.useState(""),[h,f]=v.useState({roleType:"",userEmail:"",userName:"",clientId:"6914486fef016d63d6ac03ce"});v.useEffect(()=>{g(),p()},[]);const g=async()=>{var b,C;try{c(!0),console.log("Fetching role configs...");const S=await Ka.getRoleConfigs();console.log("Role configs response:",S),S.data.success?(n(S.data.data.availableRoles),console.log("Role configs loaded:",S.data.data.availableRoles)):d("Failed to fetch role configurations: "+(S.data.message||"Unknown error"))}catch(S){console.error("Error fetching role configs:",S),d("Failed to fetch role configurations: "+(((C=(b=S.response)==null?void 0:b.data)==null?void 0:C.message)||S.message))}finally{c(!1)}},p=async()=>{try{const C=await Ka.getRolesAndUsers("6914486fef016d63d6ac03ce");C.data.success&&i(C.data.data)}catch(b){console.error("Error fetching roles and users:",b),d("Failed to fetch roles and users")}},u=async b=>{var C,S;b.preventDefault(),c(!0),d(""),m("");try{console.log("ðŸš€ Creating role with data:",h);const k=await Ka.createEmployeeRole(h);console.log("âœ… Role creation response:",k),k.data.success?(m(`Role "${k.data.data.role.name}" created successfully! User credentials: ${k.data.data.user.email} / ${k.data.data.user.defaultPassword}`),f({roleType:"",userEmail:"",userName:"",clientId:"6914486fef016d63d6ac03ce"}),p()):d(k.data.message||"Failed to create role")}catch(k){console.error("âŒ Role creation error:",k);const F=((S=(C=k.response)==null?void 0:C.data)==null?void 0:S.message)||k.message||"Failed to create role";d(`Error: ${F}`),k.response&&(console.error("Error response:",k.response.data),console.error("Error status:",k.response.status))}finally{c(!1)}},j=async(b,C)=>{var S,k;try{(await Ka.updateUserStatus(b,{isActive:!C})).data.success&&(m(`User ${C?"deactivated":"activated"} successfully`),p())}catch(F){d(((k=(S=F.response)==null?void 0:S.data)==null?void 0:k.message)||"Failed to update user status")}},y=async b=>{var C,S;try{const k=await Ka.resetUserPassword(b);k.data.success&&m(`Password reset successfully. New password: ${k.data.data.defaultPassword}`)}catch(k){d(((S=(C=k.response)==null?void 0:C.data)==null?void 0:S.message)||"Failed to reset password")}},N=b=>{navigator.clipboard.writeText(b),m("Copied to clipboard!")},w=b=>({regular_employee:Re,team_lead:bt,consultant:Rs,intern:ls})[b]||Re,D=b=>({regular_employee:"bg-blue-500",team_lead:"bg-green-500",consultant:"bg-purple-500",intern:"bg-orange-500"})[b]||"bg-gray-500";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Employee Role Management"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Create and manage employee-level roles within your tenant"})]}),o&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg p-4 flex items-center gap-3",children:[e.jsx(st,{className:"h-5 w-5 text-red-400"}),e.jsx("span",{className:"text-red-400",children:o}),e.jsx("button",{onClick:()=>d(""),className:"ml-auto text-red-400 hover:text-red-300",children:e.jsx(ze,{className:"h-4 w-4"})})]}),x&&e.jsxs("div",{className:"bg-green-500/10 border border-green-500/20 rounded-lg p-4 flex items-center gap-3",children:[e.jsx(we,{className:"h-5 w-5 text-green-400"}),e.jsx("span",{className:"text-green-400",children:x}),e.jsx("button",{onClick:()=>m(""),className:"ml-auto text-green-400 hover:text-green-300",children:e.jsx(ze,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex space-x-1 bg-gray-800/50 p-1 rounded-lg",children:[e.jsxs("button",{onClick:()=>a("create"),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${t==="create"?"bg-blue-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:[e.jsx(ls,{className:"h-4 w-4 inline mr-2"}),"Create Role"]}),e.jsxs("button",{onClick:()=>a("manage"),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${t==="manage"?"bg-blue-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:[e.jsx(Re,{className:"h-4 w-4 inline mr-2"}),"Manage Users"]}),e.jsxs("button",{onClick:()=>a("overview"),className:`flex-1 py-2 px-4 rounded-md text-sm font-medium transition-colors ${t==="overview"?"bg-blue-600 text-white":"text-gray-400 hover:text-white hover:bg-gray-700"}`,children:[e.jsx(bt,{className:"h-4 w-4 inline mr-2"}),"Overview"]})]}),t==="create"&&e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-xl font-semibold text-white mb-6",children:"Create Employee Role"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:s.length>0?s.map(b=>{const C=w(b.type),S=h.roleType===b.type;return e.jsxs("div",{onClick:()=>f({...h,roleType:b.type}),className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${S?"border-blue-500 bg-blue-500/10":"border-gray-600 hover:border-gray-500 bg-gray-800/50"}`,children:[e.jsx("div",{className:`w-12 h-12 rounded-lg ${D(b.type)} flex items-center justify-center mb-3`,children:e.jsx(C,{className:"h-6 w-6 text-white"})}),e.jsx("h3",{className:"font-semibold text-white mb-1",children:b.name}),e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:b.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:["Scope: ",b.scope]}),e.jsxs("span",{className:"text-gray-500",children:[b.permissionCount," permissions"]})]})]},b.type)}):e.jsxs("div",{className:"col-span-full",children:[e.jsxs("div",{className:"text-center py-4 mb-6",children:[e.jsx("div",{className:"text-gray-400 mb-4",children:l?"Loading role configurations...":"Unable to load role configurations from API"}),e.jsxs("button",{onClick:g,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2 mx-auto",children:[e.jsx(Lt,{className:"h-4 w-4"}),"Retry Loading Roles"]})]}),e.jsxs("div",{className:"border-t border-gray-700 pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-4",children:"Or Select Role Manually:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{type:"regular_employee",name:"Regular Employee",description:"Basic employee with self-service permissions",scope:"self"},{type:"team_lead",name:"Team Lead",description:"Team leader with team management permissions",scope:"team"},{type:"consultant",name:"Consultant",description:"Consultant with timesheet and project focus",scope:"self"},{type:"intern",name:"Intern",description:"Intern with limited permissions",scope:"self"}].map(b=>{const C=w(b.type),S=h.roleType===b.type;return e.jsxs("div",{onClick:()=>f({...h,roleType:b.type}),className:`p-4 rounded-lg border-2 cursor-pointer transition-all ${S?"border-blue-500 bg-blue-500/10":"border-gray-600 hover:border-gray-500 bg-gray-800/50"}`,children:[e.jsx("div",{className:`w-12 h-12 rounded-lg ${D(b.type)} flex items-center justify-center mb-3`,children:e.jsx(C,{className:"h-6 w-6 text-white"})}),e.jsx("h3",{className:"font-semibold text-white mb-1",children:b.name}),e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:b.description}),e.jsx("div",{className:"flex items-center justify-between text-xs",children:e.jsxs("span",{className:"text-gray-500",children:["Scope: ",b.scope]})})]},b.type)})})]})]})}),h.roleType&&e.jsxs("form",{onSubmit:u,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Target Tenant ID"}),e.jsx("input",{type:"text",value:h.clientId,onChange:b=>f({...h,clientId:b.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter tenant/client ID",required:!0}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"The MongoDB ObjectId of the tenant where this role will be created"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"User Name"}),e.jsx("input",{type:"text",value:h.userName,onChange:b=>f({...h,userName:b.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter user full name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address"}),e.jsx("input",{type:"email",value:h.userEmail,onChange:b=>f({...h,userEmail:b.target.value}),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"user@company.com",required:!0})]})]})]}),e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-yellow-400 mb-2",children:"Default Credentials"}),e.jsxs("p",{className:"text-sm text-gray-300",children:["The user will be created with the default password: ",e.jsx("code",{className:"bg-gray-700 px-2 py-1 rounded",children:"password123"})]}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"They will be required to change this password on first login."})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{type:"submit",disabled:l,className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-800 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[l?e.jsx(Lt,{className:"h-4 w-4 animate-spin"}):e.jsx(ls,{className:"h-4 w-4"}),l?"Creating...":"Create Role & User"]})})]})]}),t==="manage"&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Manage Users"}),e.jsxs("button",{onClick:p,className:"px-4 py-2 bg-gray-700 text-white rounded-md hover:bg-gray-600 flex items-center gap-2",children:[e.jsx(Lt,{className:"h-4 w-4"}),"Refresh"]})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-700",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-300",children:"User"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-300",children:"Role"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-300",children:"Scope"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-300",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-300",children:"First Login"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{children:r.users.map(b=>{const C=w(b.roleSlug);return e.jsxs("tr",{className:"border-b border-gray-800 hover:bg-gray-800/50",children:[e.jsx("td",{className:"py-4 px-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full ${D(b.roleSlug)} flex items-center justify-center`,children:e.jsx(C,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:b.name}),e.jsxs("div",{className:"text-sm text-gray-400 flex items-center gap-1",children:[e.jsx(ut,{className:"h-3 w-3"}),b.email,e.jsx("button",{onClick:()=>N(b.email),className:"ml-1 text-gray-500 hover:text-gray-300",children:e.jsx(ji,{className:"h-3 w-3"})})]})]})]})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("span",{className:"text-white font-medium",children:b.roleName})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("span",{className:"text-gray-300 capitalize",children:b.scope})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${b.isActive?"bg-green-500/10 text-green-400":"bg-red-500/10 text-red-400"}`,children:b.isActive?"Active":"Inactive"})}),e.jsx("td",{className:"py-4 px-4",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${b.isFirstLogin?"bg-yellow-500/10 text-yellow-400":"bg-gray-500/10 text-gray-400"}`,children:b.isFirstLogin?"Pending":"Completed"})}),e.jsx("td",{className:"py-4 px-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>j(b.id,b.isActive),className:`p-2 rounded-md ${b.isActive?"text-red-400 hover:bg-red-500/10":"text-green-400 hover:bg-green-500/10"}`,title:b.isActive?"Deactivate User":"Activate User",children:b.isActive?e.jsx(hn,{className:"h-4 w-4"}):e.jsx(Rt,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>y(b.id),className:"p-2 text-blue-400 hover:bg-blue-500/10 rounded-md",title:"Reset Password",children:e.jsx(Lt,{className:"h-4 w-4"})})]})})]},b.id)})})]}),r.users.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-400",children:"No users found. Create your first employee role to get started."})]})]}),t==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-400",children:"Total Roles"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:r.summary.totalRoles||0})]}),e.jsx(bt,{className:"h-8 w-8 text-blue-400"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-400",children:"Total Users"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:r.summary.totalUsers||0})]}),e.jsx(Re,{className:"h-8 w-8 text-green-400"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-400",children:"Active Users"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:r.summary.activeUsers||0})]}),e.jsx(we,{className:"h-8 w-8 text-green-400"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-400",children:"First Time Users"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:r.summary.firstTimeUsers||0})]}),e.jsx(st,{className:"h-8 w-8 text-yellow-400"})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Roles Overview"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:r.roles.map(b=>{const C=w(b.slug);return e.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg ${D(b.slug)} flex items-center justify-center`,children:e.jsx(C,{className:"h-5 w-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white",children:b.name}),e.jsxs("p",{className:"text-sm text-gray-400 capitalize",children:[b.scope," scope"]})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Users:"}),e.jsx("span",{className:"text-white",children:b.userCount})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Permissions:"}),e.jsx("span",{className:"text-white",children:b.permissionCount})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Type:"}),e.jsx("span",{className:"text-white",children:b.isSystemRole?"System":"Custom"})]})]})]},b.id)})}),r.roles.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-400",children:"No roles created yet. Start by creating your first employee role."})]})]})]})},Kw=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Policies"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage company policies"})]}),e.jsx("div",{className:"card",children:e.jsx("p",{className:"text-gray-400",children:"Policy management interface coming soon"})})]}),Jw=()=>{var j;const[t,a]=v.useState([]),[s,n]=v.useState(!0),[r,i]=v.useState(!1),[l,c]=v.useState(null),[o,d]=v.useState({newPassword:"",confirmPassword:"",mustChangePassword:!0}),[x,m]=v.useState(!1);v.useEffect(()=>{h()},[]);const h=async()=>{try{const y=await Y.get("/user/all");a(y.data.data)}catch(y){E.error("Failed to load users"),console.error("Error loading users:",y)}finally{n(!1)}},f=async y=>{var N,w,D;if(y.preventDefault(),o.newPassword!==o.confirmPassword){E.error("Passwords do not match");return}if(o.newPassword.length<8){E.error("Password must be at least 8 characters long");return}m(!0);try{const b=l._id||((N=l.userId)==null?void 0:N._id);if(!b){E.error("User ID not found"),m(!1);return}console.log("Resetting password for user ID:",b),await Y.put(`/auth/admin/reset-password/${b}`,{newPassword:o.newPassword,mustChangePassword:o.mustChangePassword}),E.success(`Password reset successfully for ${l.firstName} ${l.lastName}`),i(!1),c(null),d({newPassword:"",confirmPassword:"",mustChangePassword:!0})}catch(b){console.error("Password reset error:",b),E.error(((D=(w=b.response)==null?void 0:w.data)==null?void 0:D.message)||"Failed to reset password")}finally{m(!1)}},g=y=>{c(y),i(!0)},p=()=>{i(!1),c(null),d({newPassword:"",confirmPassword:"",mustChangePassword:!0})},u=y=>({admin:"badge-danger",hr:"badge-warning",manager:"badge-info",employee:"badge-success"})[y]||"badge-default";return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"User Management"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage user accounts and reset passwords"})]})}),e.jsx("div",{className:"card p-0",children:e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Employee"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Last Login"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:t.map(y=>{var N;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white",children:y.employeeId?`${y.employeeId.firstName} ${y.employeeId.lastName}`:"N/A"}),e.jsx("p",{className:"text-sm text-gray-400",children:((N=y.employeeId)==null?void 0:N.employeeCode)||"N/A"})]})}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ut,{size:16,className:"text-gray-400"}),e.jsx("span",{children:y.email})]})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${u(y.role)}`,children:y.role})}),e.jsx("td",{children:y.isActive?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-danger",children:"Inactive"})}),e.jsx("td",{children:y.lastLogin?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{size:16,className:"text-gray-400"}),e.jsx("span",{className:"text-sm",children:new Date(y.lastLogin).toLocaleDateString()})]}):e.jsx("span",{className:"text-gray-500",children:"Never"})}),e.jsx("td",{children:e.jsxs("button",{onClick:()=>g(y),className:"btn-outline text-sm py-2 px-3 flex items-center space-x-2",children:[e.jsx(ho,{size:16}),e.jsx("span",{children:"Reset Password"})]})})]},y._id)})})]})})}),t.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Re,{size:48,className:"mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No users found"})]}),r&&l&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-900 rounded-xl w-full max-w-md",children:[e.jsxs("div",{className:"border-b border-dark-800 p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Reset Password"}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:[l.firstName," ",l.lastName," (",(j=l.userId)==null?void 0:j.email,")"]})]}),e.jsx("button",{onClick:p,className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:24})})]}),e.jsxs("form",{onSubmit:f,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"New Password *"}),e.jsx("input",{type:"password",required:!0,value:o.newPassword,onChange:y=>d({...o,newPassword:y.target.value}),className:"input-field",placeholder:"Enter new password (min 8 characters)",minLength:8})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Confirm Password *"}),e.jsx("input",{type:"password",required:!0,value:o.confirmPassword,onChange:y=>d({...o,confirmPassword:y.target.value}),className:"input-field",placeholder:"Confirm new password",minLength:8})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"mustChangePassword",checked:o.mustChangePassword,onChange:y=>d({...o,mustChangePassword:y.target.checked}),className:"w-4 h-4 text-primary-600 bg-dark-800 border-dark-700 rounded focus:ring-primary-500"}),e.jsx("label",{htmlFor:"mustChangePassword",className:"text-sm text-gray-300",children:"Require user to change password on next login"})]}),e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(bt,{size:20,className:"text-yellow-500 mt-0.5"}),e.jsxs("div",{className:"text-sm text-yellow-200",children:[e.jsx("p",{className:"font-medium mb-1",children:"Security Notice"}),e.jsx("p",{className:"text-yellow-300/80",children:"The user will be able to login with this new password immediately. Make sure to communicate the new password securely."})]})]})}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:p,className:"btn-outline",disabled:x,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:x,children:x?"Resetting...":"Reset Password"})]})]})]})})]})},tl=["Personal Leave","Sick Leave","Casual Leave","Comp Offs","Floater Leave","Marriage Leave","Maternity Leave","Paternity Leave","Unpaid Leave"],Qw=()=>{const[t,a]=v.useState(!0),[s,n]=v.useState({defaults:[],overrides:[],summary:{}}),[r,i]=v.useState([]),[l,c]=v.useState(!1),[o,d]=v.useState(!1),[x,m]=v.useState(!1),[h,f]=v.useState(null),[g,p]=v.useState(null),[u,j]=v.useState({leaveType:"",yearlyAllocation:0,accrualFrequency:"yearly",carryForwardEnabled:!1,maxCarryForward:0,isActive:!0}),[y,N]=v.useState({leaveType:"",yearlyAllocation:0,applicableTo:"specific-departments",departments:[],designations:[],locations:[],accrualFrequency:"yearly",carryForwardEnabled:!1,maxCarryForward:0,isActive:!0}),[w,D]=v.useState(new Date().getFullYear()),[b,C]=v.useState(!1);v.useEffect(()=>{S()},[]);const S=async()=>{try{a(!0);const[B,K]=await Promise.all([Y.get("/leave-management/quotas"),Y.get("/departments")]);n(B.data.data),i(K.data.data||[])}catch(B){E.error("Failed to load leave management data"),console.error(B)}finally{a(!1)}},k=B=>{f(B),j({leaveType:B.leaveType,yearlyAllocation:B.default.yearlyAllocation||0,accrualFrequency:B.default.accrualFrequency||"yearly",carryForwardEnabled:B.default.carryForwardEnabled||!1,maxCarryForward:B.default.maxCarryForward||0,isActive:B.default.isActive!==!1}),c(!0)},F=async B=>{var K,Q;B.preventDefault();try{await Y.post("/leave-management/quota/default",u),E.success("Default quota saved successfully"),c(!1),f(null),S()}catch(_){E.error(((Q=(K=_.response)==null?void 0:K.data)==null?void 0:Q.message)||"Failed to save default quota")}},R=()=>{p(null),N({leaveType:"",yearlyAllocation:0,applicableTo:"specific-departments",departments:[],designations:[],locations:[],accrualFrequency:"yearly",carryForwardEnabled:!1,maxCarryForward:0,isActive:!0}),d(!0)},T=B=>{var K;p(B),N({leaveType:B.leaveType,yearlyAllocation:B.yearlyAllocation||0,applicableTo:B.applicableTo,departments:((K=B.departments)==null?void 0:K.map(Q=>Q._id||Q))||[],designations:B.designations||[],locations:B.locations||[],accrualFrequency:B.accrualFrequency||"yearly",carryForwardEnabled:B.carryForwardEnabled||!1,maxCarryForward:B.maxCarryForward||0,isActive:B.isActive!==!1}),d(!0)},M=async B=>{var K,Q;B.preventDefault();try{g?(await Y.put(`/leave-management/quota/override/${g._id}`,y),E.success("Override updated successfully")):(await Y.post("/leave-management/quota/override",y),E.success("Override created successfully")),d(!1),p(null),S()}catch(_){E.error(((Q=(K=_.response)==null?void 0:K.data)==null?void 0:Q.message)||"Failed to save override")}},X=async B=>{if(window.confirm("Are you sure you want to delete this override?"))try{await Y.delete(`/leave-management/quota/override/${B}`),E.success("Override deleted successfully"),S()}catch{E.error("Failed to delete override")}},q=async()=>{var B,K;try{C(!0);const Q=await Y.post("/leave-management/quota/apply",{year:w});E.success(`Quotas applied successfully! Applied: ${Q.data.data.applied}, Skipped: ${Q.data.data.skipped}`),m(!1)}catch(Q){E.error(((K=(B=Q.response)==null?void 0:B.data)==null?void 0:K.message)||"Failed to apply quotas")}finally{C(!1)}};return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Leave Management"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Configure leave quotas for all employees"})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("button",{onClick:()=>m(!0),className:"btn-primary flex items-center space-x-2",children:[e.jsx(Re,{size:18}),e.jsx("span",{children:"Apply to Employees"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-500",children:e.jsx(Fe,{size:20,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Total Categories"}),e.jsx("p",{className:"text-xl font-bold text-white",children:s.summary.totalCategories||tl.length})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-green-500",children:e.jsx(we,{size:20,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Active Defaults"}),e.jsx("p",{className:"text-xl font-bold text-white",children:s.summary.activeDefaults||0})]})]})}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-purple-500",children:e.jsx(Rs,{size:20,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Group Overrides"}),e.jsx("p",{className:"text-xl font-bold text-white",children:s.summary.totalOverrides||0})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Default Leave Quotas"}),e.jsx("p",{className:"text-sm text-gray-400",children:"These quotas apply to all employees by default"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Leave Category"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Yearly Allocation"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Accrual Frequency"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Carry Forward"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:s.defaults.map(B=>e.jsxs("tr",{className:"hover:bg-gray-800/50",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-white font-medium",children:B.leaveType}),e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-300",children:[B.default.yearlyAllocation||0," days"]}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300 capitalize",children:B.default.accrualFrequency||"yearly"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:B.default.carryForwardEnabled?e.jsxs("span",{className:"text-green-400",children:["Yes (",B.default.maxCarryForward||0," days)"]}):e.jsx("span",{className:"text-gray-500",children:"No"})}),e.jsx("td",{className:"px-4 py-3",children:B.default.isActive!==!1?e.jsxs("span",{className:"flex items-center space-x-1 text-green-400",children:[e.jsx(we,{size:16}),e.jsx("span",{children:"Active"})]}):e.jsxs("span",{className:"flex items-center space-x-1 text-gray-500",children:[e.jsx(ze,{size:16}),e.jsx("span",{children:"Inactive"})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("button",{onClick:()=>k(B),className:"text-blue-400 hover:text-blue-300 flex items-center space-x-1",children:[e.jsx(fs,{size:16}),e.jsx("span",{children:"Edit"})]})})]},B.leaveType))})]})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Group Overrides"}),e.jsxs("button",{onClick:R,className:"btn-primary flex items-center space-x-2",children:[e.jsx(Pe,{size:18}),e.jsx("span",{children:"Add Override"})]})]}),s.overrides.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(p0,{size:48,className:"mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No group overrides configured"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Create overrides to set different quotas for specific departments, designations, or locations"})]}):e.jsx("div",{className:"space-y-4",children:s.overrides.map(B=>{var K,Q,_;return e.jsx("div",{className:"p-4 bg-gray-800/50 rounded-lg border border-gray-700",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-white font-medium",children:B.leaveType}),e.jsxs("span",{className:"text-sm text-gray-400",children:[B.yearlyAllocation," days/year"]}),B.isActive?e.jsx("span",{className:"badge badge-success",children:"Active"}):e.jsx("span",{className:"badge badge-warning",children:"Inactive"})]}),e.jsx("div",{className:"text-sm text-gray-400",children:e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Applies to:"})," ",B.applicableTo==="specific-departments"&&e.jsxs("span",{children:["Departments: ",((K=B.departments)==null?void 0:K.map(ne=>ne.name||ne).join(", "))||"None"]}),B.applicableTo==="specific-designations"&&e.jsxs("span",{children:["Designations: ",((Q=B.designations)==null?void 0:Q.join(", "))||"None"]}),B.applicableTo==="specific-locations"&&e.jsxs("span",{children:["Locations: ",((_=B.locations)==null?void 0:_.join(", "))||"None"]})]})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>T(B),className:"text-blue-400 hover:text-blue-300 p-2",children:e.jsx(fs,{size:18})}),e.jsx("button",{onClick:()=>X(B._id),className:"text-red-400 hover:text-red-300 p-2",children:e.jsx(ct,{size:18})})]})]})},B._id)})})]}),l&&e.jsx(Zw,{formData:u,setFormData:j,onClose:()=>{c(!1),f(null)},onSave:F,leaveType:h==null?void 0:h.leaveType}),o&&e.jsx(e1,{formData:y,setFormData:N,departments:r,onClose:()=>{d(!1),p(null)},onSave:M,isEditing:!!g}),x&&e.jsx(t1,{year:w,setYear:D,onClose:()=>m(!1),onApply:q,applying:b})]})},Zw=({formData:t,setFormData:a,onClose:s,onSave:n,leaveType:r})=>{const i=l=>{const{name:c,value:o,type:d,checked:x}=l.target;a(m=>({...m,[c]:d==="checkbox"?x:d==="number"?parseFloat(o)||0:o}))};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:r?`Edit ${r}`:"Set Default Quota"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:24})})]}),e.jsxs("form",{onSubmit:n,className:"space-y-4",children:[r&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Leave Category"}),e.jsx("input",{type:"text",value:r,disabled:!0,className:"input-field w-full bg-gray-700"})]}),!r&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Leave Category *"}),e.jsxs("select",{name:"leaveType",value:t.leaveType,onChange:i,className:"input-field w-full",required:!0,children:[e.jsx("option",{value:"",children:"Select Leave Type"}),tl.map(l=>e.jsx("option",{value:l,children:l},l))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Yearly Allocation (days) *"}),e.jsx("input",{type:"number",name:"yearlyAllocation",value:t.yearlyAllocation,onChange:i,className:"input-field w-full",min:"0",step:"0.5",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Accrual Frequency"}),e.jsxs("select",{name:"accrualFrequency",value:t.accrualFrequency,onChange:i,className:"input-field w-full",children:[e.jsx("option",{value:"yearly",children:"Yearly (one-time allocation)"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"quarterly",children:"Quarterly"}),e.jsx("option",{value:"one-time",children:"One-time"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",name:"carryForwardEnabled",checked:t.carryForwardEnabled,onChange:i,className:"rounded"}),e.jsx("label",{className:"text-sm text-gray-300",children:"Enable Carry Forward"})]}),t.carryForwardEnabled&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Max Carry Forward (days)"}),e.jsx("input",{type:"number",name:"maxCarryForward",value:t.maxCarryForward,onChange:i,className:"input-field w-full",min:"0"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",name:"isActive",checked:t.isActive,onChange:i,className:"rounded"}),e.jsx("label",{className:"text-sm text-gray-300",children:"Active"})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 border border-gray-600 text-gray-300 rounded-lg hover:bg-gray-700",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"flex-1 btn-primary flex items-center justify-center space-x-2",children:[e.jsx(ds,{size:18}),e.jsx("span",{children:"Save"})]})]})]})]})})},e1=({formData:t,setFormData:a,departments:s,onClose:n,onSave:r,isEditing:i})=>{const l=d=>{const{name:x,value:m,type:h,checked:f}=d.target;a(g=>({...g,[x]:h==="checkbox"?f:h==="number"?parseFloat(m)||0:m}))},c=d=>{a(x=>{const m=x.departments||[];return m.includes(d)?{...x,departments:m.filter(h=>h!==d)}:{...x,departments:[...m,d]}})},o=d=>{const x=d.target.value.split(",").map(m=>m.trim()).filter(m=>m);a(m=>({...m,designations:x}))};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:i?"Edit Group Override":"Create Group Override"}),e.jsx("button",{onClick:n,className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:24})})]}),e.jsxs("form",{onSubmit:r,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Leave Category *"}),e.jsxs("select",{name:"leaveType",value:t.leaveType,onChange:l,className:"input-field w-full",required:!0,children:[e.jsx("option",{value:"",children:"Select Leave Type"}),tl.map(d=>e.jsx("option",{value:d,children:d},d))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Yearly Allocation (days) *"}),e.jsx("input",{type:"number",name:"yearlyAllocation",value:t.yearlyAllocation,onChange:l,className:"input-field w-full",min:"0",step:"0.5",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Applies To *"}),e.jsxs("select",{name:"applicableTo",value:t.applicableTo,onChange:l,className:"input-field w-full",required:!0,children:[e.jsx("option",{value:"specific-departments",children:"Specific Departments"}),e.jsx("option",{value:"specific-designations",children:"Specific Designations"}),e.jsx("option",{value:"specific-locations",children:"Specific Locations"})]})]}),t.applicableTo==="specific-departments"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select Departments *"}),e.jsx("div",{className:"max-h-40 overflow-y-auto border border-gray-700 rounded-lg p-2",children:s.map(d=>e.jsxs("label",{className:"flex items-center space-x-2 p-2 hover:bg-gray-700 rounded cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.departments.includes(d._id),onChange:()=>c(d._id),className:"rounded"}),e.jsx("span",{className:"text-sm text-gray-300",children:d.name})]},d._id))})]}),t.applicableTo==="specific-designations"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Designations (comma-separated) *"}),e.jsx("input",{type:"text",value:t.designations.join(", "),onChange:o,className:"input-field w-full",placeholder:"e.g., Manager, Senior Developer, HR Executive",required:!0})]}),t.applicableTo==="specific-locations"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Locations (comma-separated) *"}),e.jsx("input",{type:"text",value:t.locations.join(", "),onChange:d=>{const x=d.target.value.split(",").map(m=>m.trim()).filter(m=>m);a(m=>({...m,locations:x}))},className:"input-field w-full",placeholder:"e.g., Mumbai, Delhi, Bangalore",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Accrual Frequency"}),e.jsxs("select",{name:"accrualFrequency",value:t.accrualFrequency,onChange:l,className:"input-field w-full",children:[e.jsx("option",{value:"yearly",children:"Yearly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"quarterly",children:"Quarterly"}),e.jsx("option",{value:"one-time",children:"One-time"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",name:"carryForwardEnabled",checked:t.carryForwardEnabled,onChange:l,className:"rounded"}),e.jsx("label",{className:"text-sm text-gray-300",children:"Enable Carry Forward"})]}),t.carryForwardEnabled&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Max Carry Forward (days)"}),e.jsx("input",{type:"number",name:"maxCarryForward",value:t.maxCarryForward,onChange:l,className:"input-field w-full",min:"0"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",name:"isActive",checked:t.isActive,onChange:l,className:"rounded"}),e.jsx("label",{className:"text-sm text-gray-300",children:"Active"})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-2 border border-gray-600 text-gray-300 rounded-lg hover:bg-gray-700",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"flex-1 btn-primary flex items-center justify-center space-x-2",children:[e.jsx(ds,{size:18}),e.jsx("span",{children:i?"Update":"Create"})]})]})]})]})})},t1=({year:t,setYear:a,onClose:s,onApply:n,applying:r})=>e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Apply Quotas to Employees"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:24})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-blue-900/20 border border-blue-800 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(st,{size:20,className:"text-blue-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-300 font-medium mb-1",children:"What this does:"}),e.jsxs("ul",{className:"text-xs text-blue-200 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Applies default quotas to all active employees"}),e.jsx("li",{children:"Applies group overrides where applicable"}),e.jsx("li",{children:"Creates/updates LeaveBalance records for the selected year"}),e.jsx("li",{children:"Calculates pro-rated allocation for mid-year employees"})]})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Year"}),e.jsx("input",{type:"number",value:t,onChange:i=>a(parseInt(i.target.value)),className:"input-field w-full",min:"2020",max:"2100"})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 border border-gray-600 text-gray-300 rounded-lg hover:bg-gray-700",disabled:r,children:"Cancel"}),e.jsx("button",{onClick:n,disabled:r,className:"flex-1 btn-primary flex items-center justify-center space-x-2 disabled:opacity-50",children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Applying..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Re,{size:18}),e.jsx("span",{children:"Apply to All Employees"})]})})]})]})]})}),s1=()=>{const[t,a]=v.useState([]),[s,n]=v.useState(!0);v.useEffect(()=>{r()},[]);const r=async()=>{try{const l=await Y.get("/assets");a(l.data.data)}catch{E.error("Failed to load assets")}finally{n(!1)}},i=l=>({available:"badge-success",assigned:"badge-info",maintenance:"badge-warning",retired:"badge-danger"})[l]||"badge-default";return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Assets"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage company assets"})]}),e.jsxs("button",{className:"btn-primary flex items-center space-x-2",children:[e.jsx(Pe,{size:20}),e.jsx("span",{children:"Add Asset"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(l=>e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-primary-600/20 rounded-lg flex items-center justify-center",children:e.jsx(Tt,{size:24,className:"text-primary-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:l.name}),e.jsx("p",{className:"text-sm text-gray-400",children:l.assetCode})]})]}),e.jsx("span",{className:`badge ${i(l.status)}`,children:l.status})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Category:"}),e.jsx("span",{className:"text-white capitalize",children:l.category})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Brand:"}),e.jsx("span",{className:"text-white",children:l.brand||"N/A"})]}),l.assignedTo&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Assigned To:"}),e.jsx("span",{className:"text-white",children:l.assignedTo.firstName})]})]})]},l._id))})]})},a1=()=>{const{user:t}=kt();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Profile Settings"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage your profile information"})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:(t==null?void 0:t.email)||"",className:"input-field",disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Role"}),e.jsx("input",{type:"text",value:(t==null?void 0:t.role)||"",className:"input-field capitalize",disabled:!0})]})]})})]})},r1=()=>{const[t,a]=v.useState(!1),[s,n]=v.useState({currentPassword:"",newPassword:"",confirmPassword:""}),r=async i=>{var l,c;if(i.preventDefault(),s.newPassword!==s.confirmPassword){E.error("Passwords do not match");return}a(!0);try{await Y.put("/auth/updatepassword",{currentPassword:s.currentPassword,newPassword:s.newPassword}),E.success("Password updated successfully"),n({currentPassword:"",newPassword:"",confirmPassword:""})}catch(o){E.error(((c=(l=o.response)==null?void 0:l.data)==null?void 0:c.message)||"Failed to update password")}finally{a(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Security Settings"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage your password and security"})]}),e.jsx("form",{onSubmit:r,className:"max-w-2xl",children:e.jsxs("div",{className:"card space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Current Password"}),e.jsx("input",{type:"password",value:s.currentPassword,onChange:i=>n({...s,currentPassword:i.target.value}),className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"New Password"}),e.jsx("input",{type:"password",value:s.newPassword,onChange:i=>n({...s,newPassword:i.target.value}),className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Confirm New Password"}),e.jsx("input",{type:"password",value:s.confirmPassword,onChange:i=>n({...s,confirmPassword:i.target.value}),className:"input-field",required:!0})]}),e.jsxs("button",{type:"submit",disabled:t,className:"btn-primary flex items-center space-x-2",children:[e.jsx(ds,{size:20}),e.jsx("span",{children:t?"Updating...":"Update Password"})]})]})})]})},n1=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Preferences"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Customize your experience"})]}),e.jsx("div",{className:"card",children:e.jsx("p",{className:"text-gray-400",children:"Preference settings coming soon"})})]}),Bc=()=>{var f,g,p;const{theme:t,setTheme:a,isChanging:s}=ot(),n=ph(),[r,i]=v.useState(!1),[l,c]=v.useState({primary:"#8b5cf6",background:"#0f0a1f",surface:"#1a1333",text:"#ede9fe"});v.useEffect(()=>{if(r){const u=localStorage.getItem("customThemeColors");if(u)try{const j=JSON.parse(u);c({primary:j.primary||"#8b5cf6",background:j.background||"#0f0a1f",surface:j.surface||"#1a1333",text:j.text||"#ede9fe"})}catch(j){console.error("Failed to load custom colors",j)}}},[r]);const o=async u=>{var j;if(u==="custom"){i(!0);return}try{await a(u),E.success(`Theme changed to ${(j=n.find(y=>y.id===u))==null?void 0:j.name}`)}catch{E.error("Failed to change theme")}},d=(u,j)=>{c(y=>({...y,[u]:j}))},x=async()=>{try{const u={primary:l.primary,primaryHover:m(l.primary,-20),background:l.background,surface:l.surface,surfaceHover:m(l.surface,10),text:l.text,textSecondary:m(l.text,-30),border:m(l.surface,20),accent:l.primary};localStorage.setItem("customThemeColors",JSON.stringify(u)),await new Promise(j=>setTimeout(j,50)),ei("custom"),await a("custom"),i(!1),E.success("Custom theme applied!")}catch(u){console.error("Custom theme error:",u),E.error("Failed to apply custom theme")}},m=(u,j)=>{const y=parseInt(u.replace("#",""),16),N=Math.round(2.55*j),w=(y>>16)+N,D=(y>>8&255)+N,b=(y&255)+N;return"#"+(16777216+(w<255?w<1?0:w:255)*65536+(D<255?D<1?0:D:255)*256+(b<255?b<1?0:b:255)).toString(16).slice(1)},h=async()=>{try{await a("dark"),E.success("Theme reset to default")}catch{E.error("Failed to reset theme")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Wn,{className:"w-8 h-8 text-primary-500"}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Theme Settings"})]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Customize your workspace appearance with beautiful themes"})]}),e.jsxs("button",{onClick:h,className:"flex items-center px-4 py-2 bg-dark-800 hover:bg-dark-700 text-gray-300 rounded-lg transition-colors",children:[e.jsx(Vn,{className:"w-4 h-4 mr-2"}),"Reset to Default"]})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-1",children:"Current Theme"}),e.jsxs("p",{className:"text-gray-400",children:[(f=n.find(u=>u.id===t))==null?void 0:f.name," - ",(g=n.find(u=>u.id===t))==null?void 0:g.description]})]}),e.jsx("div",{className:`w-16 h-16 rounded-lg ${(p=n.find(u=>u.id===t))==null?void 0:p.preview} shadow-lg`})]})}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Available Themes"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:n.map(u=>e.jsxs("div",{className:`relative group cursor-pointer rounded-xl border-2 transition-all duration-300 ${t===u.id?"border-primary-500 shadow-lg shadow-primary-500/20":"border-dark-700 hover:border-dark-600"} ${s?"pointer-events-none opacity-50":""}`,onClick:()=>o(u.id),children:[e.jsxs("div",{className:`h-32 rounded-t-lg ${u.preview} relative overflow-hidden`,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/5 to-transparent"}),e.jsxs("div",{className:"absolute bottom-2 left-2 right-2 flex space-x-1",children:[e.jsx("div",{className:"h-2 w-8 bg-white/20 rounded-full"}),e.jsx("div",{className:"h-2 w-12 bg-white/20 rounded-full"}),e.jsx("div",{className:"h-2 w-6 bg-white/20 rounded-full"})]})]}),e.jsx("div",{className:"p-4 bg-dark-800 rounded-b-lg",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-white mb-1",children:u.name}),e.jsx("p",{className:"text-sm text-gray-400",children:u.description})]}),t===u.id&&e.jsx("div",{className:"ml-2 flex-shrink-0",children:e.jsx("div",{className:"w-6 h-6 bg-primary-600 rounded-full flex items-center justify-center",children:e.jsx(Pa,{className:"w-4 h-4 text-white"})})})]})}),t!==u.id&&e.jsx("div",{className:"absolute inset-0 bg-primary-600/0 group-hover:bg-primary-600/5 rounded-xl transition-colors duration-300"})]},u.id))})]}),e.jsx("div",{className:"card bg-gradient-to-br from-primary-600/10 to-purple-600/10 border-primary-600/20",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Jr,{className:"w-6 h-6 text-primary-400 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Theme Tips"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-300",children:[e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-primary-400 mr-2",children:"â€¢"}),e.jsx("span",{children:"Click any theme to apply it instantly"})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-primary-400 mr-2",children:"â€¢"}),e.jsx("span",{children:"Your theme preference is saved automatically and syncs across all your devices"})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-primary-400 mr-2",children:"â€¢"}),e.jsx("span",{children:"Themes apply globally to dashboard, navbar, sidebar, and all components"})]}),e.jsxs("li",{className:"flex items-start",children:[e.jsx("span",{className:"text-primary-400 mr-2",children:"â€¢"}),e.jsx("span",{children:"All themes are optimized for both desktop and mobile devices"})]})]})]})]})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-900 rounded-xl border border-dark-700 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-dark-700",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Wn,{className:"w-6 h-6 text-primary-500"}),e.jsx("h2",{className:"text-xl font-bold text-white",children:"Custom Theme Builder"})]}),e.jsx("button",{onClick:()=>i(!1),className:"p-2 hover:bg-dark-800 rounded-lg transition-colors",children:e.jsx(Ee,{className:"w-5 h-5 text-gray-400"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Create your personalized theme by choosing colors for different elements. The system will automatically generate complementary shades."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-white",children:"Primary Color"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Used for buttons, links, and highlights"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"color",value:l.primary,onChange:u=>d("primary",u.target.value),className:"w-16 h-16 rounded-lg cursor-pointer border-2 border-dark-700"}),e.jsx("input",{type:"text",value:l.primary,onChange:u=>d("primary",u.target.value),className:"flex-1 bg-dark-800 border border-dark-700 text-white rounded-lg px-4 py-2 font-mono text-sm",placeholder:"#8b5cf6"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-white",children:"Background Color"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Main page background (should be very dark)"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"color",value:l.background,onChange:u=>d("background",u.target.value),className:"w-16 h-16 rounded-lg cursor-pointer border-2 border-dark-700"}),e.jsx("input",{type:"text",value:l.background,onChange:u=>d("background",u.target.value),className:"flex-1 bg-dark-800 border border-dark-700 text-white rounded-lg px-4 py-2 font-mono text-sm",placeholder:"#0f0a1f"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-white",children:"Surface Color"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Cards, sidebar, and header background"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"color",value:l.surface,onChange:u=>d("surface",u.target.value),className:"w-16 h-16 rounded-lg cursor-pointer border-2 border-dark-700"}),e.jsx("input",{type:"text",value:l.surface,onChange:u=>d("surface",u.target.value),className:"flex-1 bg-dark-800 border border-dark-700 text-white rounded-lg px-4 py-2 font-mono text-sm",placeholder:"#1a1333"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-white",children:"Text Color"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Main text color (should be light)"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"color",value:l.text,onChange:u=>d("text",u.target.value),className:"w-16 h-16 rounded-lg cursor-pointer border-2 border-dark-700"}),e.jsx("input",{type:"text",value:l.text,onChange:u=>d("text",u.target.value),className:"flex-1 bg-dark-800 border border-dark-700 text-white rounded-lg px-4 py-2 font-mono text-sm",placeholder:"#ede9fe"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-white",children:"Preview"}),e.jsx("div",{className:"rounded-lg p-6 border-2",style:{backgroundColor:l.background,borderColor:l.surface},children:e.jsxs("div",{className:"rounded-lg p-4 mb-4",style:{backgroundColor:l.surface},children:[e.jsx("h3",{className:"font-semibold mb-2",style:{color:l.text},children:"Sample Card"}),e.jsx("p",{className:"text-sm mb-3",style:{color:l.text,opacity:.7},children:"This is how your custom theme will look"}),e.jsx("button",{className:"px-4 py-2 rounded-lg text-white font-medium",style:{backgroundColor:l.primary},children:"Primary Button"})]})})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 p-6 border-t border-dark-700",children:[e.jsx("button",{onClick:()=>i(!1),className:"px-6 py-2 bg-dark-800 hover:bg-dark-700 text-gray-300 rounded-lg transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:x,className:"px-6 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition-colors flex items-center space-x-2",children:[e.jsx(Pa,{className:"w-4 h-4"}),e.jsx("span",{children:"Apply Custom Theme"})]})]})]})})]})},i1=()=>{const[t,a]=v.useState([]),[s,n]=v.useState(!0),[r,i]=v.useState(""),[l,c]=v.useState("all"),[o,d]=v.useState(!1),[x,m]=v.useState(!1),[h,f]=v.useState(null),[g,p]=v.useState(!1),[u,j]=v.useState({name:"",companyName:"",email:"",phone:"",clientCode:"",status:"active",billingType:"per-month",address:{street:"",city:"",state:"",zipCode:"",country:""},contactPerson:{name:"",designation:"",email:"",phone:""},industry:"",website:"",notes:""}),[y,N]=v.useState({});v.useEffect(()=>{w()},[]);const w=async()=>{try{const M=await Y.get("/clients");a(M.data.data)}catch{E.error("Failed to load clients")}finally{n(!1)}},D=async M=>{var X,q;if(window.confirm("Are you sure you want to delete this client?"))try{await Y.delete(`/clients/${M}`),E.success("Client deleted successfully"),w()}catch(B){E.error(((q=(X=B==null?void 0:B.response)==null?void 0:X.data)==null?void 0:q.message)||"Failed to delete client")}},b=()=>{j({name:"",companyName:"",email:"",phone:"",clientCode:"",status:"active",billingType:"per-month",address:{street:"",city:"",state:"",zipCode:"",country:""},contactPerson:{name:"",designation:"",email:"",phone:""},industry:"",website:"",notes:""}),N({}),f(null),d(!0)},C=M=>{var X,q,B,K,Q,_,ne,ie,A;j({name:M.name||"",companyName:M.companyName||"",email:M.email||"",phone:M.phone||"",clientCode:M.clientCode||"",status:M.status||"active",billingType:M.billingType||"per-month",address:{street:((X=M.address)==null?void 0:X.street)||"",city:((q=M.address)==null?void 0:q.city)||"",state:((B=M.address)==null?void 0:B.state)||"",zipCode:((K=M.address)==null?void 0:K.zipCode)||"",country:((Q=M.address)==null?void 0:Q.country)||""},contactPerson:{name:((_=M.contactPerson)==null?void 0:_.name)||"",designation:((ne=M.contactPerson)==null?void 0:ne.designation)||"",email:((ie=M.contactPerson)==null?void 0:ie.email)||"",phone:((A=M.contactPerson)==null?void 0:A.phone)||""},industry:M.industry||"",website:M.website||"",notes:M.notes||""}),N({}),f(M),m(!0)},S=()=>{const M={};return u.name.trim()||(M.name="Client name is required"),u.companyName.trim()||(M.companyName="Company name is required"),u.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u.email)||(M.email="Invalid email format"):M.email="Email is required",u.phone.trim()||(M.phone="Phone is required"),N(M),Object.keys(M).length===0},k=async M=>{var X,q;if(M.preventDefault(),!!S()){p(!0);try{const B={...u};B.clientCode||delete B.clientCode,B.industry||delete B.industry,B.website||delete B.website,B.notes||delete B.notes,h?(await Y.put(`/clients/${h._id}`,B),E.success("Client updated successfully"),m(!1)):(await Y.post("/clients",B),E.success("Client created successfully"),d(!1)),f(null),w()}catch(B){E.error(((q=(X=B==null?void 0:B.response)==null?void 0:X.data)==null?void 0:q.message)||`Failed to ${h?"update":"create"} client`)}finally{p(!1)}}},F=M=>{const{name:X,value:q}=M.target;if(X.includes(".")){const[B,K]=X.split(".");j(Q=>({...Q,[B]:{...Q[B],[K]:q}}))}else j(B=>({...B,[X]:q}));y[X]&&N(B=>{const K={...B};return delete K[X],K})},R=t.filter(M=>{const X=M.name.toLowerCase().includes(r.toLowerCase())||M.companyName.toLowerCase().includes(r.toLowerCase())||M.clientCode.toLowerCase().includes(r.toLowerCase()),q=l==="all"||M.status===l;return X&&q}),T=M=>({active:"badge-success",inactive:"badge-default",suspended:"badge-danger"})[M]||"badge-default";return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Clients"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage client relationships"})]}),e.jsxs("button",{onClick:b,className:"btn-primary flex items-center space-x-2",children:[e.jsx(Pe,{size:20}),e.jsx("span",{children:"Add Client"})]})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(rt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",size:20}),e.jsx("input",{type:"text",placeholder:"Search clients...",value:r,onChange:M=>i(M.target.value),className:"input-field pl-10"})]}),e.jsxs("select",{value:l,onChange:M=>c(M.target.value),className:"input-field md:w-48",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"suspended",children:"Suspended"})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:R.map(M=>e.jsxs("div",{className:"card hover:border-primary-600 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-primary-600/20 rounded-lg flex items-center justify-center",children:e.jsx(qs,{size:24,className:"text-primary-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:M.name}),e.jsx("p",{className:"text-sm text-gray-400",children:M.clientCode})]})]}),e.jsx("span",{className:`badge ${T(M.status)}`,children:M.status})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx("span",{className:"font-medium text-gray-300 w-24",children:"Company:"}),e.jsx("span",{children:M.companyName})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx("span",{className:"font-medium text-gray-300 w-24",children:"Email:"}),e.jsx("span",{className:"truncate",children:M.email})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx("span",{className:"font-medium text-gray-300 w-24",children:"Phone:"}),e.jsx("span",{children:M.phone})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx("span",{className:"font-medium text-gray-300 w-24",children:"Billing:"}),e.jsx("span",{className:"capitalize",children:M.billingType})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-4 border-t border-dark-800",children:[e.jsxs(Ut,{to:`/clients/${M._id}`,className:"flex-1 btn-outline text-sm py-2 flex items-center justify-center space-x-1",children:[e.jsx(Rt,{size:16}),e.jsx("span",{children:"View"})]}),e.jsxs("button",{onClick:()=>C(M),className:"flex-1 btn-outline text-sm py-2 flex items-center justify-center space-x-1",children:[e.jsx(Is,{size:16}),e.jsx("span",{children:"Edit"})]}),e.jsx("button",{onClick:()=>D(M._id),className:"btn-outline text-sm py-2 px-3 text-red-500 hover:bg-red-500/10",children:e.jsx(ct,{size:16})})]})]},M._id))}),R.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(qs,{size:48,className:"mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No clients found"})]}),o&&e.jsx(Uc,{formData:u,errors:y,submitting:g,onChange:F,onSubmit:k,onClose:()=>{d(!1),j({name:"",companyName:"",email:"",phone:"",clientCode:"",status:"active",billingType:"per-month",address:{street:"",city:"",state:"",zipCode:"",country:""},contactPerson:{name:"",designation:"",email:"",phone:""},industry:"",website:"",notes:""}),N({})},title:"Add Client"}),x&&e.jsx(Uc,{formData:u,errors:y,submitting:g,onChange:F,onSubmit:k,onClose:()=>{m(!1),f(null),j({name:"",companyName:"",email:"",phone:"",clientCode:"",status:"active",billingType:"per-month",address:{street:"",city:"",state:"",zipCode:"",country:""},contactPerson:{name:"",designation:"",email:"",phone:""},industry:"",website:"",notes:""}),N({})},title:"Edit Client"})]})},Uc=({formData:t,errors:a,submitting:s,onChange:n,onSubmit:r,onClose:i,title:l})=>e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-800 border-b border-gray-700 p-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:l}),e.jsx("button",{onClick:i,className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:24})})]}),e.jsxs("form",{onSubmit:r,className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:["Client Name ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",name:"name",value:t.name,onChange:n,className:`input-field w-full ${a.name?"border-red-500":""}`,required:!0}),a.name&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:a.name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:["Company Name ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",name:"companyName",value:t.companyName,onChange:n,className:`input-field w-full ${a.companyName?"border-red-500":""}`,required:!0}),a.companyName&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:a.companyName})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:["Email ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"email",name:"email",value:t.email,onChange:n,className:`input-field w-full ${a.email?"border-red-500":""}`,required:!0}),a.email&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:a.email})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:["Phone ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"tel",name:"phone",value:t.phone,onChange:n,className:`input-field w-full ${a.phone?"border-red-500":""}`,required:!0}),a.phone&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:a.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Client Code"}),e.jsx("input",{type:"text",name:"clientCode",value:t.clientCode,onChange:n,className:"input-field w-full",placeholder:"Auto-generated if empty"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:["Status ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{name:"status",value:t.status,onChange:n,className:"input-field w-full",required:!0,children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"suspended",children:"Suspended"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Billing Type"}),e.jsxs("select",{name:"billingType",value:t.billingType,onChange:n,className:"input-field w-full",children:[e.jsx("option",{value:"per-day",children:"Per Day"}),e.jsx("option",{value:"per-month",children:"Per Month"}),e.jsx("option",{value:"fte",children:"FTE"}),e.jsx("option",{value:"fixed",children:"Fixed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Industry"}),e.jsx("input",{type:"text",name:"industry",value:t.industry,onChange:n,className:"input-field w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Website"}),e.jsx("input",{type:"url",name:"website",value:t.website,onChange:n,className:"input-field w-full",placeholder:"https://"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Address"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Street"}),e.jsx("input",{type:"text",name:"address.street",value:t.address.street,onChange:n,className:"input-field w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"City"}),e.jsx("input",{type:"text",name:"address.city",value:t.address.city,onChange:n,className:"input-field w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"State"}),e.jsx("input",{type:"text",name:"address.state",value:t.address.state,onChange:n,className:"input-field w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Zip Code"}),e.jsx("input",{type:"text",name:"address.zipCode",value:t.address.zipCode,onChange:n,className:"input-field w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Country"}),e.jsx("input",{type:"text",name:"address.country",value:t.address.country,onChange:n,className:"input-field w-full"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Contact Person"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",name:"contactPerson.name",value:t.contactPerson.name,onChange:n,className:"input-field w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Designation"}),e.jsx("input",{type:"text",name:"contactPerson.designation",value:t.contactPerson.designation,onChange:n,className:"input-field w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Email"}),e.jsx("input",{type:"email",name:"contactPerson.email",value:t.contactPerson.email,onChange:n,className:"input-field w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",name:"contactPerson.phone",value:t.contactPerson.phone,onChange:n,className:"input-field w-full"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Notes"}),e.jsx("textarea",{name:"notes",value:t.notes,onChange:n,className:"input-field w-full",rows:"4",placeholder:"Additional notes about the client..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:i,className:"px-6 py-2 border border-gray-600 text-gray-300 rounded-lg hover:bg-gray-700",disabled:s,children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn-primary px-6 py-2 flex items-center space-x-2",disabled:s,children:[s&&e.jsx(cs,{size:16,className:"animate-spin"}),e.jsx("span",{children:s?"Saving...":"Save Client"})]})]})]})]})}),l1=()=>{const[t,a]=v.useState([]),[s,n]=v.useState(!0),[r,i]=v.useState("all"),[l,c]=v.useState([]),[o,d]=v.useState([]),[x,m]=v.useState(!1),[h,f]=v.useState(!1),[g,p]=v.useState(!1),[u,j]=v.useState(null),[y,N]=v.useState(!1),[w,D]=v.useState({name:"",client:"",description:"",location:"",startDate:"",endDate:"",status:"planning",projectManager:"",budget:{estimated:"",actual:"",currency:"USD"}}),[b,C]=v.useState({});v.useEffect(()=>{S(),k(),F()},[]);const S=async()=>{try{const _=await Y.get("/projects");a(_.data.data)}catch{E.error("Failed to load projects")}finally{n(!1)}},k=async()=>{try{const _=await Y.get("/clients?status=active");c(_.data.data||[])}catch(_){console.error("Failed to load clients:",_)}},F=async()=>{try{const _=await Y.get("/employees"),ne=["manager","hr","admin","company_admin"],ie=(_.data.data||[]).filter(A=>ne.includes(A.role));d(ie)}catch(_){console.error("Failed to load employees:",_)}},R=()=>{D({name:"",client:"",description:"",location:"",startDate:"",endDate:"",status:"planning",projectManager:"",budget:{estimated:"",actual:"",currency:"USD"}}),C({}),j(null),m(!0)},T=_=>{var ne,ie,A,P,O;D({name:_.name||"",client:((ne=_.client)==null?void 0:ne._id)||_.client||"",description:_.description||"",location:_.location||"",startDate:_.startDate?new Date(_.startDate).toISOString().split("T")[0]:"",endDate:_.endDate?new Date(_.endDate).toISOString().split("T")[0]:"",status:_.status||"planning",projectManager:((ie=_.projectManager)==null?void 0:ie._id)||_.projectManager||"",budget:{estimated:((A=_.budget)==null?void 0:A.estimated)||"",actual:((P=_.budget)==null?void 0:P.actual)||"",currency:((O=_.budget)==null?void 0:O.currency)||"USD"}}),C({}),j(_),f(!0)},M=_=>{j(_),p(!0)},X=()=>{const _={};return w.name.trim()||(_.name="Project name is required"),w.client||(_.client="Client is required"),w.location.trim()||(_.location="Location is required"),w.startDate||(_.startDate="Start date is required"),w.endDate&&w.startDate&&new Date(w.endDate)<new Date(w.startDate)&&(_.endDate="End date must be after start date"),C(_),Object.keys(_).length===0},q=async _=>{var ne,ie;if(_.preventDefault(),!!X()){N(!0);try{const A={...w,budget:{estimated:w.budget.estimated?parseFloat(w.budget.estimated):void 0,actual:w.budget.actual?parseFloat(w.budget.actual):void 0,currency:w.budget.currency}};A.description||delete A.description,A.endDate||delete A.endDate,A.projectManager||delete A.projectManager,A.budget.estimated||delete A.budget.estimated,A.budget.actual||delete A.budget.actual,u?(await Y.put(`/projects/${u._id}`,A),E.success("Project updated successfully"),f(!1)):(await Y.post("/projects",A),E.success("Project created successfully"),m(!1)),j(null),S()}catch(A){E.error(((ie=(ne=A==null?void 0:A.response)==null?void 0:ne.data)==null?void 0:ie.message)||`Failed to ${u?"update":"create"} project`)}finally{N(!1)}}},B=_=>{const{name:ne,value:ie}=_.target;if(ne.includes(".")){const[A,P]=ne.split(".");D(O=>({...O,[A]:{...O[A],[P]:ie}}))}else D(A=>({...A,[ne]:ie}));b[ne]&&C(A=>{const P={...A};return delete P[ne],P})},K=t.filter(_=>r==="all"||_.status===r),Q=_=>({planning:"badge-info",active:"badge-success","on-hold":"badge-warning",completed:"badge-default",cancelled:"badge-danger"})[_]||"badge-default";return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Projects"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage client projects and assignments"})]}),e.jsxs("button",{onClick:R,className:"btn-primary flex items-center space-x-2",children:[e.jsx(Pe,{size:20}),e.jsx("span",{children:"Add Project"})]})]}),e.jsx("div",{className:"card",children:e.jsxs("select",{value:r,onChange:_=>i(_.target.value),className:"input-field w-48",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"planning",children:"Planning"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"on-hold",children:"On Hold"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:K.map(_=>{var ne,ie;return e.jsxs("div",{className:"card hover:border-primary-600 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-primary-600/20 rounded-lg flex items-center justify-center",children:e.jsx(ll,{size:24,className:"text-primary-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:_.name}),e.jsx("p",{className:"text-sm text-gray-400",children:_.projectCode})]})]}),e.jsx("span",{className:`badge ${Q(_.status)}`,children:_.status})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx("span",{className:"font-medium text-gray-300 w-24",children:"Client:"}),e.jsx("span",{children:(ne=_.client)==null?void 0:ne.name})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx("span",{className:"font-medium text-gray-300 w-24",children:"Location:"}),e.jsx("span",{children:_.location})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx("span",{className:"font-medium text-gray-300 w-24",children:"Manager:"}),e.jsx("span",{children:_.projectManager?`${_.projectManager.firstName} ${_.projectManager.lastName}`:"Not assigned"})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx("span",{className:"font-medium text-gray-300 w-24",children:"Team Size:"}),e.jsx("span",{children:((ie=_.teamMembers)==null?void 0:ie.filter(A=>A.isActive).length)||0})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx("span",{className:"font-medium text-gray-300 w-24",children:"Duration:"}),e.jsxs("span",{children:[new Date(_.startDate).toLocaleDateString()," -",_.endDate?new Date(_.endDate).toLocaleDateString():"Ongoing"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:()=>M(_),className:"flex-1 btn-primary text-sm",children:[e.jsx(Rt,{size:16,className:"inline mr-1"}),"View Details"]}),e.jsx("button",{onClick:()=>T(_),className:"btn-outline text-sm px-3",title:"Edit Project",children:"Edit"})]})]},_._id)})}),K.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ll,{size:48,className:"mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No projects found"})]}),x&&e.jsx(zc,{formData:w,errors:b,submitting:y,clients:l,employees:o,onChange:B,onSubmit:q,onClose:()=>{m(!1),D({name:"",client:"",description:"",location:"",startDate:"",endDate:"",status:"planning",projectManager:"",budget:{estimated:"",actual:"",currency:"USD"}}),C({})},title:"Add Project"}),h&&e.jsx(zc,{formData:w,errors:b,submitting:y,clients:l,employees:o,onChange:B,onSubmit:q,onClose:()=>{f(!1),j(null),D({name:"",client:"",description:"",location:"",startDate:"",endDate:"",status:"planning",projectManager:"",budget:{estimated:"",actual:"",currency:"USD"}}),C({})},title:"Edit Project"}),g&&u&&e.jsx(c1,{project:u,onClose:()=>{p(!1),j(null)},onEdit:()=>{p(!1),T(u)}})]})},zc=({formData:t,errors:a,submitting:s,clients:n,employees:r,onChange:i,onSubmit:l,onClose:c,title:o})=>e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-800 border-b border-gray-700 p-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:o}),e.jsx("button",{onClick:c,className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:24})})]}),e.jsxs("form",{onSubmit:l,className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:["Project Name ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",name:"name",value:t.name,onChange:i,className:`input-field w-full ${a.name?"border-red-500":""}`,required:!0}),a.name&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:a.name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:["Client ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{name:"client",value:t.client,onChange:i,className:`input-field w-full ${a.client?"border-red-500":""}`,required:!0,children:[e.jsx("option",{value:"",children:"Select Client"}),n.map(d=>e.jsxs("option",{value:d._id,children:[d.name," (",d.clientCode,")"]},d._id))]}),a.client&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:a.client})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:["Location ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",name:"location",value:t.location,onChange:i,className:`input-field w-full ${a.location?"border-red-500":""}`,required:!0}),a.location&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:a.location})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:["Status ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{name:"status",value:t.status,onChange:i,className:"input-field w-full",required:!0,children:[e.jsx("option",{value:"planning",children:"Planning"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"on-hold",children:"On Hold"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:["Start Date ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"date",name:"startDate",value:t.startDate,onChange:i,className:`input-field w-full ${a.startDate?"border-red-500":""}`,required:!0}),a.startDate&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:a.startDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"End Date"}),e.jsx("input",{type:"date",name:"endDate",value:t.endDate,onChange:i,min:t.startDate,className:`input-field w-full ${a.endDate?"border-red-500":""}`}),a.endDate&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:a.endDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Project Manager"}),e.jsxs("select",{name:"projectManager",value:t.projectManager,onChange:i,className:"input-field w-full",children:[e.jsx("option",{value:"",children:"Not Assigned"}),r.map(d=>e.jsxs("option",{value:d._id,children:[d.firstName," ",d.lastName," (",d.role,")"]},d._id))]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",value:t.description,onChange:i,className:"input-field w-full",rows:"4",placeholder:"Project description..."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Budget"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Estimated Amount"}),e.jsx("input",{type:"number",name:"budget.estimated",value:t.budget.estimated,onChange:i,className:"input-field w-full",min:"0",step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Actual Amount"}),e.jsx("input",{type:"number",name:"budget.actual",value:t.budget.actual,onChange:i,className:"input-field w-full",min:"0",step:"0.01"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Currency"}),e.jsxs("select",{name:"budget.currency",value:t.budget.currency,onChange:i,className:"input-field w-full",children:[e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"EUR",children:"EUR"}),e.jsx("option",{value:"GBP",children:"GBP"}),e.jsx("option",{value:"INR",children:"INR"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:c,className:"px-6 py-2 border border-gray-600 text-gray-300 rounded-lg hover:bg-gray-700",disabled:s,children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn-primary px-6 py-2 flex items-center space-x-2",disabled:s,children:[s&&e.jsx(cs,{size:16,className:"animate-spin"}),e.jsx("span",{children:s?"Saving...":"Save Project"})]})]})]})]})}),c1=({project:t,onClose:a,onEdit:s})=>{var n;return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-800 border-b border-gray-700 p-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Project Details"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:24})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Project Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Project Name"}),e.jsx("p",{className:"text-white font-medium",children:t.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Project Code"}),e.jsx("p",{className:"text-white font-medium",children:t.projectCode})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Client"}),e.jsx("p",{className:"text-white font-medium",children:((n=t.client)==null?void 0:n.name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Status"}),e.jsx("p",{className:"text-white font-medium capitalize",children:t.status})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Location"}),e.jsx("p",{className:"text-white font-medium",children:t.location})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Project Manager"}),e.jsx("p",{className:"text-white font-medium",children:t.projectManager?`${t.projectManager.firstName} ${t.projectManager.lastName}`:"Not assigned"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Start Date"}),e.jsx("p",{className:"text-white font-medium",children:new Date(t.startDate).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"End Date"}),e.jsx("p",{className:"text-white font-medium",children:t.endDate?new Date(t.endDate).toLocaleDateString():"Ongoing"})]})]}),t.description&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Description"}),e.jsx("p",{className:"text-white",children:t.description})]})]}),t.budget&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Budget"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Estimated"}),e.jsx("p",{className:"text-white font-medium",children:t.budget.estimated?`${t.budget.currency||"USD"} ${t.budget.estimated.toLocaleString()}`:"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Actual"}),e.jsx("p",{className:"text-white font-medium",children:t.budget.actual?`${t.budget.currency||"USD"} ${t.budget.actual.toLocaleString()}`:"N/A"})]})]})]}),t.teamMembers&&t.teamMembers.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Team Members"}),e.jsx("div",{className:"space-y-2",children:t.teamMembers.filter(r=>r.isActive).map((r,i)=>{var l,c;return e.jsx("div",{className:"p-3 bg-gray-700 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-white font-medium",children:[(l=r.employee)==null?void 0:l.firstName," ",(c=r.employee)==null?void 0:c.lastName]}),e.jsx("p",{className:"text-sm text-gray-400",children:r.role})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Status"}),e.jsx("p",{className:"text-green-400",children:"Active"})]})]})},i)})})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{onClick:a,className:"px-6 py-2 border border-gray-600 text-gray-300 rounded-lg hover:bg-gray-700",children:"Close"}),e.jsx("button",{onClick:s,className:"btn-primary px-6 py-2",children:"Edit Project"})]})]})]})})},o1=()=>{const{user:t}=kt(),[a,s]=v.useState([]),[n,r]=v.useState(!0),[i,l]=v.useState("all"),[c,o]=v.useState(!1),[d,x]=v.useState([]),[m,h]=v.useState([]),[f,g]=v.useState([]),[p,u]=v.useState(!1),[j,y]=v.useState(""),[N,w]=v.useState({employee:"",project:"",client:"",entries:[{date:"",hours:"",taskDescription:"",billable:!0},{date:"",hours:"",taskDescription:"",billable:!0},{date:"",hours:"",taskDescription:"",billable:!0},{date:"",hours:"",taskDescription:"",billable:!0},{date:"",hours:"",taskDescription:"",billable:!0},{date:"",hours:"",taskDescription:"",billable:!0},{date:"",hours:"",taskDescription:"",billable:!0}],notes:""}),[D,b]=v.useState({});v.useEffect(()=>{C(),c&&(S(),k(),F())},[c]);const C=async()=>{try{const I=await Y.get("/timesheets");s(I.data.data)}catch{E.error("Failed to load timesheets")}finally{r(!1)}},S=async()=>{try{const I=await Y.get("/projects?status=active");x(I.data.data||[])}catch(I){console.error("Failed to load projects:",I)}},k=async()=>{try{const I=await Y.get("/clients?status=active");h(I.data.data||[])}catch(I){console.error("Failed to load clients:",I)}},F=async()=>{try{const I=await Y.get("/employees");g(I.data.data||[])}catch(I){console.error("Failed to load employees:",I)}},R=I=>{if(!I)return[];const J=new Date(I),te=[];for(let se=0;se<7;se++){const le=new Date(J);le.setDate(le.getDate()+se),te.push(le.toISOString().split("T")[0])}return te},T=()=>{const I=new Date,J=I.getDay();I.getDate()-J+(J===0?-6:1);const te=new Date(I);te.setDate(te.getDate()-J+(J===0?-6:1)),te.setHours(0,0,0,0);const se=te.toISOString().split("T")[0],le=R(se);y(se),w({employee:((t==null?void 0:t.role)==="employee",""),project:"",client:"",entries:le.map(ue=>({date:ue,hours:"",taskDescription:"",billable:!0})),notes:""}),b({}),o(!0)},M=I=>{y(I);const J=R(I);w(te=>({...te,entries:J.map((se,le)=>{var ue,be,H;return{date:se,hours:((ue=te.entries[le])==null?void 0:ue.hours)||"",taskDescription:((be=te.entries[le])==null?void 0:be.taskDescription)||"",billable:((H=te.entries[le])==null?void 0:H.billable)!==!1}})}))},X=I=>{const J=d.find(te=>te._id===I);w(te=>{var se;return{...te,project:I,client:((se=J==null?void 0:J.client)==null?void 0:se._id)||(J==null?void 0:J.client)||""}})},q=(I,J,te)=>{w(se=>({...se,entries:se.entries.map((le,ue)=>ue===I?{...le,[J]:te}:le)}))},B=()=>N.entries.reduce((I,J)=>{const te=parseFloat(J.hours)||0;return I+te},0),K=()=>N.entries.reduce((I,J)=>{if(J.billable){const te=parseFloat(J.hours)||0;return I+te}return I},0),Q=()=>{const I={};return!N.employee&&(t==null?void 0:t.role)!=="employee"&&(t==null?void 0:t.role)!=="hr"&&(I.employee="Employee is required"),N.project||(I.project="Project is required"),N.client||(I.client="Client is required"),j||(I.weekStartDate="Week start date is required"),N.entries.some(te=>te.hours&&parseFloat(te.hours)>0)||(I.entries="At least one entry with hours is required"),N.entries.forEach((te,se)=>{if(te.hours&&te.hours!==""){const le=parseFloat(te.hours);(isNaN(le)||le<0||le>24)&&(I[`entry_${se}_hours`]="Hours must be between 0 and 24")}}),b(I),Object.keys(I).length===0},_=async I=>{var J,te;if(I.preventDefault(),!!Q()){u(!0);try{const se=new Date(j),le=new Date(se);le.setDate(le.getDate()+6);const ue=N.entries.filter(H=>H.hours&&parseFloat(H.hours)>0).map(H=>({date:H.date,hours:parseFloat(H.hours),taskDescription:H.taskDescription||"",billable:H.billable!==!1})),be={...(t==null?void 0:t.role)!=="employee"&&N.employee?{employee:N.employee}:{},project:N.project,client:N.client,weekStartDate:j,weekEndDate:le.toISOString().split("T")[0],entries:ue,...N.notes?{notes:N.notes}:{}};await Y.post("/timesheets",be),E.success("Timesheet created successfully"),o(!1),C(),w({employee:"",project:"",client:"",entries:Array(7).fill({date:"",hours:"",taskDescription:"",billable:!0}),notes:""}),y("")}catch(se){E.error(((te=(J=se==null?void 0:se.response)==null?void 0:J.data)==null?void 0:te.message)||"Failed to create timesheet")}finally{u(!1)}}},ne=async I=>{try{await Y.put(`/timesheets/${I}/approve`),E.success("Timesheet approved successfully"),C()}catch{E.error("Failed to approve timesheet")}},ie=async I=>{var te,se;const J=window.prompt("Enter rejection reason:");if(J)try{await Y.put(`/timesheets/${I}/reject`,{rejectionReason:J}),E.success("Timesheet rejected"),C()}catch(le){E.error(((se=(te=le==null?void 0:le.response)==null?void 0:te.data)==null?void 0:se.message)||"Failed to reject timesheet")}},A=a.filter(I=>i==="all"||I.status===i),P=I=>({draft:"badge-default",submitted:"badge-warning",approved:"badge-success",rejected:"badge-danger",invoiced:"badge-info"})[I]||"badge-default",O=(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="hr"||(t==null?void 0:t.role)==="client";return n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Timesheets"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Track project hours and billing"})]}),e.jsxs("button",{onClick:T,className:"btn-primary flex items-center space-x-2",children:[e.jsx(Pe,{size:20}),e.jsx("span",{children:"New Timesheet"})]})]}),e.jsx("div",{className:"card",children:e.jsxs("select",{value:i,onChange:I=>l(I.target.value),className:"input-field w-48",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"submitted",children:"Submitted"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"invoiced",children:"Invoiced"})]})}),e.jsx("div",{className:"card p-0",children:e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Employee"}),e.jsx("th",{children:"Project"}),e.jsx("th",{children:"Client"}),e.jsx("th",{children:"Week"}),e.jsx("th",{children:"Total Hours"}),e.jsx("th",{children:"Billable Hours"}),e.jsx("th",{children:"Status"}),O&&e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:A.map(I=>{var J,te,se,le;return e.jsxs("tr",{children:[e.jsxs("td",{children:[(J=I.employee)==null?void 0:J.firstName," ",(te=I.employee)==null?void 0:te.lastName]}),e.jsx("td",{children:(se=I.project)==null?void 0:se.name}),e.jsx("td",{children:(le=I.client)==null?void 0:le.name}),e.jsxs("td",{children:[new Date(I.weekStartDate).toLocaleDateString()," -",new Date(I.weekEndDate).toLocaleDateString()]}),e.jsxs("td",{children:[I.totalHours," hrs"]}),e.jsxs("td",{children:[I.totalBillableHours," hrs"]}),e.jsx("td",{children:e.jsx("span",{className:`badge ${P(I.status)}`,children:I.status})}),O&&e.jsx("td",{children:I.status==="submitted"&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>ne(I._id),className:"p-2 text-green-400 hover:bg-dark-800 rounded",title:"Approve",children:e.jsx(Pa,{size:16})}),e.jsx("button",{onClick:()=>ie(I._id),className:"p-2 text-red-400 hover:bg-dark-800 rounded",title:"Reject",children:e.jsx(Ee,{size:16})})]})})]},I._id)})})]})})}),A.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Te,{size:48,className:"mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No timesheets found"})]}),c&&e.jsx(d1,{formData:N,errors:D,submitting:p,weekStartDate:j,projects:d,clients:m,employees:f,user:t,onChange:(I,J)=>w(te=>({...te,[I]:J})),onWeekStartChange:M,onProjectChange:X,onEntryChange:q,onSubmit:_,onClose:()=>{o(!1),w({employee:"",project:"",client:"",entries:Array(7).fill({date:"",hours:"",taskDescription:"",billable:!0}),notes:""}),y(""),b({})},calculateTotalHours:B,calculateBillableHours:K})]})},d1=({formData:t,errors:a,submitting:s,weekStartDate:n,projects:r,clients:i,employees:l,user:c,onChange:o,onWeekStartChange:d,onProjectChange:x,onEntryChange:m,onSubmit:h,onClose:f,calculateTotalHours:g,calculateBillableHours:p})=>{(()=>{if(!n)return[];const y=new Date(n),N=[];for(let w=0;w<7;w++){const D=new Date(y);D.setDate(D.getDate()+w),N.push(D.toISOString().split("T")[0])}return N})();const j=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-5xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-800 border-b border-gray-700 p-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Create New Timesheet"}),e.jsx("button",{onClick:f,className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:24})})]}),e.jsxs("form",{onSubmit:h,className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(c==null?void 0:c.role)!=="employee"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:["Employee ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{value:t.employee,onChange:y=>o("employee",y.target.value),className:`input-field w-full ${a.employee?"border-red-500":""}`,required:(c==null?void 0:c.role)!=="employee",children:[e.jsx("option",{value:"",children:"Select Employee"}),l.map(y=>e.jsxs("option",{value:y._id,children:[y.firstName," ",y.lastName," (",y.employeeCode||y.email,")"]},y._id))]}),a.employee&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:a.employee})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:["Week Start Date ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"date",value:n,onChange:y=>d(y.target.value),className:`input-field w-full ${a.weekStartDate?"border-red-500":""}`,required:!0}),a.weekStartDate&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:a.weekStartDate})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:["Project ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{value:t.project,onChange:y=>x(y.target.value),className:`input-field w-full ${a.project?"border-red-500":""}`,required:!0,children:[e.jsx("option",{value:"",children:"Select Project"}),r.map(y=>e.jsxs("option",{value:y._id,children:[y.name," (",y.projectCode,")"]},y._id))]}),a.project&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:a.project})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:["Client ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("select",{value:t.client,onChange:y=>o("client",y.target.value),className:`input-field w-full ${a.client?"border-red-500":""}`,required:!0,children:[e.jsx("option",{value:"",children:"Select Client"}),i.map(y=>e.jsxs("option",{value:y._id,children:[y.name," (",y.clientCode,")"]},y._id))]}),a.client&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:a.client})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Time Entries"}),e.jsxs("div",{className:"space-y-3",children:[t.entries.map((y,N)=>e.jsx("div",{className:"p-4 bg-gray-700 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-12 gap-3 items-center",children:[e.jsxs("div",{className:"col-span-12 md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:j[N]}),e.jsx("input",{type:"date",value:y.date,onChange:w=>m(N,"date",w.target.value),className:"input-field w-full text-sm",readOnly:!0})]}),e.jsxs("div",{className:"col-span-12 md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Hours"}),e.jsx("input",{type:"number",value:y.hours,onChange:w=>m(N,"hours",w.target.value),className:`input-field w-full text-sm ${a[`entry_${N}_hours`]?"border-red-500":""}`,min:"0",max:"24",step:"0.25",placeholder:"0.00"}),a[`entry_${N}_hours`]&&e.jsx("p",{className:"text-red-400 text-xs mt-1",children:a[`entry_${N}_hours`]})]}),e.jsxs("div",{className:"col-span-12 md:col-span-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Task Description"}),e.jsx("input",{type:"text",value:y.taskDescription,onChange:w=>m(N,"taskDescription",w.target.value),className:"input-field w-full text-sm",placeholder:"What did you work on..."})]}),e.jsx("div",{className:"col-span-12 md:col-span-2 flex items-end",children:e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:y.billable,onChange:w=>m(N,"billable",w.target.checked),className:"rounded"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Billable"})]})})]})},N)),a.entries&&e.jsx("p",{className:"text-red-400 text-xs",children:a.entries})]}),e.jsx("div",{className:"mt-4 p-4 bg-gray-700 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Total Hours"}),e.jsx("p",{className:"text-white font-bold text-lg",children:g().toFixed(2)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Billable Hours"}),e.jsx("p",{className:"text-white font-bold text-lg",children:p().toFixed(2)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Non-Billable Hours"}),e.jsx("p",{className:"text-white font-bold text-lg",children:(g()-p()).toFixed(2)})]})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Notes"}),e.jsx("textarea",{value:t.notes,onChange:y=>o("notes",y.target.value),className:"input-field w-full",rows:"3",placeholder:"Additional notes..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{type:"button",onClick:f,className:"px-6 py-2 border border-gray-600 text-gray-300 rounded-lg hover:bg-gray-700",disabled:s,children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn-primary px-6 py-2 flex items-center space-x-2",disabled:s,children:[s&&e.jsx(cs,{size:16,className:"animate-spin"}),e.jsx("span",{children:s?"Creating...":"Create Timesheet"})]})]})]})]})})},x1=()=>{const[t,a]=v.useState([]),[s,n]=v.useState(!0),[r,i]=v.useState("all"),[l,c]=v.useState("all");v.useEffect(()=>{o()},[]);const o=async()=>{try{const h=await Y.get("/documents");a(h.data.data)}catch{E.error("Failed to load documents")}finally{n(!1)}},d=t.filter(h=>{const f=r==="all"||h.documentType===r,g=l==="all"||h.status===l;return f&&g}),x=h=>({pending:"badge-warning",verified:"badge-success",rejected:"badge-danger",expired:"badge-default"})[h]||"badge-default",m=h=>{if(!h)return null;const f=Math.ceil((new Date(h)-new Date)/(1e3*60*60*24));return f<=0?"Expired":f<=30?`Expires in ${f} days`:null};return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Documents"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage employee documents and compliance"})]}),e.jsxs("button",{className:"btn-primary flex items-center space-x-2",children:[e.jsx(Pe,{size:20}),e.jsx("span",{children:"Upload Document"})]})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("select",{value:r,onChange:h=>i(h.target.value),className:"input-field md:w-48",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"aadhaar",children:"Aadhaar"}),e.jsx("option",{value:"pan",children:"PAN"}),e.jsx("option",{value:"passport",children:"Passport"}),e.jsx("option",{value:"offer-letter",children:"Offer Letter"}),e.jsx("option",{value:"contract",children:"Contract"}),e.jsx("option",{value:"education",children:"Education"})]}),e.jsxs("select",{value:l,onChange:h=>c(h.target.value),className:"input-field md:w-48",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"verified",children:"Verified"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"expired",children:"Expired"})]})]})}),e.jsx("div",{className:"card p-0",children:e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Employee"}),e.jsx("th",{children:"Document Type"}),e.jsx("th",{children:"Document Name"}),e.jsx("th",{children:"Issue Date"}),e.jsx("th",{children:"Expiry Date"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:d.map(h=>{var g,p;const f=m(h.expiryDate);return e.jsxs("tr",{children:[e.jsxs("td",{children:[(g=h.employee)==null?void 0:g.firstName," ",(p=h.employee)==null?void 0:p.lastName]}),e.jsx("td",{className:"capitalize",children:h.documentType}),e.jsx("td",{children:h.documentName}),e.jsx("td",{children:h.issueDate?new Date(h.issueDate).toLocaleDateString():"-"}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:h.expiryDate?new Date(h.expiryDate).toLocaleDateString():"-"}),f&&e.jsxs("span",{className:"flex items-center text-xs text-yellow-500",children:[e.jsx(Ct,{size:14,className:"mr-1"}),f]})]})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${x(h.status)}`,children:h.status})}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{className:"p-2 text-blue-400 hover:bg-dark-800 rounded",children:"View"}),h.status==="pending"&&e.jsx("button",{className:"p-2 text-green-400 hover:bg-dark-800 rounded",children:e.jsx(we,{size:16})})]})})]},h._id)})})]})})}),d.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ue,{size:48,className:"mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No documents found"})]})]})},m1=()=>{const[t,a]=v.useState([]),[s,n]=v.useState(!0),[r,i]=v.useState("all");v.useEffect(()=>{l()},[]);const l=async()=>{try{const d=await Y.get("/compliance");a(d.data.data)}catch{E.error("Failed to load compliance records")}finally{n(!1)}},c=t.filter(d=>r==="all"||d.status===r),o=d=>({pending:"badge-warning","in-progress":"badge-info",completed:"badge-success",failed:"badge-danger",expired:"badge-default"})[d]||"badge-default";return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Compliance Tracker"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Track compliance requirements and deadlines"})]}),e.jsxs("button",{className:"btn-primary flex items-center space-x-2",children:[e.jsx(Pe,{size:20}),e.jsx("span",{children:"Add Compliance"})]})]}),e.jsx("div",{className:"card",children:e.jsxs("select",{value:r,onChange:d=>i(d.target.value),className:"input-field w-48",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"in-progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"failed",children:"Failed"}),e.jsx("option",{value:"expired",children:"Expired"})]})}),e.jsx("div",{className:"card p-0",children:e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Employee"}),e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Client"}),e.jsx("th",{children:"Due Date"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:c.map(d=>{var m,h,f;const x=d.dueDate?Math.ceil((new Date(d.dueDate)-new Date)/864e5):null;return e.jsxs("tr",{children:[e.jsxs("td",{children:[(m=d.employee)==null?void 0:m.firstName," ",(h=d.employee)==null?void 0:h.lastName]}),e.jsx("td",{children:d.title}),e.jsx("td",{className:"capitalize",children:d.complianceType}),e.jsx("td",{children:((f=d.client)==null?void 0:f.name)||"-"}),e.jsx("td",{children:e.jsxs("div",{children:[d.dueDate?new Date(d.dueDate).toLocaleDateString():"-",x!==null&&x<=15&&x>0&&e.jsxs("span",{className:"block text-xs text-yellow-500",children:["Due in ",x," days"]}),x!==null&&x<=0&&e.jsx("span",{className:"block text-xs text-red-500",children:"Overdue"})]})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${o(d.status)}`,children:d.status})}),e.jsx("td",{children:e.jsx("button",{className:"p-2 text-blue-400 hover:bg-dark-800 rounded",children:"View Details"})})]},d._id)})})]})})}),c.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(pi,{size:48,className:"mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No compliance records found"})]})]})},h1=()=>{const t=Ke(),[a,s]=v.useState([]),[n,r]=v.useState(!0),[i,l]=v.useState("all"),[c,o]=v.useState(!1),[d,x]=v.useState([]),[m,h]=v.useState({candidateCode:"",firstName:"",lastName:"",email:"",phone:"",appliedFor:"",experience:{years:0,months:0},currentCTC:"",expectedCTC:"",noticePeriod:"",source:"job-portal",resumeUrl:"",linkedinUrl:""}),[f,g]=v.useState(!1);v.useEffect(()=>{p(),u()},[]);const p=async()=>{try{const b=await Y.get("/candidates");s(b.data.data)}catch{E.error("Failed to load candidates")}finally{r(!1)}},u=async()=>{try{const b=await Y.get("/jobs");x(b.data.data.filter(C=>C.status==="active"))}catch{console.error("Failed to load jobs")}},j=async b=>{var C,S;b.preventDefault(),g(!0);try{const k=await Y.post("/candidates",m);s([k.data.data,...a]),E.success("Candidate added successfully"),o(!1),y()}catch(k){E.error(((S=(C=k.response)==null?void 0:C.data)==null?void 0:S.message)||"Failed to add candidate")}finally{g(!1)}},y=()=>{h({candidateCode:"",firstName:"",lastName:"",email:"",phone:"",appliedFor:"",experience:{years:0,months:0},currentCTC:"",expectedCTC:"",noticePeriod:"",source:"job-portal",resumeUrl:"",linkedinUrl:""})},N=b=>{t(`/candidates/${b}/timeline`)},w=a.filter(b=>i==="all"||b.stage===i),D=b=>({applied:"badge-info",screening:"badge-warning",shortlisted:"badge-success","interview-scheduled":"badge-info","interview-completed":"badge-warning","offer-extended":"badge-success","offer-accepted":"badge-success","offer-rejected":"badge-danger",joined:"badge-success",rejected:"badge-danger"})[b]||"badge-default";return n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Candidates"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage recruitment pipeline"})]}),e.jsxs("button",{onClick:()=>o(!0),className:"btn-primary flex items-center space-x-2",children:[e.jsx(Pe,{size:20}),e.jsx("span",{children:"Add Candidate"})]})]}),e.jsx("div",{className:"card",children:e.jsxs("select",{value:i,onChange:b=>l(b.target.value),className:"input-field w-64",children:[e.jsx("option",{value:"all",children:"All Stages"}),e.jsx("option",{value:"applied",children:"Applied"}),e.jsx("option",{value:"screening",children:"Screening"}),e.jsx("option",{value:"shortlisted",children:"Shortlisted"}),e.jsx("option",{value:"interview-scheduled",children:"Interview Scheduled"}),e.jsx("option",{value:"interview-completed",children:"Interview Completed"}),e.jsx("option",{value:"offer-extended",children:"Offer Extended"}),e.jsx("option",{value:"offer-accepted",children:"Offer Accepted"}),e.jsx("option",{value:"joined",children:"Joined"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})}),e.jsx("div",{className:"card p-0",children:e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Candidate"}),e.jsx("th",{children:"Applied For"}),e.jsx("th",{children:"Experience"}),e.jsx("th",{children:"Current CTC"}),e.jsx("th",{children:"Expected CTC"}),e.jsx("th",{children:"Source"}),e.jsx("th",{children:"Stage"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:w.map(b=>{var C,S,k,F,R;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-white",children:[b.firstName," ",b.lastName]}),e.jsx("p",{className:"text-sm text-gray-400",children:b.email}),e.jsx("p",{className:"text-sm text-gray-400",children:b.phone})]})}),e.jsx("td",{children:((C=b.appliedFor)==null?void 0:C.title)||"N/A"}),e.jsxs("td",{children:[((S=b.experience)==null?void 0:S.years)||0,"y ",((k=b.experience)==null?void 0:k.months)||0,"m"]}),e.jsxs("td",{children:["$",((F=b.currentCTC)==null?void 0:F.toLocaleString())||0]}),e.jsxs("td",{children:["$",((R=b.expectedCTC)==null?void 0:R.toLocaleString())||0]}),e.jsx("td",{className:"capitalize",children:b.source}),e.jsx("td",{children:e.jsx("span",{className:`badge ${D(b.stage)}`,children:b.stage})}),e.jsx("td",{children:e.jsx("button",{onClick:()=>N(b._id),className:"p-2 text-blue-400 hover:bg-dark-800 rounded",children:"View Details"})})]},b._id)})})]})})}),w.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ls,{size:48,className:"mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No candidates found"})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-900 rounded-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-dark-900 border-b border-dark-800 p-6 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Add New Candidate"}),e.jsx("button",{onClick:()=>{o(!1),y()},className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:24})})]}),e.jsxs("form",{onSubmit:j,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Employee Code *"}),e.jsx("input",{type:"text",required:!0,value:m.candidateCode,onChange:b=>h({...m,candidateCode:b.target.value}),className:"input-field",placeholder:"e.g., EMP001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"First Name *"}),e.jsx("input",{type:"text",required:!0,value:m.firstName,onChange:b=>h({...m,firstName:b.target.value}),className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Last Name *"}),e.jsx("input",{type:"text",required:!0,value:m.lastName,onChange:b=>h({...m,lastName:b.target.value}),className:"input-field"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email *"}),e.jsx("input",{type:"email",required:!0,value:m.email,onChange:b=>h({...m,email:b.target.value}),className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Phone *"}),e.jsx("input",{type:"tel",required:!0,value:m.phone,onChange:b=>h({...m,phone:b.target.value}),className:"input-field"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Applied For *"}),e.jsxs("select",{required:!0,value:m.appliedFor,onChange:b=>h({...m,appliedFor:b.target.value}),className:"input-field",children:[e.jsx("option",{value:"",children:"Select Job"}),d.map(b=>e.jsx("option",{value:b._id,children:b.title},b._id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Experience (Years)"}),e.jsx("input",{type:"number",min:"0",value:m.experience.years,onChange:b=>h({...m,experience:{...m.experience,years:parseInt(b.target.value)||0}}),className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Experience (Months)"}),e.jsx("input",{type:"number",min:"0",max:"11",value:m.experience.months,onChange:b=>h({...m,experience:{...m.experience,months:parseInt(b.target.value)||0}}),className:"input-field"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Current CTC"}),e.jsx("input",{type:"number",value:m.currentCTC,onChange:b=>h({...m,currentCTC:b.target.value}),className:"input-field",placeholder:"In USD"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Expected CTC"}),e.jsx("input",{type:"number",value:m.expectedCTC,onChange:b=>h({...m,expectedCTC:b.target.value}),className:"input-field",placeholder:"In USD"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Notice Period (Days)"}),e.jsx("input",{type:"number",value:m.noticePeriod,onChange:b=>h({...m,noticePeriod:b.target.value}),className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Source"}),e.jsxs("select",{value:m.source,onChange:b=>h({...m,source:b.target.value}),className:"input-field",children:[e.jsx("option",{value:"job-portal",children:"Job Portal"}),e.jsx("option",{value:"referral",children:"Referral"}),e.jsx("option",{value:"linkedin",children:"LinkedIn"}),e.jsx("option",{value:"direct",children:"Direct Application"}),e.jsx("option",{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Resume URL"}),e.jsx("input",{type:"url",value:m.resumeUrl,onChange:b=>h({...m,resumeUrl:b.target.value}),className:"input-field",placeholder:"https://..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"LinkedIn URL"}),e.jsx("input",{type:"url",value:m.linkedinUrl,onChange:b=>h({...m,linkedinUrl:b.target.value}),className:"input-field",placeholder:"https://linkedin.com/in/..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>{o(!1),y()},className:"btn-outline",disabled:f,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:f,children:f?"Adding...":"Add Candidate"})]})]})]})})]})},u1=()=>{const t=Ke(),[a,s]=v.useState([]),[n,r]=v.useState(!0),[i,l]=v.useState(""),[c,o]=v.useState("all"),[d,x]=v.useState("");v.useEffect(()=>{m()},[]);const m=async()=>{try{const u=await Y.get("/talent-pool");s(u.data.data)}catch{E.error("Failed to load talent pool")}finally{r(!1)}},h=async u=>{var j,y;if(window.confirm("Are you sure you want to delete this entry?"))try{await Y.delete(`/talent-pool/${u}`),s(N=>N.filter(w=>w._id!==u)),E.success("Entry deleted successfully")}catch(N){E.error(((y=(j=N.response)==null?void 0:j.data)==null?void 0:y.message)||"Failed to delete entry")}},f=async(u,j)=>{var y,N;try{const w=await Y.put(`/talent-pool/${u}/status`,{status:j});s(D=>D.map(b=>b._id===u?w.data.data:b)),E.success(`Status updated to ${j}`)}catch(w){E.error(((N=(y=w.response)==null?void 0:y.data)==null?void 0:N.message)||"Failed to update status")}},g=a.filter(u=>{const j=u.name.toLowerCase().includes(i.toLowerCase())||u.email.toLowerCase().includes(i.toLowerCase())||u.talentCode.toLowerCase().includes(i.toLowerCase())||u.desiredPosition.toLowerCase().includes(i.toLowerCase()),y=c==="all"||u.status===c,N=!d||u.desiredDepartment.toLowerCase().includes(d.toLowerCase());return j&&y&&N}),p=u=>({new:"bg-blue-600 text-white",reviewed:"bg-yellow-600 text-white",contacted:"bg-purple-600 text-white",shortlisted:"bg-green-600 text-white",rejected:"bg-red-600 text-white",hired:"bg-emerald-600 text-white"})[u]||"bg-gray-600 text-white";return n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Talent Pool"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage general resume submissions"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-gray-400",children:"Total Submissions:"}),e.jsx("span",{className:"text-2xl font-bold text-white",children:a.length})]})]}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(rt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",size:20}),e.jsx("input",{type:"text",placeholder:"Search by name, email, code, or position...",value:i,onChange:u=>l(u.target.value),className:"input-field pl-10"})]}),e.jsx("input",{type:"text",placeholder:"Filter by department...",value:d,onChange:u=>x(u.target.value),className:"input-field md:w-64"}),e.jsxs("select",{value:c,onChange:u=>o(u.target.value),className:"input-field md:w-48",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"reviewed",children:"Reviewed"}),e.jsx("option",{value:"contacted",children:"Contacted"}),e.jsx("option",{value:"shortlisted",children:"Shortlisted"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"hired",children:"Hired"})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(u=>{var j,y;return e.jsxs("div",{className:"card hover:border-primary-600 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:u.name}),e.jsx("p",{className:"text-sm text-gray-400",children:u.talentCode})]}),e.jsxs("select",{value:u.status,onChange:N=>f(u._id,N.target.value),className:`badge ${p(u.status)} cursor-pointer hover:opacity-80 text-xs`,onClick:N=>N.stopPropagation(),children:[e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"reviewed",children:"Reviewed"}),e.jsx("option",{value:"contacted",children:"Contacted"}),e.jsx("option",{value:"shortlisted",children:"Shortlisted"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"hired",children:"Hired"})]})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx("span",{className:"font-medium text-gray-300 w-32",children:"Email:"}),e.jsx("span",{className:"truncate",children:u.email})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx("span",{className:"font-medium text-gray-300 w-32",children:"Phone:"}),e.jsx("span",{children:u.phone})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx("span",{className:"font-medium text-gray-300 w-32",children:"Department:"}),e.jsx("span",{children:u.desiredDepartment})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx("span",{className:"font-medium text-gray-300 w-32",children:"Position:"}),e.jsx("span",{children:u.desiredPosition})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx("span",{className:"font-medium text-gray-300 w-32",children:"Experience:"}),e.jsxs("span",{children:[((j=u.experience)==null?void 0:j.years)||0," years ",((y=u.experience)==null?void 0:y.months)||0," months"]})]}),u.skills&&u.skills.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[u.skills.slice(0,3).map((N,w)=>e.jsx("span",{className:"inline-block bg-primary-900/30 text-primary-400 text-xs px-2 py-1 rounded",children:N},w)),u.skills.length>3&&e.jsxs("span",{className:"inline-block bg-gray-700 text-gray-300 text-xs px-2 py-1 rounded",children:["+",u.skills.length-3," more"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-4 border-t border-dark-800",children:[e.jsxs("button",{onClick:()=>t(`/talent-pool/${u._id}`),className:"flex-1 btn-outline text-sm py-2 flex items-center justify-center space-x-1",children:[e.jsx(Rt,{size:16}),e.jsx("span",{children:"View"})]}),e.jsxs("button",{className:"flex-1 btn-outline text-sm py-2 flex items-center justify-center space-x-1",title:"Move to Job Posting",children:[e.jsx(at,{size:16}),e.jsx("span",{children:"Move"})]}),e.jsx("button",{onClick:()=>h(u._id),className:"btn-outline text-sm py-2 px-3 text-red-500 hover:bg-red-500/10",children:e.jsx(ct,{size:16})})]}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Submitted: ",new Date(u.createdAt).toLocaleDateString()]})]},u._id)})}),g.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ra,{size:48,className:"mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No talent pool submissions found"})]})]})},Hc=()=>{const[t,a]=v.useState([]),[s,n]=v.useState(!0);v.useEffect(()=>{r()},[]);const r=async()=>{try{const l=await Y.get("/feedback");a(l.data.data)}catch{E.error("Failed to load feedback")}finally{n(!1)}},i=l=>({draft:"badge-default",submitted:"badge-warning",acknowledged:"badge-success",disputed:"badge-danger"})[l]||"badge-default";return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Performance Feedback"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Employee performance reviews and feedback"})]}),e.jsxs("button",{className:"btn-primary flex items-center space-x-2",children:[e.jsx(Pe,{size:20}),e.jsx("span",{children:"Add Feedback"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(l=>{var c,o,d;return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-white",children:[(c=l.employee)==null?void 0:c.firstName," ",(o=l.employee)==null?void 0:o.lastName]}),e.jsx("p",{className:"text-sm text-gray-400 capitalize",children:l.feedbackType})]}),e.jsx("span",{className:`badge ${i(l.status)}`,children:l.status})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Project:"}),e.jsx("span",{className:"text-white",children:((d=l.project)==null?void 0:d.name)||"N/A"})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Overall Rating:"}),e.jsxs("span",{className:"text-white font-bold",children:[l.overallRating||"N/A","/5"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Submitted By:"}),e.jsx("span",{className:"text-white capitalize",children:l.feedbackBy})]})]}),e.jsx("button",{className:"w-full btn-primary text-sm",children:"View Details"})]},l._id)})}),t.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ba,{size:48,className:"mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No feedback records found"})]})]})},p1=()=>{const[t,a]=v.useState([]),[s,n]=v.useState(!0);v.useEffect(()=>{r()},[]);const r=async()=>{try{const l=await Y.get("/exit-process");a(l.data.data)}catch{E.error("Failed to load exit processes")}finally{n(!1)}},i=l=>({initiated:"badge-info","clearance-pending":"badge-warning","clearance-completed":"badge-success",completed:"badge-success",cancelled:"badge-danger"})[l]||"badge-default";return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Exit Process"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage employee exit and clearance"})]}),e.jsxs("button",{className:"btn-primary flex items-center space-x-2",children:[e.jsx(Pe,{size:20}),e.jsx("span",{children:"Initiate Exit"})]})]}),e.jsx("div",{className:"card p-0",children:e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Employee"}),e.jsx("th",{children:"Exit Type"}),e.jsx("th",{children:"Last Working Date"}),e.jsx("th",{children:"Clearance Status"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:t.map(l=>{var x,m,h;const c=l.clearanceChecklist||{},o=Object.keys(c).length,d=Object.values(c).filter(f=>f.cleared).length;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-white",children:[(x=l.employee)==null?void 0:x.firstName," ",(m=l.employee)==null?void 0:m.lastName]}),e.jsx("p",{className:"text-sm text-gray-400",children:(h=l.employee)==null?void 0:h.employeeCode})]})}),e.jsx("td",{className:"capitalize",children:l.exitType}),e.jsx("td",{children:new Date(l.lastWorkingDate).toLocaleDateString()}),e.jsx("td",{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-32 bg-dark-800 rounded-full h-2",children:e.jsx("div",{className:"bg-primary-600 h-2 rounded-full",style:{width:`${d/o*100}%`}})}),e.jsxs("span",{className:"text-sm text-gray-400",children:[d,"/",o]})]})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${i(l.status)}`,children:l.status})}),e.jsx("td",{children:e.jsx("button",{className:"p-2 text-blue-400 hover:bg-dark-800 rounded",children:"View Details"})})]},l._id)})})]})})}),t.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ni,{size:48,className:"mx-auto text-gray-600 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"No exit processes found"})]})]})},f1=()=>{const[t,a]=v.useState({}),s=async(r,i={})=>{a(l=>({...l,[r]:!0}));try{const l=new URLSearchParams(i).toString(),c=await Y.get(`/reports/export/${r}?${l}`,{responseType:"blob"}),o=window.URL.createObjectURL(new Blob([c.data])),d=document.createElement("a");d.href=o,d.setAttribute("download",`${r}-${new Date().toISOString().split("T")[0]}.xlsx`),document.body.appendChild(d),d.click(),d.remove(),E.success("Report downloaded successfully")}catch{E.error("Failed to download report")}finally{a(l=>({...l,[r]:!1}))}},n=[{id:"employees",title:"Employee Report",description:"Export all employee data with personal and employment details",icon:la},{id:"attendance",title:"Attendance Report",description:"Export attendance records with work hours and status",icon:la},{id:"timesheets",title:"Timesheet Report",description:"Export project-wise timesheet data for billing",icon:la},{id:"payroll",title:"Payroll Report",description:"Export salary details, deductions, and net pay",icon:la}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Export Reports"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Download data in Excel format"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:n.map(r=>e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-primary-600/20 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(r.icon,{size:24,className:"text-primary-500"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:r.title}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:r.description}),e.jsxs("button",{onClick:()=>s(r.id),disabled:t[r.id],className:"btn-primary text-sm flex items-center space-x-2",children:[e.jsx(_t,{size:16}),e.jsx("span",{children:t[r.id]?"Downloading...":"Download Excel"})]})]})]})},r.id))})]})},g1=()=>{var i,l,c;const[t,a]=v.useState(null),[s,n]=v.useState(!0);v.useEffect(()=>{r()},[]);const r=async()=>{try{const o=await Y.get("/reports/compliance");a(o.data.data)}catch{E.error("Failed to load compliance report")}finally{n(!1)}};return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"w-12 h-12 border-4 border-primary-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Compliance Report"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Overview of compliance status"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Expiring Documents"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:((i=t==null?void 0:t.expiringDocuments)==null?void 0:i.length)||0})]}),e.jsxs("div",{className:"card",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Due Compliances"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:((l=t==null?void 0:t.dueCompliances)==null?void 0:l.length)||0})]}),e.jsxs("div",{className:"card",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-1",children:"Expiring Contracts"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:((c=t==null?void 0:t.expiringContracts)==null?void 0:c.length)||0})]})]})]})},Ox=async()=>(await Y.get("/employee/dashboard")).data,y1=async t=>(await Y.get("/employee/leaves/summary",{params:{year:t}})).data,b1=async t=>(await Y.get("/employee/leaves/balance",{params:{year:t}})).data,sl=async(t={})=>(await Y.get("/employee/leaves",{params:t})).data,Mx=async t=>(await Y.post("/employee/leaves/apply",t)).data,j1=async t=>(await Y.put(`/employee/leaves/${t}/cancel`)).data,v1=async(t={})=>(await Y.get("/employee/requests",{params:t})).data,N1=async t=>(await Y.post("/employee/requests",t)).data,w1=()=>{const{theme:t}=ot(),[a,s]=v.useState(!0),[n,r]=v.useState([]),[i,l]=v.useState([]),[c,o]=v.useState(!1),[d,x]=v.useState(new Date().getFullYear()),[m,h]=v.useState({leaveType:"casual",startDate:"",endDate:"",numberOfDays:1,halfDay:!1,halfDayPeriod:"first-half",reason:"",handoverNotes:"",emergencyContact:{name:"",phone:""},isUrgent:!1});v.useEffect(()=>{f()},[d]);const f=async()=>{var w,D,b,C;try{s(!0);const[S,k]=await Promise.all([y1(d),sl({year:d})]);r(((w=S.data)==null?void 0:w.balances)||((D=S.data)==null?void 0:D.data)||[]),l(((b=S.data)==null?void 0:b.history)||((C=k.data)==null?void 0:C.data)||k.data||[])}catch(S){console.error("Error fetching leave data:",S),E.error("Failed to load leave data"),r([]),l([])}finally{s(!1)}},g=()=>{if(m.startDate&&m.endDate){const w=new Date(m.startDate),D=new Date(m.endDate),b=Math.abs(D-w),C=Math.ceil(b/(1e3*60*60*24))+1;h({...m,numberOfDays:m.halfDay?.5:C})}};v.useEffect(()=>{g()},[m.startDate,m.endDate,m.halfDay]);const p=async w=>{var D,b;w.preventDefault();try{await Mx(m),E.success("Leave application submitted successfully"),o(!1),f(),j()}catch(C){E.error(((b=(D=C.response)==null?void 0:D.data)==null?void 0:b.message)||"Failed to apply for leave")}},u=async w=>{var D,b;if(window.confirm("Are you sure you want to cancel this leave application?"))try{await j1(w),E.success("Leave application cancelled"),f()}catch(C){E.error(((b=(D=C.response)==null?void 0:D.data)==null?void 0:b.message)||"Failed to cancel leave")}},j=()=>{h({leaveType:"casual",startDate:"",endDate:"",numberOfDays:1,halfDay:!1,halfDayPeriod:"first-half",reason:"",handoverNotes:"",emergencyContact:{name:"",phone:""},isUrgent:!1})},y=w=>{switch(w){case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},N=w=>{switch(w){case"approved":return e.jsx(we,{className:"w-4 h-4"});case"rejected":return e.jsx(ze,{className:"w-4 h-4"});case"pending":return e.jsx(Te,{className:"w-4 h-4"});default:return e.jsx(Ue,{className:"w-4 h-4"})}};return a?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-primary-600 border-t-transparent rounded-full animate-spin mx-auto"}),e.jsx("p",{className:`mt-4 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Loading leave data..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:`text-2xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Leave Management"}),e.jsx("p",{className:`mt-1 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Manage your leave applications and view balance"})]}),e.jsxs("button",{onClick:()=>o(!0),className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[e.jsx(Pe,{className:"w-5 h-5 mr-2"}),"Apply Leave"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:n&&n.length>0?n.map((w,D)=>e.jsxs("div",{className:`rounded-xl p-6 ${t==="dark"?"bg-dark-800":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:`text-sm font-medium uppercase ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:w.leaveType||"N/A"}),e.jsx(Fe,{className:"w-5 h-5 text-primary-600"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:t==="dark"?"text-gray-400":"text-gray-600",children:"Total"}),e.jsx("span",{className:`font-semibold ${t==="dark"?"text-white":"text-gray-900"}`,children:w.totalAllotted||w.total||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:t==="dark"?"text-gray-400":"text-gray-600",children:"Used"}),e.jsx("span",{className:`font-semibold ${t==="dark"?"text-white":"text-gray-900"}`,children:w.used||w.consumed||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:t==="dark"?"text-gray-400":"text-gray-600",children:"Pending"}),e.jsx("span",{className:`font-semibold ${t==="dark"?"text-white":"text-gray-900"}`,children:w.pending||0})]}),e.jsx("div",{className:"pt-2 border-t border-gray-200 dark:border-dark-700",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:`font-medium ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Remaining"}),e.jsx("span",{className:"font-bold text-primary-600 text-lg",children:w.remaining||w.available||0})]})})]})]},D)):e.jsx("div",{className:`col-span-full text-center py-8 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"No leave balance data available"})}),e.jsxs("div",{className:`rounded-xl p-6 ${t==="dark"?"bg-dark-800":"bg-white"}`,children:[e.jsx("h2",{className:`text-lg font-semibold mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Leave History"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:`border-b ${t==="dark"?"border-dark-700":"border-gray-200"}`,children:[e.jsx("th",{className:`text-left py-3 px-4 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Type"}),e.jsx("th",{className:`text-left py-3 px-4 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Duration"}),e.jsx("th",{className:`text-left py-3 px-4 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Days"}),e.jsx("th",{className:`text-left py-3 px-4 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Reason"}),e.jsx("th",{className:`text-left py-3 px-4 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Status"}),e.jsx("th",{className:`text-left py-3 px-4 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Actions"})]})}),e.jsx("tbody",{children:i&&i.length>0?i.map(w=>e.jsxs("tr",{className:`border-b ${t==="dark"?"border-dark-700":"border-gray-100"}`,children:[e.jsx("td",{className:`py-3 px-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:e.jsx("span",{className:"capitalize",children:w.leaveType})}),e.jsxs("td",{className:`py-3 px-4 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:[new Date(w.startDate).toLocaleDateString()," - ",new Date(w.endDate).toLocaleDateString()]}),e.jsx("td",{className:`py-3 px-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:w.numberOfDays}),e.jsx("td",{className:`py-3 px-4 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:e.jsx("span",{className:"truncate max-w-xs block",children:w.reason})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${y(w.status)}`,children:[N(w.status),e.jsx("span",{className:"ml-1 capitalize",children:w.status})]})}),e.jsx("td",{className:"py-3 px-4",children:w.status==="pending"&&e.jsx("button",{onClick:()=>u(w.id),className:"text-red-600 hover:text-red-700 text-sm font-medium",children:"Cancel"})})]},w.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:`py-8 text-center ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"No leave applications found"})})})]})})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:`rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto ${t==="dark"?"bg-dark-800":"bg-white"}`,children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:`text-xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Apply for Leave"}),e.jsx("button",{onClick:()=>o(!1),className:`p-2 rounded-lg ${t==="dark"?"hover:bg-dark-700":"hover:bg-gray-100"}`,children:e.jsx(Ee,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Leave Type *"}),e.jsxs("select",{value:m.leaveType,onChange:w=>h({...m,leaveType:w.target.value}),className:`w-full px-4 py-2 rounded-lg border ${t==="dark"?"bg-dark-700 border-dark-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0,children:[e.jsx("option",{value:"casual",children:"Casual Leave"}),e.jsx("option",{value:"sick",children:"Sick Leave"}),e.jsx("option",{value:"earned",children:"Earned Leave"}),e.jsx("option",{value:"maternity",children:"Maternity Leave"}),e.jsx("option",{value:"paternity",children:"Paternity Leave"}),e.jsx("option",{value:"unpaid",children:"Unpaid Leave"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Start Date *"}),e.jsx("input",{type:"date",value:m.startDate,onChange:w=>h({...m,startDate:w.target.value}),className:`w-full px-4 py-2 rounded-lg border ${t==="dark"?"bg-dark-700 border-dark-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"End Date *"}),e.jsx("input",{type:"date",value:m.endDate,onChange:w=>h({...m,endDate:w.target.value}),className:`w-full px-4 py-2 rounded-lg border ${t==="dark"?"bg-dark-700 border-dark-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:m.halfDay,onChange:w=>h({...m,halfDay:w.target.checked}),className:"mr-2"}),e.jsx("span",{className:t==="dark"?"text-gray-300":"text-gray-700",children:"Half Day"})]}),m.halfDay&&e.jsxs("select",{value:m.halfDayPeriod,onChange:w=>h({...m,halfDayPeriod:w.target.value}),className:`px-4 py-2 rounded-lg border ${t==="dark"?"bg-dark-700 border-dark-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"first-half",children:"First Half"}),e.jsx("option",{value:"second-half",children:"Second Half"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Reason *"}),e.jsx("textarea",{value:m.reason,onChange:w=>h({...m,reason:w.target.value}),rows:"3",className:`w-full px-4 py-2 rounded-lg border ${t==="dark"?"bg-dark-700 border-dark-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Handover Notes (Optional)"}),e.jsx("textarea",{value:m.handoverNotes,onChange:w=>h({...m,handoverNotes:w.target.value}),rows:"2",className:`w-full px-4 py-2 rounded-lg border ${t==="dark"?"bg-dark-700 border-dark-600 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:"Mention work handover details..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>o(!1),className:`px-4 py-2 rounded-lg ${t==="dark"?"bg-dark-700 text-gray-300 hover:bg-dark-600":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Submit Application"})]})]})]})})})]})},k1=()=>{const{theme:t}=ot(),[a,s]=v.useState(!0),[n,r]=v.useState([]),[i,l]=v.useState(!1),[c,o]=v.useState(null),[d,x]=v.useState({requestType:"hr-query",priority:"medium",subject:"",description:""});v.useEffect(()=>{m()},[]);const m=async()=>{try{s(!0);const j=await v1();r(j.data)}catch(j){console.error("Error fetching requests:",j),E.error("Failed to load requests")}finally{s(!1)}},h=async j=>{var y,N;j.preventDefault();try{await N1(d),E.success("Request submitted successfully"),l(!1),m(),f()}catch(w){E.error(((N=(y=w.response)==null?void 0:y.data)==null?void 0:N.message)||"Failed to create request")}},f=()=>{x({requestType:"hr-query",priority:"medium",subject:"",description:""})},g=j=>{switch(j){case"resolved":return"bg-green-100 text-green-800";case"closed":return"bg-gray-100 text-gray-800";case"in-progress":return"bg-blue-100 text-blue-800";case"pending-info":return"bg-yellow-100 text-yellow-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-orange-100 text-orange-800"}},p=j=>{switch(j){case"urgent":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-yellow-100 text-yellow-800";default:return"bg-blue-100 text-blue-800"}},u=[{value:"id-card-reissue",label:"ID Card Reissue"},{value:"hr-query",label:"HR Query"},{value:"bank-update",label:"Bank Update"},{value:"document-upload",label:"Document Upload"},{value:"address-change",label:"Address Change"},{value:"emergency-contact-update",label:"Emergency Contact Update"},{value:"salary-certificate",label:"Salary Certificate"},{value:"experience-letter",label:"Experience Letter"},{value:"noc-request",label:"NOC Request"},{value:"other",label:"Other"}];return a?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-primary-600 border-t-transparent rounded-full animate-spin mx-auto"}),e.jsx("p",{className:`mt-4 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Loading requests..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:`text-2xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Request Center"}),e.jsx("p",{className:`mt-1 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Submit and track your requests"})]}),e.jsxs("button",{onClick:()=>l(!0),className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:[e.jsx(Pe,{className:"w-5 h-5 mr-2"}),"New Request"]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:n.map((j,y)=>e.jsxs("div",{className:`rounded-xl p-6 cursor-pointer transition-all hover:shadow-lg ${t==="dark"?"bg-dark-800 hover:bg-dark-700":"bg-white hover:shadow-xl"}`,onClick:()=>o(j),children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:`text-lg font-semibold ${t==="dark"?"text-white":"text-gray-900"}`,children:j.subject}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium capitalize ${g(j.status)}`,children:j.status.replace("-"," ")}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium capitalize ${p(j.priority)}`,children:j.priority})]}),e.jsxs("p",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:[j.requestNumber," â€¢ ",j.requestType.replace("-"," ")]})]})}),e.jsx("p",{className:`text-sm mb-3 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:j.description}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-500",children:["Created: ",new Date(j.createdAt).toLocaleDateString()]}),j.comments&&j.comments.length>0&&e.jsxs("span",{className:`flex items-center ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:[e.jsx(f0,{className:"w-4 h-4 mr-1"}),j.comments.length," comments"]})]})]},y))}),n.length===0&&e.jsxs("div",{className:`rounded-xl p-12 text-center ${t==="dark"?"bg-dark-800":"bg-white"}`,children:[e.jsx(Ue,{className:`w-16 h-16 mx-auto mb-4 ${t==="dark"?"text-gray-600":"text-gray-400"}`}),e.jsx("p",{className:`text-lg ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"No requests submitted yet"})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:`rounded-xl max-w-2xl w-full ${t==="dark"?"bg-dark-800":"bg-white"}`,children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:`text-xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Create New Request"}),e.jsx("button",{onClick:()=>l(!1),className:`p-2 rounded-lg ${t==="dark"?"hover:bg-dark-700":"hover:bg-gray-100"}`,children:e.jsx(Ee,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Request Type *"}),e.jsx("select",{value:d.requestType,onChange:j=>x({...d,requestType:j.target.value}),className:`w-full px-4 py-2 rounded-lg border ${t==="dark"?"bg-dark-700 border-dark-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0,children:u.map(j=>e.jsx("option",{value:j.value,children:j.label},j.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Priority *"}),e.jsxs("select",{value:d.priority,onChange:j=>x({...d,priority:j.target.value}),className:`w-full px-4 py-2 rounded-lg border ${t==="dark"?"bg-dark-700 border-dark-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0,children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Subject *"}),e.jsx("input",{type:"text",value:d.subject,onChange:j=>x({...d,subject:j.target.value}),className:`w-full px-4 py-2 rounded-lg border ${t==="dark"?"bg-dark-700 border-dark-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0,maxLength:200})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Description *"}),e.jsx("textarea",{value:d.description,onChange:j=>x({...d,description:j.target.value}),rows:"5",className:`w-full px-4 py-2 rounded-lg border ${t==="dark"?"bg-dark-700 border-dark-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0,maxLength:2e3})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>l(!1),className:`px-4 py-2 rounded-lg ${t==="dark"?"bg-dark-700 text-gray-300 hover:bg-dark-600":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Submit Request"})]})]})]})})})]})},ms=()=>{const t=Ke(),a=ya(),{user:s}=kt(),r=(s==null?void 0:s.role)==="manager"?[{id:"home",label:"Home",icon:zn,path:"/employee/dashboard"},{id:"manager",label:"Manager",icon:bt,path:"/employee/manager/home"},{id:"leave",label:"Leave",icon:Fe,path:"/employee/leave/balance"},{id:"profile",label:"Me",icon:ft,path:"/employee/profile"},{id:"more",label:"More",icon:_a,path:"/employee/team"}]:[{id:"home",label:"Home",icon:zn,path:"/employee/dashboard"},{id:"leave",label:"Leave",icon:Fe,path:"/employee/leave/balance"},{id:"attendance",label:"Time",icon:Te,path:"/employee/attendance"},{id:"profile",label:"Me",icon:ft,path:"/employee/profile"},{id:"more",label:"More",icon:_a,path:"/employee/team"}],i=l=>a.pathname===l||a.pathname.startsWith(l+"/");return e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-[#2A2A3A] border-t border-gray-800 md:hidden z-50",children:e.jsx("div",{className:"flex items-center justify-around py-2 px-2",children:r.map(l=>{const c=l.icon,o=i(l.path);return e.jsxs("button",{onClick:()=>t(l.path),className:`flex flex-col items-center justify-center py-2 px-3 rounded-xl transition-all min-w-[60px] ${o?"text-[#A88BFF]":"text-gray-400"}`,children:[e.jsx(c,{className:`w-6 h-6 mb-1 ${o?"text-[#A88BFF]":""}`}),e.jsx("span",{className:"text-xs font-medium",children:l.label}),o&&e.jsx("div",{className:"w-8 h-1 bg-[#A88BFF] rounded-full mt-1"})]},l.id)})})})},qc=()=>{const t=Ke(),[a,s]=v.useState(!0),[n,r]=v.useState(null),[i,l]=v.useState("");v.useEffect(()=>{c()},[]);const c=async()=>{var y,N;try{s(!0);const w=await Ox();r(w.data)}catch(w){console.error("Error fetching dashboard data:",w),E.error(((N=(y=w.response)==null?void 0:y.data)==null?void 0:N.message)||"Failed to load dashboard data")}finally{s(!1)}},o=y=>new Date(y).toLocaleDateString("en-US",{month:"short",day:"numeric"}),d=(y,N)=>`${o(y)} â€“ ${o(N)}`;if(a)return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-[#1E1E2A]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-[#A88BFF] border-t-transparent rounded-full animate-spin mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-400",children:"Loading..."})]})});const{employee:x,shiftTiming:m,quickStats:h,upcomingHolidays:f,offThisWeek:g,birthdays:p,anniversaries:u,announcements:j}=n||{};return e.jsxs("div",{className:"min-h-screen bg-[#1E1E2A] pb-20 md:pb-6",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-[#1E1E2A] border-b border-gray-800 px-4 py-4",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"relative",children:[e.jsx(rt,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search your colleagues",value:i,onChange:y=>l(y.target.value),className:"w-full bg-[#2A2A3A] text-white pl-12 pr-4 py-3 rounded-2xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none transition-colors"})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>t("/employee/leave/apply"),className:"bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] text-white p-4 rounded-2xl shadow-lg hover:shadow-xl transition-all flex items-center justify-center space-x-3",children:[e.jsx(Fe,{className:"w-6 h-6"}),e.jsx("span",{className:"font-semibold",children:"Apply Leave"})]}),e.jsxs("button",{onClick:()=>t("/employee/leave/balance"),className:"bg-[#2A2A3A] text-white p-4 rounded-2xl border border-gray-700 hover:border-[#A88BFF] transition-all flex items-center justify-center space-x-3",children:[e.jsx(Te,{className:"w-6 h-6 text-[#A88BFF]"}),e.jsx("span",{className:"font-semibold",children:"Leave Balance"})]})]}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Shift Today"}),e.jsxs("h3",{className:"text-white text-xl font-bold",children:[m==null?void 0:m.name," (",m==null?void 0:m.startTime," - ",m==null?void 0:m.endTime,")"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Worked Hours"}),e.jsxs("p",{className:"text-[#A88BFF] text-xl font-bold",children:[m==null?void 0:m.workedToday," / ",m==null?void 0:m.totalHours,"h"]})]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] h-2 rounded-full",style:{width:"85%"}})})]}),g&&g.length>0&&e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-white text-lg font-semibold mb-4",children:"OFF THIS WEEK"}),e.jsx("div",{className:"flex overflow-x-auto space-x-4 pb-2 scrollbar-hide",children:g.map((y,N)=>e.jsxs("div",{className:"flex-shrink-0 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] flex items-center justify-center mb-2",children:y.employee.profileImage?e.jsx("img",{src:y.employee.profileImage,alt:y.employee.name,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-white text-xl font-bold",children:y.employee.name.charAt(0)})}),e.jsx("p",{className:"text-white text-xs font-medium w-20 truncate",children:y.employee.name.split(" ")[0]}),e.jsx("p",{className:"text-gray-400 text-xs",children:d(y.startDate,y.endDate)})]},N))})]}),((p==null?void 0:p.length)>0||(u==null?void 0:u.length)>0)&&e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-white text-lg font-semibold mb-4",children:"Wish Them ðŸŽ‰"}),e.jsxs("div",{className:"space-y-3",children:[p==null?void 0:p.slice(0,3).map((y,N)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#1E1E2A] rounded-xl",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-pink-500 to-purple-500 flex items-center justify-center",children:y.profileImage?e.jsx("img",{src:y.profileImage,alt:y.name,className:"w-full h-full rounded-full object-cover"}):e.jsx(g0,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:y.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:o(y.date)})]})]}),e.jsx("span",{className:"px-3 py-1 bg-pink-500/20 text-pink-400 rounded-full text-xs font-medium",children:"Birthday"})]},`birthday-${N}`)),u==null?void 0:u.slice(0,2).map((y,N)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#1E1E2A] rounded-xl",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center",children:y.profileImage?e.jsx("img",{src:y.profileImage,alt:y.name,className:"w-full h-full rounded-full object-cover"}):e.jsx(Ds,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:y.name}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[y.years," years"]})]})]}),e.jsx("span",{className:"px-3 py-1 bg-blue-500/20 text-blue-400 rounded-full text-xs font-medium",children:"Work Anniversary"})]},`anniversary-${N}`))]})]}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-white text-lg font-semibold",children:"Announcements"}),e.jsx(Ps,{className:"w-5 h-5 text-gray-400"})]}),j&&j.length>0?e.jsx("div",{className:"space-y-3",children:j.map((y,N)=>e.jsxs("div",{className:"p-4 bg-[#1E1E2A] rounded-xl",children:[e.jsx("h4",{className:"text-white font-medium mb-1",children:y.title}),e.jsx("p",{className:"text-gray-400 text-sm",children:y.message})]},N))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ps,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"No announcements at the moment"})]})]}),f&&f.length>0&&e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-white text-lg font-semibold mb-4",children:"Upcoming Holidays"}),e.jsx("div",{className:"space-y-4",children:f.map((y,N)=>e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-sm",children:new Date(y.date).getDate()})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-white font-medium",children:y.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:new Date(y.date).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${y.type==="public"?"bg-green-500/20 text-green-400":"bg-blue-500/20 text-blue-400"}`,children:y.type})]},N))})]})]}),e.jsx(ms,{})]})},S1=()=>{const t=Ke(),[a,s]=v.useState("balance"),[n,r]=v.useState(!0),[i,l]=v.useState([]),[c,o]=v.useState([]),[d,x]=v.useState(new Date().getFullYear());v.useEffect(()=>{m()},[d,a]);const m=async()=>{var u,j;try{if(r(!0),a==="balance"){const y=await b1(d);l(y.data)}else{const y=await sl({year:d});o(y.data)}}catch(y){console.error("Error fetching leave data:",y),E.error(((j=(u=y.response)==null?void 0:u.data)==null?void 0:j.message)||"Failed to load leave data")}finally{r(!1)}},h=u=>new Date(u).toLocaleDateString("en-US",{month:"short",day:"numeric"}),f=(u,j)=>{const y=new Date(u),N=new Date(j);return y.toDateString()===N.toDateString()?h(u):`${h(u)} â€“ ${h(j)}`},g=u=>{switch(u==null?void 0:u.toLowerCase()){case"approved":return"bg-green-500/20 text-green-400";case"rejected":return"bg-red-500/20 text-red-400";case"pending":return"bg-yellow-500/20 text-yellow-400";default:return"bg-gray-500/20 text-gray-400"}},p=u=>{switch(u==null?void 0:u.toLowerCase()){case"approved":return e.jsx(we,{className:"w-4 h-4"});case"rejected":return e.jsx(ze,{className:"w-4 h-4"});case"pending":return e.jsx(Te,{className:"w-4 h-4"});default:return null}};return e.jsxs("div",{className:"min-h-screen bg-[#1E1E2A] p-4 md:p-6 pb-24 md:pb-6",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-[#1E1E2A] border-b border-gray-800 px-4 py-4",children:e.jsx("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>t("/employee/home"),className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(wt,{className:"w-6 h-6"})}),e.jsx("h1",{className:"text-white text-xl font-bold",children:"Leave Management"})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-1 mb-6 inline-flex border border-gray-700",children:[e.jsx("button",{onClick:()=>s("balance"),className:`px-6 py-3 rounded-xl font-semibold transition-all ${a==="balance"?"bg-[#A88BFF] text-white":"text-gray-400 hover:text-white"}`,children:"Leave Balances"}),e.jsx("button",{onClick:()=>s("history"),className:`px-6 py-3 rounded-xl font-semibold transition-all ${a==="history"?"bg-[#A88BFF] text-white":"text-gray-400 hover:text-white"}`,children:"Leave History"})]}),a==="history"&&e.jsx("div",{className:"mb-6",children:e.jsxs("select",{value:d,onChange:u=>x(parseInt(u.target.value)),className:"bg-[#2A2A3A] text-white px-4 py-3 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none",children:[e.jsx("option",{value:2025,children:"Jan 2025 â€“ Dec 2025"}),e.jsx("option",{value:2024,children:"Jan 2024 â€“ Dec 2024"}),e.jsx("option",{value:2023,children:"Jan 2023 â€“ Dec 2023"})]})}),n?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"w-12 h-12 border-4 border-[#A88BFF] border-t-transparent rounded-full animate-spin"})}):e.jsxs(e.Fragment,{children:[a==="balance"&&e.jsx("div",{className:"space-y-4",children:i.map((u,j)=>e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700 hover:border-[#A88BFF] transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-white text-lg font-semibold mb-1",children:u.leaveType}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[u.consumed||0," days consumed"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-3xl font-bold text-[#A88BFF]",children:u.available||0}),e.jsx("p",{className:"text-gray-400 text-sm",children:"days available"})]})]}),u.total>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] h-2 rounded-full transition-all",style:{width:`${(u.consumed||0)/u.total*100}%`}})}),e.jsxs("div",{className:"flex justify-between mt-2 text-xs text-gray-400",children:[e.jsxs("span",{children:["Used: ",u.consumed||0]}),e.jsxs("span",{children:["Total: ",u.total]})]})]})]},j))}),a==="history"&&e.jsx("div",{className:"space-y-4",children:c.length>0?c.map((u,j)=>e.jsx("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700 hover:border-[#A88BFF] transition-all",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Fe,{className:"w-5 h-5 text-[#A88BFF]"}),e.jsx("h3",{className:"text-white text-lg font-semibold",children:f(u.startDate,u.endDate)})]}),e.jsxs("p",{className:"text-gray-400 text-sm mb-1",children:[u.numberOfDays," ",u.numberOfDays===1?"day":"days",", ",u.leaveType]}),u.reason&&e.jsxs("p",{className:"text-gray-500 text-sm italic mt-2",children:['"',u.reason,'"']}),u.approvedBy&&e.jsxs("p",{className:"text-gray-500 text-xs mt-2",children:["Approved by ",u.approvedBy]})]}),e.jsx("div",{className:"flex-shrink-0 ml-4",children:e.jsxs("span",{className:`inline-flex items-center space-x-1 px-3 py-2 rounded-full text-xs font-semibold uppercase ${g(u.status)}`,children:[p(u.status),e.jsx("span",{children:u.status})]})})]})},j)):e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-12 border border-gray-700 text-center",children:[e.jsx(Fe,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-white text-lg font-semibold mb-2",children:"No Leave History"}),e.jsxs("p",{className:"text-gray-400",children:["You haven't applied for any leaves in ",d]})]})})]}),e.jsx("div",{className:"mt-8",children:e.jsx("button",{onClick:()=>t("/employee/leave/apply"),className:"w-full bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] text-white py-4 rounded-2xl font-semibold shadow-lg hover:shadow-xl transition-all",children:"Apply for Leave"})})]}),e.jsx(ms,{})]})},C1=()=>{const t=Ke(),[a,s]=v.useState(1),[n,r]=v.useState(!1),[i,l]=v.useState(null),[c,o]=v.useState(null),[d,x]=v.useState(new Date),[m,h]=v.useState([]),[f,g]=v.useState({leaveType:"",reason:"",notifyTeammates:[]});v.useEffect(()=>{p()},[]);const p=async()=>{try{const K=(await sl({status:"approved"})).data.filter(Q=>new Date(Q.startDate)>=new Date);h(K.slice(0,5))}catch(B){console.error("Error fetching upcoming leaves:",B)}},u=B=>{const K=B.getFullYear(),Q=B.getMonth(),_=new Date(K,Q,1),ie=new Date(K,Q+1,0).getDate(),A=_.getDay();return{daysInMonth:ie,startingDayOfWeek:A,year:K,month:Q}},j=B=>{if(!B)return!1;const K=new Date(d.getFullYear(),d.getMonth(),B);return i&&!c?K.toDateString()===i.toDateString():i&&c?K>=i&&K<=c:!1},y=B=>{if(!B||!i||!c)return!1;const K=new Date(d.getFullYear(),d.getMonth(),B);return K>i&&K<c},N=B=>{const K=new Date(d.getFullYear(),d.getMonth(),B);!i||i&&c?(l(K),o(null)):K>=i?o(K):(l(K),o(null))},w=()=>{if(!i||!c)return i?1:0;const B=Math.abs(c-i);return Math.ceil(B/(1e3*60*60*24))+1},D=async()=>{var B,K;if(!f.leaveType||!i||!c){E.error("Please fill all required fields");return}try{r(!0),await Mx({leaveType:f.leaveType,startDate:i.toISOString(),endDate:c.toISOString(),reason:f.reason,notifyTeammates:f.notifyTeammates}),E.success("Leave application submitted successfully!"),t("/employee/leave/balance")}catch(Q){console.error("Error applying for leave:",Q),E.error(((K=(B=Q.response)==null?void 0:B.data)==null?void 0:K.message)||"Failed to submit leave application")}finally{r(!1)}},{daysInMonth:b,startingDayOfWeek:C,year:S,month:k}=u(d),F=Array.from({length:b},(B,K)=>K+1),T=[...Array.from({length:C},(B,K)=>null),...F],M=["January","February","March","April","May","June","July","August","September","October","November","December"],X=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],q=["Personal Leave","Sick Leave","Comp Offs","Floater Leave","Marriage Leave","Maternity Leave","Unpaid Leave"];return e.jsxs("div",{className:"min-h-screen bg-[#1E1E2A] p-4 md:p-6 pb-24 md:pb-6",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-[#1E1E2A] border-b border-gray-800 px-4 py-4",children:e.jsx("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>a===1?t("/employee/home"):s(1),className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(wt,{className:"w-6 h-6"})}),e.jsx("h1",{className:"text-white text-xl font-bold",children:a===1?"Select Date":"Apply Leave"})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:a===1?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700 mb-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Start Date"}),e.jsx("div",{className:"bg-[#1E1E2A] rounded-xl p-4 border border-gray-700",children:e.jsx("p",{className:"text-white font-semibold",children:i?i.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Select date"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"End Date"}),e.jsx("div",{className:"bg-[#1E1E2A] rounded-xl p-4 border border-gray-700",children:e.jsx("p",{className:"text-white font-semibold",children:c?c.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Select date"})})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:()=>x(new Date(S,k-1)),className:"p-2 text-gray-400 hover:text-white transition-colors",children:e.jsx(vi,{className:"w-6 h-6"})}),e.jsxs("h3",{className:"text-white text-lg font-semibold",children:[M[k]," ",S]}),e.jsx("button",{onClick:()=>x(new Date(S,k+1)),className:"p-2 text-gray-400 hover:text-white transition-colors",children:e.jsx(jr,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"grid grid-cols-7 gap-2",children:[X.map(B=>e.jsx("div",{className:"text-center text-gray-400 text-sm font-medium py-2",children:B},B)),T.map((B,K)=>e.jsx("button",{onClick:()=>B&&N(B),disabled:!B,className:`aspect-square rounded-xl flex items-center justify-center text-sm font-medium transition-all ${B?j(B)&&i&&c?"bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] text-white":j(B)?"bg-[#A88BFF] text-white":y(B)?"bg-[#A88BFF]/30 text-white":"bg-[#1E1E2A] text-gray-400 hover:bg-[#A88BFF]/20 hover:text-white":"invisible"}`,children:B},K))]})]})]}),m.length>0&&e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700 mb-6",children:[e.jsx("h3",{className:"text-white text-lg font-semibold mb-4",children:"Upcoming Leaves"}),e.jsx("div",{className:"space-y-3",children:m.map((B,K)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#1E1E2A] rounded-xl",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:B.leaveType}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[new Date(B.startDate).toLocaleDateString("en-US",{month:"short",day:"numeric"})," -",new Date(B.endDate).toLocaleDateString("en-US",{month:"short",day:"numeric"})]})]}),e.jsxs("span",{className:"text-[#A88BFF] text-sm font-medium",children:[B.numberOfDays," ",B.numberOfDays===1?"day":"days"]})]},K))})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-[#2A2A3A] border-t border-gray-700 p-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Leave request is for"}),e.jsxs("p",{className:"text-white text-lg font-bold",children:[w()," ",w()===1?"Day":"Days"]})]}),e.jsx("button",{onClick:()=>s(2),disabled:!i||!c,className:`px-8 py-3 rounded-2xl font-semibold transition-all ${i&&c?"bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] text-white hover:shadow-lg":"bg-gray-700 text-gray-500 cursor-not-allowed"}`,children:"NEXT"})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700 mb-24",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Leave Type *"}),e.jsxs("select",{value:f.leaveType,onChange:B=>g({...f,leaveType:B.target.value}),className:"w-full bg-[#1E1E2A] text-white px-4 py-3 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none",children:[e.jsx("option",{value:"",children:"Select leave type"}),q.map(B=>e.jsx("option",{value:B,children:B},B))]})]}),e.jsx("div",{className:"bg-[#1E1E2A] rounded-xl p-4 border border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Duration"}),e.jsxs("p",{className:"text-white font-semibold",children:[i==null?void 0:i.toLocaleDateString("en-US",{month:"short",day:"numeric"})," -",c==null?void 0:c.toLocaleDateString("en-US",{month:"short",day:"numeric"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[#A88BFF] text-2xl font-bold",children:w()}),e.jsx("p",{className:"text-gray-400 text-sm",children:"days"})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Note to Approver"}),e.jsx("textarea",{value:f.reason,onChange:B=>g({...f,reason:B.target.value}),placeholder:"Add a reason for your leave...",rows:4,className:"w-full bg-[#1E1E2A] text-white px-4 py-3 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Notify your teammates"}),e.jsxs("button",{className:"w-full bg-[#1E1E2A] text-gray-400 px-4 py-3 rounded-xl border border-gray-700 hover:border-[#A88BFF] transition-colors flex items-center justify-center space-x-2",children:[e.jsx(Pe,{className:"w-5 h-5"}),e.jsx("span",{children:"Add teammates to notify"})]})]})]})}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-[#2A2A3A] border-t border-gray-700 p-4",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("button",{onClick:D,disabled:n||!f.leaveType,className:`w-full py-4 rounded-2xl font-semibold transition-all ${n||!f.leaveType?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] text-white hover:shadow-lg"}`,children:n?"Submitting...":"Request Leave"})})})]})}),e.jsx(ms,{})]})},A1=()=>{const t=Ke(),[a,s]=v.useState("time"),n=[{id:"time",label:"Time",icon:Te},{id:"finances",label:"Finances",icon:at},{id:"performance",label:"Performance",icon:Ds},{id:"documents",label:"Documents",icon:Ue}],r=[{title:"Raise Request",subtitle:"WFH, On Duty, Partial Day",icon:Ue,action:"/employee/attendance/request"},{title:"Logs & Shifts",subtitle:"View attendance logs",icon:Te,action:"/employee/attendance/logs"},{title:"Requests History",subtitle:"View past requests",icon:Fe,action:"/employee/attendance/history"},{title:"Leave",subtitle:"Apply and manage leaves",icon:Fe,action:"/employee/leave/balance"},{title:"Upcoming Holidays",subtitle:"View holiday calendar",icon:Fe,action:"/employee/holidays"}];return e.jsxs("div",{className:"min-h-screen bg-[#1E1E2A] p-4 md:p-6 pb-24 md:pb-6",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-[#1E1E2A] border-b border-gray-800 px-4 py-4",children:e.jsx("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>t("/employee/home"),className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(wt,{className:"w-6 h-6"})}),e.jsx("h1",{className:"text-white text-xl font-bold",children:"Attendance & More"})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[e.jsx("div",{className:"flex overflow-x-auto space-x-2 mb-6 pb-2 scrollbar-hide",children:n.map(i=>{const l=i.icon;return e.jsxs("button",{onClick:()=>s(i.id),className:`flex items-center space-x-2 px-6 py-3 rounded-xl font-semibold whitespace-nowrap transition-all ${a===i.id?"bg-[#A88BFF] text-white":"bg-[#2A2A3A] text-gray-400 hover:text-white border border-gray-700"}`,children:[e.jsx(l,{className:"w-5 h-5"}),e.jsx("span",{children:i.label})]},i.id)})}),a==="time"&&e.jsx("div",{className:"space-y-4",children:r.map((i,l)=>e.jsxs("button",{onClick:()=>t(i.action),className:"w-full bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700 hover:border-[#A88BFF] transition-all flex items-center justify-between group",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-[#A88BFF]/20 flex items-center justify-center group-hover:bg-[#A88BFF] transition-colors",children:e.jsx(i.icon,{className:"w-6 h-6 text-[#A88BFF] group-hover:text-white transition-colors"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-white font-semibold text-lg",children:i.title}),e.jsx("p",{className:"text-gray-400 text-sm",children:i.subtitle})]})]}),e.jsx(jr,{className:"w-6 h-6 text-gray-400 group-hover:text-[#A88BFF] transition-colors"})]},l))}),a==="finances"&&e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-12 border border-gray-700 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-[#A88BFF]/20 flex items-center justify-center mx-auto mb-6",children:e.jsx(at,{className:"w-10 h-10 text-[#A88BFF]"})}),e.jsx("h3",{className:"text-white text-xl font-bold mb-2",children:"Finances are not configured"}),e.jsx("p",{className:"text-gray-400",children:"Your salary and expenses have not been configured yet."})]}),a==="performance"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700 hover:border-[#A88BFF] transition-all",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-[#A88BFF]/20 flex items-center justify-center",children:e.jsx(Ds,{className:"w-6 h-6 text-[#A88BFF]"})}),e.jsx("h3",{className:"text-white text-lg font-semibold",children:"Personal Feedback"})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"No feedback available at the moment"})]}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700 hover:border-[#A88BFF] transition-all",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-[#A88BFF]/20 flex items-center justify-center",children:e.jsx(Ds,{className:"w-6 h-6 text-[#A88BFF]"})}),e.jsx("h3",{className:"text-white text-lg font-semibold",children:"Praise"})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"No praise received yet"})]})]}),a==="documents"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700 hover:border-[#A88BFF] transition-all",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-[#A88BFF]/20 flex items-center justify-center",children:e.jsx(Ue,{className:"w-6 h-6 text-[#A88BFF]"})}),e.jsx("h3",{className:"text-white text-lg font-semibold",children:"Org Documents"})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"No organization documents available"})]}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700 hover:border-[#A88BFF] transition-all",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-[#A88BFF]/20 flex items-center justify-center",children:e.jsx(Ue,{className:"w-6 h-6 text-[#A88BFF]"})}),e.jsx("h3",{className:"text-white text-lg font-semibold",children:"My Documents"})]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"No personal documents uploaded"})]})]})]}),e.jsx(ms,{})]})},E1=()=>{var j;const t=Ke(),[a,s]=v.useState(!0),[n,r]=v.useState(""),[i,l]=v.useState("all"),[c,o]=v.useState(null);v.useEffect(()=>{d()},[]);const d=async()=>{var y,N;try{s(!0);const w=await Ox();o(w.data)}catch(w){console.error("Error fetching team data:",w),E.error(((N=(y=w.response)==null?void 0:y.data)==null?void 0:N.message)||"Failed to load team data")}finally{s(!1)}},x=y=>new Date(y).toLocaleDateString("en-US",{month:"short",day:"numeric"}),m=(y,N)=>`${x(y)} â€“ ${x(N)}`,h=((j=c==null?void 0:c.teamMembers)==null?void 0:j.filter(y=>y.name.toLowerCase().includes(n.toLowerCase())||y.designation.toLowerCase().includes(n.toLowerCase())))||[];if(a)return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-[#1E1E2A]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-[#A88BFF] border-t-transparent rounded-full animate-spin mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-400",children:"Loading team..."})]})});const{employee:f,teamMembers:g,manager:p,offThisWeek:u}=c||{};return e.jsxs("div",{className:"min-h-screen bg-[#1E1E2A] p-4 md:p-6 pb-24 md:pb-6",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-[#1E1E2A] border-b border-gray-800 px-4 py-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsx("button",{onClick:()=>t("/employee/home"),className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(wt,{className:"w-6 h-6"})}),e.jsx("h1",{className:"text-white text-xl font-bold",children:"My Team"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(rt,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search team members...",value:n,onChange:y=>r(y.target.value),className:"w-full bg-[#2A2A3A] text-white pl-12 pr-4 py-3 rounded-2xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none transition-colors"})]})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6 space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] rounded-2xl p-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white/80 text-sm mb-1",children:"Department"}),e.jsx("h2",{className:"text-2xl font-bold",children:(f==null?void 0:f.department)||"Technology"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-white/20 flex items-center justify-center backdrop-blur-sm",children:e.jsx(Re,{className:"w-8 h-8 text-white"})}),e.jsxs("p",{className:"text-sm mt-2",children:[(g==null?void 0:g.length)||0," people"]})]})]})}),u&&u.length>0&&e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-white text-lg font-semibold mb-4",children:"Off This Week"}),e.jsx("div",{className:"flex overflow-x-auto space-x-4 pb-2 scrollbar-hide",children:u.map((y,N)=>e.jsxs("div",{className:"flex-shrink-0 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] flex items-center justify-center mb-2",children:y.employee.profileImage?e.jsx("img",{src:y.employee.profileImage,alt:y.employee.name,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-white text-xl font-bold",children:y.employee.name.charAt(0)})}),e.jsx("p",{className:"text-white text-xs font-medium w-20 truncate",children:y.employee.name.split(" ")[0]}),e.jsx("p",{className:"text-gray-400 text-xs",children:m(y.startDate,y.endDate)})]},N))})]}),e.jsxs("div",{className:"flex items-center space-x-2 mb-6 overflow-x-auto scrollbar-hide",children:[e.jsx("button",{onClick:()=>l("all"),className:`px-6 py-3 rounded-xl font-semibold whitespace-nowrap transition-all ${i==="all"?"bg-[#A88BFF] text-white":"bg-[#2A2A3A] text-gray-400 hover:text-white border border-gray-700"}`,children:"All"}),e.jsx("button",{onClick:()=>l("late"),className:`px-6 py-3 rounded-xl font-semibold whitespace-nowrap transition-all ${i==="late"?"bg-[#A88BFF] text-white":"bg-[#2A2A3A] text-gray-400 hover:text-white border border-gray-700"}`,children:"Late arrivals"}),e.jsx("button",{onClick:()=>l("ontime"),className:`px-6 py-3 rounded-xl font-semibold whitespace-nowrap transition-all ${i==="ontime"?"bg-[#A88BFF] text-white":"bg-[#2A2A3A] text-gray-400 hover:text-white border border-gray-700"}`,children:"On Time"})]}),p&&e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-white text-lg font-semibold mb-4",children:"Manager"}),e.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-[#1E1E2A] rounded-xl",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] flex items-center justify-center flex-shrink-0",children:p.profileImage?e.jsx("img",{src:p.profileImage,alt:p.name,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-white text-2xl font-bold",children:p.name.charAt(0)})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-white font-semibold text-lg",children:p.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:p.designation})]})]})]}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsxs("h3",{className:"text-white text-lg font-semibold mb-4",children:["Team Members (",h.length,")"]}),e.jsx("div",{className:"space-y-3",children:h.length>0?h.map((y,N)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#1E1E2A] rounded-xl hover:border hover:border-[#A88BFF] transition-all",children:[e.jsxs("div",{className:"flex items-center space-x-4 flex-1",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] flex items-center justify-center flex-shrink-0",children:y.profileImage?e.jsx("img",{src:y.profileImage,alt:y.name,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-white text-lg font-bold",children:y.name.charAt(0)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-white font-semibold truncate",children:y.name}),e.jsx("p",{className:"text-gray-400 text-sm truncate",children:y.designation}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[y.email&&e.jsxs("a",{href:`mailto:${y.email}`,className:"flex items-center space-x-1 text-gray-500 hover:text-[#A88BFF] text-xs transition-colors",children:[e.jsx(ut,{className:"w-3 h-3"}),e.jsx("span",{className:"truncate max-w-[150px]",children:y.email})]}),y.phone&&e.jsxs("a",{href:`tel:${y.phone}`,className:"flex items-center space-x-1 text-gray-500 hover:text-[#A88BFF] text-xs transition-colors",children:[e.jsx(ts,{className:"w-3 h-3"}),e.jsx("span",{children:y.phone})]})]})]})]}),e.jsxs("div",{className:"flex-shrink-0 ml-4",children:[i==="ontime"&&e.jsxs("div",{className:"flex items-center space-x-1 text-green-400",children:[e.jsx(we,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs font-medium",children:"On Time"})]}),i==="late"&&e.jsxs("div",{className:"flex items-center space-x-1 text-yellow-400",children:[e.jsx(Te,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs font-medium",children:"Late"})]})]})]},N)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Re,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"No team members found"})]})})]})]}),e.jsx(ms,{})]})},F1=()=>{const[t,a]=v.useState(new Date().getFullYear()),s=[{month:"November 2024",salary:"â‚¹75,000",netPay:"â‚¹68,500",date:"Nov 30, 2024",status:"paid"},{month:"October 2024",salary:"â‚¹75,000",netPay:"â‚¹68,500",date:"Oct 31, 2024",status:"paid"},{month:"September 2024",salary:"â‚¹75,000",netPay:"â‚¹68,500",date:"Sep 30, 2024",status:"paid"}],n={basic:"â‚¹45,000",hra:"â‚¹18,000",allowances:"â‚¹12,000",gross:"â‚¹75,000",deductions:"â‚¹6,500",netPay:"â‚¹68,500"};return e.jsxs("div",{className:"min-h-screen bg-[#1E1E2A] p-4 md:p-6 pb-24 md:pb-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Payslips"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"View and download your salary slips"})]}),e.jsxs("select",{value:t,onChange:r=>a(parseInt(r.target.value)),className:"bg-[#2A2A3A] text-white px-4 py-2 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none",children:[e.jsx("option",{value:2024,children:"2024"}),e.jsx("option",{value:2023,children:"2023"}),e.jsx("option",{value:2022,children:"2022"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Gross Salary"}),e.jsx(tt,{className:"w-5 h-5 text-[#A88BFF]"})]}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:n.gross}),e.jsx("p",{className:"text-green-400 text-sm mt-1",children:"Per month"})]}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Deductions"}),e.jsx(Ss,{className:"w-5 h-5 text-red-400"})]}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:n.deductions}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Tax + PF"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] rounded-2xl p-6 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-white/80 text-sm",children:"Net Pay"}),e.jsx(tt,{className:"w-5 h-5 text-white"})]}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:n.netPay}),e.jsx("p",{className:"text-white/80 text-sm mt-1",children:"Take home"})]})]}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-white text-lg font-semibold mb-4",children:"Salary Breakdown"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#1E1E2A] rounded-xl",children:[e.jsx("span",{className:"text-gray-400",children:"Basic Salary"}),e.jsx("span",{className:"text-white font-medium",children:n.basic})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#1E1E2A] rounded-xl",children:[e.jsx("span",{className:"text-gray-400",children:"HRA"}),e.jsx("span",{className:"text-white font-medium",children:n.hra})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#1E1E2A] rounded-xl",children:[e.jsx("span",{className:"text-gray-400",children:"Allowances"}),e.jsx("span",{className:"text-white font-medium",children:n.allowances})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#1E1E2A] rounded-xl",children:[e.jsx("span",{className:"text-gray-400",children:"Gross Salary"}),e.jsx("span",{className:"text-green-400 font-medium",children:n.gross})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-[#1E1E2A] rounded-xl",children:[e.jsx("span",{className:"text-gray-400",children:"Deductions"}),e.jsxs("span",{className:"text-red-400 font-medium",children:["-",n.deductions]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-[#A88BFF]/20 to-[#8B6FE8]/20 rounded-xl border border-[#A88BFF]/30",children:[e.jsx("span",{className:"text-white font-medium",children:"Net Pay"}),e.jsx("span",{className:"text-[#A88BFF] font-bold",children:n.netPay})]})]})]})]}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-white text-lg font-semibold mb-4",children:"Payslip History"}),e.jsx("div",{className:"space-y-3",children:s.map((r,i)=>e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between p-4 bg-[#1E1E2A] rounded-xl hover:border hover:border-[#A88BFF] transition-all cursor-pointer gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] flex items-center justify-center flex-shrink-0",children:e.jsx(Ue,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-medium",children:r.month}),e.jsx("p",{className:"text-gray-400 text-sm",children:r.date})]})]}),e.jsxs("div",{className:"flex items-center justify-between md:space-x-6",children:[e.jsxs("div",{className:"text-left md:text-right",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Net Pay"}),e.jsx("p",{className:"text-white font-semibold",children:r.netPay})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"px-3 py-1 bg-green-500/20 text-green-400 rounded-full text-xs font-medium",children:r.status.toUpperCase()}),e.jsx("button",{className:"p-2 rounded-xl bg-[#2A2A3A] hover:bg-[#A88BFF] transition-colors",children:e.jsx(_t,{className:"w-5 h-5 text-white"})})]})]})]},i))})]})]}),e.jsx(ms,{})]})},T1=()=>{const[t,a]=v.useState("all"),s=[{id:1,name:"HRMS Portal Development",client:"Internal",status:"active",progress:75,team:5,deadline:"Dec 31, 2024",role:"Full Stack Developer"},{id:2,name:"E-commerce Platform",client:"ABC Corp",status:"active",progress:45,team:8,deadline:"Jan 15, 2025",role:"Backend Developer"},{id:3,name:"Mobile App Redesign",client:"XYZ Ltd",status:"completed",progress:100,team:6,deadline:"Nov 20, 2024",role:"UI/UX Developer"}],n=[{id:"all",label:"All Projects"},{id:"active",label:"Active"},{id:"completed",label:"Completed"}],r=t==="all"?s:s.filter(i=>i.status===t);return e.jsxs("div",{className:"min-h-screen bg-[#1E1E2A] p-4 md:p-6 pb-24 md:pb-6",children:[e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"My Projects"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Track your project assignments and progress"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Total Projects"}),e.jsx(at,{className:"w-5 h-5 text-[#A88BFF]"})]}),e.jsx("h3",{className:"text-3xl font-bold text-white",children:s.length})]}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Active"}),e.jsx(st,{className:"w-5 h-5 text-blue-400"})]}),e.jsx("h3",{className:"text-3xl font-bold text-white",children:s.filter(i=>i.status==="active").length})]}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Completed"}),e.jsx(we,{className:"w-5 h-5 text-green-400"})]}),e.jsx("h3",{className:"text-3xl font-bold text-white",children:s.filter(i=>i.status==="completed").length})]})]}),e.jsx("div",{className:"flex items-center space-x-2 overflow-x-auto pb-2 scrollbar-hide",children:n.map(i=>e.jsx("button",{onClick:()=>a(i.id),className:`px-4 py-2 rounded-xl font-medium transition-all ${t===i.id?"bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] text-white shadow-lg":"bg-[#2A2A3A] text-gray-400 hover:text-white border border-gray-700"}`,children:i.label},i.id))}),e.jsx("div",{className:"space-y-4",children:r.map(i=>e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700 hover:border-[#A88BFF] transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] flex items-center justify-center flex-shrink-0",children:e.jsx(at,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white text-lg font-semibold",children:i.name}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:i.client}),e.jsx("p",{className:"text-[#A88BFF] text-sm mt-1",children:i.role})]})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${i.status==="active"?"bg-blue-500/20 text-blue-400":"bg-green-500/20 text-green-400"}`,children:i.status.toUpperCase()})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Progress"}),e.jsxs("span",{className:"text-white font-medium",children:[i.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] h-2 rounded-full transition-all",style:{width:`${i.progress}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Re,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"text-gray-400 text-sm",children:[i.team," members"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-400 text-sm",children:i.deadline})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-400 text-sm",children:i.status==="completed"?"Completed":"In Progress"})]})]})]},i.id))}),r.length===0&&e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-12 border border-gray-700 text-center",children:[e.jsx(at,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-white text-lg font-semibold mb-2",children:"No projects found"}),e.jsx("p",{className:"text-gray-400",children:"No projects match the selected filter"})]})]}),e.jsx(ms,{})]})},D1=()=>{const[t,a]=v.useState([]),[s,n]=v.useState(!0),[r,i]=v.useState(!1),[l,c]=v.useState(null),[o,d]=v.useState({relationship:"",name:"",dateOfBirth:"",gender:"",aadhaarNumber:"",panNumber:"",isNominee:!1,nomineeFor:[],nomineePercentage:100,contactNumber:"",address:{street:"",city:"",state:"",zipCode:"",country:"India"}});v.useEffect(()=>{x()},[]);const x=async()=>{var p,u;try{n(!0);const j=await Y.get("/employee/profile/family");a(j.data.data)}catch(j){E.error(((u=(p=j.response)==null?void 0:p.data)==null?void 0:u.message)||"Failed to fetch family details")}finally{n(!1)}},m=p=>{const{name:u,value:j,type:y,checked:N}=p.target;if(u.startsWith("address.")){const w=u.split(".")[1];d(D=>({...D,address:{...D.address,[w]:j}}))}else if(u==="isNominee")d(w=>({...w,[u]:N}));else if(u==="nomineeFor"){const w=Array.from(p.target.selectedOptions,D=>D.value);d(D=>({...D,[u]:w}))}else d(w=>({...w,[u]:j}))},h=async p=>{var u,j;p.preventDefault();try{l?(await Y.put(`/employee/profile/family/${l._id}`,o),E.success("Family detail updated successfully")):(await Y.post("/employee/profile/family",o),E.success("Family detail added successfully")),i(!1),c(null),d({relationship:"",name:"",dateOfBirth:"",gender:"",aadhaarNumber:"",panNumber:"",isNominee:!1,nomineeFor:[],nomineePercentage:100,contactNumber:"",address:{street:"",city:"",state:"",zipCode:"",country:"India"}}),x()}catch(y){E.error(((j=(u=y.response)==null?void 0:u.data)==null?void 0:j.message)||"Failed to save family detail")}},f=p=>{c(p),d({relationship:p.relationship||"",name:p.name||"",dateOfBirth:p.dateOfBirth?new Date(p.dateOfBirth).toISOString().split("T")[0]:"",gender:p.gender||"",aadhaarNumber:p.aadhaarNumber||"",panNumber:p.panNumber||"",isNominee:p.isNominee||!1,nomineeFor:p.nomineeFor||[],nomineePercentage:p.nomineePercentage||100,contactNumber:p.contactNumber||"",address:p.address||{street:"",city:"",state:"",zipCode:"",country:"India"}}),i(!0)},g=async p=>{var u,j;if(window.confirm("Are you sure you want to delete this family detail?"))try{await Y.delete(`/employee/profile/family/${p}`),E.success("Family detail deleted successfully"),x()}catch(y){E.error(((j=(u=y.response)==null?void 0:u.data)==null?void 0:j.message)||"Failed to delete family detail")}};return s?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"text-white",children:"Loading..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold text-white flex items-center gap-2",children:[e.jsx(Re,{size:20})," Family Details"]}),e.jsxs("button",{onClick:()=>{c(null),d({relationship:"",name:"",dateOfBirth:"",gender:"",aadhaarNumber:"",panNumber:"",isNominee:!1,nomineeFor:[],nomineePercentage:100,contactNumber:"",address:{street:"",city:"",state:"",zipCode:"",country:"India"}}),i(!0)},className:"btn-primary",children:[e.jsx(Pe,{size:20})," Add Family Member"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(p=>e.jsxs("div",{className:"bg-dark-700 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:p.name}),e.jsx("p",{className:"text-gray-400 text-sm capitalize",children:p.relationship})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>f(p),className:"text-primary-400 hover:text-primary-300",children:e.jsx(Is,{size:18})}),e.jsx("button",{onClick:()=>g(p._id),className:"text-red-400 hover:text-red-300",children:e.jsx(ct,{size:18})})]})]}),p.isNominee&&e.jsxs("div",{className:"mt-2 p-2 bg-primary-900/20 rounded",children:[e.jsxs("p",{className:"text-primary-400 text-sm",children:["Nominee for: ",p.nomineeFor.join(", ")]}),e.jsxs("p",{className:"text-primary-400 text-sm",children:["Percentage: ",p.nomineePercentage,"%"]})]}),p.dateOfBirth&&e.jsxs("p",{className:"text-gray-400 text-sm mt-2",children:["DOB: ",new Date(p.dateOfBirth).toLocaleDateString()]})]},p._id))}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-700 p-6 rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:l?"Edit Family Member":"Add Family Member"}),e.jsx("button",{onClick:()=>i(!1),className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:20})})]}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Relationship *"}),e.jsxs("select",{name:"relationship",value:o.relationship,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white",required:!0,children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"spouse",children:"Spouse"}),e.jsx("option",{value:"son",children:"Son"}),e.jsx("option",{value:"daughter",children:"Daughter"}),e.jsx("option",{value:"father",children:"Father"}),e.jsx("option",{value:"mother",children:"Mother"}),e.jsx("option",{value:"brother",children:"Brother"}),e.jsx("option",{value:"sister",children:"Sister"}),e.jsx("option",{value:"father_in_law",children:"Father-in-law"}),e.jsx("option",{value:"mother_in_law",children:"Mother-in-law"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name *"}),e.jsx("input",{type:"text",name:"name",value:o.name,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Date of Birth *"}),e.jsx("input",{type:"date",name:"dateOfBirth",value:o.dateOfBirth,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Gender"}),e.jsxs("select",{name:"gender",value:o.gender,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white",children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Aadhaar Number"}),e.jsx("input",{type:"text",name:"aadhaarNumber",value:o.aadhaarNumber,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"PAN Number"}),e.jsx("input",{type:"text",name:"panNumber",value:o.panNumber,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Contact Number"}),e.jsx("input",{type:"text",name:"contactNumber",value:o.contactNumber,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"isNominee",checked:o.isNominee,onChange:m,className:"w-4 h-4"}),e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Is Nominee"})]}),o.isNominee&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Nominee For"}),e.jsxs("select",{name:"nomineeFor",multiple:!0,value:o.nomineeFor,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white",children:[e.jsx("option",{value:"PF",children:"PF"}),e.jsx("option",{value:"ESI",children:"ESI"}),e.jsx("option",{value:"Gratuity",children:"Gratuity"}),e.jsx("option",{value:"Insurance",children:"Insurance"}),e.jsx("option",{value:"Pension",children:"Pension"}),e.jsx("option",{value:"Other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Nominee Percentage"}),e.jsx("input",{type:"number",name:"nomineePercentage",value:o.nomineePercentage,onChange:m,min:"0",max:"100",className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Address"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Street"}),e.jsx("input",{type:"text",name:"address.street",value:o.address.street,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"City"}),e.jsx("input",{type:"text",name:"address.city",value:o.address.city,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"State"}),e.jsx("input",{type:"text",name:"address.state",value:o.address.state,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Zip Code"}),e.jsx("input",{type:"text",name:"address.zipCode",value:o.address.zipCode,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Country"}),e.jsx("input",{type:"text",name:"address.country",value:o.address.country,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"btn-secondary",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn-primary",children:[e.jsx(ds,{size:20})," ",l?"Update":"Save"]})]})]})]})})]})},_1=()=>{const[t,a]=v.useState([]),[s,n]=v.useState(!0),[r,i]=v.useState(!1),[l,c]=v.useState(null),[o,d]=v.useState({certificationName:"",issuingOrganization:"",certificateNumber:"",issueDate:"",expiryDate:"",isPermanent:!1,documentUrl:"",skills:[],description:""});v.useEffect(()=>{x()},[]);const x=async()=>{var u,j;try{n(!0);const y=await Y.get("/employee/profile/certifications");a(y.data.data)}catch(y){E.error(((j=(u=y.response)==null?void 0:u.data)==null?void 0:j.message)||"Failed to fetch certifications")}finally{n(!1)}},m=u=>{const{name:j,value:y,type:N,checked:w}=u.target;if(j==="isPermanent")d(D=>({...D,[j]:w}));else if(j==="skills"){const D=y.split(",").map(b=>b.trim()).filter(b=>b);d(b=>({...b,[j]:D}))}else d(D=>({...D,[j]:y}))},h=async u=>{var j,y;u.preventDefault();try{l?(await Y.put(`/employee/profile/certifications/${l._id}`,o),E.success("Certification updated successfully")):(await Y.post("/employee/profile/certifications",o),E.success("Certification added successfully")),i(!1),c(null),d({certificationName:"",issuingOrganization:"",certificateNumber:"",issueDate:"",expiryDate:"",isPermanent:!1,documentUrl:"",skills:[],description:""}),x()}catch(N){E.error(((y=(j=N.response)==null?void 0:j.data)==null?void 0:y.message)||"Failed to save certification")}},f=u=>{c(u),d({certificationName:u.certificationName||"",issuingOrganization:u.issuingOrganization||"",certificateNumber:u.certificateNumber||"",issueDate:u.issueDate?new Date(u.issueDate).toISOString().split("T")[0]:"",expiryDate:u.expiryDate?new Date(u.expiryDate).toISOString().split("T")[0]:"",isPermanent:u.isPermanent||!1,documentUrl:u.documentUrl||"",skills:u.skills||[],description:u.description||""}),i(!0)},g=async u=>{var j,y;if(window.confirm("Are you sure you want to delete this certification?"))try{await Y.delete(`/employee/profile/certifications/${u}`),E.success("Certification deleted successfully"),x()}catch(N){E.error(((y=(j=N.response)==null?void 0:j.data)==null?void 0:y.message)||"Failed to delete certification")}},p=u=>{if(!u)return!1;const N=(new Date(u)-new Date)/(1e3*60*60*24);return N>0&&N<=90};return s?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"text-white",children:"Loading..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold text-white flex items-center gap-2",children:[e.jsx(Ds,{size:20})," Certifications"]}),e.jsxs("button",{onClick:()=>{c(null),d({certificationName:"",issuingOrganization:"",certificateNumber:"",issueDate:"",expiryDate:"",isPermanent:!1,documentUrl:"",skills:[],description:""}),i(!0)},className:"btn-primary",children:[e.jsx(Pe,{size:20})," Add Certification"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(u=>{const j=u.isExpired,y=p(u.expiryDate);return e.jsxs("div",{className:`bg-dark-700 p-4 rounded-lg ${j?"border-l-4 border-red-500":y?"border-l-4 border-yellow-500":""}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:u.certificationName}),e.jsx("p",{className:"text-gray-400 text-sm",children:u.issuingOrganization})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>f(u),className:"text-primary-400 hover:text-primary-300",children:e.jsx(Is,{size:18})}),e.jsx("button",{onClick:()=>g(u._id),className:"text-red-400 hover:text-red-300",children:e.jsx(ct,{size:18})})]})]}),u.certificateNumber&&e.jsxs("p",{className:"text-gray-400 text-sm",children:["Cert #: ",u.certificateNumber]}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("p",{className:"text-gray-400 text-sm",children:["Issued: ",u.issueDate?new Date(u.issueDate).toLocaleDateString():"N/A"]}),!u.isPermanent&&u.expiryDate&&e.jsx("p",{className:`text-sm ${j?"text-red-400":y?"text-yellow-400":"text-gray-400"}`,children:j?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(st,{size:14})," Expired: ",new Date(u.expiryDate).toLocaleDateString()]}):`Expires: ${new Date(u.expiryDate).toLocaleDateString()}`}),u.isPermanent&&e.jsx("p",{className:"text-green-400 text-sm",children:"Permanent"})]}),u.skills&&u.skills.length>0&&e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:u.skills.map((N,w)=>e.jsx("span",{className:"px-2 py-1 bg-primary-900/30 text-primary-300 text-xs rounded",children:N},w))})]},u._id)})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-700 p-6 rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:l?"Edit Certification":"Add Certification"}),e.jsx("button",{onClick:()=>i(!1),className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:20})})]}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Certification Name *"}),e.jsx("input",{type:"text",name:"certificationName",value:o.certificationName,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white",required:!0})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Issuing Organization *"}),e.jsx("input",{type:"text",name:"issuingOrganization",value:o.issuingOrganization,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Certificate Number"}),e.jsx("input",{type:"text",name:"certificateNumber",value:o.certificateNumber,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Issue Date *"}),e.jsx("input",{type:"date",name:"issueDate",value:o.issueDate,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Expiry Date"}),e.jsx("input",{type:"date",name:"expiryDate",value:o.expiryDate,onChange:m,disabled:o.isPermanent,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white disabled:opacity-50"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"isPermanent",checked:o.isPermanent,onChange:m,className:"w-4 h-4"}),e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Permanent (No Expiry)"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Skills (comma-separated)"}),e.jsx("input",{type:"text",name:"skills",value:o.skills.join(", "),onChange:m,placeholder:"e.g., JavaScript, React, Node.js",className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Document URL"}),e.jsx("input",{type:"url",name:"documentUrl",value:o.documentUrl,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",value:o.description,onChange:m,rows:"3",className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"btn-secondary",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn-primary",children:[e.jsx(ds,{size:20})," ",l?"Update":"Save"]})]})]})]})})]})},R1=()=>{const[t,a]=v.useState([]),[s,n]=v.useState(!0),[r,i]=v.useState(!1),[l,c]=v.useState(null),[o,d]=v.useState({degree:"",specialization:"",institution:"",passingYear:"",percentage:"",documentUrl:""});v.useEffect(()=>{x()},[]);const x=async()=>{try{n(!0);const p=await Y.get("/employees/profile");p.data.data&&p.data.data.education&&a(p.data.data.education)}catch{console.log("Education endpoint not available yet")}finally{n(!1)}},m=p=>{const{name:u,value:j}=p.target;d(y=>({...y,[u]:j}))},h=async p=>{var u,j;p.preventDefault();try{E.success("Academic qualification saved successfully"),i(!1),c(null),d({degree:"",specialization:"",institution:"",passingYear:"",percentage:"",documentUrl:""}),x()}catch(y){E.error(((j=(u=y.response)==null?void 0:u.data)==null?void 0:j.message)||"Failed to save qualification")}},f=p=>{c(p),d({degree:p.degree||"",specialization:p.specialization||"",institution:p.institution||"",passingYear:p.passingYear||"",percentage:p.percentage||"",documentUrl:p.documentUrl||""}),i(!0)},g=async p=>{var u,j;if(window.confirm("Are you sure you want to delete this qualification?"))try{E.success("Qualification deleted successfully"),x()}catch(y){E.error(((j=(u=y.response)==null?void 0:u.data)==null?void 0:j.message)||"Failed to delete qualification")}};return s?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"text-white",children:"Loading..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold text-white flex items-center gap-2",children:[e.jsx(yi,{size:20})," Academic Qualifications"]}),e.jsxs("button",{onClick:()=>{c(null),d({degree:"",specialization:"",institution:"",passingYear:"",percentage:"",documentUrl:""}),i(!0)},className:"btn-primary",children:[e.jsx(Pe,{size:20})," Add Qualification"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map((p,u)=>e.jsxs("div",{className:"bg-dark-700 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:p.degree}),e.jsx("p",{className:"text-gray-400 text-sm",children:p.specialization})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>f(p),className:"text-primary-400 hover:text-primary-300",children:e.jsx(Is,{size:18})}),e.jsx("button",{onClick:()=>g(),className:"text-red-400 hover:text-red-300",children:e.jsx(ct,{size:18})})]})]}),e.jsxs("div",{className:"space-y-1 mt-2",children:[e.jsxs("p",{className:"text-gray-400 text-sm",children:["Institution: ",p.institution]}),e.jsxs("p",{className:"text-gray-400 text-sm",children:["Year: ",p.passingYear]}),p.percentage&&e.jsxs("p",{className:"text-gray-400 text-sm",children:["Percentage: ",p.percentage,"%"]}),p.documentUrl&&e.jsxs("a",{href:p.documentUrl,target:"_blank",rel:"noopener noreferrer",className:"text-primary-400 hover:text-primary-300 text-sm flex items-center gap-1",children:[e.jsx(Ue,{size:14})," View Document"]})]})]},u))}),t.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-400",children:"No academic qualifications added yet"})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-700 p-6 rounded-lg shadow-xl w-full max-w-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:l?"Edit Qualification":"Add Qualification"}),e.jsx("button",{onClick:()=>i(!1),className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:20})})]}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Degree *"}),e.jsx("input",{type:"text",name:"degree",value:o.degree,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Specialization"}),e.jsx("input",{type:"text",name:"specialization",value:o.specialization,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Institution *"}),e.jsx("input",{type:"text",name:"institution",value:o.institution,onChange:m,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Passing Year *"}),e.jsx("input",{type:"number",name:"passingYear",value:o.passingYear,onChange:m,min:"1950",max:new Date().getFullYear(),className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Percentage/GPA"}),e.jsx("input",{type:"text",name:"percentage",value:o.percentage,onChange:m,placeholder:"e.g., 85 or 3.5",className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Document URL"}),e.jsx("input",{type:"url",name:"documentUrl",value:o.documentUrl,onChange:m,placeholder:"https://...",className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"btn-secondary",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"btn-primary",children:[e.jsx(ds,{size:20})," ",l?"Update":"Save"]})]})]})]})})]})},P1=()=>{const{user:t}=kt(),[a,s]=v.useState([]),[n,r]=v.useState(!0),[i,l]=v.useState(!1),[c,o]=v.useState({fieldName:"",fieldCategory:"",oldValue:"",newValue:"",reason:""});v.useEffect(()=>{d()},[]);const d=async()=>{var g,p;try{r(!0);const u=await Y.get("/employee/profile/update-requests");s(u.data.data)}catch(u){E.error(((p=(g=u.response)==null?void 0:g.data)==null?void 0:p.message)||"Failed to fetch update requests")}finally{r(!1)}},x=g=>{const{name:p,value:u}=g.target;o(j=>({...j,[p]:u}))},m=async g=>{var p,u;g.preventDefault();try{await Y.post("/employee/profile/update-requests",c),E.success("Profile update request submitted successfully"),l(!1),o({fieldName:"",fieldCategory:"",oldValue:"",newValue:"",reason:""}),d()}catch(j){E.error(((u=(p=j.response)==null?void 0:p.data)==null?void 0:u.message)||"Failed to submit request")}},h=async(g,p,u="")=>{var j,y;try{await Y.post(`/employee/profile/update-requests/${g}/approve`,{action:p,comments:u}),E.success(`Request ${p}d successfully`),d()}catch(N){E.error(((y=(j=N.response)==null?void 0:j.data)==null?void 0:y.message)||`Failed to ${p} request`)}},f=g=>{switch(g){case"approved":return"text-green-400";case"rejected":return"text-red-400";case"pending":return"text-yellow-400";default:return"text-gray-400"}};return n?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"text-white",children:"Loading..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold text-white flex items-center gap-2",children:[e.jsx(un,{size:20})," Profile Update Requests"]}),t.role==="employee"&&e.jsxs("button",{onClick:()=>{o({fieldName:"",fieldCategory:"",oldValue:"",newValue:"",reason:""}),l(!0)},className:"btn-primary",children:[e.jsx(Pe,{size:20})," New Request"]})]}),e.jsx("div",{className:"space-y-4",children:a.map(g=>{var p;return e.jsxs("div",{className:"bg-dark-700 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white capitalize",children:g.fieldName.replace(/([A-Z])/g," $1").trim()}),e.jsx("p",{className:"text-gray-400 text-sm capitalize",children:g.fieldCategory})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${f(g.status)} bg-opacity-20`,children:g.status})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Old Value"}),e.jsx("p",{className:"text-white",children:String(g.oldValue||"N/A")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"New Value"}),e.jsx("p",{className:"text-white",children:String(g.newValue||"N/A")})]})]}),g.reason&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Reason"}),e.jsx("p",{className:"text-white",children:g.reason})]}),g.slaDeadline&&g.status==="pending"&&e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-yellow-400 text-sm",children:[e.jsx(Te,{size:14}),"SLA Deadline: ",new Date(g.slaDeadline).toLocaleString()]}),(t.role==="manager"||t.role==="hr"||t.role==="admin")&&g.status==="pending"&&((p=g.currentApprover)==null?void 0:p._id)===t._id&&e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsxs("button",{onClick:()=>{const u=window.prompt("Enter approval comments (optional):");h(g._id,"approve",u||"")},className:"btn-primary flex items-center gap-2",children:[e.jsx(Pa,{size:18})," Approve"]}),e.jsxs("button",{onClick:()=>{const u=window.prompt("Enter rejection reason:");u&&h(g._id,"reject",u)},className:"btn-secondary flex items-center gap-2",children:[e.jsx(Ee,{size:18})," Reject"]})]}),g.approvals&&g.approvals.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-2",children:"Approval Status:"}),e.jsx("div",{className:"space-y-1",children:g.approvals.map((u,j)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsxs("span",{className:"text-gray-400",children:[u.approverName,":"]}),e.jsx("span",{className:f(u.status),children:u.status})]},j))})]})]},g._id)})}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-dark-700 p-6 rounded-lg shadow-xl w-full max-w-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"New Profile Update Request"}),e.jsx("button",{onClick:()=>l(!1),className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{size:20})})]}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Field Category *"}),e.jsxs("select",{name:"fieldCategory",value:c.fieldCategory,onChange:x,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white",required:!0,children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:"personal",children:"Personal"}),e.jsx("option",{value:"address",children:"Address"}),e.jsx("option",{value:"contact",children:"Contact"}),e.jsx("option",{value:"family",children:"Family"}),e.jsx("option",{value:"education",children:"Education"}),e.jsx("option",{value:"experience",children:"Experience"}),e.jsx("option",{value:"certification",children:"Certification"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Field Name *"}),e.jsx("input",{type:"text",name:"fieldName",value:c.fieldName,onChange:x,placeholder:"e.g., phone, email, permanentAddress",className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Current Value"}),e.jsx("input",{type:"text",name:"oldValue",value:c.oldValue,onChange:x,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"New Value *"}),e.jsx("input",{type:"text",name:"newValue",value:c.newValue,onChange:x,className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Reason *"}),e.jsx("textarea",{name:"reason",value:c.reason,onChange:x,rows:"3",className:"w-full px-3 py-2 bg-dark-600 border border-gray-600 rounded-md text-white",required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>l(!1),className:"btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",children:"Submit Request"})]})]})]})})]})},L1=()=>{const{user:t}=kt(),[a,s]=v.useState(!1),[n,r]=v.useState("personal"),[i,l]=v.useState({firstName:(t==null?void 0:t.firstName)||"John",lastName:(t==null?void 0:t.lastName)||"Doe",email:(t==null?void 0:t.email)||"john.doe@company.com",phone:"+91 9876543210",designation:"Senior Software Engineer",department:"Technology",employeeId:"EMP001",joiningDate:"Jan 15, 2022",reportingTo:"Jane Smith",location:"Bangalore, India",address:"123 Tech Park, Whitefield, Bangalore - 560066"}),c=[{id:"personal",label:"Personal Info"},{id:"employment",label:"Employment"},{id:"family",label:"Family Details",icon:Re},{id:"certifications",label:"Certifications",icon:Ds},{id:"education",label:"Education",icon:yi},{id:"update-requests",label:"Update Requests",icon:un},{id:"documents",label:"Documents"}],o=()=>{s(!1)};return e.jsxs("div",{className:"min-h-screen bg-[#1E1E2A] p-4 md:p-6 pb-24 md:pb-6",children:[e.jsxs("div",{className:"max-w-5xl mx-auto space-y-6",children:[e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-4 md:p-8 border border-gray-700",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start justify-between mb-6 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-4 md:space-x-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] flex items-center justify-center",children:e.jsxs("span",{className:"text-white text-3xl font-bold",children:[i.firstName.charAt(0),i.lastName.charAt(0)]})}),e.jsx("button",{className:"absolute bottom-0 right-0 w-8 h-8 bg-[#A88BFF] rounded-full flex items-center justify-center hover:bg-[#8B6FE8] transition-colors",children:e.jsx(y0,{className:"w-4 h-4 text-white"})})]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white",children:[i.firstName," ",i.lastName]}),e.jsx("p",{className:"text-[#A88BFF] font-medium mt-1",children:i.designation}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:i.department}),e.jsxs("div",{className:"flex items-center space-x-4 mt-3",children:[e.jsx("span",{className:"px-3 py-1 bg-green-500/20 text-green-400 rounded-full text-xs font-medium",children:"ACTIVE"}),e.jsxs("span",{className:"text-gray-400 text-sm",children:["ID: ",i.employeeId]})]})]})]}),a?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:o,className:"flex items-center space-x-2 px-4 py-2 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors",children:[e.jsx(ds,{className:"w-4 h-4"}),e.jsx("span",{children:"Save"})]}),e.jsxs("button",{onClick:()=>s(!1),className:"flex items-center space-x-2 px-4 py-2 bg-[#1E1E2A] text-gray-400 rounded-xl hover:text-white transition-colors",children:[e.jsx(Ee,{className:"w-4 h-4"}),e.jsx("span",{children:"Cancel"})]})]}):e.jsxs("button",{onClick:()=>s(!0),className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] text-white rounded-xl hover:shadow-lg transition-all",children:[e.jsx(fs,{className:"w-4 h-4"}),e.jsx("span",{children:"Edit Profile"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 pt-6 border-t border-gray-700",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Years at Company"}),e.jsx("p",{className:"text-white text-xl font-bold",children:"2.9"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Projects Completed"}),e.jsx("p",{className:"text-white text-xl font-bold",children:"12"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Performance Rating"}),e.jsx("p",{className:"text-[#A88BFF] text-xl font-bold",children:"4.5/5"})]})]})]}),e.jsx("div",{className:"flex items-center space-x-2 border-b border-gray-700 overflow-x-auto scrollbar-hide",children:c.map(d=>{const x=d.icon;return e.jsxs("button",{onClick:()=>r(d.id),className:`px-4 md:px-6 py-3 font-medium transition-all relative flex items-center gap-2 whitespace-nowrap ${n===d.id?"text-[#A88BFF]":"text-gray-400 hover:text-white"}`,children:[x&&e.jsx(x,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:d.label}),e.jsx("span",{className:"sm:hidden",children:d.label.split(" ")[0]}),n===d.id&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-[#A88BFF]"})]},d.id)})}),n==="personal"&&e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-white text-lg font-semibold mb-4",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"First Name"}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-[#1E1E2A] rounded-xl",children:[e.jsx(ft,{className:"w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:i.firstName,disabled:!a,onChange:d=>l({...i,firstName:d.target.value}),className:"bg-transparent text-white flex-1 outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Last Name"}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-[#1E1E2A] rounded-xl",children:[e.jsx(ft,{className:"w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:i.lastName,disabled:!a,onChange:d=>l({...i,lastName:d.target.value}),className:"bg-transparent text-white flex-1 outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Email"}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-[#1E1E2A] rounded-xl",children:[e.jsx(ut,{className:"w-5 h-5 text-gray-400"}),e.jsx("input",{type:"email",value:i.email,disabled:!0,className:"bg-transparent text-gray-500 flex-1 outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Phone"}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-[#1E1E2A] rounded-xl",children:[e.jsx(ts,{className:"w-5 h-5 text-gray-400"}),e.jsx("input",{type:"tel",value:i.phone,disabled:!a,onChange:d=>l({...i,phone:d.target.value}),className:"bg-transparent text-white flex-1 outline-none"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Address"}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-[#1E1E2A] rounded-xl",children:[e.jsx(ea,{className:"w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:i.address,disabled:!a,onChange:d=>l({...i,address:d.target.value}),className:"bg-transparent text-white flex-1 outline-none"})]})]})]})]}),n==="employment"&&e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-white text-lg font-semibold mb-4",children:"Employment Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Employee ID"}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-[#1E1E2A] rounded-xl",children:[e.jsx(Ds,{className:"w-5 h-5 text-gray-400"}),e.jsx("span",{className:"text-white",children:i.employeeId})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Designation"}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-[#1E1E2A] rounded-xl",children:[e.jsx(at,{className:"w-5 h-5 text-gray-400"}),e.jsx("span",{className:"text-white",children:i.designation})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Department"}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-[#1E1E2A] rounded-xl",children:[e.jsx(Nr,{className:"w-5 h-5 text-gray-400"}),e.jsx("span",{className:"text-white",children:i.department})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Joining Date"}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-[#1E1E2A] rounded-xl",children:[e.jsx(Fe,{className:"w-5 h-5 text-gray-400"}),e.jsx("span",{className:"text-white",children:i.joiningDate})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Reporting To"}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-[#1E1E2A] rounded-xl",children:[e.jsx(ft,{className:"w-5 h-5 text-gray-400"}),e.jsx("span",{className:"text-white",children:i.reportingTo})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Location"}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-[#1E1E2A] rounded-xl",children:[e.jsx(ea,{className:"w-5 h-5 text-gray-400"}),e.jsx("span",{className:"text-white",children:i.location})]})]})]})]}),n==="family"&&e.jsx("div",{className:"bg-[#2A2A3A] rounded-2xl p-4 md:p-6 border border-gray-700",children:e.jsx(D1,{})}),n==="certifications"&&e.jsx("div",{className:"bg-[#2A2A3A] rounded-2xl p-4 md:p-6 border border-gray-700",children:e.jsx(_1,{})}),n==="education"&&e.jsx("div",{className:"bg-[#2A2A3A] rounded-2xl p-4 md:p-6 border border-gray-700",children:e.jsx(R1,{})}),n==="update-requests"&&e.jsx("div",{className:"bg-[#2A2A3A] rounded-2xl p-4 md:p-6 border border-gray-700",children:e.jsx(P1,{})}),n==="documents"&&e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-12 border border-gray-700 text-center",children:[e.jsx(Ds,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-white text-lg font-semibold mb-2",children:"No Documents"}),e.jsx("p",{className:"text-gray-400",children:"Document management feature coming soon"})]})]}),e.jsx(ms,{})]})},I1=()=>{const t=Ke(),[a,s]=v.useState(""),[n,r]=v.useState(!0),[i,l]=v.useState({totalMembers:0,present:0,onLeave:0}),[c,o]=v.useState({current:[],past:[]}),d=[];v.useEffect(()=>{(async()=>{try{const h=localStorage.getItem("token"),g=await(await fetch("undefined/api/manager/team-stats",{headers:{Authorization:`Bearer ${h}`}})).json();g.success&&l(g.data);const u=await(await fetch("undefined/api/manager/projects",{headers:{Authorization:`Bearer ${h}`}})).json();u.success&&o(u.data),r(!1)}catch(h){console.error("Error fetching data:",h),r(!1)}})()},[]);const x=m=>new Date(m).toLocaleDateString("en-US",{month:"short",day:"numeric"});return e.jsxs("div",{className:"min-h-screen bg-[#1E1E2A] pb-24 md:pb-6",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-[#1E1E2A] border-b border-gray-800 px-4 py-4",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsxs("div",{className:"relative",children:[e.jsx(rt,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search team members",value:a,onChange:m=>s(m.target.value),className:"w-full bg-[#2A2A3A] text-white pl-12 pr-4 py-3 rounded-2xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none transition-colors"})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("button",{onClick:()=>t("/employee/manager/leave-approvals"),className:"bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] text-white p-4 rounded-2xl shadow-lg hover:shadow-xl transition-all",children:[e.jsx(we,{className:"w-6 h-6 mx-auto mb-2"}),e.jsx("span",{className:"text-sm font-semibold",children:"Leave Approvals"})]}),e.jsxs("button",{onClick:()=>t("/employee/manager/assign-project"),className:"bg-[#2A2A3A] text-white p-4 rounded-2xl border border-gray-700 hover:border-[#A88BFF] transition-all",children:[e.jsx(at,{className:"w-6 h-6 text-[#A88BFF] mx-auto mb-2"}),e.jsx("span",{className:"text-sm font-semibold",children:"Assign Project"})]}),e.jsxs("button",{onClick:()=>t("/employee/manager/schedule-meeting"),className:"bg-[#2A2A3A] text-white p-4 rounded-2xl border border-gray-700 hover:border-[#A88BFF] transition-all",children:[e.jsx(Fe,{className:"w-6 h-6 text-[#A88BFF] mx-auto mb-2"}),e.jsx("span",{className:"text-sm font-semibold",children:"Schedule Meeting"})]}),e.jsxs("button",{onClick:()=>t("/employee/manager/announcements"),className:"bg-[#2A2A3A] text-white p-4 rounded-2xl border border-gray-700 hover:border-[#A88BFF] transition-all",children:[e.jsx(Ba,{className:"w-6 h-6 text-[#A88BFF] mx-auto mb-2"}),e.jsx("span",{className:"text-sm font-semibold",children:"Announcements"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Team Size"}),e.jsx(Re,{className:"w-5 h-5 text-[#A88BFF]"})]}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:i.totalMembers})]}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"Present Today"}),e.jsx(we,{className:"w-5 h-5 text-green-400"})]}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:i.present})]}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"On Leave"}),e.jsx(Fe,{className:"w-5 h-5 text-yellow-400"})]}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:i.onLeave})]})]}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-white text-lg font-semibold",children:"Assigned Projects"}),e.jsxs("button",{onClick:()=>t("/employee/manager/assign-project"),className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] text-white rounded-xl hover:shadow-lg transition-all text-sm",children:[e.jsx(Pe,{className:"w-4 h-4"}),e.jsx("span",{children:"Assign Project"})]})]}),c.current&&c.current.length>0?e.jsx("div",{className:"space-y-3",children:c.current.map(m=>{var h;return e.jsx("div",{className:"p-4 bg-[#1E1E2A] rounded-xl",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] flex items-center justify-center",children:e.jsx(at,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-medium",children:m.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:m.projectCode})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("p",{className:"text-gray-400",children:[e.jsx("span",{className:"text-white font-medium",children:"Client:"})," ",((h=m.client)==null?void 0:h.name)||"N/A"]}),e.jsxs("p",{className:"text-gray-400",children:[e.jsx("span",{className:"text-white font-medium",children:"Role:"})," ",m.managerRole]}),e.jsxs("p",{className:"text-gray-400",children:[e.jsx("span",{className:"text-white font-medium",children:"Status:"})," ",e.jsx("span",{className:`capitalize ${m.status==="active"?"text-green-400":m.status==="completed"?"text-blue-400":m.status==="on-hold"?"text-yellow-400":"text-gray-400"}`,children:m.status})]}),e.jsxs("p",{className:"text-gray-400",children:[e.jsx("span",{className:"text-white font-medium",children:"Team Size:"})," ",m.teamSize]})]}),m.description&&e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:m.description})]}),e.jsx("button",{onClick:()=>t(`/projects/${m._id}`),className:"ml-4 px-4 py-2 bg-[#1E1E2A] text-white rounded-xl border border-gray-700 hover:border-[#A88BFF] transition-all text-sm",children:"View Details"})]})},m._id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(at,{className:"w-12 h-12 text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-400",children:"No active projects assigned"})]}),c.past&&c.past.length>0&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-700",children:[e.jsx("h4",{className:"text-white font-medium mb-3",children:"Past Projects"}),e.jsx("div",{className:"space-y-2",children:c.past.slice(0,3).map(m=>e.jsx("div",{className:"p-3 bg-[#1E1E2A] rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white text-sm font-medium",children:m.name}),e.jsxs("p",{className:"text-gray-400 text-xs",children:[m.projectCode," â€¢ ",m.managerRole]})]}),e.jsx("span",{className:`text-xs capitalize ${m.status==="completed"?"text-green-400":m.status==="cancelled"?"text-red-400":"text-gray-400"}`,children:m.status})]})},m._id))})]})]}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-white text-lg font-semibold",children:"Upcoming Meetings"}),e.jsxs("button",{onClick:()=>t("/employee/manager/schedule-meeting"),className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] text-white rounded-xl hover:shadow-lg transition-all",children:[e.jsx(Pe,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Schedule"})]})]}),e.jsx("div",{className:"space-y-3",children:d.map(m=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#1E1E2A] rounded-xl",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] flex items-center justify-center",children:e.jsx(Fe,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-medium",children:m.title}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[x(m.date)," at ",m.time]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Re,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-400 text-sm",children:m.attendees})]})]},m.id))})]})]}),e.jsx(ms,{})]})},O1=()=>{const t=Ke(),[a,s]=v.useState("pending"),[n,r]=v.useState(!1),[i,l]=v.useState(null),[c,o]=v.useState(""),[d,x]=v.useState([]);v.useEffect(()=>{(async()=>{try{const y=localStorage.getItem("token"),w=await(await fetch("undefined/api/manager/pending-leaves",{headers:{Authorization:`Bearer ${y}`}})).json();w.success&&x(w.data)}catch(y){console.error("Error fetching leave requests:",y)}})()},[]);const m=[{id:"pending",label:"Pending",count:2},{id:"approved",label:"Approved",count:1},{id:"rejected",label:"Rejected",count:0}],h=d.filter(j=>j.status===a),f=async j=>{try{const y=localStorage.getItem("token"),w=await(await fetch(`undefined/api/manager/leave/${j}/approve`,{method:"PUT",headers:{Authorization:`Bearer ${y}`,"Content-Type":"application/json"},body:JSON.stringify({comments:""})})).json();w.success?(x(d.filter(D=>D._id!==j)),alert("Leave approved successfully!")):alert(w.message||"Failed to approve leave")}catch(y){console.error("Error approving leave:",y),alert("Failed to approve leave")}},g=async()=>{if(!c.trim()){alert("Please provide a reason for rejection");return}try{const j=localStorage.getItem("token"),N=await(await fetch(`undefined/api/manager/leave/${i}/reject`,{method:"PUT",headers:{Authorization:`Bearer ${j}`,"Content-Type":"application/json"},body:JSON.stringify({reason:c})})).json();N.success?(x(d.filter(w=>w._id!==i)),alert("Leave rejected successfully!")):alert(N.message||"Failed to reject leave")}catch(j){console.error("Error rejecting leave:",j),alert("Failed to reject leave")}r(!1),o(""),l(null)},p=j=>new Date(j).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),u=j=>{switch(j){case"approved":return"bg-green-500/20 text-green-400";case"rejected":return"bg-red-500/20 text-red-400";case"pending":return"bg-orange-500/20 text-orange-400";default:return"bg-gray-500/20 text-gray-400"}};return e.jsxs("div",{className:"min-h-screen bg-[#1E1E2A] p-4 md:p-6 pb-24 md:pb-6",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-[#1E1E2A] border-b border-gray-800 px-4 py-4 -mx-4 mb-6",children:e.jsx("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>t("/employee/manager/home"),className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(wt,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-white",children:"Leave Approvals"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Review and approve team leave requests"})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsx("div",{className:"flex items-center space-x-2 overflow-x-auto scrollbar-hide",children:m.map(j=>e.jsxs("button",{onClick:()=>s(j.id),className:`px-6 py-3 rounded-xl font-semibold whitespace-nowrap transition-all ${a===j.id?"bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] text-white shadow-lg":"bg-[#2A2A3A] text-gray-400 hover:text-white border border-gray-700"}`,children:[j.label,j.count>0&&e.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full text-xs ${a===j.id?"bg-white/20":"bg-gray-700"}`,children:j.count})]},j.id))}),e.jsx("div",{className:"space-y-4",children:h.length>0?h.map(j=>e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold text-lg",children:j.employeeName.charAt(0)})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold",children:j.employeeName}),e.jsx("p",{className:"text-gray-400 text-sm",children:j.employeeEmail})]})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${u(j.status)}`,children:j.status.toUpperCase()})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-400 text-sm",children:"Leave Type:"}),e.jsx("span",{className:"text-white text-sm font-medium",children:j.leaveType})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-400 text-sm",children:"Duration:"}),e.jsxs("span",{className:"text-white text-sm font-medium",children:[j.numberOfDays," day(s)"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"From:"}),e.jsx("span",{className:"text-white text-sm font-medium",children:p(j.startDate)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"To:"}),e.jsx("span",{className:"text-white text-sm font-medium",children:p(j.endDate)})]})]})]}),e.jsx("div",{className:"p-4 bg-[#1E1E2A] rounded-xl mb-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(Ba,{className:"w-4 h-4 text-gray-400 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Reason:"}),e.jsx("p",{className:"text-white text-sm",children:j.reason})]})]})}),e.jsxs("p",{className:"text-gray-400 text-xs mb-4",children:["Applied on: ",p(j.appliedOn)]}),j.status==="pending"&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:()=>f(j._id),className:"flex-1 flex items-center justify-center space-x-2 px-4 py-3 bg-green-500 text-white rounded-xl hover:bg-green-600 transition-colors font-semibold",children:[e.jsx(we,{className:"w-5 h-5"}),e.jsx("span",{children:"Approve"})]}),e.jsxs("button",{onClick:()=>{l(j._id),r(!0)},className:"flex-1 flex items-center justify-center space-x-2 px-4 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors font-semibold",children:[e.jsx(ze,{className:"w-5 h-5"}),e.jsx("span",{children:"Reject"})]})]}),j.status==="approved"&&e.jsxs("div",{className:"flex items-center space-x-2 text-green-400",children:[e.jsx(we,{className:"w-5 h-5"}),e.jsxs("span",{className:"text-sm",children:["Approved on ",p(j.approvedOn)]})]})]},j._id)):e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-12 border border-gray-700 text-center",children:[e.jsx(Te,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsxs("h3",{className:"text-white text-lg font-semibold mb-2",children:["No ",a," requests"]}),e.jsxs("p",{className:"text-gray-400",children:["There are no ",a," leave requests at the moment"]})]})})]}),n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 max-w-md w-full border border-gray-700",children:[e.jsx("h3",{className:"text-white text-lg font-semibold mb-4",children:"Reject Leave Request"}),e.jsxs("p",{className:"text-gray-400 text-sm mb-4",children:["Please provide a reason for rejecting ",i==null?void 0:i.employeeName,"'s leave request"]}),e.jsx("textarea",{value:c,onChange:j=>o(j.target.value),placeholder:"Enter rejection reason...",className:"w-full bg-[#1E1E2A] text-white p-4 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none mb-4 min-h-[100px]"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:g,className:"flex-1 px-4 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-colors font-semibold",children:"Confirm Reject"}),e.jsx("button",{onClick:()=>{r(!1),o(""),l(null)},className:"flex-1 px-4 py-3 bg-gray-700 text-white rounded-xl hover:bg-gray-600 transition-colors font-semibold",children:"Cancel"})]})]})}),e.jsx(ms,{})]})},M1=()=>{const t=Ke(),[a,s]=v.useState({projectName:"",description:"",startDate:"",endDate:"",priority:"medium",selectedEmployees:[]}),[n,r]=v.useState([]);v.useEffect(()=>{(async()=>{try{const o=localStorage.getItem("token"),x=await(await fetch("undefined/api/manager/team-members",{headers:{Authorization:`Bearer ${o}`}})).json();if(x.success){const m=x.data.map(h=>({id:h._id,name:`${h.firstName} ${h.lastName}`,designation:h.designation||"Employee",avatar:`${h.firstName.charAt(0)}${h.lastName.charAt(0)}`}));r(m)}}catch(o){console.error("Error fetching team members:",o)}})()},[]);const i=c=>{s(o=>({...o,selectedEmployees:o.selectedEmployees.includes(c)?o.selectedEmployees.filter(d=>d!==c):[...o.selectedEmployees,c]}))},l=c=>{c.preventDefault(),console.log("Assigning project:",a),t("/employee/manager/home")};return e.jsxs("div",{className:"min-h-screen bg-[#1E1E2A] p-4 md:p-6 pb-24 md:pb-6",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-[#1E1E2A] border-b border-gray-800 px-4 py-4 -mx-4 mb-6",children:e.jsxs("div",{className:"max-w-3xl mx-auto flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>t("/employee/manager/home"),className:"text-gray-400 hover:text-white transition-colors",children:e.jsx(wt,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-white",children:"Assign Project"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Create and assign new project to team"})]})]})}),e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsxs("form",{onSubmit:l,className:"space-y-6",children:[e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] flex items-center justify-center",children:e.jsx(at,{className:"w-5 h-5 text-white"})}),e.jsx("h2",{className:"text-white text-lg font-semibold",children:"Project Details"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Project Name *"}),e.jsx("input",{type:"text",required:!0,value:a.projectName,onChange:c=>s({...a,projectName:c.target.value}),placeholder:"Enter project name",className:"w-full bg-[#1E1E2A] text-white p-4 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Description *"}),e.jsx("textarea",{required:!0,value:a.description,onChange:c=>s({...a,description:c.target.value}),placeholder:"Describe the project objectives and scope",className:"w-full bg-[#1E1E2A] text-white p-4 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none min-h-[100px]"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Start Date *"}),e.jsx("input",{type:"date",required:!0,value:a.startDate,onChange:c=>s({...a,startDate:c.target.value}),className:"w-full bg-[#1E1E2A] text-white p-4 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"End Date *"}),e.jsx("input",{type:"date",required:!0,value:a.endDate,onChange:c=>s({...a,endDate:c.target.value}),className:"w-full bg-[#1E1E2A] text-white p-4 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Priority"}),e.jsxs("select",{value:a.priority,onChange:c=>s({...a,priority:c.target.value}),className:"w-full bg-[#1E1E2A] text-white p-4 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]})]})]}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] flex items-center justify-center",children:e.jsx(Re,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-white text-lg font-semibold",children:"Assign Team Members"}),e.jsxs("p",{className:"text-gray-400 text-sm",children:[a.selectedEmployees.length," member(s) selected"]})]})]}),e.jsx("div",{className:"space-y-3",children:n.map(c=>e.jsxs("div",{onClick:()=>i(c.id),className:`flex items-center justify-between p-4 rounded-xl cursor-pointer transition-all ${a.selectedEmployees.includes(c.id)?"bg-[#A88BFF]/20 border-2 border-[#A88BFF]":"bg-[#1E1E2A] border-2 border-transparent hover:border-gray-700"}`,children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold",children:c.avatar})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-medium",children:c.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:c.designation})]})]}),a.selectedEmployees.includes(c.id)&&e.jsx("div",{className:"w-6 h-6 rounded-full bg-[#A88BFF] flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]},c.id))})]}),e.jsx("button",{type:"submit",disabled:a.selectedEmployees.length===0,className:"w-full bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] text-white py-4 rounded-2xl font-semibold shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"Assign Project to Team"})]})}),e.jsx(ms,{})]})},$1=()=>{const t=Ke(),[a,s]=v.useState({title:"",description:"",date:"",time:"",duration:"30",meetingType:"online",location:"",selectedAttendees:[]}),[n,r]=v.useState([]);v.useEffect(()=>{(async()=>{try{const o=localStorage.getItem("token"),x=await(await fetch("undefined/api/manager/team-members",{headers:{Authorization:`Bearer ${o}`}})).json();if(x.success){const m=x.data.map(h=>({id:h._id,name:`${h.firstName} ${h.lastName}`,designation:h.designation||"Employee"}));r(m)}}catch(o){console.error("Error fetching team members:",o)}})()},[]);const i=c=>{s(o=>({...o,selectedAttendees:o.selectedAttendees.includes(c)?o.selectedAttendees.filter(d=>d!==c):[...o.selectedAttendees,c]}))},l=c=>{c.preventDefault(),console.log("Scheduling meeting:",a),t("/employee/manager/home")};return e.jsxs("div",{className:"min-h-screen bg-[#1E1E2A] p-4 md:p-6 pb-24 md:pb-6",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-[#1E1E2A] border-b border-gray-800 px-4 py-4 -mx-4 mb-6",children:e.jsxs("div",{className:"max-w-3xl mx-auto flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>t("/employee/manager/home"),className:"text-gray-400 hover:text-white",children:e.jsx(wt,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-white",children:"Schedule Meeting"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Create a new team meeting"})]})]})}),e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsxs("form",{onSubmit:l,className:"space-y-6",children:[e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Meeting Title *"}),e.jsx("input",{type:"text",required:!0,value:a.title,onChange:c=>s({...a,title:c.target.value}),placeholder:"e.g., Sprint Planning, Team Standup",className:"w-full bg-[#1E1E2A] text-white p-4 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Description"}),e.jsx("textarea",{value:a.description,onChange:c=>s({...a,description:c.target.value}),placeholder:"Meeting agenda and objectives",className:"w-full bg-[#1E1E2A] text-white p-4 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none min-h-[80px]"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Date *"}),e.jsx("input",{type:"date",required:!0,value:a.date,onChange:c=>s({...a,date:c.target.value}),className:"w-full bg-[#1E1E2A] text-white p-4 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Time *"}),e.jsx("input",{type:"time",required:!0,value:a.time,onChange:c=>s({...a,time:c.target.value}),className:"w-full bg-[#1E1E2A] text-white p-4 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Duration (minutes)"}),e.jsxs("select",{value:a.duration,onChange:c=>s({...a,duration:c.target.value}),className:"w-full bg-[#1E1E2A] text-white p-4 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none",children:[e.jsx("option",{value:"15",children:"15 minutes"}),e.jsx("option",{value:"30",children:"30 minutes"}),e.jsx("option",{value:"45",children:"45 minutes"}),e.jsx("option",{value:"60",children:"1 hour"}),e.jsx("option",{value:"90",children:"1.5 hours"}),e.jsx("option",{value:"120",children:"2 hours"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Meeting Type"}),e.jsxs("select",{value:a.meetingType,onChange:c=>s({...a,meetingType:c.target.value}),className:"w-full bg-[#1E1E2A] text-white p-4 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none",children:[e.jsx("option",{value:"online",children:"Online"}),e.jsx("option",{value:"offline",children:"Offline"})]})]})]}),a.meetingType==="offline"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Location"}),e.jsx("input",{type:"text",value:a.location,onChange:c=>s({...a,location:c.target.value}),placeholder:"Meeting room or location",className:"w-full bg-[#1E1E2A] text-white p-4 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none"})]})]}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsxs("h3",{className:"text-white font-semibold mb-4",children:["Select Attendees (",a.selectedAttendees.length,")"]}),e.jsx("div",{className:"space-y-2",children:n.map(c=>e.jsx("label",{className:`flex items-center justify-between p-3 rounded-xl cursor-pointer transition-all ${a.selectedAttendees.includes(c.id)?"bg-[#A88BFF]/20 border border-[#A88BFF]":"bg-[#1E1E2A] hover:bg-[#1E1E2A]/50"}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",checked:a.selectedAttendees.includes(c.id),onChange:()=>i(c.id),className:"w-5 h-5 rounded accent-[#A88BFF]"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:c.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:c.designation})]})]})},c.id))})]}),e.jsx("button",{type:"submit",disabled:a.selectedAttendees.length===0,className:"w-full bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] text-white py-4 rounded-2xl font-semibold shadow-lg hover:shadow-xl transition-all disabled:opacity-50",children:"Schedule Meeting"})]})}),e.jsx(ms,{})]})},B1=()=>{const t=Ke(),[a,s]=v.useState(!1),[n,r]=v.useState({title:"",message:"",priority:"normal",sendTo:"team"}),[i,l]=v.useState([]);v.useEffect(()=>{(async()=>{})()},[]);const c=x=>{x.preventDefault();const m={id:Date.now(),...n,createdAt:new Date().toISOString().split("T")[0],createdBy:"You"};l([m,...i]),r({title:"",message:"",priority:"normal",sendTo:"team"}),s(!1)},o=x=>{l(i.filter(m=>m.id!==x))},d=x=>{switch(x){case"high":return"bg-red-500/20 text-red-400";case"normal":return"bg-blue-500/20 text-blue-400";case"low":return"bg-gray-500/20 text-gray-400";default:return"bg-gray-500/20 text-gray-400"}};return e.jsxs("div",{className:"min-h-screen bg-[#1E1E2A] p-4 md:p-6 pb-24 md:pb-6",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-[#1E1E2A] border-b border-gray-800 px-4 py-4 -mx-4 mb-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>t("/employee/manager/home"),className:"text-gray-400 hover:text-white",children:e.jsx(wt,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-white",children:"Announcements"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Create and manage team announcements"})]})]}),e.jsxs("button",{onClick:()=>s(!a),className:"flex items-center space-x-2 px-4 py-2 bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] text-white rounded-xl hover:shadow-lg transition-all",children:[e.jsx(Ba,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden md:inline",children:"New"})]})]})}),e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[a&&e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:[e.jsx("h3",{className:"text-white text-lg font-semibold mb-4",children:"Create Announcement"}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Title *"}),e.jsx("input",{type:"text",required:!0,value:n.title,onChange:x=>r({...n,title:x.target.value}),placeholder:"Announcement title",className:"w-full bg-[#1E1E2A] text-white p-4 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Message *"}),e.jsx("textarea",{required:!0,value:n.message,onChange:x=>r({...n,message:x.target.value}),placeholder:"Write your announcement message...",className:"w-full bg-[#1E1E2A] text-white p-4 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none min-h-[120px]"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Priority"}),e.jsxs("select",{value:n.priority,onChange:x=>r({...n,priority:x.target.value}),className:"w-full bg-[#1E1E2A] text-white p-4 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"High"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-gray-400 text-sm mb-2 block",children:"Send To"}),e.jsxs("select",{value:n.sendTo,onChange:x=>r({...n,sendTo:x.target.value}),className:"w-full bg-[#1E1E2A] text-white p-4 rounded-xl border border-gray-700 focus:border-[#A88BFF] focus:outline-none",children:[e.jsx("option",{value:"team",children:"My Team"}),e.jsx("option",{value:"department",children:"Entire Department"}),e.jsx("option",{value:"company",children:"All Employees"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{type:"submit",className:"flex-1 flex items-center justify-center space-x-2 px-4 py-3 bg-gradient-to-r from-[#A88BFF] to-[#8B6FE8] text-white rounded-xl hover:shadow-lg transition-all font-semibold",children:[e.jsx(Vr,{className:"w-5 h-5"}),e.jsx("span",{children:"Send Announcement"})]}),e.jsx("button",{type:"button",onClick:()=>s(!1),className:"px-4 py-3 bg-gray-700 text-white rounded-xl hover:bg-gray-600 transition-colors font-semibold",children:"Cancel"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-white font-semibold",children:["Recent Announcements (",i.length,")"]}),i.length>0?i.map(x=>e.jsx("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-700",children:e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-[#A88BFF] to-[#8B6FE8] flex items-center justify-center flex-shrink-0",children:e.jsx(Ps,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-white font-semibold",children:x.title}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${d(x.priority)}`,children:x.priority.toUpperCase()})]}),e.jsx("p",{className:"text-gray-300 text-sm mb-3",children:x.message}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-400",children:[e.jsxs("span",{children:["By ",x.createdBy]}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:new Date(x.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})]})]}),e.jsx("button",{onClick:()=>o(x.id),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",children:e.jsx(ct,{className:"w-5 h-5"})})]})},x.id)):e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-12 border border-gray-700 text-center",children:[e.jsx(Ps,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-white text-lg font-semibold mb-2",children:"No Announcements"}),e.jsx("p",{className:"text-gray-400",children:"Create your first announcement to notify your team"})]})]})]}),e.jsx(ms,{})]})},U1=async()=>(await Y.get("/dashboard/hr/stats")).data,z1=()=>{var h,f,g,p,u,j,y,N;const t=Ke(),[a,s]=v.useState({totalEmployees:0,pendingLeaves:0,payrollThisMonth:0,openPositions:0,recruitment:{totalApplications:0,shortlisted:0,interviewScheduled:0,selected:0,rejected:0},onboarding:{total:0,preboarding:0,inProgress:0,completed:0}}),[n,r]=v.useState(!0),[i,l]=v.useState("");v.useEffect(()=>{c()},[]);const c=async()=>{var w,D;r(!0),l("");try{const b=await U1();b.success?s(b.data):(l(b.message||"Failed to load dashboard stats"),E.error(b.message||"Failed to load dashboard stats"))}catch(b){const C=((D=(w=b.response)==null?void 0:w.data)==null?void 0:D.message)||"Failed to load dashboard stats";l(C),E.error(C)}finally{r(!1)}},o=w=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(w),d=[{name:"Total Employees",value:a.totalEmployees.toString(),icon:Re,color:"from-blue-500 to-blue-600"},{name:"Pending Leaves",value:a.pendingLeaves.toString(),icon:Fe,color:"from-orange-500 to-orange-600"},{name:"Payroll This Month",value:o(a.payrollThisMonth),icon:tt,color:"from-green-500 to-green-600"},{name:"Open Positions",value:a.openPositions.toString(),icon:at,color:"from-purple-500 to-purple-600"}],x=[{name:"Total Applications",value:((h=a.recruitment)==null?void 0:h.totalApplications)||0,icon:Re,color:"from-cyan-500 to-cyan-600"},{name:"Shortlisted",value:((f=a.recruitment)==null?void 0:f.shortlisted)||0,icon:Ra,color:"from-green-500 to-green-600"},{name:"Interview Scheduled",value:((g=a.recruitment)==null?void 0:g.interviewScheduled)||0,icon:Fe,color:"from-blue-500 to-blue-600"},{name:"Selected",value:((p=a.recruitment)==null?void 0:p.selected)||0,icon:ls,color:"from-emerald-500 to-emerald-600"}],m=[{name:"Total Onboarding",value:((u=a.onboarding)==null?void 0:u.total)||0,icon:lo,color:"from-indigo-500 to-indigo-600"},{name:"Preboarding",value:((j=a.onboarding)==null?void 0:j.preboarding)||0,icon:Te,color:"from-yellow-500 to-yellow-600"},{name:"In Progress",value:((y=a.onboarding)==null?void 0:y.inProgress)||0,icon:Ss,color:"from-orange-500 to-orange-600"},{name:"Completed",value:((N=a.onboarding)==null?void 0:N.completed)||0,icon:Ra,color:"from-green-500 to-green-600"}];return e.jsxs("div",{className:"min-h-screen bg-[#1E1E2A] p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"HR Dashboard"}),e.jsx("p",{className:"text-gray-400",children:"Welcome to HR Management Portal"})]}),i&&e.jsx("div",{className:"mb-6 bg-red-500/10 border border-red-500/40 text-red-300 text-sm rounded-xl px-4 py-3",children:i}),n?e.jsx("div",{className:"flex items-center justify-center h-64 mb-8",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(cs,{className:"w-8 h-8 animate-spin text-[#A88BFF]"}),e.jsx("p",{className:"text-gray-400",children:"Loading dashboard stats..."})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:d.map(w=>{const D=w.icon;return e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-800",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("div",{className:`w-12 h-12 rounded-xl bg-gradient-to-br ${w.color} flex items-center justify-center`,children:e.jsx(D,{className:"w-6 h-6 text-white"})})}),e.jsx("h3",{className:"text-gray-400 text-sm mb-1",children:w.name}),e.jsx("p",{className:"text-3xl font-bold text-white",children:w.value})]},w.name)})}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-800 mb-8",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Recruitment Pipeline"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:x.map(w=>{const D=w.icon;return e.jsxs("div",{className:"bg-[#1E1E2A] rounded-xl p-4 border border-gray-800",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("div",{className:`w-10 h-10 rounded-lg bg-gradient-to-br ${w.color} flex items-center justify-center`,children:e.jsx(D,{className:"w-5 h-5 text-white"})})}),e.jsx("h3",{className:"text-gray-400 text-xs mb-1",children:w.name}),e.jsx("p",{className:"text-2xl font-bold text-white",children:w.value})]},w.name)})})]}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-800 mb-8",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Onboarding Status"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:m.map(w=>{const D=w.icon;return e.jsxs("div",{className:"bg-[#1E1E2A] rounded-xl p-4 border border-gray-800",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("div",{className:`w-10 h-10 rounded-lg bg-gradient-to-br ${w.color} flex items-center justify-center`,children:e.jsx(D,{className:"w-5 h-5 text-white"})})}),e.jsx("h3",{className:"text-gray-400 text-xs mb-1",children:w.name}),e.jsx("p",{className:"text-2xl font-bold text-white",children:w.value})]},w.name)})})]}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl p-6 border border-gray-800",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("button",{onClick:()=>t("/employees"),className:"p-4 bg-[#1E1E2A] rounded-xl hover:bg-[#3A3A4A] transition-colors text-left",children:[e.jsx(Re,{className:"w-6 h-6 text-[#A88BFF] mb-2"}),e.jsx("h3",{className:"text-white font-semibold mb-1",children:"Manage Employees"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"View and manage employee records"})]}),e.jsxs("button",{onClick:()=>t("/approval-workflow/pending"),className:"p-4 bg-[#1E1E2A] rounded-xl hover:bg-[#3A3A4A] transition-colors text-left",children:[e.jsx(Fe,{className:"w-6 h-6 text-[#A88BFF] mb-2"}),e.jsx("h3",{className:"text-white font-semibold mb-1",children:"Leave Approvals"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Review pending leave requests"})]}),e.jsxs("button",{onClick:()=>t("/payroll"),className:"p-4 bg-[#1E1E2A] rounded-xl hover:bg-[#3A3A4A] transition-colors text-left",children:[e.jsx(tt,{className:"w-6 h-6 text-[#A88BFF] mb-2"}),e.jsx("h3",{className:"text-white font-semibold mb-1",children:"Process Payroll"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Generate and manage payroll"})]})]})]})]})},H1=()=>e.jsx(Qo,{}),q1=()=>{const[t,a]=v.useState({requiredSkills:[],preferredSkills:[],minimumExperience:0,candidateIds:[],maxResults:10,includeAllCandidates:!1}),[s,n]=v.useState(""),[r,i]=v.useState(""),[l,c]=v.useState([]),[o,d]=v.useState(!1),[x,m]=v.useState(""),[h,f]=v.useState(!1),[g,p]=v.useState(null),u=["JavaScript","Python","Java","React","Node.js","Angular","Vue.js","AWS","Azure","GCP","Docker","Kubernetes","MongoDB","PostgreSQL","MySQL","Redis","REST APIs","GraphQL","Microservices","Git","Agile","Scrum","Machine Learning","Deep Learning","TensorFlow","TypeScript","HTML","CSS","DevOps","CI/CD","Terraform","Ansible"],j=(b,C)=>{if(!b.trim())return;const S=C==="required"?"requiredSkills":"preferredSkills",k=t[S];k.includes(b.trim())||a(F=>({...F,[S]:[...k,b.trim()]})),C==="required"?n(""):i("")},y=(b,C)=>{const S=C==="required"?"requiredSkills":"preferredSkills";a(k=>({...k,[S]:k[S].filter(F=>F!==b)}))},N=async()=>{var b,C;d(!0),m(""),c([]);try{const S=await Y.post("/ai-analysis/resume-search",t);S.data.success?c(S.data.data):m(S.data.message||"Search failed")}catch(S){m(((C=(b=S.response)==null?void 0:b.data)==null?void 0:C.message)||"Failed to search resumes")}finally{d(!1)}},w=b=>b>=80?"text-green-400":b>=60?"text-yellow-400":b>=40?"text-orange-400":"text-red-400",D=b=>b>=80?"bg-green-500/20 border-green-500":b>=60?"bg-yellow-500/20 border-yellow-500":b>=40?"bg-orange-500/20 border-orange-500":"bg-red-500/20 border-red-500";return e.jsxs("div",{className:"min-h-screen bg-[#1E1E2A] p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Resume Search & Shortlisting"}),e.jsx("p",{className:"text-gray-400",children:"AI-powered candidate screening and matching"})]}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl border border-gray-800 p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Search Criteria"}),e.jsxs("button",{onClick:()=>f(!h),className:"flex items-center gap-2 text-[#A88BFF] hover:text-[#B89CFF] transition-colors",children:[e.jsx(xs,{className:"w-4 h-4"}),h?"Hide Filters":"Show Filters",e.jsx(fi,{className:`w-4 h-4 transition-transform ${h?"rotate-180":""}`})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:["Required Skills ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("input",{type:"text",value:s,onChange:b=>n(b.target.value),onKeyPress:b=>b.key==="Enter"&&j(s,"required"),placeholder:"Add required skill (e.g., React, Node.js)",className:"flex-1 px-4 py-2 bg-[#1E1E2A] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-[#A88BFF]"}),e.jsx("button",{onClick:()=>j(s,"required"),className:"px-4 py-2 bg-[#A88BFF] text-white rounded-lg hover:bg-[#B89CFF] transition-colors",children:e.jsx(Pe,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.requiredSkills.map(b=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-[#A88BFF]/20 text-[#A88BFF] rounded-full text-sm",children:[b,e.jsx("button",{onClick:()=>y(b,"required"),className:"hover:text-white",children:e.jsx(Ee,{className:"w-3 h-3"})})]},b))}),t.requiredSkills.length===0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Common skills:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:u.slice(0,8).map(b=>e.jsx("button",{onClick:()=>j(b,"required"),className:"px-2 py-1 text-xs bg-[#1E1E2A] border border-gray-700 rounded text-gray-400 hover:border-[#A88BFF] hover:text-[#A88BFF] transition-colors",children:b},b))})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Preferred Skills (Optional)"}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx("input",{type:"text",value:r,onChange:b=>i(b.target.value),onKeyPress:b=>b.key==="Enter"&&j(r,"preferred"),placeholder:"Add preferred skill",className:"flex-1 px-4 py-2 bg-[#1E1E2A] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-[#A88BFF]"}),e.jsx("button",{onClick:()=>j(r,"preferred"),className:"px-4 py-2 bg-[#A88BFF] text-white rounded-lg hover:bg-[#B89CFF] transition-colors",children:e.jsx(Pe,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.preferredSkills.map(b=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-green-500/20 text-green-400 rounded-full text-sm",children:[b,e.jsx("button",{onClick:()=>y(b,"preferred"),className:"hover:text-white",children:e.jsx(Ee,{className:"w-3 h-3"})})]},b))})]}),h&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Minimum Experience (years)"}),e.jsx("input",{type:"number",min:"0",value:t.minimumExperience,onChange:b=>a(C=>({...C,minimumExperience:parseInt(b.target.value)||0})),className:"w-full px-4 py-2 bg-[#1E1E2A] border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-[#A88BFF]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Max Results"}),e.jsxs("select",{value:t.maxResults,onChange:b=>a(C=>({...C,maxResults:parseInt(b.target.value)})),className:"w-full px-4 py-2 bg-[#1E1E2A] border border-gray-700 rounded-lg text-white focus:outline-none focus:border-[#A88BFF]",children:[e.jsx("option",{value:5,children:"5 Results"}),e.jsx("option",{value:10,children:"10 Results"}),e.jsx("option",{value:20,children:"20 Results"}),e.jsx("option",{value:50,children:"50 Results"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.includeAllCandidates,onChange:b=>a(C=>({...C,includeAllCandidates:b.target.checked})),className:"w-4 h-4 text-[#A88BFF] bg-[#1E1E2A] border-gray-700 rounded focus:ring-[#A88BFF]"}),"Search all candidates"]})})]}),e.jsx("button",{onClick:N,disabled:o||t.requiredSkills.length===0,className:"w-full py-3 bg-[#A88BFF] text-white rounded-lg hover:bg-[#B89CFF] disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center gap-2",children:o?e.jsxs(e.Fragment,{children:[e.jsx(cs,{className:"w-4 h-4 animate-spin"}),"Searching Candidates..."]}):e.jsxs(e.Fragment,{children:[e.jsx(rt,{className:"w-4 h-4"}),"Search & Shortlist Candidates"]})})]}),x&&e.jsx("div",{className:"bg-red-500/20 border border-red-500 rounded-lg p-4 mb-6",children:e.jsx("p",{className:"text-red-400",children:x})}),l.length>0&&e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl border border-gray-800 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Shortlisted Candidates"}),e.jsxs("span",{className:"text-sm text-gray-400",children:[l.length," candidates found"]})]}),e.jsx("div",{className:"space-y-4",children:l.map((b,C)=>e.jsxs("div",{className:"bg-[#1E1E2A] rounded-xl border border-gray-700 p-6 hover:border-[#A88BFF]/50 transition-colors",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:b.name}),e.jsx("div",{className:`px-3 py-1 rounded-full border ${D(b.score)}`,children:e.jsxs("span",{className:`text-sm font-medium ${w(b.score)}`,children:[b.score,"% Match"]})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-400",children:[b.email&&e.jsx("span",{children:b.email}),b.currentCompany&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(at,{className:"w-3 h-3"}),b.currentCompany]}),b.currentDesignation&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Re,{className:"w-3 h-3"}),b.currentDesignation]}),b.experience&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Te,{className:"w-3 h-3"}),b.experience]})]})]})}),b.matchedSkills&&b.matchedSkills.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-300 mb-2",children:"Matched Skills:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:b.matchedSkills.map((S,k)=>e.jsx("span",{className:"px-2 py-1 bg-[#A88BFF]/20 text-[#A88BFF] rounded text-sm",children:S},k))})]}),b.summary&&e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-300 mb-2",children:"Why this candidate is relevant:"}),e.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:b.summary})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>p(b),className:"px-4 py-2 bg-[#A88BFF] text-white rounded-lg hover:bg-[#B89CFF] transition-colors text-sm",children:"View Details"}),e.jsx("button",{className:"px-4 py-2 bg-[#1E1E2A] border border-gray-700 text-gray-300 rounded-lg hover:border-[#A88BFF] hover:text-[#A88BFF] transition-colors text-sm",children:"Contact Candidate"})]})]},b.candidateId||C))})]}),g&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-6 z-50",children:e.jsx("div",{className:"bg-[#2A2A3A] rounded-2xl border border-gray-800 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Candidate Details"}),e.jsx("button",{onClick:()=>p(null),className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-white mb-3",children:g.name}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Email:"}),e.jsx("p",{className:"text-white",children:g.email||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Phone:"}),e.jsx("p",{className:"text-white",children:g.phone||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Experience:"}),e.jsx("p",{className:"text-white",children:g.experience||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Location:"}),e.jsx("p",{className:"text-white",children:g.location||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Current Company:"}),e.jsx("p",{className:"text-white",children:g.currentCompany||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Current Role:"}),e.jsx("p",{className:"text-white",children:g.currentDesignation||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-white font-medium mb-3",children:"All Skills"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:(g.allSkills||[]).map((b,C)=>e.jsx("span",{className:"px-2 py-1 bg-[#1E1E2A] border border-gray-700 rounded text-sm text-gray-300",children:b},C))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-white font-medium mb-3",children:"Matched Skills"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:g.matchedSkills.map((b,C)=>e.jsx("span",{className:"px-2 py-1 bg-[#A88BFF]/20 text-[#A88BFF] rounded text-sm",children:b},C))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-white font-medium mb-3",children:"AI Summary"}),e.jsx("p",{className:"text-gray-300 leading-relaxed",children:g.summary})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-700",children:[e.jsx("button",{className:"px-4 py-2 bg-[#A88BFF] text-white rounded-lg hover:bg-[#B89CFF] transition-colors",children:"Schedule Interview"}),e.jsx("button",{className:"px-4 py-2 bg-[#1E1E2A] border border-gray-700 text-gray-300 rounded-lg hover:border-[#A88BFF] hover:text-[#A88BFF] transition-colors",children:"Send Message"}),e.jsx("button",{className:"px-4 py-2 bg-green-500/20 text-green-400 rounded-lg hover:bg-green-500/30 transition-colors",children:"Shortlist"})]})]})]})})})]})},W1=()=>{var ie,A;const[t,a]=v.useState([]),[s,n]=v.useState(!1),[r,i]=v.useState(""),[l,c]=v.useState(1),[o,d]=v.useState(1),[x,m]=v.useState(""),[h,f]=v.useState(!1),[g,p]=v.useState(!1),[u,j]=v.useState(null),[y,N]=v.useState({status:"active",processingStatus:"",minExperience:"",maxExperience:""}),[w,D]=v.useState({name:"",email:"",phone:"",rawText:"",tags:""}),[b,C]=v.useState({file:null,name:"",email:"",phone:"",tags:""}),[S,k]=v.useState(!1),F=20,R=async(P={})=>{var O,I;n(!0),i("");try{const J={page:P.page||l,limit:F,status:y.status};if(y.processingStatus&&(J.processingStatus=y.processingStatus),y.minExperience&&(J.minExperience=y.minExperience),y.maxExperience&&(J.maxExperience=y.maxExperience),x.trim()){const te=await Y.post("/resume-pool/search",{query:x.trim(),page:P.page||l,limit:F,filters:{}});if(te.data.success){a(te.data.data||[]);const se=te.data.pagination||{};c(se.page||1),d(se.pages||1)}else i(te.data.message||"Failed to search resumes")}else{const te=await Y.get("/resume-pool",{params:J});if(te.data.success){a(te.data.data||[]);const se=te.data.pagination||{};c(se.page||1),d(se.pages||1)}else i(te.data.message||"Failed to load resumes")}}catch(J){i(((I=(O=J.response)==null?void 0:O.data)==null?void 0:I.message)||"Failed to load candidate pool")}finally{n(!1)}};v.useEffect(()=>{R({page:1})},[]);const T=()=>{R({page:1})},M=(P,O)=>{N(I=>({...I,[P]:O}))},X=P=>{P<1||P>o||(c(P),R({page:P}))},q=()=>{D({name:"",email:"",phone:"",rawText:"",tags:""}),f(!0)},B=()=>{C({file:null,name:"",email:"",phone:"",tags:""}),p(!0)},K=async()=>{var P,O;if(!(!w.name.trim()||!w.rawText.trim())){k(!0),i("");try{const I={name:w.name.trim(),email:w.email.trim()||void 0,phone:w.phone.trim()||void 0,rawText:w.rawText,tags:w.tags?w.tags.split(",").map(te=>te.trim()).filter(Boolean):[]},J=await Y.post("/resume-pool/text",I);J.data.success?(f(!1),await R({page:1})):i(J.data.message||"Failed to add resume")}catch(I){i(((O=(P=I.response)==null?void 0:P.data)==null?void 0:O.message)||"Failed to add resume")}finally{k(!1)}}},Q=async()=>{var P,O;if(b.file){k(!0),i("");try{const I=new FormData;I.append("resume",b.file),b.name&&I.append("name",b.name),b.email&&I.append("email",b.email),b.phone&&I.append("phone",b.phone),b.tags&&I.append("tags",b.tags);const J=await Y.post("/resume-pool/file",I,{headers:{"Content-Type":"multipart/form-data"}});J.data.success?(p(!1),await R({page:1})):i(J.data.message||"Failed to upload resume file")}catch(I){i(((O=(P=I.response)==null?void 0:P.data)==null?void 0:O.message)||"Failed to upload resume file")}finally{k(!1)}}},_=P=>{switch(P){case"completed":return"text-green-400 bg-green-500/10 border-green-500/40";case"processing":return"text-yellow-400 bg-yellow-500/10 border-yellow-500/40";case"failed":return"text-red-400 bg-red-500/10 border-red-500/40";default:return"text-gray-400 bg-gray-500/10 border-gray-500/40"}},ne=P=>{var J,te;const O=((J=P==null?void 0:P.experience)==null?void 0:J.years)||0,I=((te=P==null?void 0:P.experience)==null?void 0:te.months)||0;return!O&&!I?"N/A":I?`${O} yrs ${I} mo`:`${O} yrs`};return e.jsxs("div",{className:"min-h-screen bg-[#1E1E2A] p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-white flex items-center gap-3",children:[e.jsx(Re,{className:"w-7 h-7 text-[#A88BFF]"}),"Candidate Pool"]}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Central pool of all resumes. View, search, and add candidates."})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:q,className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-[#A88BFF] text-white text-sm font-medium hover:bg-[#B89CFF] transition-colors",children:[e.jsx(Pe,{className:"w-4 h-4"}),"Add Raw Text"]}),e.jsxs("button",{onClick:B,className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-[#1E1E2A] border border-gray-700 text-gray-200 text-sm font-medium hover:border-[#A88BFF] hover:text-[#A88BFF] transition-colors",children:[e.jsx(Pr,{className:"w-4 h-4"}),"Upload Resume File"]})]})]}),e.jsx("div",{className:"bg-[#2A2A3A] rounded-2xl border border-gray-800 p-4 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(rt,{className:"w-4 h-4 text-gray-500 absolute left-3 top-1/2 -translate-y-1/2"}),e.jsx("input",{type:"text",placeholder:"Search by name, skills, text...",value:x,onChange:P=>m(P.target.value),onKeyDown:P=>P.key==="Enter"&&T(),className:"w-full pl-9 pr-3 py-2 bg-[#1E1E2A] border border-gray-700 rounded-lg text-sm text-white placeholder-gray-500 focus:outline-none focus:border-[#A88BFF]"})]}),e.jsxs("button",{onClick:T,className:"inline-flex items-center gap-2 px-3 py-2 rounded-lg bg-[#A88BFF] text-white text-sm font-medium hover:bg-[#B89CFF] transition-colors",children:[e.jsx(rt,{className:"w-4 h-4"}),"Search"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[e.jsx(xs,{className:"w-3 h-3"}),"Filters"]}),e.jsxs("select",{value:y.processingStatus,onChange:P=>M("processingStatus",P.target.value),className:"px-3 py-1.5 bg-[#1E1E2A] border border-gray-700 rounded-lg text-xs text-gray-200 focus:outline-none focus:border-[#A88BFF]",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"failed",children:"Failed"})]}),e.jsx("input",{type:"number",placeholder:"Min Exp",value:y.minExperience,onChange:P=>M("minExperience",P.target.value),className:"w-20 px-2 py-1.5 bg-[#1E1E2A] border border-gray-700 rounded-lg text-xs text-gray-200 placeholder-gray-500 focus:outline-none focus:border-[#A88BFF]"}),e.jsx("input",{type:"number",placeholder:"Max Exp",value:y.maxExperience,onChange:P=>M("maxExperience",P.target.value),className:"w-20 px-2 py-1.5 bg-[#1E1E2A] border border-gray-700 rounded-lg text-xs text-gray-200 placeholder-gray-500 focus:outline-none focus:border-[#A88BFF]"})]})]})}),r&&e.jsx("div",{className:"bg-red-500/10 border border-red-500/40 text-red-300 text-sm rounded-xl px-4 py-3 mb-4",children:r}),e.jsxs("div",{className:"bg-[#2A2A3A] rounded-2xl border border-gray-800 overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-800 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-300",children:[e.jsx(Re,{className:"w-4 h-4 text-[#A88BFF]"}),e.jsx("span",{children:"Candidate Pool"}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",t.length," shown)"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx(Te,{className:"w-3 h-3"}),"Auto-processed with AI for skills & experience"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-[#232334] text-xs uppercase text-gray-400",children:[e.jsx("th",{className:"px-4 py-3 text-left",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Contact"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Experience"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Key Skills"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Tags"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Actions"})]})}),e.jsx("tbody",{children:s?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10 text-center text-gray-400",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2",children:[e.jsx(cs,{className:"w-5 h-5 animate-spin text-[#A88BFF]"}),e.jsx("span",{children:"Loading candidate pool..."})]})})}):t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-10 text-center text-gray-500 text-sm",children:"No resumes found in the pool."})}):t.map(P=>{var O,I;return e.jsxs("tr",{className:"border-t border-gray-800 hover:bg-[#1E1E2A]/60 transition-colors",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-white font-medium",children:P.name}),e.jsx("span",{className:"text-xs text-gray-500",children:P.fileName||"Manual Entry"})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col text-xs text-gray-300",children:[P.email&&e.jsx("span",{children:P.email}),P.phone&&e.jsx("span",{className:"text-gray-500",children:P.phone})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-xs text-gray-300",children:ne(P.parsedData)})}),e.jsx("td",{className:"px-4 py-3 max-w-xs",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[(((O=P.parsedData)==null?void 0:O.skills)||[]).slice(0,5).map((J,te)=>e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-[#1E1E2A] border border-gray-700 text-[11px] text-gray-200",children:J},te)),(((I=P.parsedData)==null?void 0:I.skills)||[]).length>5&&e.jsxs("span",{className:"text-[11px] text-gray-500",children:["+",P.parsedData.skills.length-5," more"]})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full border text-[11px] ${_(P.processingStatus)}`,children:P.processingStatus||"pending"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:(P.tags||[]).slice(0,3).map((J,te)=>e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-[#1E1E2A] border border-gray-700 text-[11px] text-gray-400",children:J},te))})}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("button",{onClick:()=>j(P),className:"inline-flex items-center gap-1 px-3 py-1.5 rounded-lg bg-[#1E1E2A] border border-gray-700 text-xs text-gray-200 hover:border-[#A88BFF] hover:text-[#A88BFF] transition-colors",children:[e.jsx(Ue,{className:"w-3 h-3"}),"View"]})})]},P._id)})})]})}),o>1&&e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-gray-800 text-xs text-gray-400",children:[e.jsxs("span",{children:["Page ",l," of ",o]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>X(l-1),disabled:l===1,className:"px-2 py-1 rounded border border-gray-700 disabled:opacity-40 disabled:cursor-not-allowed hover:border-[#A88BFF] hover:text-[#A88BFF]",children:"Prev"}),e.jsx("button",{onClick:()=>X(l+1),disabled:l===o,className:"px-2 py-1 rounded border border-gray-700 disabled:opacity-40 disabled:cursor-not-allowed hover:border-[#A88BFF] hover:text-[#A88BFF]",children:"Next"})]})]})]}),h&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"w-full max-w-3xl bg-[#2A2A3A] border border-gray-800 rounded-2xl shadow-xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-800",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(Pe,{className:"w-4 h-4 text-[#A88BFF]"}),"Add Resume (Raw Text)"]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Paste full resume text. We will auto-parse skills and experience."})]}),e.jsx("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"px-5 py-4 space-y-4 overflow-y-auto max-h-[70vh]",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:["Candidate Name ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("input",{type:"text",value:w.name,onChange:P=>D(O=>({...O,name:P.target.value})),className:"w-full px-3 py-2 bg-[#1E1E2A] border border-gray-700 rounded-lg text-sm text-white placeholder-gray-500 focus:outline-none focus:border-[#A88BFF]",placeholder:"e.g. Sarah Chen"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:w.email,onChange:P=>D(O=>({...O,email:P.target.value})),className:"w-full px-3 py-2 bg-[#1E1E2A] border border-gray-700 rounded-lg text-sm text-white placeholder-gray-500 focus:outline-none focus:border-[#A88BFF]",placeholder:"candidate@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Phone"}),e.jsx("input",{type:"text",value:w.phone,onChange:P=>D(O=>({...O,phone:P.target.value})),className:"w-full px-3 py-2 bg-[#1E1E2A] border border-gray-700 rounded-lg text-sm text-white placeholder-gray-500 focus:outline-none focus:border-[#A88BFF]",placeholder:"+91 98765 43210"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Tags (comma separated)"}),e.jsx("input",{type:"text",value:w.tags,onChange:P=>D(O=>({...O,tags:P.target.value})),className:"w-full px-3 py-2 bg-[#1E1E2A] border border-gray-700 rounded-lg text-sm text-white placeholder-gray-500 focus:outline-none focus:border-[#A88BFF]",placeholder:"e.g. Java, Backend, 6 years"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:["Resume Text ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsx("textarea",{rows:10,value:w.rawText,onChange:P=>D(O=>({...O,rawText:P.target.value})),className:"w-full px-3 py-2 bg-[#1E1E2A] border border-gray-700 rounded-lg text-sm text-white placeholder-gray-500 focus:outline-none focus:border-[#A88BFF] resize-none",placeholder:"Paste full resume content here..."})]})]}),e.jsxs("div",{className:"px-5 py-4 border-t border-gray-800 flex items-center justify-between",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Tip: You can copy-paste from PDF or Word. The system will auto-extract skills & experience."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 rounded-lg border border-gray-700 text-xs text-gray-300 hover:border-gray-500 hover:text-white",children:"Cancel"}),e.jsx("button",{onClick:K,disabled:S||!w.name.trim()||!w.rawText.trim(),className:"px-4 py-2 rounded-lg bg-[#A88BFF] text-xs text-white font-medium hover:bg-[#B89CFF] disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:S?e.jsxs(e.Fragment,{children:[e.jsx(cs,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"w-3 h-3"}),"Add to Pool"]})})]})]})]})}),g&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"w-full max-w-xl bg-[#2A2A3A] border border-gray-800 rounded-2xl shadow-xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-800",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-Ñenter gap-2",children:[e.jsx(Pr,{className:"w-4 h-4 text-[#A88BFF]"}),"Upload Resume File"]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Upload PDF or DOCX files. We will parse them automatically."})]}),e.jsx("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"px-5 py-4 space-y-4 overflow-y-auto max-h-[70vh]",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Candidate Name (optional)"}),e.jsx("input",{type:"text",value:b.name,onChange:P=>C(O=>({...O,name:P.target.value})),className:"w-full px-3 py-2 bg-[#1E1E2A] border border-gray-700 rounded-lg text-sm text-white placeholder-gray-500 focus:outline-none focus:border-[#A88BFF]",placeholder:"If empty, system will try to detect"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-300 mb-1",children:"Tags (comma separated)"}),e.jsx("input",{type:"text",value:b.tags,onChange:P=>C(O=>({...O,tags:P.target.value})),className:"w-full px-3 py-2 bg-[#1E1E2A] border border-gray-700 rounded-lg text-sm text-white placeholder-gray-500 focus:outline-none focus:border-[#A88BFF]",placeholder:"e.g. Backend, Senior, React"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-300 mb-2",children:["Resume File ",e.jsx("span",{className:"text-red-400",children:"*"})]}),e.jsxs("label",{className:"flex flex-col items-center justify-center gap-2 px-4 py-8 border-2 border-dashed border-gray-700 rounded-xl bg-[#1E1E2A] text-gray-400 cursor-pointer hover:border-[#A88BFF] hover:text-[#A88BFF] transition-colors text-center text-xs",children:[e.jsx(Pr,{className:"w-5 h-5"}),b.file?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-200 text-sm",children:b.file.name}),e.jsx("span",{children:"Click to change file"})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-200 text-sm",children:"Click to upload PDF or DOCX"}),e.jsx("span",{children:"Max 10MB per file"})]}),e.jsx("input",{type:"file",className:"hidden",accept:"application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document",onChange:P=>{var I;const O=(I=P.target.files)==null?void 0:I[0];O&&C(J=>({...J,file:O}))}})]})]})]}),e.jsxs("div",{className:"px-5 py-4 border-t border-gray-800 flex items-center justify-between",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Files are stored in the resume pool and auto-parsed for skills & experience."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 rounded-lg border border-gray-700 text-xs text-gray-300 hover:border-gray-500 hover:text-white",children:"Cancel"}),e.jsx("button",{onClick:Q,disabled:S||!b.file,className:"px-4 py-2 rounded-lg bg-[#A88BFF] text-xs text-white font-medium hover:bg-[#B89CFF] disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:S?e.jsxs(e.Fragment,{children:[e.jsx(cs,{className:"w-4 h-4 animate-spin"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Pr,{className:"w-3 h-3"}),"Upload"]})})]})]})]})}),u&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"w-full max-w-4xl bg-[#2A2A3A] border border-gray-800 rounded-2xl shadow-xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-800",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold text-white flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4 text-[#A88BFF]"}),u.name]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["From Resume Pool â€¢ ",u.fileName||"Manual Entry"]})]}),e.jsx("button",{onClick:()=>j(null),className:"text-gray-400 hover:text-white",children:e.jsx(Ee,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 px-5 py-4 overflow-y-auto max-h-[70vh]",children:[e.jsxs("div",{className:"space-y-4 lg:col-span-1",children:[e.jsxs("div",{className:"bg-[#1E1E2A] border border-gray-800 rounded-xl p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-white mb-3",children:"Basic Info"}),e.jsxs("div",{className:"space-y-2 text-xs text-gray-300",children:[u.email&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Email: "}),e.jsx("span",{children:u.email})]}),u.phone&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Phone: "}),e.jsx("span",{children:u.phone})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Experience: "}),e.jsx("span",{children:ne(u.parsedData)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Status: "}),e.jsx("span",{className:"capitalize",children:u.processingStatus||"pending"})]}),u.tags&&u.tags.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Tags: "}),e.jsx("div",{className:"mt-1 flex flex-wrap gap-1",children:u.tags.map((P,O)=>e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-[#1E1E2A] border border-gray-700 text-[11px] text-gray-300",children:P},O))})]})]})]}),e.jsxs("div",{className:"bg-[#1E1E2A] border border-gray-800 rounded-xl p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-white mb-3",children:"Skills"}),e.jsxs("div",{className:"flex flex-wrap gap-1 text-xs",children:[(((ie=u.parsedData)==null?void 0:ie.skills)||[]).map((P,O)=>e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-[#232334] text-gray-200 border border-gray-700",children:P},O)),(!((A=u.parsedData)!=null&&A.skills)||u.parsedData.skills.length===0)&&e.jsx("span",{className:"text-gray-500",children:"No parsed skills available."})]})]}),u.aiAnalysis&&e.jsxs("div",{className:"bg-[#1E1E2A] border border-gray-800 rounded-xl p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-white mb-3",children:"AI Insights"}),e.jsxs("div",{className:"space-y-2 text-xs text-gray-300",children:[u.aiAnalysis.overallFit&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Overall Fit: "}),e.jsx("span",{className:"capitalize",children:u.aiAnalysis.overallFit})]}),u.aiAnalysis.keyHighlights&&u.aiAnalysis.keyHighlights.length>0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Highlights:"}),e.jsx("ul",{className:"mt-1 list-disc list-inside space-y-1",children:u.aiAnalysis.keyHighlights.map((P,O)=>e.jsx("li",{children:P},O))})]})]})]})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-[#1E1E2A] border border-gray-800 rounded-xl p-4 h-full flex flex-col",children:[e.jsxs("h3",{className:"text-sm font-semibold text-white mb-3 flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4 text-[#A88BFF]"}),"Raw Resume Text"]}),e.jsx("div",{className:"flex-1 overflow-y-auto rounded-lg bg-[#11111C] border border-gray-900 p-3 text-xs text-gray-300 whitespace-pre-wrap leading-relaxed",children:u.rawText||"No raw text available."})]})})]})]})})]})},V1=()=>{const[t,a]=v.useState([]),[s,n]=v.useState(null),[r,i]=v.useState([]),[l,c]=v.useState(!0),[o,d]=v.useState(null),[x,m]=v.useState(""),[h,f]=v.useState(""),[g,p]=v.useState([]),[u,j]=v.useState(!1),[y,N]=v.useState(null),[w,D]=v.useState("");v.useEffect(()=>{b(),C()},[x]);const b=async()=>{try{c(!0);const q=await su(x);q.success&&a(q.data)}catch{E.error("Failed to load candidates")}finally{c(!1)}},C=async()=>{try{const q=await cu();q.success&&d(q.data)}catch(q){console.error("Failed to load stats:",q)}},S=async q=>{try{const B=await au(q);B.success&&(n(B.data.candidate),i(B.data.documents))}catch{E.error("Failed to load documents")}},k=async q=>{try{(await ru(q,"Document verified")).success&&(E.success("Document verified successfully"),S(s.onboardingId),b(),C())}catch{E.error("Failed to verify document")}},F=async()=>{if(!w.trim()){E.error("Please provide a reason for rejection");return}try{(await nu(y._id,w)).success&&(E.success("Document rejected. Re-submission email sent to candidate."),j(!1),N(null),D(""),S(s.onboardingId),b(),C())}catch{E.error("Failed to reject document")}},R=async()=>{if(g.length===0){E.error("Please select documents to verify");return}try{(await iu(g,"Bulk verified")).success&&(E.success(`${g.length} documents verified successfully`),p([]),S(s.onboardingId),b(),C())}catch{E.error("Failed to bulk verify documents")}},T=async(q,B)=>{try{const K=await lu(q),Q=window.URL.createObjectURL(K),_=document.createElement("a");_.href=Q,_.download=B,document.body.appendChild(_),_.click(),window.URL.revokeObjectURL(Q),document.body.removeChild(_),E.success("Document downloaded")}catch{E.error("Failed to download document")}},M=t.filter(q=>{var B,K,Q;return((B=q.candidateName)==null?void 0:B.toLowerCase().includes(h.toLowerCase()))||((K=q.candidateEmail)==null?void 0:K.toLowerCase().includes(h.toLowerCase()))||((Q=q.candidateId)==null?void 0:Q.toLowerCase().includes(h.toLowerCase()))}),X=q=>({verified:"bg-green-100 text-green-800",unverified:"bg-red-100 text-red-800",pending:"bg-yellow-100 text-yellow-800",resubmitted:"bg-blue-100 text-blue-800"})[q]||"bg-gray-100 text-gray-800";return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Document Verification"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Review and verify candidate documents"})]})}),o&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Total Documents"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:o.total})]}),e.jsx(Ue,{className:"w-8 h-8 text-blue-500"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Pending Review"}),e.jsx("h3",{className:"text-2xl font-bold text-yellow-500",children:o.pending})]}),e.jsx(st,{className:"w-8 h-8 text-yellow-500"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Verified"}),e.jsx("h3",{className:"text-2xl font-bold text-green-500",children:o.verified})]}),e.jsx(we,{className:"w-8 h-8 text-green-500"})]})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Rejected"}),e.jsx("h3",{className:"text-2xl font-bold text-red-500",children:o.unverified})]}),e.jsx(ze,{className:"w-8 h-8 text-red-500"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Candidates"}),e.jsxs("div",{className:"relative mb-3",children:[e.jsx(rt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search candidates...",value:h,onChange:q=>f(q.target.value),className:"input pl-10 w-full"})]}),e.jsxs("select",{value:x,onChange:q=>m(q.target.value),className:"input w-full",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"verified",children:"Verified"}),e.jsx("option",{value:"unverified",children:"Rejected"}),e.jsx("option",{value:"resubmitted",children:"Resubmitted"})]})]}),e.jsx("div",{className:"space-y-2 max-h-[600px] overflow-y-auto",children:M.map(q=>e.jsxs("div",{onClick:()=>S(q.onboardingId),className:`p-4 rounded-lg cursor-pointer transition-colors ${(s==null?void 0:s.onboardingId)===q.onboardingId?"bg-primary-600":"bg-dark-800 hover:bg-dark-700"}`,children:[e.jsx("h4",{className:"font-medium text-white",children:q.candidateName}),e.jsx("p",{className:"text-sm text-gray-400",children:q.position}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs",children:[e.jsxs("span",{className:"text-gray-400",children:[q.documentStats.total," docs"]}),q.documentStats.pending>0&&e.jsxs("span",{className:"px-2 py-0.5 bg-yellow-500/20 text-yellow-400 rounded",children:[q.documentStats.pending," pending"]})]})]},q.onboardingId))})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsx("div",{className:"card",children:s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:s.candidateName}),e.jsx("p",{className:"text-sm text-gray-400",children:s.candidateEmail}),e.jsx("p",{className:"text-sm text-gray-400",children:s.position})]}),g.length>0&&e.jsxs("button",{onClick:R,className:"btn-primary",children:["Verify Selected (",g.length,")"]})]})}),e.jsxs("div",{className:"space-y-4",children:[r.map(q=>e.jsx("div",{className:"bg-dark-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("input",{type:"checkbox",checked:g.includes(q._id),onChange:B=>{B.target.checked?p([...g,q._id]):p(g.filter(K=>K!==q._id))},className:"mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ue,{className:"w-5 h-5 text-gray-400"}),e.jsx("h4",{className:"font-medium text-white",children:q.documentName}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${X(q.verificationStatus)}`,children:q.verificationStatus})]}),e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:q.originalFileName}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Uploaded: ",new Date(q.uploadedAt).toLocaleString()]}),q.unverificationReason&&e.jsx("div",{className:"mt-2 p-2 bg-red-500/10 border border-red-500/20 rounded",children:e.jsxs("p",{className:"text-sm text-red-400",children:[e.jsx("strong",{children:"Rejection Reason:"})," ",q.unverificationReason]})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>T(q._id,q.originalFileName),className:"p-2 hover:bg-dark-700 rounded-lg transition-colors",title:"Download",children:e.jsx(_t,{className:"w-4 h-4 text-gray-400"})}),q.verificationStatus!=="verified"&&e.jsx("button",{onClick:()=>k(q._id),className:"p-2 hover:bg-green-500/10 rounded-lg transition-colors",title:"Verify",children:e.jsx(we,{className:"w-4 h-4 text-green-500"})}),q.verificationStatus!=="unverified"&&e.jsx("button",{onClick:()=>{N(q),j(!0)},className:"p-2 hover:bg-red-500/10 rounded-lg transition-colors",title:"Reject",children:e.jsx(ze,{className:"w-4 h-4 text-red-500"})})]})]})},q._id)),r.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-400",children:"No documents uploaded yet"})]})]}):e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(Ue,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Select a candidate to view their documents"})]})})})]}),u&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-900 rounded-xl max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Reject Document"}),e.jsxs("p",{className:"text-gray-400 mb-4",children:["Please provide a reason for rejecting ",e.jsx("strong",{children:y==null?void 0:y.documentName})]}),e.jsx("textarea",{value:w,onChange:q=>D(q.target.value),placeholder:"Enter rejection reason...",className:"input w-full h-32 mb-4",required:!0}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{j(!1),N(null),D("")},className:"btn-secondary flex-1",children:"Cancel"}),e.jsx("button",{onClick:F,className:"btn-danger flex-1",children:"Reject & Send Email"})]})]})})]})},G1=()=>{var o,d,x,m,h,f,g;const{theme:t}=ot(),[a,s]=v.useState(null),[n,r]=v.useState(!0);v.useEffect(()=>{i()},[]);const i=async()=>{try{const p=await wh();s(p.data),r(!1)}catch(p){console.error("Error fetching dashboard stats:",p),E.error("Failed to fetch dashboard statistics"),s({overview:{totalClients:0,activeClients:0,totalUsers:1,totalPackages:3},clientStats:[],subscriptionStats:[],recentActivities:[]}),r(!1)}},l=({title:p,value:u,icon:j,trend:y,color:N="blue"})=>e.jsx("div",{className:`p-6 rounded-xl border ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} hover:shadow-lg transition-shadow duration-200`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:p}),e.jsx("p",{className:`text-3xl font-bold mt-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:u}),y&&e.jsxs("p",{className:`text-sm mt-2 flex items-center ${y.type==="increase"?"text-green-600":"text-red-600"}`,children:[e.jsx(Ss,{className:"w-4 h-4 mr-1"}),y.value,"% from last month"]})]}),e.jsx("div",{className:`p-3 rounded-lg bg-${N}-100 dark:bg-${N}-900/20`,children:e.jsx(j,{className:`w-6 h-6 text-${N}-600 dark:text-${N}-400`})})]})}),c=({activity:p})=>{var u,j;return e.jsxs("div",{className:`flex items-center space-x-3 p-3 rounded-lg ${t==="dark"?"hover:bg-gray-700":"hover:bg-gray-50"} transition-colors duration-200`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${p.action==="create"?"bg-green-100 dark:bg-green-900/20":p.action==="update"?"bg-blue-100 dark:bg-blue-900/20":"bg-red-100 dark:bg-red-900/20"}`,children:p.action==="create"?e.jsx(we,{className:"w-4 h-4 text-green-600 dark:text-green-400"}):p.action==="update"?e.jsx(La,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"}):e.jsx(ze,{className:"w-4 h-4 text-red-600 dark:text-red-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:[(u=p.userId)==null?void 0:u.email," ",p.action,"d ",p.resource]}),e.jsxs("p",{className:`text-xs ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:[(j=p.clientId)==null?void 0:j.name," â€¢ ",new Date(p.createdAt).toLocaleString()]})]})]})};return n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:`text-3xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Super Admin Dashboard"}),e.jsx("p",{className:`mt-2 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"System overview and key metrics"})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("div",{className:`px-3 py-1 rounded-full text-xs font-medium ${t==="dark"?"bg-green-900/20 text-green-400":"bg-green-100 text-green-800"}`,children:[e.jsx(Qr,{className:"w-3 h-3 inline mr-1"}),"All Systems Operational"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(l,{title:"Total Clients",value:((o=a==null?void 0:a.overview)==null?void 0:o.totalClients)||0,icon:Re,trend:{type:"increase",value:12},color:"blue"}),e.jsx(l,{title:"Active Clients",value:((d=a==null?void 0:a.overview)==null?void 0:d.activeClients)||0,icon:we,trend:{type:"increase",value:8},color:"green"}),e.jsx(l,{title:"Total Users",value:((x=a==null?void 0:a.overview)==null?void 0:x.totalUsers)||0,icon:La,trend:{type:"increase",value:15},color:"purple"}),e.jsx(l,{title:"Active Packages",value:((m=a==null?void 0:a.overview)==null?void 0:m.totalPackages)||0,icon:Tt,color:"orange"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:`p-6 rounded-xl border ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Client Status"}),e.jsx("div",{className:"space-y-3",children:(h=a==null?void 0:a.clientStats)==null?void 0:h.map(p=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${p._id==="active"?"bg-green-500":p._id==="inactive"?"bg-gray-500":"bg-red-500"}`}),e.jsx("span",{className:`text-sm capitalize ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:p._id})]}),e.jsx("span",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:p.count})]},p._id))})]}),e.jsxs("div",{className:`p-6 rounded-xl border ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Subscriptions"}),e.jsx("div",{className:"space-y-3",children:(f=a==null?void 0:a.subscriptionStats)==null?void 0:f.map(p=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${p._id==="active"?"bg-blue-500":p._id==="trial"?"bg-yellow-500":"bg-red-500"}`}),e.jsx("span",{className:`text-sm capitalize ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:p._id})]}),e.jsx("span",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:p.count})]},p._id))})]}),e.jsxs("div",{className:`p-6 rounded-xl border ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Recent Activities"}),e.jsx("div",{className:"space-y-2",children:((g=a==null?void 0:a.recentActivities)==null?void 0:g.length)>0?a.recentActivities.map(p=>e.jsx(c,{activity:p},p._id)):e.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"No recent activities"})})]})]}),e.jsx("div",{className:"p-6 rounded-xl border border-yellow-200 bg-yellow-50 dark:bg-yellow-900/10 dark:border-yellow-800",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Ct,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"System Alerts"}),e.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-1",children:"2 subscriptions expiring in the next 7 days. Review client renewals."})]})]})})]})},Wc=({client:t,onClose:a,onSuccess:s})=>{const{theme:n}=ot(),[r,i]=v.useState({companyName:"",clientCode:"",email:"",adminEmail:"",phone:"",address:"",contactPerson:"",subscriptionPlan:"basic",subscriptionStartDate:new Date().toISOString().split("T")[0],subscriptionEndDate:"",maxUsers:10,status:"active",industry:"",website:"",taxId:"",notes:""});v.useEffect(()=>{var o,d,x,m,h,f;t&&i({companyName:t.companyName||"",clientCode:t.clientCode||"",email:t.email||"",adminEmail:((o=t.contactPerson)==null?void 0:o.email)||"",phone:t.phone||"",address:typeof t.address=="string"?t.address:"",contactPerson:((d=t.contactPerson)==null?void 0:d.name)||"",subscriptionPlan:((x=t.subscription)==null?void 0:x.plan)||"basic",subscriptionStartDate:(m=t.subscription)!=null&&m.startDate?new Date(t.subscription.startDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],subscriptionEndDate:(h=t.subscription)!=null&&h.endDate?new Date(t.subscription.endDate).toISOString().split("T")[0]:"",maxUsers:((f=t.subscription)==null?void 0:f.maxUsers)||10,status:t.status||"active",industry:t.industry||"",website:t.website||"",taxId:t.taxId||"",notes:t.notes||""})},[t]);const l=o=>{const{name:d,value:x}=o.target;i(m=>({...m,[d]:x}))},c=async o=>{var d,x;o.preventDefault();try{const m={clientCode:r.clientCode,name:r.companyName,companyName:r.companyName,email:r.email,adminEmail:r.adminEmail,phone:r.phone,address:r.address,contactPerson:{name:r.contactPerson,email:r.adminEmail||r.email,phone:r.phone},status:r.status,industry:r.industry,website:r.website,taxId:r.taxId,notes:r.notes,subscription:{plan:r.subscriptionPlan,startDate:r.subscriptionStartDate,endDate:r.subscriptionEndDate,maxUsers:r.maxUsers,status:"active"}};t?(await Sh(t._id,m),E.success("Client updated successfully")):(await kh(m),E.success("Client created successfully")),s(),a()}catch(m){console.error("Error saving client:",m),E.error(((x=(d=m.response)==null?void 0:d.data)==null?void 0:x.message)||"Failed to save client")}};return e.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 ${n==="dark"?"dark":""}`,children:e.jsxs("div",{className:`w-full max-w-4xl rounded-xl shadow-2xl overflow-hidden ${n==="dark"?"bg-gray-800 text-white":"bg-white text-gray-900"}`,children:[e.jsxs("div",{className:`flex items-center justify-between p-4 border-b ${n==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsx("h2",{className:"text-xl font-semibold",children:t?"Edit Client":"Add New Client"}),e.jsx("button",{onClick:a,className:`p-2 rounded-full hover:bg-opacity-10 hover:bg-gray-500 ${n==="dark"?"text-gray-400":"text-gray-600"}`,children:e.jsx(Ee,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:c,className:"p-6 max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-lg font-medium flex items-center",children:[e.jsx(Nr,{className:"w-5 h-5 mr-2 text-blue-500"}),"Company Information"]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Company Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"companyName",value:r.companyName,onChange:l,className:`w-full px-3 py-2 rounded-lg border ${n==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Client Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"clientCode",value:r.clientCode,onChange:l,className:`w-full px-3 py-2 rounded-lg border ${n==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Industry"}),e.jsx("input",{type:"text",name:"industry",value:r.industry,onChange:l,className:`w-full px-3 py-2 rounded-lg border ${n==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Website"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("span",{className:"text-gray-500",children:"https://"})}),e.jsx("input",{type:"text",name:"website",value:r.website,onChange:l,className:`w-full px-3 py-2 pl-16 rounded-lg border ${n==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,placeholder:"example.com"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tax ID"}),e.jsx("input",{type:"text",name:"taxId",value:r.taxId,onChange:l,className:`w-full px-3 py-2 rounded-lg border ${n==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-lg font-medium flex items-center",children:[e.jsx(ft,{className:"w-5 h-5 mr-2 text-blue-500"}),"Contact Information"]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Contact Person ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"contactPerson",value:r.contactPerson,onChange:l,className:`w-full px-3 py-2 rounded-lg border ${n==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Company Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ut,{className:"h-4 w-4 text-gray-500"})}),e.jsx("input",{type:"email",name:"email",value:r.email,onChange:l,className:`w-full pl-10 px-3 py-2 rounded-lg border ${n==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,placeholder:"company@example.com",required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Admin User Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ft,{className:"h-4 w-4 text-gray-500"})}),e.jsx("input",{type:"email",name:"adminEmail",value:r.adminEmail,onChange:l,className:`w-full pl-10 px-3 py-2 rounded-lg border ${n==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,placeholder:"admin@example.com",required:!0})]}),e.jsx("p",{className:`text-xs mt-1 ${n==="dark"?"text-gray-400":"text-gray-500"}`,children:"This email will be used to create the admin user account (password: password123)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Phone ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ts,{className:"h-4 w-4 text-gray-500"})}),e.jsx("input",{type:"tel",name:"phone",value:r.phone,onChange:l,className:`w-full pl-10 px-3 py-2 rounded-lg border ${n==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Address"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-3 left-3",children:e.jsx(ea,{className:"h-4 w-4 text-gray-500"})}),e.jsx("textarea",{name:"address",value:r.address,onChange:l,rows:"3",className:`w-full pl-10 px-3 py-2 rounded-lg border ${n==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-lg font-medium flex items-center",children:[e.jsx(ha,{className:"w-5 h-5 mr-2 text-blue-500"}),"Subscription Details"]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Plan ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"subscriptionPlan",value:r.subscriptionPlan,onChange:l,className:`w-full px-3 py-2 rounded-lg border ${n==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"free",children:"Free"}),e.jsx("option",{value:"basic",children:"Basic"}),e.jsx("option",{value:"standard",children:"Standard"}),e.jsx("option",{value:"premium",children:"Premium"}),e.jsx("option",{value:"enterprise",children:"Enterprise"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Start Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"date",name:"subscriptionStartDate",value:r.subscriptionStartDate,onChange:l,className:`w-full px-3 py-2 rounded-lg border ${n==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,required:!0})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"End Date"}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"date",name:"subscriptionEndDate",value:r.subscriptionEndDate,onChange:l,min:r.subscriptionStartDate,className:`w-full px-3 py-2 rounded-lg border ${n==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`})})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Maximum Users ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(Re,{className:"h-4 w-4 text-gray-500"})}),e.jsx("input",{type:"number",name:"maxUsers",min:"1",value:r.maxUsers,onChange:l,className:`w-full pl-10 px-3 py-2 rounded-lg border ${n==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,required:!0})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Status ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"status",value:r.status,onChange:l,className:`w-full px-3 py-2 rounded-lg border ${n==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"suspended",children:"Suspended"})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-lg font-medium flex items-center",children:[e.jsx(Ue,{className:"w-5 h-5 mr-2 text-blue-500"}),"Additional Information"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notes"}),e.jsx("textarea",{name:"notes",value:r.notes,onChange:l,rows:"4",className:`w-full px-3 py-2 rounded-lg border ${n==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-300"}`,placeholder:"Any additional notes about this client..."})]})]})]}),e.jsxs("div",{className:"mt-8 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:a,className:`px-4 py-2 rounded-lg border ${n==="dark"?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Cancel"}),e.jsxs("button",{type:"submit",className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 flex items-center",children:[e.jsx(ds,{className:"w-4 h-4 mr-2"}),t?"Update Client":"Create Client"]})]})]})]})})},Y1=({clientId:t,clientName:a,isOpen:s,onClose:n})=>{const{theme:r}=ot(),[i,l]=v.useState([]),[c,o]=v.useState([]),[d,x]=v.useState(!1),[m,h]=v.useState(!1),[f,g]=v.useState(null),[p,u]=v.useState({billingCycle:"monthly",customPrice:"",startDate:new Date().toISOString().split("T")[0],autoRenew:!1,trialDays:0});v.useEffect(()=>{s&&t&&(j(),y())},[s,t]);const j=async()=>{var b,C;try{const S=await Ai();(C=(b=S.data)==null?void 0:b.data)!=null&&C.packages&&l(S.data.data.packages)}catch(S){console.error("Error fetching packages:",S),E.error("Failed to fetch packages")}},y=async()=>{var b;try{const C=await Yo(t);(b=C.data)!=null&&b.clientPackages&&o(C.data.clientPackages)}catch(C){console.error("Error fetching client packages:",C)}},N=async()=>{var b,C;if(f)try{x(!0);const S={clientId:t,packageId:f._id,...p,customPrice:p.customPrice?parseFloat(p.customPrice):null};await Go(S),E.success("Package assigned successfully!"),h(!1),g(null),u({billingCycle:"monthly",customPrice:"",startDate:new Date().toISOString().split("T")[0],autoRenew:!1,trialDays:0}),y()}catch(S){console.error("Error assigning package:",S),E.error(((C=(b=S.response)==null?void 0:b.data)==null?void 0:C.message)||"Failed to assign package")}finally{x(!1)}},w=async(b,C)=>{if(window.confirm(`Are you sure you want to cancel the "${C}" package for ${a}?`))try{await $h(b,{reason:"Cancelled by Super Admin"}),E.success("Package cancelled successfully"),y()}catch(S){console.error("Error cancelling package:",S),E.error("Failed to cancel package")}},D=b=>{const C={active:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",trial:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400",expired:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400",cancelled:"bg-gray-100 text-gray-800 dark:bg-gray-600 dark:text-gray-300",suspended:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400"};return C[b]||C.active};return s?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:`max-w-4xl w-full max-h-[90vh] overflow-y-auto rounded-xl ${r==="dark"?"bg-gray-800":"bg-white"}`,children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-2xl font-bold ${r==="dark"?"text-white":"text-gray-900"}`,children:"Package Management"}),e.jsxs("p",{className:`text-sm ${r==="dark"?"text-gray-400":"text-gray-600"}`,children:["Managing packages for: ",e.jsx("span",{className:"font-medium",children:a})]})]}),e.jsx("button",{onClick:n,className:`p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 ${r==="dark"?"text-gray-400":"text-gray-600"}`,children:"Ã—"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:`text-lg font-semibold ${r==="dark"?"text-white":"text-gray-900"}`,children:"Current Packages"}),e.jsxs("button",{onClick:()=>h(!0),className:"flex items-center space-x-2 px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm transition-colors duration-200",children:[e.jsx(Pe,{className:"w-4 h-4"}),e.jsx("span",{children:"Assign Package"})]})]}),e.jsx("div",{className:"space-y-3",children:c.length>0?c.map(b=>{var C,S,k;return e.jsxs("div",{className:`p-4 rounded-lg border ${r==="dark"?"border-gray-700 bg-gray-700":"border-gray-200 bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:`font-medium ${r==="dark"?"text-white":"text-gray-900"}`,children:((C=b.packageId)==null?void 0:C.name)||"Unknown Package"}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${D(b.status)}`,children:b.status})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-500 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(tt,{className:"w-4 h-4"}),e.jsxs("span",{children:["$",b.customPrice||((k=(S=b.packageId)==null?void 0:S.pricing)==null?void 0:k.monthly)||0,"/",b.billingCycle]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Fe,{className:"w-4 h-4"}),e.jsxs("span",{children:["Ends: ",new Date(b.endDate).toLocaleDateString()]})]})]}),e.jsx("div",{className:"flex justify-end space-x-2",children:e.jsx("button",{onClick:()=>{var F;return w(b._id,(F=b.packageId)==null?void 0:F.name)},className:"p-1 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/20 rounded",title:"Cancel Package",children:e.jsx(ct,{className:"w-4 h-4"})})})]},b._id)}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Tt,{className:`w-12 h-12 mx-auto mb-4 opacity-50 ${r==="dark"?"text-gray-400":"text-gray-500"}`}),e.jsx("p",{className:`${r==="dark"?"text-gray-400":"text-gray-500"}`,children:"No packages assigned to this client"})]})})]}),e.jsx("div",{children:m?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:`text-lg font-semibold ${r==="dark"?"text-white":"text-gray-900"}`,children:"Assign New Package"}),e.jsx("button",{onClick:()=>{h(!1),g(null)},className:`text-sm ${r==="dark"?"text-gray-400":"text-gray-600"}`,children:"Cancel"})]}),e.jsx("div",{className:"space-y-3 mb-4 max-h-40 overflow-y-auto",children:i.map(b=>e.jsx("div",{onClick:()=>g(b),className:`p-3 rounded-lg cursor-pointer transition-colors border ${(f==null?void 0:f._id)===b._id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":r==="dark"?"border-gray-600 bg-gray-700 hover:bg-gray-600":"border-gray-200 bg-white hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`font-medium ${r==="dark"?"text-white":"text-gray-900"}`,children:b.name}),e.jsx("p",{className:"text-xs text-gray-500",children:b.type})]}),e.jsxs("span",{className:`text-sm font-medium ${r==="dark"?"text-green-400":"text-green-600"}`,children:["$",b.pricing.monthly,"/mo"]})]})},b._id))}),f&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${r==="dark"?"text-gray-300":"text-gray-700"}`,children:"Billing Cycle"}),e.jsxs("select",{value:p.billingCycle,onChange:b=>u({...p,billingCycle:b.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"quarterly",children:"Quarterly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${r==="dark"?"text-gray-300":"text-gray-700"}`,children:"Custom Price (optional)"}),e.jsx("input",{type:"number",placeholder:`Default: $${f.pricing[p.billingCycle]||f.pricing.monthly}`,value:p.customPrice,onChange:b=>u({...p,customPrice:b.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${r==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"autoRenew",checked:p.autoRenew,onChange:b=>u({...p,autoRenew:b.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"autoRenew",className:`text-sm ${r==="dark"?"text-gray-300":"text-gray-700"}`,children:"Auto Renew"})]}),e.jsx("button",{onClick:N,disabled:d,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white rounded-lg transition-colors duration-200",children:d?"Assigning...":"Assign Package"})]})]}):e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 ${r==="dark"?"text-white":"text-gray-900"}`,children:"Available Packages"}),e.jsx("div",{className:"space-y-3",children:i.map(b=>{var C;return e.jsx("div",{className:`p-3 rounded-lg border ${r==="dark"?"border-gray-600 bg-gray-700":"border-gray-200 bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`font-medium ${r==="dark"?"text-white":"text-gray-900"}`,children:b.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[b.type," â€¢ ",((C=b.includedModules)==null?void 0:C.length)||0," modules"]})]}),e.jsxs("span",{className:`text-sm font-medium ${r==="dark"?"text-green-400":"text-green-600"}`,children:["$",b.pricing.monthly,"/mo"]})]})},b._id)})})]})})]})]})})}):null},X1=()=>{var _,ne,ie;const{theme:t}=ot(),[a,s]=v.useState([]),[n,r]=v.useState(!0),[i,l]=v.useState(""),[c,o]=v.useState(""),[d,x]=v.useState(""),[m,h]=v.useState(1),[f,g]=v.useState(1),[p,u]=v.useState(!1),[j,y]=v.useState(null),[N,w]=v.useState(!1),[D,b]=v.useState(null),[C,S]=v.useState(!1),[k,F]=v.useState(null),[R,T]=v.useState(null);v.useEffect(()=>{M()},[m,i,c,d]);const M=async()=>{var A,P,O,I,J,te;try{r(!0);const le=await Vo({page:m,limit:10,search:i,status:c,subscriptionStatus:d}),ue=((P=(A=le.data)==null?void 0:A.data)==null?void 0:P.clients)||[],be=((I=(O=le.data)==null?void 0:O.data)==null?void 0:I.pagination)||{pages:1};s(ue),g(be.pages||1)}catch(se){console.error("Error fetching clients:",se),s([]),g(1),E.error("Failed to fetch clients: "+(((te=(J=se.response)==null?void 0:J.data)==null?void 0:te.message)||se.message))}finally{r(!1)}},X=async(A,P)=>{try{await Ch(A,P),E.success(`Client ${P} successfully`),M()}catch(O){console.error("Error updating client status:",O),E.error("Failed to update client status")}},q=async A=>{if(window.confirm("Are you sure you want to delete this client? This action cannot be undone."))try{await Ah(A),E.success("Client deleted successfully"),M()}catch(P){console.error("Error deleting client:",P),E.error("Failed to delete client")}},B=A=>{const P={active:{bg:"bg-green-100 dark:bg-green-900/20",text:"text-green-800 dark:text-green-400",label:"Active"},inactive:{bg:"bg-gray-100 dark:bg-gray-900/20",text:"text-gray-800 dark:text-gray-400",label:"Inactive"},suspended:{bg:"bg-red-100 dark:bg-red-900/20",text:"text-red-800 dark:text-red-400",label:"Suspended"}},O=P[A]||P.inactive;return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${O.bg} ${O.text}`,children:O.label})},K=A=>{const P={active:{bg:"bg-blue-100 dark:bg-blue-900/20",text:"text-blue-800 dark:text-blue-400",label:"Active"},trial:{bg:"bg-yellow-100 dark:bg-yellow-900/20",text:"text-yellow-800 dark:text-yellow-400",label:"Trial"},expired:{bg:"bg-red-100 dark:bg-red-900/20",text:"text-red-800 dark:text-red-400",label:"Expired"},suspended:{bg:"bg-orange-100 dark:bg-orange-900/20",text:"text-orange-800 dark:text-orange-400",label:"Suspended"}},O=(A==null?void 0:A.status)||"trial",I=P[O]||P.trial;return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${I.bg} ${I.text}`,children:I.label})},Q=({client:A})=>{var P;return e.jsxs("div",{className:`p-6 rounded-xl border ${t==="dark"?"bg-gray-800 border-gray-700 hover:border-gray-600":"bg-white border-gray-200 hover:border-gray-300"} hover:shadow-lg transition-all duration-200`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:e.jsx(Nr,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-semibold ${t==="dark"?"text-white":"text-gray-900"}`,children:A.companyName}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:A.clientCode})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>T(R===A._id?null:A._id),className:`p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:e.jsx(mo,{className:"w-4 h-4"})}),R===A._id&&e.jsx("div",{className:`absolute right-0 top-10 w-48 rounded-lg shadow-lg border z-10 ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:()=>{y(A),T(null)},className:`w-full px-4 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center space-x-2 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:[e.jsx(Rt,{className:"w-4 h-4"}),e.jsx("span",{children:"View Details"})]}),e.jsxs("button",{onClick:()=>{b(A),T(null)},className:`w-full px-4 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center space-x-2 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:[e.jsx(Is,{className:"w-4 h-4"}),e.jsx("span",{children:"Edit Client"})]}),e.jsxs("button",{onClick:()=>{F(A),S(!0),T(null)},className:`w-full px-4 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center space-x-2 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:[e.jsx(Tt,{className:"w-4 h-4"}),e.jsx("span",{children:"Manage Packages"})]}),A.status==="active"?e.jsxs("button",{onClick:()=>{X(A._id,"suspended"),T(null)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center space-x-2 text-orange-600",children:[e.jsx(Ni,{className:"w-4 h-4"}),e.jsx("span",{children:"Suspend"})]}):e.jsxs("button",{onClick:()=>{X(A._id,"active"),T(null)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center space-x-2 text-green-600",children:[e.jsx(Ra,{className:"w-4 h-4"}),e.jsx("span",{children:"Activate"})]}),e.jsxs("button",{onClick:()=>{q(A._id),T(null)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center space-x-2 text-red-600",children:[e.jsx(ct,{className:"w-4 h-4"}),e.jsx("span",{children:"Delete"})]})]})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Status"}),B(A.status)]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Subscription"}),K(A.subscription)]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ut,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:A.email})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ts,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:A.phone})]}),((P=A.address)==null?void 0:P.city)&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ea,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:[A.address.city,", ",A.address.country]})]}),e.jsx("div",{className:"pt-2 border-t border-gray-200 dark:border-gray-700",children:A.activePackages&&A.activePackages.length>0?e.jsx("div",{className:"space-y-2",children:A.activePackages.map((O,I)=>{var J;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Tt,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:`text-sm font-medium ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:((J=O.packageId)==null?void 0:J.name)||"Unknown Package"}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${O.status==="active"?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400"}`,children:O.status})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:`text-xs ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:O.endDate?new Date(O.endDate).toLocaleDateString():"No expiry"})]})]},I)})}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Tt,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"No Active Packages"})]})})]})]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:`text-3xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Client Management"}),e.jsx("p",{className:`mt-2 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Manage and monitor all client accounts"})]}),e.jsxs("button",{onClick:()=>u(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors duration-200",children:[e.jsx(Pe,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Client"})]})]}),e.jsx("div",{className:`p-4 rounded-xl border ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(rt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search clients...",value:i,onChange:A=>l(A.target.value),className:`w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"}`})]}),e.jsxs("select",{value:c,onChange:A=>o(A.target.value),className:`px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"suspended",children:"Suspended"})]}),e.jsxs("select",{value:d,onChange:A=>x(A.target.value),className:`px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"",children:"All Subscriptions"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"trial",children:"Trial"}),e.jsx("option",{value:"expired",children:"Expired"}),e.jsx("option",{value:"suspended",children:"Suspended"})]}),e.jsxs("button",{onClick:()=>{l(""),o(""),x("")},className:`flex items-center justify-center space-x-2 px-4 py-2 border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200 ${t==="dark"?"border-gray-600 text-gray-300":"border-gray-300 text-gray-700"}`,children:[e.jsx(xs,{className:"w-4 h-4"}),e.jsx("span",{children:"Clear"})]})]})}),n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a&&Array.isArray(a)&&a.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(A=>e.jsx(Q,{client:A},A._id))}):e.jsxs("div",{className:`text-center py-12 ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:[e.jsx(Re,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"No clients found"}),e.jsx("p",{children:"Try adjusting your search criteria or add a new client."})]}),f>1&&e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("button",{onClick:()=>h(Math.max(1,m-1)),disabled:m===1,className:`px-3 py-2 rounded-lg border ${m===1?"opacity-50 cursor-not-allowed":"hover:bg-gray-50 dark:hover:bg-gray-700"} ${t==="dark"?"border-gray-600 text-gray-300":"border-gray-300 text-gray-700"}`,children:"Previous"}),e.jsxs("span",{className:`px-4 py-2 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Page ",m," of ",f]}),e.jsx("button",{onClick:()=>h(Math.min(f,m+1)),disabled:m===f,className:`px-3 py-2 rounded-lg border ${m===f?"opacity-50 cursor-not-allowed":"hover:bg-gray-50 dark:hover:bg-gray-700"} ${t==="dark"?"border-gray-600 text-gray-300":"border-gray-300 text-gray-700"}`,children:"Next"})]}),p&&e.jsx(Wc,{onClose:()=>u(!1),onSuccess:()=>{u(!1),h(1),l(""),o(""),x(""),setTimeout(()=>{M()},500)}}),D&&e.jsx(Wc,{client:D,onClose:()=>b(null),onSuccess:()=>{M(),b(null)}}),C&&k&&e.jsx(Y1,{clientId:k._id,clientName:k.companyName,isOpen:C,onClose:()=>{S(!1),F(null)}}),j&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:`w-full max-w-4xl max-h-[90vh] overflow-y-auto rounded-xl shadow-xl ${t==="dark"?"bg-gray-800":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${j.status==="active"?"bg-green-100 dark:bg-green-900/20":j.status==="suspended"?"bg-red-100 dark:bg-red-900/20":"bg-yellow-100 dark:bg-yellow-900/20"}`,children:e.jsx(Ra,{className:`w-6 h-6 ${j.status==="active"?"text-green-600 dark:text-green-400":j.status==="suspended"?"text-red-600 dark:text-red-400":"text-yellow-600 dark:text-yellow-400"}`})}),e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl font-semibold ${t==="dark"?"text-white":"text-gray-900"}`,children:j.companyName}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:j.clientCode})]})]}),e.jsx("button",{onClick:()=>y(null),className:`p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:e.jsx(Ee,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-medium mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Company Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ut,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:j.email})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ts,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:j.phone})]}),j.website&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(wi,{className:"w-4 h-4 text-gray-400"}),e.jsx("a",{href:j.website,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:j.website})]}),j.address&&e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ea,{className:"w-4 h-4 text-gray-400 mt-0.5"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:typeof j.address=="string"?j.address:`${j.address.street}, ${j.address.city}, ${j.address.country}`})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-medium mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Contact Person"}),e.jsxs("div",{className:"space-y-3",children:[((_=j.contactPerson)==null?void 0:_.name)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ft,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:j.contactPerson.name})]}),((ne=j.contactPerson)==null?void 0:ne.email)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ut,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:j.contactPerson.email})]}),((ie=j.contactPerson)==null?void 0:ie.position)&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(at,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:j.contactPerson.position})]})]})]})]}),j.activePackages&&j.activePackages.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-medium mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Active Packages"}),e.jsx("div",{className:"space-y-3",children:j.activePackages.map((A,P)=>{var O;return e.jsx("div",{className:`p-4 rounded-lg border ${t==="dark"?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Tt,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:`font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:((O=A.packageId)==null?void 0:O.name)||"Unknown Package"}),e.jsxs("p",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:[A.billingCycle," billing â€¢ ",A.status]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Expires: ",A.endDate?new Date(A.endDate).toLocaleDateString():"No expiry"]})})]})},P)})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-medium mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Status Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Status:"}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${j.status==="active"?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":j.status==="suspended"?"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400"}`,children:j.status})]}),j.industry&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Industry:"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:j.industry})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-medium mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Timeline"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Created:"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:new Date(j.createdAt).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Last Updated:"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:new Date(j.updatedAt).toLocaleDateString()})]})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4 p-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:()=>{const A=j;y(null),b(A)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors duration-200",children:"Edit Client"}),e.jsx("button",{onClick:()=>y(null),className:`px-4 py-2 border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200 ${t==="dark"?"border-gray-600 text-gray-300":"border-gray-300 text-gray-700"}`,children:"Close"})]})]})})]})},K1=({isOpen:t,onClose:a})=>{const{theme:s}=ot(),[n,r]=v.useState([]),[i,l]=v.useState([]),[c,o]=v.useState(null),[d,x]=v.useState(null),[m,h]=v.useState([]),[f,g]=v.useState(!1),[p,u]=v.useState(""),[j,y]=v.useState({billingCycle:"monthly",customPrice:"",startDate:new Date().toISOString().split("T")[0],endDate:"",autoRenew:!1,trialDays:0});v.useEffect(()=>{t&&(N(),w())},[t]),v.useEffect(()=>{c&&D()},[c]);const N=async()=>{var S,k,F,R;try{console.log("ðŸ” Fetching clients with search:",p);const T=await Vo({search:p});console.log("ðŸ“Š Clients API response:",T),console.log("ðŸ“Š Clients data:",T.data),console.log("ðŸ” Clients response keys:",Object.keys(T.data||{}));let M=[];(k=(S=T.data)==null?void 0:S.data)!=null&&k.clients?(M=T.data.data.clients,console.log("âœ… Found clients in data.data.clients:",M.length)):(F=T.data)!=null&&F.clients?(M=T.data.clients,console.log("âœ… Found clients in data.clients:",M.length)):Array.isArray(T.data)?(M=T.data,console.log("âœ… Found clients as direct array:",M.length)):(console.log("âŒ No clients found in any expected location"),console.log("ðŸ“‹ Clients response keys:",Object.keys(T.data||{}))),r(M||[])}catch(T){console.error("âŒ Error fetching clients:",T),console.error("ðŸ“‹ Client error details:",(R=T.response)==null?void 0:R.data),E.error("Failed to fetch clients"),r([])}},w=async()=>{var S,k,F,R;try{console.log("ðŸ” Fetching packages for assignment...");const T=await Ai();console.log("ðŸ“Š Packages API response:",T),console.log("ðŸ” Packages response keys:",Object.keys(T.data||{}));let M=[];(k=(S=T.data)==null?void 0:S.data)!=null&&k.packages?(M=T.data.data.packages,console.log("âœ… Found packages in data.data.packages:",M.length)):(F=T.data)!=null&&F.packages?(M=T.data.packages,console.log("âœ… Found packages in data.packages:",M.length)):Array.isArray(T.data)?(M=T.data,console.log("âœ… Found packages as direct array:",M.length)):(console.log("âŒ No packages found for assignment"),console.log("ðŸ“‹ Packages response keys:",Object.keys(T.data||{}))),l(M||[])}catch(T){console.error("âŒ Error fetching packages for assignment:",T),console.error("ðŸ“‹ Package error details:",(R=T.response)==null?void 0:R.data),E.error("Failed to fetch packages"),l([])}},D=async()=>{try{const S=await Yo(c._id);h(S.data.clientPackages||[])}catch(S){console.error("Error fetching client packages:",S)}},b=async()=>{var S,k;if(!c||!d){E.error("Please select both client and package");return}try{g(!0);const F={clientId:c._id,packageId:d._id,...j,customPrice:j.customPrice?parseFloat(j.customPrice):null};await Go(F),E.success("Package assigned successfully!"),x(null),y({billingCycle:"monthly",customPrice:"",startDate:new Date().toISOString().split("T")[0],endDate:"",autoRenew:!1,trialDays:0}),D()}catch(F){console.error("Error assigning package:",F),E.error(((k=(S=F.response)==null?void 0:S.data)==null?void 0:k.message)||"Failed to assign package")}finally{g(!1)}},C=n.filter(S=>{var k,F;return((k=S.companyName)==null?void 0:k.toLowerCase().includes(p.toLowerCase()))||((F=S.name)==null?void 0:F.toLowerCase().includes(p.toLowerCase()))});return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:`max-w-6xl w-full max-h-[90vh] overflow-y-auto rounded-xl ${s==="dark"?"bg-gray-800":"bg-white"}`,children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:`text-2xl font-bold ${s==="dark"?"text-white":"text-gray-900"}`,children:"Package Assignment"}),e.jsx("button",{onClick:a,className:`p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 ${s==="dark"?"text-gray-400":"text-gray-600"}`,children:"Ã—"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:`p-4 rounded-lg border ${s==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 ${s==="dark"?"text-white":"text-gray-900"}`,children:"Select Client"}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(rt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search clients...",value:p,onChange:S=>u(S.target.value),className:`w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${s==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"}`})]}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:C.map(S=>e.jsx("div",{onClick:()=>o(S),className:`p-3 rounded-lg cursor-pointer transition-colors ${(c==null?void 0:c._id)===S._id?"bg-blue-100 dark:bg-blue-900/20 border-blue-500":s==="dark"?"bg-gray-700 hover:bg-gray-600 border-gray-600":"bg-gray-50 hover:bg-gray-100 border-gray-200"} border`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ft,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-medium ${s==="dark"?"text-white":"text-gray-900"}`,children:S.companyName}),e.jsx("p",{className:"text-xs text-gray-500",children:S.email})]})]})},S._id))})]}),e.jsxs("div",{className:`p-4 rounded-lg border ${s==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 ${s==="dark"?"text-white":"text-gray-900"}`,children:"Select Package"}),e.jsx("div",{className:"space-y-3 mb-4 max-h-40 overflow-y-auto",children:i.map(S=>e.jsx("div",{onClick:()=>x(S),className:`p-3 rounded-lg cursor-pointer transition-colors ${(d==null?void 0:d._id)===S._id?"bg-green-100 dark:bg-green-900/20 border-green-500":s==="dark"?"bg-gray-700 hover:bg-gray-600 border-gray-600":"bg-gray-50 hover:bg-gray-100 border-gray-200"} border`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Tt,{className:"w-4 h-4 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-medium ${s==="dark"?"text-white":"text-gray-900"}`,children:S.name}),e.jsx("p",{className:"text-xs text-gray-500",children:S.type})]})]}),e.jsxs("span",{className:`text-sm font-medium ${s==="dark"?"text-green-400":"text-green-600"}`,children:["$",S.pricing.monthly,"/mo"]})]})},S._id))}),d&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${s==="dark"?"text-gray-300":"text-gray-700"}`,children:"Billing Cycle"}),e.jsxs("select",{value:j.billingCycle,onChange:S=>y({...j,billingCycle:S.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${s==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"quarterly",children:"Quarterly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${s==="dark"?"text-gray-300":"text-gray-700"}`,children:"Custom Price (optional)"}),e.jsx("input",{type:"number",placeholder:`Default: $${d.pricing[j.billingCycle]||d.pricing.monthly}`,value:j.customPrice,onChange:S=>y({...j,customPrice:S.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${s==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${s==="dark"?"text-gray-300":"text-gray-700"}`,children:"Start Date"}),e.jsx("input",{type:"date",value:j.startDate,onChange:S=>y({...j,startDate:S.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${s==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${s==="dark"?"text-gray-300":"text-gray-700"}`,children:"End Date (Optional)"}),e.jsx("input",{type:"date",value:j.endDate,onChange:S=>y({...j,endDate:S.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${s==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:"Auto-calculated if not provided"}),e.jsx("p",{className:`text-xs mt-1 ${s==="dark"?"text-gray-400":"text-gray-500"}`,children:"If not provided, will be calculated based on billing cycle"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"autoRenew",checked:j.autoRenew,onChange:S=>y({...j,autoRenew:S.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"autoRenew",className:`text-sm ${s==="dark"?"text-gray-300":"text-gray-700"}`,children:"Auto Renew"})]}),e.jsx("button",{onClick:b,disabled:f||!c,className:"w-full px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white rounded-lg transition-colors duration-200",children:f?"Assigning...":"Assign Package"})]})]}),e.jsxs("div",{className:`p-4 rounded-lg border ${s==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 ${s==="dark"?"text-white":"text-gray-900"}`,children:c?`${c.companyName} Packages`:"Client Packages"}),c?e.jsx("div",{className:"space-y-3",children:m.length>0?m.map(S=>{var k;return e.jsxs("div",{className:`p-3 rounded-lg border ${s==="dark"?"border-gray-600 bg-gray-700":"border-gray-200 bg-gray-50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`font-medium ${s==="dark"?"text-white":"text-gray-900"}`,children:(k=S.packageId)==null?void 0:k.name}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${S.status==="active"?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-600 dark:text-gray-300"}`,children:S.status})]}),e.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[e.jsxs("p",{children:["Billing: ",S.billingCycle]}),e.jsxs("p",{children:["End Date: ",new Date(S.endDate).toLocaleDateString()]})]})]},S._id)}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No packages assigned"})}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Select a client to view their packages"})]})]})]})})}):null},Vc=({package:t,onClose:a,onSuccess:s})=>{const{theme:n}=ot(),[r,i]=v.useState(!1),[l,c]=v.useState({name:"",description:"",type:"starter",pricing:{monthly:"",quarterly:"",yearly:"",currency:"USD"},features:{maxEmployees:"",maxAdmins:"2",storageLimit:"10",customBranding:!1,apiAccess:!1,advancedReporting:!1,multiLocation:!1,integrations:!1},includedModules:[],isActive:!0,isPopular:!1,trialDays:"14"}),o=["hr","payroll","timesheet","attendance","recruitment","performance","assets","compliance"],d=[{value:"starter",label:"Starter",color:"text-green-600"},{value:"professional",label:"Professional",color:"text-blue-600"},{value:"enterprise",label:"Enterprise",color:"text-purple-600"},{value:"custom",label:"Custom",color:"text-orange-600"}];v.useEffect(()=>{var h,f,g,p,u,j,y,N,w,D,b,C,S,k,F,R,T,M,X;t&&c({name:t.name||"",description:t.description||"",type:t.type||"starter",pricing:{monthly:((f=(h=t.pricing)==null?void 0:h.monthly)==null?void 0:f.toString())||"",quarterly:((p=(g=t.pricing)==null?void 0:g.quarterly)==null?void 0:p.toString())||"",yearly:((j=(u=t.pricing)==null?void 0:u.yearly)==null?void 0:j.toString())||"",currency:((y=t.pricing)==null?void 0:y.currency)||"USD"},features:{maxEmployees:((w=(N=t.features)==null?void 0:N.maxEmployees)==null?void 0:w.toString())||"",maxAdmins:((b=(D=t.features)==null?void 0:D.maxAdmins)==null?void 0:b.toString())||"2",storageLimit:((S=(C=t.features)==null?void 0:C.storageLimit)==null?void 0:S.toString())||"10",customBranding:((k=t.features)==null?void 0:k.customBranding)||!1,apiAccess:((F=t.features)==null?void 0:F.apiAccess)||!1,advancedReporting:((R=t.features)==null?void 0:R.advancedReporting)||!1,multiLocation:((T=t.features)==null?void 0:T.multiLocation)||!1,integrations:((M=t.features)==null?void 0:M.integrations)||!1},includedModules:t.includedModules||[],isActive:t.isActive!==void 0?t.isActive:!0,isPopular:t.isPopular||!1,trialDays:((X=t.trialDays)==null?void 0:X.toString())||"14"})},[t]);const x=async h=>{var f,g;h.preventDefault(),i(!0);try{const p={...l,pricing:{...l.pricing,monthly:parseFloat(l.pricing.monthly)||0,quarterly:parseFloat(l.pricing.quarterly)||0,yearly:parseFloat(l.pricing.yearly)||0},features:{...l.features,maxEmployees:parseInt(l.features.maxEmployees)||0,maxAdmins:parseInt(l.features.maxAdmins)||2,storageLimit:parseInt(l.features.storageLimit)||10},trialDays:parseInt(l.trialDays)||14};t?(await Fh(t._id,p),E.success("Package updated successfully!")):(await Eh(p),E.success("Package created successfully!")),s(),a()}catch(p){console.error("Error saving package:",p),E.error(((g=(f=p.response)==null?void 0:f.data)==null?void 0:g.message)||"Failed to save package")}finally{i(!1)}},m=h=>{c(f=>({...f,includedModules:f.includedModules.includes(h)?f.includedModules.filter(g=>g!==h):[...f.includedModules,h]}))};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:`w-full max-w-4xl max-h-[90vh] overflow-y-auto rounded-xl shadow-xl ${n==="dark"?"bg-gray-800":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Tt,{className:"w-6 h-6 text-blue-600"}),e.jsx("h2",{className:`text-xl font-semibold ${n==="dark"?"text-white":"text-gray-900"}`,children:t?"Edit Package":"Create New Package"})]}),e.jsx("button",{onClick:a,className:`p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 ${n==="dark"?"text-gray-400":"text-gray-600"}`,children:e.jsx(Ee,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:x,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:"Package Name *"}),e.jsx("input",{type:"text",value:l.name,onChange:h=>c(f=>({...f,name:h.target.value})),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${n==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:"Package Type *"}),e.jsx("select",{value:l.type,onChange:h=>c(f=>({...f,type:h.target.value})),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${n==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0,children:d.map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:"Description *"}),e.jsx("textarea",{value:l.description,onChange:h=>c(f=>({...f,description:h.target.value})),rows:3,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${n==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:`text-lg font-medium mb-4 flex items-center space-x-2 ${n==="dark"?"text-white":"text-gray-900"}`,children:[e.jsx(tt,{className:"w-5 h-5"}),e.jsx("span",{children:"Pricing"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:"Monthly Price ($)"}),e.jsx("input",{type:"number",step:"0.01",value:l.pricing.monthly,onChange:h=>c(f=>({...f,pricing:{...f.pricing,monthly:h.target.value}})),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${n==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:"Quarterly Price ($)"}),e.jsx("input",{type:"number",step:"0.01",value:l.pricing.quarterly,onChange:h=>c(f=>({...f,pricing:{...f.pricing,quarterly:h.target.value}})),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${n==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:"Yearly Price ($)"}),e.jsx("input",{type:"number",step:"0.01",value:l.pricing.yearly,onChange:h=>c(f=>({...f,pricing:{...f.pricing,yearly:h.target.value}})),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${n==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:`text-lg font-medium mb-4 flex items-center space-x-2 ${n==="dark"?"text-white":"text-gray-900"}`,children:[e.jsx(Rs,{className:"w-5 h-5"}),e.jsx("span",{children:"Features & Limits"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:"Max Employees"}),e.jsx("input",{type:"number",value:l.features.maxEmployees,onChange:h=>c(f=>({...f,features:{...f.features,maxEmployees:h.target.value}})),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${n==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:"Max Admins"}),e.jsx("input",{type:"number",value:l.features.maxAdmins,onChange:h=>c(f=>({...f,features:{...f.features,maxAdmins:h.target.value}})),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${n==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:"Storage Limit (GB)"}),e.jsx("input",{type:"number",value:l.features.storageLimit,onChange:h=>c(f=>({...f,features:{...f.features,storageLimit:h.target.value}})),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${n==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mt-4",children:[{key:"customBranding",label:"Custom Branding"},{key:"apiAccess",label:"API Access"},{key:"advancedReporting",label:"Advanced Reporting"},{key:"multiLocation",label:"Multi Location"},{key:"integrations",label:"Integrations"}].map(h=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:h.key,checked:l.features[h.key],onChange:f=>c(g=>({...g,features:{...g.features,[h.key]:f.target.checked}})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:h.key,className:`text-sm ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:h.label})]},h.key))})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:`text-lg font-medium mb-4 flex items-center space-x-2 ${n==="dark"?"text-white":"text-gray-900"}`,children:[e.jsx(Re,{className:"w-5 h-5"}),e.jsx("span",{children:"Included Modules"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:o.map(h=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:h,checked:l.includedModules.includes(h),onChange:()=>m(h),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:h,className:`text-sm capitalize ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:h})]},h))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:"Trial Days"}),e.jsx("input",{type:"number",value:l.trialDays,onChange:h=>c(f=>({...f,trialDays:h.target.value})),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${n==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"isActive",checked:l.isActive,onChange:h=>c(f=>({...f,isActive:h.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"isActive",className:`text-sm ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:"Active Package"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"isPopular",checked:l.isPopular,onChange:h=>c(f=>({...f,isPopular:h.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"isPopular",className:`text-sm ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:"Popular Package"})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{type:"button",onClick:a,className:`px-4 py-2 border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 ${n==="dark"?"border-gray-600 text-gray-300":"border-gray-300 text-gray-700"}`,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:r,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:r?"Saving...":t?"Update Package":"Create Package"})]})]})]})})},J1=()=>{const{theme:t}=ot(),[a,s]=v.useState([]),[n,r]=v.useState(!0),[i,l]=v.useState(""),[c,o]=v.useState(""),[d,x]=v.useState(!1),[m,h]=v.useState(null),[f,g]=v.useState(!1),[p,u]=v.useState(null);v.useEffect(()=>{j()},[i,c]);const j=async()=>{var b,C,S,k,F,R,T,M,X;try{r(!0);const q={search:i,type:c};console.log("ðŸ” Fetching packages with params:",q);const B=await Ai(q);console.log("ðŸ“¦ API Response:",B),console.log("ðŸ“Š Response data:",B.data),console.log("ðŸ” Response data type:",typeof B.data),console.log("ðŸ” Response data keys:",Object.keys(B.data||{})),console.log("ðŸ” Looking for packages in:",(C=(b=B.data)==null?void 0:b.data)==null?void 0:C.packages);let K=[];(k=(S=B.data)==null?void 0:S.data)!=null&&k.packages?(K=B.data.data.packages,console.log("âœ… Found packages in data.data.packages:",K.length)):(F=B.data)!=null&&F.packages?(K=B.data.packages,console.log("âœ… Found packages in data.packages:",K.length)):Array.isArray(B.data)?(K=B.data,console.log("âœ… Found packages as direct array:",K.length)):(console.log("âŒ No packages found in any expected location"),console.log("ðŸ“‹ Response data keys:",Object.keys(B.data||{})),console.log("ðŸ“‹ Full response structure (first 500 chars):",JSON.stringify(B.data,null,2).substring(0,500))),s(K||[])}catch(q){console.error("âŒ Error fetching packages:",q),console.error("ðŸ“‹ Error response:",q.response),console.error("ðŸ“‹ Error status:",(R=q.response)==null?void 0:R.status),console.error("ðŸ“‹ Error data:",(T=q.response)==null?void 0:T.data),E.error(((X=(M=q.response)==null?void 0:M.data)==null?void 0:X.message)||"Failed to fetch packages"),s([])}finally{r(!1)}},y=async b=>{try{await Th(b),E.success("Package status updated successfully"),j()}catch(C){console.error("Error toggling package status:",C),E.error("Failed to update package status")}},N=async b=>{var C,S;if(window.confirm("Are you sure you want to delete this package? This action cannot be undone."))try{await Dh(b),E.success("Package deleted successfully"),j()}catch(k){console.error("Error deleting package:",k),E.error(((S=(C=k.response)==null?void 0:C.data)==null?void 0:S.message)||"Failed to delete package")}},w=b=>{const C={starter:"bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-400",professional:"bg-blue-100 dark:bg-blue-900/20 text-blue-800 dark:text-blue-400",enterprise:"bg-purple-100 dark:bg-purple-900/20 text-purple-800 dark:text-purple-400",custom:"bg-orange-100 dark:bg-orange-900/20 text-orange-800 dark:text-orange-400"};return C[b]||C.starter},D=({pkg:b})=>{var C,S;return e.jsxs("div",{className:`p-6 rounded-xl border ${t==="dark"?"bg-gray-800 border-gray-700 hover:border-gray-600":"bg-white border-gray-200 hover:border-gray-300"} hover:shadow-lg transition-all duration-200 relative`,children:[b.isPopular&&e.jsx("div",{className:"absolute -top-2 -right-2",children:e.jsxs("div",{className:"bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-3 py-1 rounded-full text-xs font-medium flex items-center space-x-1",children:[e.jsx(bi,{className:"w-3 h-3"}),e.jsx("span",{children:"Popular"})]})}),e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${b.type==="starter"?"bg-green-100 dark:bg-green-900/20":b.type==="professional"?"bg-blue-100 dark:bg-blue-900/20":b.type==="enterprise"?"bg-purple-100 dark:bg-purple-900/20":"bg-orange-100 dark:bg-orange-900/20"}`,children:e.jsx(Tt,{className:`w-6 h-6 ${b.type==="starter"?"text-green-600 dark:text-green-400":b.type==="professional"?"text-blue-600 dark:text-blue-400":b.type==="enterprise"?"text-purple-600 dark:text-purple-400":"text-orange-600 dark:text-orange-400"}`})}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-semibold ${t==="dark"?"text-white":"text-gray-900"}`,children:b.name}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${w(b.type)}`,children:b.type.charAt(0).toUpperCase()+b.type.slice(1)})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx("button",{onClick:()=>y(b._id),className:`p-2 rounded-lg transition-colors duration-200 ${b.isActive?"text-green-600 hover:bg-green-100 dark:hover:bg-green-900/20":"text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"}`,title:b.isActive?"Deactivate Package":"Activate Package",children:b.isActive?e.jsx(b0,{className:"w-5 h-5"}):e.jsx(j0,{className:"w-5 h-5"})})})]}),e.jsx("p",{className:`text-sm mb-4 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:b.description}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-baseline space-x-2",children:[e.jsxs("span",{className:`text-2xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:["$",b.pricing.monthly]}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"/month"})]}),b.pricing.yearly&&e.jsxs("p",{className:"text-xs text-gray-500",children:["$",b.pricing.yearly,"/year (Save ",Math.round((1-b.pricing.yearly/12/b.pricing.monthly)*100),"%)"]})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Max Employees"}),e.jsx("span",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:b.features.maxEmployees===-1?"Unlimited":b.features.maxEmployees})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Storage"}),e.jsxs("span",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:[b.features.storageLimit,"GB"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"API Access"}),b.features.apiAccess?e.jsx(we,{className:"w-4 h-4 text-green-500"}):e.jsx(ze,{className:"w-4 h-4 text-red-500"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Custom Branding"}),b.features.customBranding?e.jsx(we,{className:"w-4 h-4 text-green-500"}):e.jsx(ze,{className:"w-4 h-4 text-red-500"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:`text-sm font-medium mb-2 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Included Modules (",((C=b.includedModules)==null?void 0:C.length)||0,")"]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[((S=b.includedModules)==null?void 0:S.slice(0,3).map(k=>e.jsx("span",{className:`px-2 py-1 rounded text-xs ${t==="dark"?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-700"}`,children:k.toUpperCase()},k)))||[],b.includedModules&&b.includedModules.length>3&&e.jsxs("span",{className:`px-2 py-1 rounded text-xs ${t==="dark"?"bg-gray-700 text-gray-400":"bg-gray-100 text-gray-500"}`,children:["+",b.includedModules.length-3," more"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Re,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:[b.usageCount||0," clients"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>h(b),className:`p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 ${t==="dark"?"text-gray-400":"text-gray-600"}`,title:"View Details",children:e.jsx(Rt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>u(b),className:`p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 ${t==="dark"?"text-gray-400":"text-gray-600"}`,title:"Edit Package",children:e.jsx(Is,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>N(b._id),className:"p-2 rounded-lg hover:bg-red-100 dark:hover:bg-red-900/20 text-red-600",title:"Delete Package",children:e.jsx(ct,{className:"w-4 h-4"})})]})]})]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:`text-3xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Package Management"}),e.jsx("p",{className:`mt-2 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Create and manage subscription packages for clients"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:()=>g(!0),className:"flex items-center space-x-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors duration-200",children:[e.jsx(Re,{className:"w-4 h-4"}),e.jsx("span",{children:"Assign to Client"})]}),e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors duration-200",children:[e.jsx(Pe,{className:"w-4 h-4"}),e.jsx("span",{children:"Create Package"})]})]})]}),e.jsx("div",{className:`p-4 rounded-xl border ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(rt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search packages...",value:i,onChange:b=>l(b.target.value),className:`w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"}`})]}),e.jsxs("select",{value:c,onChange:b=>o(b.target.value),className:`px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"starter",children:"Starter"}),e.jsx("option",{value:"professional",children:"Professional"}),e.jsx("option",{value:"enterprise",children:"Enterprise"}),e.jsx("option",{value:"custom",children:"Custom"})]}),e.jsx("button",{onClick:()=>{l(""),o("")},className:`flex items-center justify-center space-x-2 px-4 py-2 border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200 ${t==="dark"?"border-gray-600 text-gray-300":"border-gray-300 text-gray-700"}`,children:e.jsx("span",{children:"Clear Filters"})})]})}),n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a&&a.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(b=>e.jsx(D,{pkg:b},b._id))}):e.jsxs("div",{className:`text-center py-12 ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:[e.jsx(Tt,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"No packages found"}),e.jsx("p",{children:"Try adjusting your search criteria or create a new package."})]}),d&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:`max-w-4xl w-full max-h-[90vh] overflow-y-auto rounded-xl ${t==="dark"?"bg-gray-800":"bg-white"}`,children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:`text-xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Create Package"}),e.jsx("button",{onClick:()=>x(!1),className:`p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Ã—"})]}),e.jsxs("form",{onSubmit:handleCreatePackage,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Package Name *"}),e.jsx("input",{type:"text",required:!0,value:createForm.name,onChange:b=>setCreateForm({...createForm,name:b.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:"e.g., Starter Plan"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Package Type *"}),e.jsxs("select",{value:createForm.type,onChange:b=>setCreateForm({...createForm,type:b.target.value}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"starter",children:"Starter"}),e.jsx("option",{value:"professional",children:"Professional"}),e.jsx("option",{value:"enterprise",children:"Enterprise"}),e.jsx("option",{value:"custom",children:"Custom"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Description *"}),e.jsx("textarea",{required:!0,value:createForm.description,onChange:b=>setCreateForm({...createForm,description:b.target.value}),rows:3,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:"Describe the package features and benefits"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Pricing"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Monthly ($) *"}),e.jsx("input",{type:"number",required:!0,value:createForm.pricing.monthly,onChange:b=>setCreateForm({...createForm,pricing:{...createForm.pricing,monthly:b.target.value}}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:"29"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Quarterly ($)"}),e.jsx("input",{type:"number",value:createForm.pricing.quarterly,onChange:b=>setCreateForm({...createForm,pricing:{...createForm.pricing,quarterly:b.target.value}}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:"78"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Yearly ($)"}),e.jsx("input",{type:"number",value:createForm.pricing.yearly,onChange:b=>setCreateForm({...createForm,pricing:{...createForm.pricing,yearly:b.target.value}}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:"290"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Features"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Max Employees *"}),e.jsx("input",{type:"number",required:!0,value:createForm.features.maxEmployees,onChange:b=>setCreateForm({...createForm,features:{...createForm.features,maxEmployees:b.target.value}}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:"25"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Storage (GB)"}),e.jsx("input",{type:"number",value:createForm.features.storageLimit,onChange:b=>setCreateForm({...createForm,features:{...createForm.features,storageLimit:b.target.value}}),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:"10"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Included Modules"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:modules.map(b=>e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:createForm.includedModules.includes(b),onChange:C=>{C.target.checked?setCreateForm({...createForm,includedModules:[...createForm.includedModules,b]}):setCreateForm({...createForm,includedModules:createForm.includedModules.filter(S=>S!==b)})},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:b.charAt(0).toUpperCase()+b.slice(1)})]},b))})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>x(!1),className:`px-4 py-2 border rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200 ${t==="dark"?"border-gray-600 text-gray-300":"border-gray-300 text-gray-700"}`,children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors duration-200",children:"Create Package"})]})]})]})})}),m&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:`max-w-2xl w-full max-h-[90vh] overflow-y-auto rounded-xl ${t==="dark"?"bg-gray-800":"bg-white"}`,children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:`text-2xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:m.name}),e.jsx("button",{onClick:()=>h(null),className:`p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Ã—"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:`${t==="dark"?"text-gray-300":"text-gray-700"}`,children:m.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:`font-medium mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Pricing"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{children:["Monthly: $",m.pricing.monthly]}),m.pricing.quarterly&&e.jsxs("p",{children:["Quarterly: $",m.pricing.quarterly]}),m.pricing.yearly&&e.jsxs("p",{children:["Yearly: $",m.pricing.yearly]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:`font-medium mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Features"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("p",{children:["Max Employees: ",m.features.maxEmployees===-1?"Unlimited":m.features.maxEmployees]}),e.jsxs("p",{children:["Storage: ",m.features.storageLimit,"GB"]}),e.jsxs("p",{children:["API Access: ",m.features.apiAccess?"Yes":"No"]}),e.jsxs("p",{children:["Custom Branding: ",m.features.customBranding?"Yes":"No"]})]})]})]})]})]})})}),f&&e.jsx(K1,{isOpen:f,onClose:()=>g(!1)}),d&&e.jsx(Vc,{onClose:()=>x(!1),onSuccess:()=>{j(),x(!1)}}),p&&e.jsx(Vc,{package:p,onClose:()=>u(null),onSuccess:()=>{j(),u(null)}})]})},Q1=()=>{var R;const{theme:t}=ot(),[a,s]=v.useState([]),[n,r]=v.useState({}),[i,l]=v.useState({}),[c,o]=v.useState(null),[d,x]=v.useState(!0),[m,h]=v.useState(!1),[f,g]=v.useState(!1),[p,u]=v.useState(null),[j,y]=v.useState({search:"",role:"",page:1});v.useEffect(()=>{N()},[j]);const N=async()=>{var T,M,X,q;try{x(!0);const[B,K,Q]=await Promise.all([Rh(j),_h(),Ph()]),_=((T=B.data)==null?void 0:T.data)||B.data,ne=((M=K.data)==null?void 0:M.data)||K.data,ie=((X=Q.data)==null?void 0:X.data)||Q.data;s((_==null?void 0:_.users)||[]),r((ne==null?void 0:ne.roles)||{}),l((ne==null?void 0:ne.permissions)||{}),o(ie||null),console.log("âœ… Role management data loaded successfully"),console.log("ðŸ“Š Users:",((q=_==null?void 0:_.users)==null?void 0:q.length)||0),console.log("ðŸŽ­ Roles:",Object.keys((ne==null?void 0:ne.roles)||{}).length)}catch(B){console.error("âŒ Error fetching role management data:",B),E.error("Failed to fetch role management data"),s([]),r({}),l({}),o(null)}finally{x(!1)}},w=async T=>{var M,X;try{await Ih(T),E.success("Super Admin user created successfully"),h(!1),N()}catch(q){E.error(((X=(M=q.response)==null?void 0:M.data)==null?void 0:X.message)||"Failed to create user")}},D=async(T,M)=>{var X,q;try{await Oh(T,{internalRole:M}),E.success("User role updated successfully"),g(!1),N()}catch(B){E.error(((q=(X=B.response)==null?void 0:X.data)==null?void 0:q.message)||"Failed to update user role")}},b=async T=>{var M,X;if(window.confirm("Are you sure you want to deactivate this user?"))try{await Mh(T),E.success("User deactivated successfully"),N()}catch(q){E.error(((X=(M=q.response)==null?void 0:M.data)==null?void 0:X.message)||"Failed to deactivate user")}},C=T=>({super_admin:N0,system_manager:Rs,finance_admin:tt,compliance_officer:Ue,tech_admin:mn,viewer:Rt})[T]||Re,S=T=>({super_admin:"text-purple-600 bg-purple-100 dark:bg-purple-900/20",system_manager:"text-blue-600 bg-blue-100 dark:bg-blue-900/20",finance_admin:"text-green-600 bg-green-100 dark:bg-green-900/20",compliance_officer:"text-orange-600 bg-orange-100 dark:bg-orange-900/20",tech_admin:"text-red-600 bg-red-100 dark:bg-red-900/20",viewer:"text-gray-600 bg-gray-100 dark:bg-gray-900/20"})[T]||"text-gray-600 bg-gray-100 dark:bg-gray-900/20",k=()=>{const[T,M]=v.useState({email:"",password:"",internalRole:"viewer"}),X=q=>{q.preventDefault(),w(T)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:`p-6 rounded-xl max-w-md w-full mx-4 ${t==="dark"?"bg-gray-800":"bg-white"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Create Super Admin User"}),e.jsxs("form",{onSubmit:X,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Email"}),e.jsx("input",{type:"email",value:T.email,onChange:q=>M({...T,email:q.target.value}),className:`w-full p-2 border rounded-lg ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Password"}),e.jsx("input",{type:"password",value:T.password,onChange:q=>M({...T,password:q.target.value}),className:`w-full p-2 border rounded-lg ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0,minLength:6})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Role"}),e.jsx("select",{value:T.internalRole,onChange:q=>M({...T,internalRole:q.target.value}),className:`w-full p-2 border rounded-lg ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:n&&Object.entries(n).map(([q,B])=>e.jsx("option",{value:q,children:B.name},q))})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"Create User"}),e.jsx("button",{type:"button",onClick:()=>h(!1),className:`flex-1 py-2 px-4 rounded-lg border transition-colors ${t==="dark"?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Cancel"})]})]})]})})},F=()=>{const[T,M]=v.useState((p==null?void 0:p.internalRole)||""),X=q=>{q.preventDefault(),D(p._id,T)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:`p-6 rounded-xl max-w-md w-full mx-4 ${t==="dark"?"bg-gray-800":"bg-white"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Update User Role"}),e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:["User: ",e.jsx("span",{className:"font-medium",children:p==null?void 0:p.email})]})}),e.jsxs("form",{onSubmit:X,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-1 ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"New Role"}),e.jsx("select",{value:T,onChange:q=>M(q.target.value),className:`w-full p-2 border rounded-lg ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:n&&Object.entries(n).map(([q,B])=>e.jsx("option",{value:q,children:B.name},q))})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"Update Role"}),e.jsx("button",{type:"button",onClick:()=>g(!1),className:`flex-1 py-2 px-4 rounded-lg border transition-colors ${t==="dark"?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Cancel"})]})]})]})})};return d||!n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:`text-3xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"User Management"}),e.jsx("p",{className:`mt-2 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Manage all system users, roles, and permissions"})]}),e.jsxs("button",{onClick:()=>h(!0),className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(ls,{className:"w-4 h-4"}),e.jsx("span",{children:"Add User"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:(R=c==null?void 0:c.roleStats)==null?void 0:R.map(T=>{var X;const M=C(T._id);return e.jsx("div",{className:`p-6 rounded-xl border ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:((X=n[T._id])==null?void 0:X.name)||T._id}),e.jsx("p",{className:`text-2xl font-bold mt-1 ${t==="dark"?"text-white":"text-gray-900"}`,children:T.count}),e.jsxs("p",{className:"text-xs mt-1 text-gray-500",children:[T.active," active"]})]}),e.jsx("div",{className:`p-3 rounded-lg ${S(T._id)}`,children:e.jsx(M,{className:"w-6 h-6"})})]})},T._id)})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Search users...",value:j.search,onChange:T=>y({...j,search:T.target.value,page:1}),className:`w-full p-3 border rounded-lg ${t==="dark"?"bg-gray-800 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"}`})}),e.jsxs("select",{value:j.role,onChange:T=>y({...j,role:T.target.value,page:1}),className:`p-3 border rounded-lg ${t==="dark"?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"",children:"All Users"}),e.jsxs("optgroup",{label:"System Roles",children:[e.jsx("option",{value:"superadmin",children:"Super Admin"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"hr",children:"HR"}),e.jsx("option",{value:"employee",children:"Employee"})]}),e.jsx("optgroup",{label:"Super Admin Internal Roles",children:n&&Object.entries(n).map(([T,M])=>e.jsx("option",{value:T,children:M.name},T))})]})]}),e.jsx("div",{className:`rounded-xl border ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:`border-b ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsx("th",{className:`text-left p-4 font-medium ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"User"}),e.jsx("th",{className:`text-left p-4 font-medium ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Role"}),e.jsx("th",{className:`text-left p-4 font-medium ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Status"}),e.jsx("th",{className:`text-left p-4 font-medium ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Last Login"}),e.jsx("th",{className:`text-left p-4 font-medium ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Actions"})]})}),e.jsx("tbody",{children:a.map(T=>{var q;const M=T.internalRole||T.role,X=C(M);return e.jsxs("tr",{className:`border-b ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${S(M)}`,children:e.jsx(X,{className:"w-4 h-4"})}),e.jsx("div",{children:e.jsx("p",{className:`font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:T.email})})]})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${S(M)}`,children:T.displayRole||((q=T.roleDefinition)==null?void 0:q.name)||T.role}),T.clientId&&e.jsx("span",{className:"text-xs text-gray-500 mt-1",children:T.clientId.companyName})]})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-1",children:[T.isActive?e.jsx(we,{className:"w-4 h-4 text-green-500"}):e.jsx(ze,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:`text-sm ${T.isActive?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:T.isActive?"Active":"Inactive"})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:T.lastLogin?new Date(T.lastLogin).toLocaleDateString():"Never"})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>{u(T),g(!0)},className:`p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 ${t==="dark"?"text-gray-400":"text-gray-600"}`,title:"Edit Role",children:e.jsx(v0,{className:"w-4 h-4"})}),T.isActive&&e.jsx("button",{onClick:()=>b(T._id),className:`p-1 rounded hover:bg-gray-100 dark:hover:bg-gray-700 ${t==="dark"?"text-gray-400":"text-gray-600"}`,title:"Deactivate User",children:e.jsx(Ni,{className:"w-4 h-4"})})]})})]},T._id)})})]})})}),m&&e.jsx(k,{}),f&&e.jsx(F,{})]})},Z1=()=>{const{theme:t}=ot(),a=[{icon:Ue,title:"Comprehensive Audit Trail",description:"Complete logging of all system activities, user actions, and data modifications with detailed timestamps and user attribution."},{icon:bt,title:"Security Event Monitoring",description:"Real-time tracking of security events including login attempts, permission changes, and suspicious activities."},{icon:ft,title:"User Activity Tracking",description:"Detailed logs of user sessions, actions performed, and access patterns across all system modules."},{icon:La,title:"System Performance Logs",description:"Monitor system performance metrics, API calls, database queries, and resource utilization patterns."},{icon:rt,title:"Advanced Search & Filtering",description:"Powerful search capabilities with filters by date range, user, action type, and severity level."},{icon:_t,title:"Export & Compliance Reports",description:"Generate compliance reports and export audit data in various formats for regulatory requirements."}],s=["Real-time log streaming and alerts","Automated compliance report generation","Integration with SIEM systems","Advanced analytics and anomaly detection","Custom audit rule configuration","Multi-level log retention policies"];return e.jsx("div",{className:`min-h-screen ${t==="dark"?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:e.jsx(Ue,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:`text-3xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Audit Logs"}),e.jsx("p",{className:`text-lg ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"Comprehensive audit trails and security monitoring"})]})]}),e.jsx("div",{className:`p-4 rounded-lg border-l-4 border-yellow-400 ${t==="dark"?"bg-yellow-900/20 border-yellow-400":"bg-yellow-50 border-yellow-400"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(st,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-semibold ${t==="dark"?"text-yellow-400":"text-yellow-800"}`,children:"Under Development"}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-yellow-300":"text-yellow-700"}`,children:"This module is currently being developed. Full functionality will be available soon."})]})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12",children:a.map((n,r)=>{const i=n.icon;return e.jsx("div",{className:`p-6 rounded-xl border ${t==="dark"?"bg-gray-800 border-gray-700 hover:border-gray-600":"bg-white border-gray-200 hover:border-gray-300"} transition-all duration-200 hover:shadow-lg`,children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg flex-shrink-0",children:e.jsx(i,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-semibold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:n.title}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:n.description})]})]})},r)})}),e.jsxs("div",{className:`p-8 rounded-xl ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border mb-8`,children:[e.jsx("h2",{className:`text-2xl font-bold mb-6 ${t==="dark"?"text-white":"text-gray-900"}`,children:"How Audit Logs Work"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Automatic Logging"}),e.jsxs("ul",{className:`space-y-2 text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:[e.jsxs("li",{className:"flex items-center space-x-2",children:[e.jsx(Te,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Real-time capture of all system events"})]}),e.jsxs("li",{className:"flex items-center space-x-2",children:[e.jsx(ft,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"User action tracking with full context"})]}),e.jsxs("li",{className:"flex items-center space-x-2",children:[e.jsx(bt,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"Security event monitoring and alerts"})]}),e.jsxs("li",{className:"flex items-center space-x-2",children:[e.jsx(La,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{children:"System performance and health metrics"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Analysis & Reporting"}),e.jsxs("ul",{className:`space-y-2 text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:[e.jsxs("li",{className:"flex items-center space-x-2",children:[e.jsx(rt,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{children:"Advanced search and filtering capabilities"})]}),e.jsxs("li",{className:"flex items-center space-x-2",children:[e.jsx(xs,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{children:"Custom filters by date, user, and action type"})]}),e.jsxs("li",{className:"flex items-center space-x-2",children:[e.jsx(_t,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{children:"Export logs for compliance and analysis"})]}),e.jsxs("li",{className:"flex items-center space-x-2",children:[e.jsx(Rt,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{children:"Detailed event inspection and drill-down"})]})]})]})]})]}),e.jsxs("div",{className:`p-6 rounded-xl ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border`,children:[e.jsx("h2",{className:`text-xl font-bold mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Upcoming Features"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map((n,r)=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:n})]},r))})]})]})})},e2=()=>{const{theme:t}=ot(),a=[{icon:Zs,title:"Revenue Analytics",description:"Comprehensive revenue tracking, growth analysis, and financial performance metrics across all clients and packages."},{icon:Re,title:"Client Analytics",description:"Client behavior analysis, subscription patterns, churn rates, and customer lifetime value calculations."},{icon:Ss,title:"Growth Metrics",description:"Track business growth with KPIs, conversion rates, market expansion, and performance benchmarking."},{icon:uo,title:"Package Performance",description:"Analyze package popularity, pricing effectiveness, and feature utilization across different client segments."},{icon:La,title:"System Usage Analytics",description:"Monitor system performance, user engagement, feature adoption, and resource utilization patterns."},{icon:wi,title:"Geographic Analytics",description:"Regional performance analysis, market penetration insights, and location-based growth opportunities."}],s=[{icon:tt,title:"Financial Reports",description:"Revenue, profit margins, billing cycles, payment analytics",frequency:"Daily, Weekly, Monthly, Quarterly"},{icon:Re,title:"Client Reports",description:"User activity, subscription status, engagement metrics",frequency:"Real-time, Daily, Weekly"},{icon:co,title:"Performance Reports",description:"KPI tracking, goal achievement, benchmark analysis",frequency:"Weekly, Monthly, Quarterly"},{icon:w0,title:"Trend Analysis",description:"Growth trends, seasonal patterns, predictive insights",frequency:"Monthly, Quarterly, Yearly"}],n=["AI-powered predictive analytics","Custom dashboard builder","Real-time data streaming","Advanced data visualization tools","Automated report scheduling","Integration with external BI tools","Machine learning insights","Custom KPI tracking"];return e.jsx("div",{className:`min-h-screen ${t==="dark"?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/20 rounded-lg",children:e.jsx(Zs,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:`text-3xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Analytics & Reports"}),e.jsx("p",{className:`text-lg ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"Comprehensive business intelligence and reporting suite"})]})]}),e.jsx("div",{className:`p-4 rounded-lg border-l-4 border-yellow-400 ${t==="dark"?"bg-yellow-900/20 border-yellow-400":"bg-yellow-50 border-yellow-400"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(st,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-semibold ${t==="dark"?"text-yellow-400":"text-yellow-800"}`,children:"Under Development"}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-yellow-300":"text-yellow-700"}`,children:"Advanced analytics and reporting features are being developed. Basic reporting is available in other modules."})]})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12",children:a.map((r,i)=>{const l=r.icon;return e.jsx("div",{className:`p-6 rounded-xl border ${t==="dark"?"bg-gray-800 border-gray-700 hover:border-gray-600":"bg-white border-gray-200 hover:border-gray-300"} transition-all duration-200 hover:shadow-lg`,children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/20 rounded-lg flex-shrink-0",children:e.jsx(l,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-semibold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:r.title}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:r.description})]})]})},i)})}),e.jsxs("div",{className:`p-8 rounded-xl ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border mb-8`,children:[e.jsx("h2",{className:`text-2xl font-bold mb-6 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Available Report Types"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:s.map((r,i)=>{const l=r.icon;return e.jsx("div",{className:`p-6 rounded-lg border ${t==="dark"?"border-gray-600 bg-gray-700/50":"border-gray-200 bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:e.jsx(l,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`font-semibold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:r.title}),e.jsx("p",{className:`text-sm mb-3 ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:r.description}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:`text-xs ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:r.frequency})]})]})]})},i)})})]}),e.jsxs("div",{className:`p-8 rounded-xl ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border mb-8`,children:[e.jsx("h2",{className:`text-2xl font-bold mb-6 ${t==="dark"?"text-white":"text-gray-900"}`,children:"How Analytics & Reports Work"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/20 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(La,{className:"w-8 h-8 text-green-600 dark:text-green-400"})}),e.jsx("h3",{className:`font-semibold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Data Collection"}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"Automatic collection of business metrics, user interactions, and system performance data"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(xs,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),e.jsx("h3",{className:`font-semibold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Data Processing"}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"Advanced algorithms process and analyze data to generate meaningful insights and trends"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/20 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(_t,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"})}),e.jsx("h3",{className:`font-semibold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Report Generation"}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"Interactive dashboards and exportable reports with customizable views and scheduling"})]})]})]}),e.jsxs("div",{className:`p-6 rounded-xl ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border`,children:[e.jsx("h2",{className:`text-xl font-bold mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Upcoming Advanced Features"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.map((r,i)=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:r})]},i))})]})]})})},t2=()=>{const{theme:t}=ot(),a=[{icon:mn,title:"System Settings",description:"Core system configuration including server settings, performance tuning, and resource allocation.",features:["Server configuration","Performance optimization","Resource limits","Cache settings"]},{icon:Gn,title:"Database Configuration",description:"Database connection settings, backup schedules, and data retention policies.",features:["Connection pools","Backup automation","Data retention","Query optimization"]},{icon:bt,title:"Security Settings",description:"Security policies, authentication methods, and access control configurations.",features:["Password policies","2FA settings","Session management","IP restrictions"]},{icon:ut,title:"Email Configuration",description:"SMTP settings, email templates, and notification preferences for system communications.",features:["SMTP configuration","Email templates","Delivery settings","Bounce handling"]},{icon:Ps,title:"Notification Settings",description:"System-wide notification preferences, alert thresholds, and communication channels.",features:["Alert thresholds","Notification channels","Escalation rules","Quiet hours"]},{icon:wi,title:"Localization",description:"Multi-language support, timezone settings, and regional formatting preferences.",features:["Language packs","Timezone settings","Date formats","Currency settings"]}],s=[{icon:ho,title:"API Configuration",description:"API rate limits, authentication keys, and integration settings"},{icon:Wn,title:"UI Customization",description:"Branding, themes, and user interface customization options"},{icon:Te,title:"Scheduling",description:"Automated tasks, maintenance windows, and system schedules"},{icon:Qr,title:"Performance Monitoring",description:"System health monitoring, alerts, and performance metrics"},{icon:vr,title:"Compliance Settings",description:"GDPR, data protection, and regulatory compliance configurations"},{icon:cl,title:"System Monitoring",description:"Real-time monitoring, logging levels, and diagnostic tools"}],n=["Advanced backup and disaster recovery","Multi-tenant configuration management","Automated system health checks","Configuration version control","Environment-specific settings","Advanced security hardening options","Custom workflow configurations","Integration marketplace"];return e.jsx("div",{className:`min-h-screen ${t==="dark"?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/20 rounded-lg",children:e.jsx(Rs,{className:"w-8 h-8 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:`text-3xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"System Configuration"}),e.jsx("p",{className:`text-lg ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"System-wide settings and configuration management"})]})]}),e.jsx("div",{className:`p-4 rounded-lg border-l-4 border-yellow-400 ${t==="dark"?"bg-yellow-900/20 border-yellow-400":"bg-yellow-50 border-yellow-400"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(st,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-semibold ${t==="dark"?"text-yellow-400":"text-yellow-800"}`,children:"Under Development"}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-yellow-300":"text-yellow-700"}`,children:"Advanced system configuration features are being developed. Basic settings are available in individual modules."})]})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-12",children:a.map((r,i)=>{const l=r.icon;return e.jsxs("div",{className:`p-6 rounded-xl border ${t==="dark"?"bg-gray-800 border-gray-700 hover:border-gray-600":"bg-white border-gray-200 hover:border-gray-300"} transition-all duration-200 hover:shadow-lg`,children:[e.jsxs("div",{className:"flex items-start space-x-4 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-900/20 rounded-lg flex-shrink-0",children:e.jsx(l,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`font-semibold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:r.title}),e.jsx("p",{className:`text-sm mb-4 ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:r.description})]})]}),e.jsx("div",{className:"space-y-2",children:r.features.map((c,o)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:c})]},o))})]},i)})}),e.jsxs("div",{className:`p-8 rounded-xl ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border mb-8`,children:[e.jsx("h2",{className:`text-2xl font-bold mb-6 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Advanced Configuration Options"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map((r,i)=>{const l=r.icon;return e.jsx("div",{className:`p-4 rounded-lg border ${t==="dark"?"border-gray-600 bg-gray-700/50":"border-gray-200 bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:e.jsx(l,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-semibold mb-1 ${t==="dark"?"text-white":"text-gray-900"}`,children:r.title}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:r.description})]})]})},i)})})]}),e.jsxs("div",{className:`p-8 rounded-xl ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border mb-8`,children:[e.jsx("h2",{className:`text-2xl font-bold mb-6 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Configuration Management Process"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(Rs,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),e.jsx("h3",{className:`font-semibold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Configure"}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"Set up system parameters and preferences"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/20 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(bt,{className:"w-8 h-8 text-green-600 dark:text-green-400"})}),e.jsx("h3",{className:`font-semibold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Validate"}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"Verify configuration integrity and security"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/20 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(Qr,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"})}),e.jsx("h3",{className:`font-semibold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Apply"}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"Deploy changes across the system"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-orange-100 dark:bg-orange-900/20 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(cl,{className:"w-8 h-8 text-orange-600 dark:text-orange-400"})}),e.jsx("h3",{className:`font-semibold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Monitor"}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"Track system performance and health"})]})]})]}),e.jsxs("div",{className:`p-6 rounded-xl ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border`,children:[e.jsx("h2",{className:`text-xl font-bold mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Upcoming Configuration Features"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.map((r,i)=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:r})]},i))})]})]})})},s2=()=>{const{theme:t}=ot(),a=[{icon:Gn,title:"Database Backups",description:"Automated and manual database backup solutions with multiple restore points and integrity verification.",features:["Scheduled backups","Point-in-time recovery","Backup verification","Cross-region storage"]},{icon:ol,title:"Data Archival",description:"Intelligent data archival system for long-term storage and compliance with automated lifecycle management.",features:["Automated archival","Compliance retention","Data compression","Retrieval on demand"]},{icon:_t,title:"Data Export",description:"Comprehensive data export capabilities with multiple formats and customizable data selection.",features:["Multiple formats","Selective export","Bulk operations","API integration"]},{icon:es,title:"Data Import",description:"Secure data import tools with validation, transformation, and error handling capabilities.",features:["Data validation","Format conversion","Error handling","Progress tracking"]},{icon:Lt,title:"Data Migration",description:"Safe and efficient data migration tools for system upgrades and platform transitions.",features:["Zero-downtime migration","Data mapping","Rollback capability","Progress monitoring"]},{icon:bt,title:"Data Security",description:"Advanced data protection with encryption, access controls, and audit trails for sensitive information.",features:["End-to-end encryption","Access logging","Data masking","Compliance reporting"]}],s=[{icon:Te,title:"Incremental Backups",description:"Daily incremental backups capturing only changed data",frequency:"Every 6 hours"},{icon:Gn,title:"Full System Backups",description:"Complete system snapshots including all databases and files",frequency:"Weekly"},{icon:k0,title:"Cloud Backups",description:"Secure cloud storage with geographic redundancy",frequency:"Real-time sync"},{icon:ji,title:"Mirror Backups",description:"Real-time database mirroring for instant failover",frequency:"Continuous"}],n=[{icon:Vn,title:"Point-in-Time Recovery",description:"Restore data to any specific point in time"},{icon:Ue,title:"Data Audit Trails",description:"Complete tracking of all data modifications"},{icon:vr,title:"Data Encryption",description:"Advanced encryption for data at rest and in transit"},{icon:ct,title:"Secure Data Deletion",description:"GDPR-compliant secure data removal processes"}],r=["AI-powered backup optimization","Automated disaster recovery testing","Multi-cloud backup strategies","Real-time data synchronization","Advanced data deduplication","Blockchain-based data integrity","Automated compliance reporting","Smart data lifecycle management"];return e.jsx("div",{className:`min-h-screen ${t==="dark"?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-indigo-100 dark:bg-indigo-900/20 rounded-lg",children:e.jsx(mn,{className:"w-8 h-8 text-indigo-600 dark:text-indigo-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:`text-3xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Data Management"}),e.jsx("p",{className:`text-lg ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"Comprehensive data backup, archival, and management solutions"})]})]}),e.jsx("div",{className:`p-4 rounded-lg border-l-4 border-yellow-400 ${t==="dark"?"bg-yellow-900/20 border-yellow-400":"bg-yellow-50 border-yellow-400"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(st,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:`font-semibold ${t==="dark"?"text-yellow-400":"text-yellow-800"}`,children:"Under Development"}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-yellow-300":"text-yellow-700"}`,children:"Advanced data management features are being developed. Basic backup functionality is available."})]})]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-12",children:a.map((i,l)=>{const c=i.icon;return e.jsxs("div",{className:`p-6 rounded-xl border ${t==="dark"?"bg-gray-800 border-gray-700 hover:border-gray-600":"bg-white border-gray-200 hover:border-gray-300"} transition-all duration-200 hover:shadow-lg`,children:[e.jsxs("div",{className:"flex items-start space-x-4 mb-4",children:[e.jsx("div",{className:"p-2 bg-indigo-100 dark:bg-indigo-900/20 rounded-lg flex-shrink-0",children:e.jsx(c,{className:"w-6 h-6 text-indigo-600 dark:text-indigo-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`font-semibold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:i.title}),e.jsx("p",{className:`text-sm mb-4 ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:i.description})]})]}),e.jsx("div",{className:"space-y-2",children:i.features.map((o,d)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-indigo-500 rounded-full"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:o})]},d))})]},l)})}),e.jsxs("div",{className:`p-8 rounded-xl ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border mb-8`,children:[e.jsx("h2",{className:`text-2xl font-bold mb-6 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Backup Strategies"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:s.map((i,l)=>{const c=i.icon;return e.jsx("div",{className:`p-6 rounded-lg border ${t==="dark"?"border-gray-600 bg-gray-700/50":"border-gray-200 bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/20 rounded-lg",children:e.jsx(c,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`font-semibold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:i.title}),e.jsx("p",{className:`text-sm mb-3 ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:i.description}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:`text-xs ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:i.frequency})]})]})]})},l)})})]}),e.jsxs("div",{className:`p-8 rounded-xl ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border mb-8`,children:[e.jsx("h2",{className:`text-2xl font-bold mb-6 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Advanced Data Operations"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:n.map((i,l)=>{const c=i.icon;return e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/20 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(c,{className:"w-8 h-8 text-green-600 dark:text-green-400"})}),e.jsx("h3",{className:`font-semibold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:i.title}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:i.description})]},l)})})]}),e.jsxs("div",{className:`p-8 rounded-xl ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border mb-8`,children:[e.jsx("h2",{className:`text-2xl font-bold mb-6 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Data Management Workflow"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/20 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(S0,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),e.jsx("h3",{className:`font-semibold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Collect"}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"Automated data collection and preparation for backup"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/20 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(bt,{className:"w-8 h-8 text-green-600 dark:text-green-400"})}),e.jsx("h3",{className:`font-semibold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Secure"}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"Encryption and security validation before storage"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/20 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(ol,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"})}),e.jsx("h3",{className:`font-semibold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Store"}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"Multi-location storage with redundancy and verification"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"p-3 bg-orange-100 dark:bg-orange-900/20 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center",children:e.jsx(Vn,{className:"w-8 h-8 text-orange-600 dark:text-orange-400"})}),e.jsx("h3",{className:`font-semibold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Restore"}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"Fast and reliable data recovery when needed"})]})]})]}),e.jsxs("div",{className:`p-6 rounded-xl ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border`,children:[e.jsx("h2",{className:`text-xl font-bold mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Upcoming Data Management Features"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map((i,l)=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-2 h-2 bg-indigo-500 rounded-full"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:i})]},l))})]})]})})},a2="modulepreload",r2=function(t){return"/"+t},Gc={},hi=function(a,s,n){let r=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));r=Promise.allSettled(s.map(o=>{if(o=r2(o),o in Gc)return;Gc[o]=!0;const d=o.endsWith(".css"),x=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${x}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":a2,d||(m.as="script"),m.crossOrigin="",m.href=o,c&&m.setAttribute("nonce",c),document.head.appendChild(m),d)return new Promise((h,f)=>{m.addEventListener("load",h),m.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${o}`)))})}))}function i(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return r.then(l=>{for(const c of l||[])c.status==="rejected"&&i(c.reason);return a().catch(i)})},n2=()=>{const{theme:t}=ot(),{user:a}=kt(),[s,n]=v.useState(null),[r,i]=v.useState(!1),l=async()=>{var x;i(!0);const o={timestamp:new Date().toISOString(),checks:[]},d=localStorage.getItem("token");o.checks.push({name:"Authentication Token",status:d?"success":"error",message:d?`Token exists (${d.length} chars)`:"No authentication token found",details:d?`Preview: ${d.substring(0,20)}...`:"Please log in again"}),o.checks.push({name:"User Object",status:a?"success":"error",message:a?`User logged in: ${a.email}`:"No user object found",details:a?`Role: ${a.role}`:"User context is missing"});try{const m=await hi(()=>Promise.resolve().then(()=>hh),void 0);o.checks.push({name:"API Configuration",status:"success",message:`API Base URL: ${m.default.apiBaseUrl}`,details:`Environment: ${m.default.env}`})}catch(m){o.checks.push({name:"API Configuration",status:"error",message:"Failed to load API configuration",details:m.message})}try{const m=await fetch("/api/super-admin/roles/my-permissions",{headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"}});if(m.ok){const h=await m.json();o.checks.push({name:"Backend Connectivity",status:"success",message:"Successfully connected to backend",details:`Response: ${m.status} ${m.statusText}`}),o.checks.push({name:"Permissions API",status:h.success?"success":"warning",message:h.success?"Permissions loaded successfully":"Permissions API returned error",details:h.success?`Internal Role: ${((x=h.data)==null?void 0:x.internalRole)||"undefined"}`:h.message})}else o.checks.push({name:"Backend Connectivity",status:"error",message:`Backend responded with error: ${m.status}`,details:`${m.status} ${m.statusText}`})}catch(m){o.checks.push({name:"Backend Connectivity",status:"error",message:"Cannot connect to backend server",details:m.message||"Network error - check if backend is running on port 5000"})}try{const m=await fetch("/api/super-admin/subscriptions?page=1&limit=1",{headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"}});o.checks.push({name:"Billing API",status:m.ok?"success":"error",message:m.ok?"Billing API accessible":`Billing API error: ${m.status}`,details:`${m.status} ${m.statusText}`})}catch(m){o.checks.push({name:"Billing API",status:"error",message:"Billing API connection failed",details:m.message})}n(o),i(!1)},c=o=>{switch(o){case"success":return e.jsx(we,{className:"w-5 h-5 text-green-500"});case"warning":return e.jsx(Ct,{className:"w-5 h-5 text-yellow-500"});case"error":return e.jsx(ze,{className:"w-5 h-5 text-red-500"});default:return e.jsx(Ct,{className:"w-5 h-5 text-gray-500"})}};return e.jsxs("div",{className:`p-6 rounded-lg border ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:"System Diagnostics"}),e.jsxs("button",{onClick:l,disabled:r,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 disabled:opacity-50",children:[r?e.jsx(Lt,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(Lt,{className:"w-4 h-4 mr-2"}),"Run Diagnostics"]})]}),s&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`text-xs ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["Last run: ",new Date(s.timestamp).toLocaleString()]}),s.checks.map((o,d)=>e.jsxs("div",{className:`flex items-start space-x-3 p-3 rounded-md ${o.status==="success"?"bg-green-50 dark:bg-green-900/20":o.status==="warning"?"bg-yellow-50 dark:bg-yellow-900/20":"bg-red-50 dark:bg-red-900/20"}`,children:[c(o.status),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:o.name}),e.jsx("div",{className:`text-sm ${o.status==="success"?"text-green-700 dark:text-green-300":o.status==="warning"?"text-yellow-700 dark:text-yellow-300":"text-red-700 dark:text-red-300"}`,children:o.message}),o.details&&e.jsx("div",{className:`text-xs mt-1 ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:o.details})]})]},d))]}),!s&&!r&&e.jsx("div",{className:`text-center py-8 ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:'Click "Run Diagnostics" to check system connectivity and authentication'})]})},i2=({isOpen:t,onClose:a,onSuccess:s})=>{const{theme:n}=ot(),[r,i]=v.useState(!1),[l,c]=v.useState([]),[o,d]=v.useState([]),[x,m]=v.useState({clientId:"",packageId:"",billingCycle:"monthly",startDate:new Date().toISOString().split("T")[0],autoRenew:!0,trialDays:0,discount:{percentage:0,amount:0,reason:""},notes:""}),[h,f]=v.useState(null),[g,p]=v.useState(0);v.useEffect(()=>{t&&(u(),j())},[t]),v.useEffect(()=>{if(x.packageId){const b=o.find(C=>C._id===x.packageId);f(b),y(b)}},[x.packageId,x.billingCycle,x.discount,o]);const u=async()=>{try{const C=await(await fetch("/api/super-admin/clients?limit=100",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}})).json();C.success&&c(C.data.clients||[])}catch(b){console.error("Error fetching clients:",b),E.error("Failed to fetch clients")}},j=async()=>{try{const C=await(await fetch("/api/super-admin/packages?limit=100",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"}})).json();C.success&&d(C.data.packages||[])}catch(b){console.error("Error fetching packages:",b),E.error("Failed to fetch packages")}},y=b=>{if(!b)return;let C=0;switch(x.billingCycle){case"monthly":C=b.pricing.monthly;break;case"quarterly":C=b.pricing.quarterly||b.pricing.monthly*3;break;case"yearly":C=b.pricing.yearly||b.pricing.monthly*12;break;default:C=b.pricing.monthly}let S=0;x.discount.percentage>0&&(S+=C*(x.discount.percentage/100)),x.discount.amount>0&&(S+=x.discount.amount);const k=Math.max(0,C-S);p(k)},N=b=>{const{name:C,value:S,type:k,checked:F}=b.target;if(C.startsWith("discount.")){const R=C.split(".")[1];m(T=>({...T,discount:{...T.discount,[R]:k==="number"?parseFloat(S)||0:S}}))}else m(R=>({...R,[C]:k==="checkbox"?F:S}))},w=async b=>{b.preventDefault(),i(!0);try{if(!x.clientId||!x.packageId){E.error("Please select both client and package");return}const S=await(await fetch("/api/super-admin/subscriptions",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("token")}`,"Content-Type":"application/json"},body:JSON.stringify({...x,basePrice:(h==null?void 0:h.pricing[x.billingCycle])||0,effectivePrice:g})})).json();S.success?(E.success("Subscription created successfully"),s&&s(S.data),a(),D()):E.error(S.message||"Failed to create subscription")}catch(C){console.error("Error creating subscription:",C),E.error("Failed to create subscription")}finally{i(!1)}},D=()=>{m({clientId:"",packageId:"",billingCycle:"monthly",startDate:new Date().toISOString().split("T")[0],autoRenew:!0,trialDays:0,discount:{percentage:0,amount:0,reason:""},notes:""}),f(null),p(0)};return t?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:a}),e.jsxs("div",{className:`inline-block align-bottom rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full ${n==="dark"?"bg-gray-800":"bg-white"}`,children:[e.jsx("div",{className:`px-6 py-4 border-b ${n==="dark"?"border-gray-700":"border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:`text-lg font-medium ${n==="dark"?"text-white":"text-gray-900"}`,children:"Create New Subscription"}),e.jsx("button",{onClick:a,className:`rounded-md p-2 hover:bg-gray-100 dark:hover:bg-gray-700 ${n==="dark"?"text-gray-400":"text-gray-500"}`,children:e.jsx(Ee,{className:"w-5 h-5"})})]})}),e.jsxs("form",{onSubmit:w,className:"px-6 py-4 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:[e.jsx(Re,{className:"w-4 h-4 inline mr-2"}),"Client"]}),e.jsxs("select",{name:"clientId",value:x.clientId,onChange:N,required:!0,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${n==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"",children:"Select a client..."}),l.map(b=>e.jsxs("option",{value:b._id,children:[b.companyName," (",b.email,")"]},b._id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:[e.jsx(Tt,{className:"w-4 h-4 inline mr-2"}),"Package"]}),e.jsxs("select",{name:"packageId",value:x.packageId,onChange:N,required:!0,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${n==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"",children:"Select a package..."}),o.map(b=>e.jsxs("option",{value:b._id,children:[b.name," - $",b.pricing.monthly,"/month"]},b._id))]}),h&&e.jsxs("div",{className:`mt-2 p-3 rounded-md ${n==="dark"?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("p",{className:`text-sm ${n==="dark"?"text-gray-300":"text-gray-600"}`,children:h.description}),e.jsxs("p",{className:`text-xs mt-1 ${n==="dark"?"text-gray-400":"text-gray-500"}`,children:["Max Employees: ",h.features.maxEmployees," | Storage: ",h.features.storageLimit,"GB"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:"Billing Cycle"}),e.jsxs("select",{name:"billingCycle",value:x.billingCycle,onChange:N,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${n==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"quarterly",children:"Quarterly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:[e.jsx(tt,{className:"w-4 h-4 inline mr-2"}),"Calculated Price"]}),e.jsxs("div",{className:`w-full px-3 py-2 border rounded-md ${n==="dark"?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-300"}`,children:[e.jsxs("span",{className:`text-lg font-bold ${n==="dark"?"text-green-400":"text-green-600"}`,children:["$",g.toFixed(2)]}),h&&e.jsxs("span",{className:`text-sm ml-2 ${n==="dark"?"text-gray-400":"text-gray-500"}`,children:["(Base: $",h.pricing[x.billingCycle]||0,")"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:[e.jsx(Fe,{className:"w-4 h-4 inline mr-2"}),"Start Date"]}),e.jsx("input",{type:"date",name:"startDate",value:x.startDate,onChange:N,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${n==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:"Trial Days"}),e.jsx("input",{type:"number",name:"trialDays",value:x.trialDays,onChange:N,min:"0",max:"90",className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${n==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`})]})]}),e.jsxs("div",{className:`p-4 rounded-md ${n==="dark"?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("h4",{className:`text-sm font-medium mb-3 ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:"Discount (Optional)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-xs mb-1 ${n==="dark"?"text-gray-400":"text-gray-600"}`,children:"Percentage (%)"}),e.jsx("input",{type:"number",name:"discount.percentage",value:x.discount.percentage,onChange:N,min:"0",max:"100",step:"0.1",className:`w-full px-2 py-1 border rounded text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500 ${n==="dark"?"bg-gray-600 border-gray-500 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-xs mb-1 ${n==="dark"?"text-gray-400":"text-gray-600"}`,children:"Fixed Amount ($)"}),e.jsx("input",{type:"number",name:"discount.amount",value:x.discount.amount,onChange:N,min:"0",step:"0.01",className:`w-full px-2 py-1 border rounded text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500 ${n==="dark"?"bg-gray-600 border-gray-500 text-white":"bg-white border-gray-300 text-gray-900"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-xs mb-1 ${n==="dark"?"text-gray-400":"text-gray-600"}`,children:"Reason"}),e.jsx("input",{type:"text",name:"discount.reason",value:x.discount.reason,onChange:N,placeholder:"e.g., Early bird",className:`w-full px-2 py-1 border rounded text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500 ${n==="dark"?"bg-gray-600 border-gray-500 text-white":"bg-white border-gray-300 text-gray-900"}`})]})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"autoRenew",checked:x.autoRenew,onChange:N,className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),e.jsx("label",{className:`ml-2 text-sm ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:"Enable auto-renewal"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:"Notes (Optional)"}),e.jsx("textarea",{name:"notes",value:x.notes,onChange:N,rows:3,placeholder:"Additional notes about this subscription...",className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${n==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"}`})]})]}),e.jsx("div",{className:`px-6 py-4 border-t ${n==="dark"?"border-gray-700 bg-gray-750":"border-gray-200 bg-gray-50"}`,children:e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:a,className:`px-4 py-2 border rounded-md text-sm font-medium ${n==="dark"?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Cancel"}),e.jsx("button",{type:"submit",onClick:w,disabled:r||!x.clientId||!x.packageId,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:r?"Creating...":"Create Subscription"})]})})]})]})}):null},l2=()=>{const{theme:t}=ot(),[a,s]=v.useState([]),[n,r]=v.useState(!0),[i,l]=v.useState(""),[c,o]=v.useState(""),[d,x]=v.useState(""),[m,h]=v.useState(!1),[f,g]=v.useState(null),[p,u]=v.useState(!1),[j,y]=v.useState(1),[N,w]=v.useState(1),[D,b]=v.useState({total:0,active:0,expiring:0,expired:0});v.useEffect(()=>{C(),S()},[i,c,d,j]);const C=async()=>{var Q,_,ne,ie,A;try{r(!0);const P=localStorage.getItem("token");console.log("ðŸ”‘ Auth token exists:",!!P),console.log("ðŸ”‘ Token preview:",P?P.substring(0,20)+"...":"No token");const O={page:j,limit:10,search:i,status:c,billingCycle:d};console.log("ðŸ“¡ Making API request to:","/api/super-admin/subscriptions"),console.log("ðŸ“Š Request params:",O);const{getSubscriptions:I}=await hi(async()=>{const{getSubscriptions:te}=await import("./billing-DDm9nhee.js");return{getSubscriptions:te}},__vite__mapDeps([0,1,2,3])),J=await I(O);console.log("âœ… API Response received:",J),(Q=J.data)!=null&&Q.success?(s(J.data.data.subscriptions||[]),w(((_=J.data.data.pagination)==null?void 0:_.pages)||1),console.log("ðŸ“‹ Subscriptions loaded:",((ne=J.data.data.subscriptions)==null?void 0:ne.length)||0)):(console.warn("âš ï¸ API response not successful:",J.data),s([]))}catch(P){console.error("âŒ Error fetching subscriptions:",P),((ie=P.response)==null?void 0:ie.status)===401?(console.error("ðŸš« Authentication failed - token may be invalid or expired"),E.error("Authentication failed. Please log in again.")):((A=P.response)==null?void 0:A.status)===403?(console.error("ðŸš« Access forbidden - insufficient permissions"),E.error("Access denied. You don't have permission to view subscriptions.")):P.code==="NETWORK_ERROR"||!P.response?(console.error("ðŸŒ Network error - backend server may be down"),E.error("Cannot connect to server. Please check if the backend is running on port 5000.")):(console.error("ðŸ’¥ Unexpected error:",P.message),E.error("Failed to fetch subscriptions: "+P.message)),s([])}finally{r(!1)}},S=async()=>{var Q,_,ne,ie,A,P,O,I,J;try{const{getSubscriptions:te}=await hi(async()=>{const{getSubscriptions:Z}=await import("./billing-DDm9nhee.js");return{getSubscriptions:Z}},__vite__mapDeps([0,1,2,3])),[se,le,ue]=await Promise.all([te({limit:1e3}),te({status:"active",expiring:!0}),te({status:"expired"})]),be=((_=(Q=se.data)==null?void 0:Q.data)==null?void 0:_.total)||0,H=((A=(ie=(ne=se.data)==null?void 0:ne.data)==null?void 0:ie.subscriptions)==null?void 0:A.filter(Z=>Z.status==="active").length)||0,De=((O=(P=le.data)==null?void 0:P.data)==null?void 0:O.total)||0,re=((J=(I=ue.data)==null?void 0:I.data)==null?void 0:J.total)||0;b({total:be,active:H,expiring:De,expired:re})}catch(te){console.error("Error fetching stats:",te),b({total:0,active:0,expiring:0,expired:0})}},k=async Q=>{try{(await fetch(`/api/super-admin/subscriptions/${Q}/renew`,{method:"PATCH",headers:{"Content-Type":"application/json"}})).ok&&(E.success("Subscription renewed successfully"),C())}catch{E.error("Failed to renew subscription")}},F=async Q=>{try{(await fetch(`/api/super-admin/subscriptions/${Q}/suspend`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({reason:"Manual suspension"})})).ok&&(E.success("Subscription suspended successfully"),C())}catch{E.error("Failed to suspend subscription")}},R=async Q=>{try{(await fetch(`/api/super-admin/subscriptions/${Q}/reactivate`,{method:"PATCH",headers:{"Content-Type":"application/json"}})).ok&&(E.success("Subscription reactivated successfully"),C())}catch{E.error("Failed to reactivate subscription")}},T=Q=>{console.log("âœ… New subscription created:",Q),C(),S()},M=Q=>{const _={active:{color:"bg-green-100 text-green-800",icon:we},pending_payment:{color:"bg-yellow-100 text-yellow-800",icon:Te},expired:{color:"bg-red-100 text-red-800",icon:ze},suspended:{color:"bg-gray-100 text-gray-800",icon:dl},cancelled:{color:"bg-red-100 text-red-800",icon:ze}},ne=_[Q]||_.active,ie=ne.icon;return e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${ne.color}`,children:[e.jsx(ie,{className:"w-3 h-3 mr-1"}),Q.replace("_"," ").toUpperCase()]})},X=Q=>{const _={monthly:"bg-blue-100 text-blue-800",quarterly:"bg-purple-100 text-purple-800",yearly:"bg-green-100 text-green-800"};return e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${_[Q]||"bg-gray-100 text-gray-800"}`,children:Q==null?void 0:Q.toUpperCase()})},q=(Q,_="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:_}).format(Q),B=Q=>new Date(Q).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),K=Q=>{const _=new Date,ie=new Date(Q)-_;return Math.ceil(ie/(1e3*60*60*24))};return e.jsx("div",{className:`min-h-screen ${t==="dark"?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:`text-3xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Subscription Management"}),e.jsx("p",{className:`mt-2 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Manage client subscriptions, billing cycles, and renewals"})]}),e.jsxs("button",{onClick:()=>h(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[e.jsx(Pe,{className:"w-4 h-4 mr-2"}),"New Subscription"]})]})}),e.jsx("div",{className:"mb-8",children:e.jsx(n2,{})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} overflow-hidden shadow rounded-lg`,children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ha,{className:"h-6 w-6 text-gray-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"} truncate`,children:"Total Subscriptions"}),e.jsx("dd",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:D.total})]})})]})})}),e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} overflow-hidden shadow rounded-lg`,children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(we,{className:"h-6 w-6 text-green-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"} truncate`,children:"Active"}),e.jsx("dd",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:D.active})]})})]})})}),e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} overflow-hidden shadow rounded-lg`,children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Ct,{className:"h-6 w-6 text-yellow-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"} truncate`,children:"Expiring Soon"}),e.jsx("dd",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:D.expiring})]})})]})})}),e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} overflow-hidden shadow rounded-lg`,children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ze,{className:"h-6 w-6 text-red-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"} truncate`,children:"Expired"}),e.jsx("dd",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:D.expired})]})})]})})})]}),e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} shadow rounded-lg mb-6`,children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t==="dark"?"text-gray-300":"text-gray-700"} mb-2`,children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(rt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",value:i,onChange:Q=>l(Q.target.value),placeholder:"Search subscriptions...",className:`pl-10 w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"}`})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t==="dark"?"text-gray-300":"text-gray-700"} mb-2`,children:"Status"}),e.jsxs("select",{value:c,onChange:Q=>o(Q.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"pending_payment",children:"Pending Payment"}),e.jsx("option",{value:"expired",children:"Expired"}),e.jsx("option",{value:"suspended",children:"Suspended"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t==="dark"?"text-gray-300":"text-gray-700"} mb-2`,children:"Billing Cycle"}),e.jsxs("select",{value:d,onChange:Q=>x(Q.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"",children:"All Cycles"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"quarterly",children:"Quarterly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:()=>{l(""),o(""),x("")},className:`px-4 py-2 border rounded-md text-sm font-medium ${t==="dark"?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Clear Filters"})})]})})}),e.jsxs("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} shadow rounded-lg overflow-hidden`,children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:"Subscriptions"})}),n?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:t==="dark"?"bg-gray-700":"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${t==="dark"?"text-gray-300":"text-gray-500"}`,children:"Client"}),e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${t==="dark"?"text-gray-300":"text-gray-500"}`,children:"Package"}),e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${t==="dark"?"text-gray-300":"text-gray-500"}`,children:"Status"}),e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${t==="dark"?"text-gray-300":"text-gray-500"}`,children:"Billing"}),e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${t==="dark"?"text-gray-300":"text-gray-500"}`,children:"End Date"}),e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${t==="dark"?"text-gray-300":"text-gray-500"}`,children:"Revenue"}),e.jsx("th",{className:`px-6 py-3 text-right text-xs font-medium uppercase tracking-wider ${t==="dark"?"text-gray-300":"text-gray-500"}`,children:"Actions"})]})}),e.jsx("tbody",{className:`divide-y ${t==="dark"?"bg-gray-800 divide-gray-700":"bg-white divide-gray-200"}`,children:a.map(Q=>{var ie,A,P;const _=K(Q.endDate),ne=_<=10&&_>0;return e.jsxs("tr",{className:t==="dark"?"hover:bg-gray-700":"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:`h-10 w-10 rounded-full flex items-center justify-center ${t==="dark"?"bg-gray-600":"bg-gray-200"}`,children:e.jsx(Re,{className:"h-5 w-5 text-gray-500"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:(ie=Q.clientId)==null?void 0:ie.companyName}),e.jsx("div",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:Q.subscriptionCode})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Tt,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:(A=Q.packageId)==null?void 0:A.name}),e.jsx("div",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:(P=Q.packageId)==null?void 0:P.type})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:M(Q.status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[X(Q.billingCycle),e.jsx("div",{className:`text-sm mt-1 ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:q(Q.effectivePrice,Q.currency)})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:`text-sm ${t==="dark"?"text-white":"text-gray-900"}`,children:B(Q.endDate)}),ne&&e.jsxs("div",{className:"text-sm text-yellow-600 flex items-center mt-1",children:[e.jsx(Ct,{className:"h-3 w-3 mr-1"}),_," days left"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:q(Q.totalRevenue,Q.currency)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>{g(Q),u(!0)},className:"text-indigo-600 hover:text-indigo-900",title:"View Details",children:e.jsx(Rt,{className:"h-4 w-4"})}),Q.status==="active"&&e.jsx("button",{onClick:()=>k(Q._id),className:"text-green-600 hover:text-green-900",title:"Renew",children:e.jsx(Lt,{className:"h-4 w-4"})}),Q.status==="active"&&e.jsx("button",{onClick:()=>F(Q._id),className:"text-yellow-600 hover:text-yellow-900",title:"Suspend",children:e.jsx(dl,{className:"h-4 w-4"})}),Q.status==="suspended"&&e.jsx("button",{onClick:()=>R(Q._id),className:"text-green-600 hover:text-green-900",title:"Reactivate",children:e.jsx(po,{className:"h-4 w-4"})})]})})]},Q._id)})})]})}),N>1&&e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-between items-center",children:[e.jsxs("div",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["Page ",j," of ",N]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>y(Q=>Math.max(Q-1,1)),disabled:j===1,className:`px-3 py-1 rounded text-sm ${j===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700"}`,children:"Previous"}),e.jsx("button",{onClick:()=>y(Q=>Math.min(Q+1,N)),disabled:j===N,className:`px-3 py-1 rounded text-sm ${j===N?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700"}`,children:"Next"})]})]})]}),e.jsx(i2,{isOpen:m,onClose:()=>h(!1),onSuccess:T})]})})},c2=()=>{const{theme:t}=ot(),[a,s]=v.useState([]),[n,r]=v.useState(!0),[i,l]=v.useState(""),[c,o]=v.useState(""),[d,x]=v.useState(""),[m,h]=v.useState(""),[f,g]=v.useState(!1),[p,u]=v.useState(null),[j,y]=v.useState(!1),[N,w]=v.useState(!1),[D,b]=v.useState(!1),[C,S]=v.useState([]),[k,F]=v.useState(!1),[R,T]=v.useState(1),[M,X]=v.useState(1),[q,B]=v.useState({total:0,paid:0,pending:0,overdue:0,totalAmount:0,paidAmount:0,pendingAmount:0});v.useEffect(()=>{K(),Q()},[i,c,d,m,R]);const K=async()=>{var re;try{r(!0);const Z=new URLSearchParams;Z.append("page",R),Z.append("limit",10),i&&Z.append("search",i),c&&Z.append("status",c),d&&Z.append("paymentStatus",d),m&&Z.append("dateRange",m);const ee=localStorage.getItem("token"),ae=await fetch("/api/super-admin/invoices?"+Z.toString(),{headers:{Authorization:`Bearer ${ee}`,"Content-Type":"application/json"}});if(!ae.ok)throw new Error(`HTTP error! status: ${ae.status}`);const xe=await ae.json();if(xe.success)s(xe.data.invoices||[]),X(((re=xe.data.pagination)==null?void 0:re.pages)||1),xe.data.invoices&&xe.data.invoices.length>0&&_(xe.data.invoices);else throw new Error(xe.message||"Failed to fetch invoices")}catch(Z){console.error("Error fetching invoices:",Z),E.error("Failed to fetch invoices: "+Z.message),s([])}finally{r(!1)}},Q=async()=>{try{const re=localStorage.getItem("token"),Z=await fetch("/api/super-admin/invoices/stats",{headers:{Authorization:`Bearer ${re}`,"Content-Type":"application/json"}});if(Z.ok){const ee=await Z.json();ee.success&&B(ee.data)}else _()}catch(re){console.error("Error fetching stats:",re),_()}},_=(re=a)=>{if(re.length===0)return;const Z=re.reduce((ee,ae)=>{var xe,fe,ve,Ae;switch(ee.total+=1,ee.totalAmount+=((xe=ae.amount)==null?void 0:xe.total)||0,ae.paymentStatus){case"paid":ee.paid+=1,ee.paidAmount+=((fe=ae.amount)==null?void 0:fe.total)||0;break;case"pending":ee.pending+=1,ee.pendingAmount+=((ve=ae.amount)==null?void 0:ve.total)||0;break;default:ae.status==="overdue"&&(ee.overdue+=1,ee.pendingAmount+=((Ae=ae.amount)==null?void 0:Ae.total)||0)}return ee},{total:0,paid:0,pending:0,overdue:0,totalAmount:0,paidAmount:0,pendingAmount:0});B(Z)},ne=async re=>{try{const Z=localStorage.getItem("token"),ee=await fetch("/api/super-admin/invoices/generate",{method:"POST",headers:{Authorization:`Bearer ${Z}`,"Content-Type":"application/json"},body:JSON.stringify({subscriptionId:re})});if(ee.ok){const ae=await ee.json();E.success("Invoice generated successfully"),K(),Q(),g(!1)}else{const ae=await ee.json();throw new Error(ae.message||"Failed to generate invoice")}}catch(Z){console.error("Error generating invoice:",Z),E.error("Failed to generate invoice: "+Z.message)}},ie=async(re,Z)=>{try{const ee=localStorage.getItem("token"),ae=await fetch(`/api/super-admin/invoices/${re}/mark-paid`,{method:"PATCH",headers:{Authorization:`Bearer ${ee}`,"Content-Type":"application/json"},body:JSON.stringify(Z)});if(ae.ok){const xe=await ae.json();E.success("Invoice marked as paid successfully"),K(),Q(),w(!1)}else if(ae.status===500){try{const xe=await ae.json();if(xe.message&&(xe.message.includes("audit")||xe.message.includes("log"))){E.success("Invoice marked as paid successfully (audit log warning)"),K(),Q(),w(!1);return}}catch{console.log("Assuming operation succeeded despite server error"),E.success("Invoice marked as paid successfully (server warning)"),K(),Q(),w(!1);return}throw new Error("Server error occurred")}else{const xe=await ae.json();throw new Error(xe.message||"Failed to mark invoice as paid")}}catch(ee){console.error("Error marking invoice as paid:",ee),E.error("Failed to mark invoice as paid: "+ee.message)}},A=async re=>{try{const Z=localStorage.getItem("token"),ee=await fetch(`/api/super-admin/invoices/${re}/send-reminder`,{method:"PATCH",headers:{Authorization:`Bearer ${Z}`,"Content-Type":"application/json"}});if(ee.ok){const ae=await ee.json();E.success("Reminder sent successfully"),K()}else{const ae=await ee.json();throw new Error(ae.message||"Failed to send reminder")}}catch(Z){console.error("Error sending reminder:",Z),E.error("Failed to send reminder: "+Z.message)}},P=async(re,Z)=>{try{const ee=localStorage.getItem("token"),ae=await fetch(`/api/super-admin/invoices/${re}/pdf`,{headers:{Authorization:`Bearer ${ee}`}});if(ae.ok){const xe=await ae.blob(),fe=window.URL.createObjectURL(xe),ve=document.createElement("a");ve.href=fe,ve.download=`invoice-${Z}.pdf`,document.body.appendChild(ve),ve.click(),window.URL.revokeObjectURL(fe),document.body.removeChild(ve),E.success("Invoice PDF downloaded successfully")}else throw new Error("Failed to download PDF")}catch(ee){console.error("Error downloading PDF:",ee),E.error("Failed to download PDF: "+ee.message)}},O=async(re,Z)=>{try{const ee=localStorage.getItem("token"),ae=await fetch(`/api/super-admin/invoices/${re}`,{method:"PUT",headers:{Authorization:`Bearer ${ee}`,"Content-Type":"application/json"},body:JSON.stringify({status:Z})});if(ae.ok){const xe=await ae.json();E.success(`Invoice status updated to ${Z}`),K(),Q(),b(!1)}else{const xe=await ae.json();throw new Error(xe.message||"Failed to update invoice status")}}catch(ee){console.error("Error updating invoice status:",ee),E.error("Failed to update status: "+ee.message)}},I=async(re,Z)=>{try{const ee=localStorage.getItem("token"),ae=await fetch(`/api/super-admin/invoices/${re._id}`,{method:"PUT",headers:{Authorization:`Bearer ${ee}`,"Content-Type":"application/json"},body:JSON.stringify({status:Z})});if(ae.ok)E.success(`Invoice ${Z==="sent"?"sent to client":"cancelled"}`),K(),Q();else{const xe=await ae.json();throw new Error(xe.message||"Failed to update invoice")}}catch(ee){console.error("Error updating invoice:",ee),E.error("Failed to update invoice: "+ee.message)}},J=(re,Z)=>{S(Z?ee=>[...ee,re]:ee=>ee.filter(ae=>ae!==re))},te=re=>{S(re?a.map(Z=>Z._id):[])},se=async re=>{if(C.length===0){E.error("Please select invoices first");return}try{const Z=localStorage.getItem("token"),ee=await fetch("/api/super-admin/invoices/bulk-update",{method:"PATCH",headers:{Authorization:`Bearer ${Z}`,"Content-Type":"application/json"},body:JSON.stringify({invoiceIds:C,action:re})});if(ee.ok){const ae=await ee.json();E.success(`${C.length} invoices updated successfully`),K(),Q(),S([]),F(!1)}else{const ae=await ee.json();throw new Error(ae.message||"Failed to update invoices")}}catch(Z){console.error("Error with bulk action:",Z),E.error("Failed to update invoices: "+Z.message)}},le=re=>{const Z={draft:{color:"bg-gray-100 text-gray-800",icon:Ue},sent:{color:"bg-blue-100 text-blue-800",icon:Vr},paid:{color:"bg-green-100 text-green-800",icon:we},overdue:{color:"bg-red-100 text-red-800",icon:Ct},cancelled:{color:"bg-gray-100 text-gray-800",icon:ze}},ee=Z[re]||Z.draft,ae=ee.icon;return e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${ee.color}`,children:[e.jsx(ae,{className:"w-3 h-3 mr-1"}),re.toUpperCase()]})},ue=re=>{const Z={pending:{color:"bg-yellow-100 text-yellow-800",icon:Te},partial:{color:"bg-orange-100 text-orange-800",icon:ha},paid:{color:"bg-green-100 text-green-800",icon:we},failed:{color:"bg-red-100 text-red-800",icon:ze},refunded:{color:"bg-purple-100 text-purple-800",icon:Lt}},ee=Z[re]||Z.pending,ae=ee.icon;return e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${ee.color}`,children:[e.jsx(ae,{className:"w-3 h-3 mr-1"}),re.toUpperCase()]})},be=(re,Z="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:Z}).format(re),H=re=>new Date(re).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),De=re=>{const Z=new Date,ee=new Date(re),ae=Z-ee,xe=Math.ceil(ae/(1e3*60*60*24));return xe>0?xe:0};return e.jsx("div",{className:`min-h-screen ${t==="dark"?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:`text-3xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Invoice Center"}),e.jsx("p",{className:`mt-2 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Manage invoices, payments, and billing operations"})]}),e.jsxs("button",{onClick:()=>g(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[e.jsx(Pe,{className:"w-4 h-4 mr-2"}),"Generate Invoice"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} overflow-hidden shadow rounded-lg`,children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Ue,{className:"h-6 w-6 text-gray-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"} truncate`,children:"Total Invoices"}),e.jsx("dd",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:q.total})]})})]})})}),e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} overflow-hidden shadow rounded-lg`,children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(we,{className:"h-6 w-6 text-green-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"} truncate`,children:"Paid"}),e.jsx("dd",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:q.paid})]})})]})})}),e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} overflow-hidden shadow rounded-lg`,children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Te,{className:"h-6 w-6 text-yellow-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"} truncate`,children:"Pending"}),e.jsx("dd",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:q.pending})]})})]})})}),e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} overflow-hidden shadow rounded-lg`,children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Ct,{className:"h-6 w-6 text-red-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"} truncate`,children:"Overdue"}),e.jsx("dd",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:q.overdue})]})})]})})})]}),e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} shadow rounded-lg mb-6`,children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:`text-lg font-medium mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Revenue Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Total Invoiced"}),e.jsx("div",{className:`text-2xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:be(q.totalAmount)})]}),e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Amount Collected"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:be(q.paidAmount)})]}),e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Outstanding"}),e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:be(q.pendingAmount)})]})]})]})}),e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} shadow rounded-lg mb-6`,children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t==="dark"?"text-gray-300":"text-gray-700"} mb-2`,children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(rt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",value:i,onChange:re=>l(re.target.value),placeholder:"Search invoices...",className:`pl-10 w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"}`})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t==="dark"?"text-gray-300":"text-gray-700"} mb-2`,children:"Status"}),e.jsxs("select",{value:c,onChange:re=>o(re.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"sent",children:"Sent"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"overdue",children:"Overdue"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t==="dark"?"text-gray-300":"text-gray-700"} mb-2`,children:"Payment Status"}),e.jsxs("select",{value:d,onChange:re=>x(re.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"",children:"All Payment Statuses"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"partial",children:"Partial"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"failed",children:"Failed"}),e.jsx("option",{value:"refunded",children:"Refunded"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t==="dark"?"text-gray-300":"text-gray-700"} mb-2`,children:"Date Range"}),e.jsxs("select",{value:m,onChange:re=>h(re.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"This Month"}),e.jsx("option",{value:"quarter",children:"This Quarter"}),e.jsx("option",{value:"year",children:"This Year"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:()=>{l(""),o(""),x(""),h("")},className:`px-4 py-2 border rounded-md text-sm font-medium ${t==="dark"?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Clear Filters"})})]})})}),e.jsxs("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} shadow rounded-lg overflow-hidden`,children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[e.jsxs("h3",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:["Invoices",C.length>0&&e.jsxs("span",{className:`ml-2 text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["(",C.length," selected)"]})]}),C.length>0&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>se("send"),className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded text-white bg-blue-600 hover:bg-blue-700",children:[e.jsx(Vr,{className:"w-3 h-3 mr-1"}),"Send Selected"]}),e.jsxs("button",{onClick:()=>se("mark-overdue"),className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded text-white bg-yellow-600 hover:bg-yellow-700",children:[e.jsx(Ct,{className:"w-3 h-3 mr-1"}),"Mark Overdue"]}),e.jsxs("button",{onClick:()=>{window.confirm(`Are you sure you want to cancel ${C.length} invoices?`)&&se("cancel")},className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded text-white bg-red-600 hover:bg-red-700",children:[e.jsx(ze,{className:"w-3 h-3 mr-1"}),"Cancel Selected"]})]})]}),n?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:t==="dark"?"bg-gray-700":"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${t==="dark"?"text-gray-300":"text-gray-500"}`,children:e.jsx("input",{type:"checkbox",checked:C.length===a.length&&a.length>0,onChange:re=>te(re.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"})}),e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${t==="dark"?"text-gray-300":"text-gray-500"}`,children:"Invoice"}),e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${t==="dark"?"text-gray-300":"text-gray-500"}`,children:"Client"}),e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${t==="dark"?"text-gray-300":"text-gray-500"}`,children:"Amount"}),e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${t==="dark"?"text-gray-300":"text-gray-500"}`,children:"Status"}),e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${t==="dark"?"text-gray-300":"text-gray-500"}`,children:"Payment"}),e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${t==="dark"?"text-gray-300":"text-gray-500"}`,children:"Due Date"}),e.jsx("th",{className:`px-6 py-3 text-right text-xs font-medium uppercase tracking-wider ${t==="dark"?"text-gray-300":"text-gray-500"}`,children:"Actions"})]})}),e.jsx("tbody",{className:`divide-y ${t==="dark"?"bg-gray-800 divide-gray-700":"bg-white divide-gray-200"}`,children:a.map(re=>{var ae,xe;const Z=De(re.dueDate),ee=Z>0&&re.status!=="paid";return e.jsxs("tr",{className:t==="dark"?"hover:bg-gray-700":"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",checked:C.includes(re._id),onChange:fe=>J(re._id,fe.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:re.invoiceNumber}),e.jsx("div",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:H(re.createdAt)})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:(ae=re.clientId)==null?void 0:ae.companyName}),e.jsx("div",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:(xe=re.clientId)==null?void 0:xe.email})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:be(re.amount.total,re.currency)}),re.paidAmount>0&&e.jsxs("div",{className:"text-sm text-green-600",children:[be(re.paidAmount,re.currency)," paid"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:le(re.status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ue(re.paymentStatus)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:`text-sm ${t==="dark"?"text-white":"text-gray-900"}`,children:H(re.dueDate)}),ee&&e.jsxs("div",{className:"text-sm text-red-600 flex items-center mt-1",children:[e.jsx(Ct,{className:"h-3 w-3 mr-1"}),Z," days overdue"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>{u(re),y(!0)},className:"text-indigo-600 hover:text-indigo-900",title:"View Details",children:e.jsx(Rt,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>P(re._id,re.invoiceNumber),className:"text-blue-600 hover:text-blue-900",title:"Download PDF",children:e.jsx(_t,{className:"h-4 w-4"})}),re.status==="draft"&&e.jsx("button",{onClick:()=>I(re,"sent"),className:"text-blue-600 hover:text-blue-900",title:"Send to Client",children:e.jsx(Vr,{className:"h-4 w-4"})}),re.paymentStatus!=="paid"&&re.status!=="cancelled"&&e.jsx("button",{onClick:()=>{u(re),w(!0)},className:"text-green-600 hover:text-green-900",title:"Mark as Paid",children:e.jsx(tt,{className:"h-4 w-4"})}),(re.status==="sent"||re.status==="overdue")&&re.paymentStatus!=="paid"&&e.jsx("button",{onClick:()=>A(re._id),className:"text-yellow-600 hover:text-yellow-900",title:"Send Reminder",children:e.jsx(ut,{className:"h-4 w-4"})}),re.status!=="paid"&&re.status!=="cancelled"&&e.jsx("button",{onClick:()=>{u(re),b(!0)},className:"text-purple-600 hover:text-purple-900",title:"Update Status",children:e.jsx(Lt,{className:"h-4 w-4"})}),(re.status==="draft"||re.status==="sent")&&e.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to cancel this invoice?")&&I(re,"cancelled")},className:"text-red-600 hover:text-red-900",title:"Cancel Invoice",children:e.jsx(ze,{className:"h-4 w-4"})})]})})]},re._id)})})]})}),M>1&&e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-between items-center",children:[e.jsxs("div",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["Page ",R," of ",M]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>T(re=>Math.max(re-1,1)),disabled:R===1,className:`px-3 py-1 rounded text-sm ${R===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700"}`,children:"Previous"}),e.jsx("button",{onClick:()=>T(re=>Math.min(re+1,M)),disabled:R===M,className:`px-3 py-1 rounded text-sm ${R===M?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700"}`,children:"Next"})]})]})]}),f&&e.jsx(o2,{isOpen:f,onClose:()=>g(!1),onGenerate:ne,theme:t}),j&&p&&e.jsx(d2,{isOpen:j,onClose:()=>y(!1),invoice:p,theme:t}),N&&p&&e.jsx(x2,{isOpen:N,onClose:()=>w(!1),onSubmit:re=>ie(p._id,re),invoice:p,theme:t}),D&&p&&e.jsx(m2,{isOpen:D,onClose:()=>b(!1),onUpdate:re=>O(p._id,re),invoice:p,theme:t})]})})},o2=({isOpen:t,onClose:a,onGenerate:s,theme:n})=>{const[r,i]=v.useState([]),[l,c]=v.useState(""),[o,d]=v.useState(!1);v.useEffect(()=>{t&&x()},[t]);const x=async()=>{try{const h=localStorage.getItem("token"),f=await fetch("/api/super-admin/subscriptions?status=active&limit=100",{headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"}});if(f.ok){const g=await f.json();i(g.data.subscriptions||[])}}catch(h){console.error("Error fetching subscriptions:",h)}},m=async h=>{h.preventDefault(),l&&(d(!0),await s(l),d(!1))};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:`${n==="dark"?"bg-gray-800":"bg-white"} rounded-lg p-6 w-full max-w-md`,children:[e.jsx("h3",{className:`text-lg font-medium mb-4 ${n==="dark"?"text-white":"text-gray-900"}`,children:"Generate Invoice"}),e.jsxs("form",{onSubmit:m,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${n==="dark"?"text-gray-300":"text-gray-700"}`,children:"Select Subscription"}),e.jsxs("select",{value:l,onChange:h=>c(h.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${n==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0,children:[e.jsx("option",{value:"",children:"Select a subscription"}),r.map(h=>{var f,g;return e.jsxs("option",{value:h._id,children:[(f=h.clientId)==null?void 0:f.companyName," - ",(g=h.packageId)==null?void 0:g.name," (",h.subscriptionCode,")"]},h._id)})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:a,className:`px-4 py-2 border rounded-md text-sm font-medium ${n==="dark"?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:o||!l,className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700 disabled:opacity-50",children:o?"Generating...":"Generate Invoice"})]})]})]})}):null},d2=({isOpen:t,onClose:a,invoice:s,theme:n})=>{var l,c,o,d,x,m,h,f,g;if(!t||!s)return null;const r=(p,u="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:u}).format(p),i=p=>new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:`${n==="dark"?"bg-gray-800":"bg-white"} rounded-lg p-6 w-full max-w-2xl max-h-screen overflow-y-auto`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:`text-xl font-medium ${n==="dark"?"text-white":"text-gray-900"}`,children:"Invoice Details"}),e.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600",children:e.jsx(ze,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:`font-medium mb-2 ${n==="dark"?"text-white":"text-gray-900"}`,children:"Invoice Information"}),e.jsxs("p",{className:`text-sm ${n==="dark"?"text-gray-300":"text-gray-600"}`,children:[e.jsx("strong",{children:"Invoice Number:"})," ",s.invoiceNumber]}),e.jsxs("p",{className:`text-sm ${n==="dark"?"text-gray-300":"text-gray-600"}`,children:[e.jsx("strong",{children:"Created:"})," ",i(s.createdAt)]}),e.jsxs("p",{className:`text-sm ${n==="dark"?"text-gray-300":"text-gray-600"}`,children:[e.jsx("strong",{children:"Due Date:"})," ",i(s.dueDate)]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:`font-medium mb-2 ${n==="dark"?"text-white":"text-gray-900"}`,children:"Client Information"}),e.jsxs("p",{className:`text-sm ${n==="dark"?"text-gray-300":"text-gray-600"}`,children:[e.jsx("strong",{children:"Company:"})," ",(l=s.clientId)==null?void 0:l.companyName]}),e.jsxs("p",{className:`text-sm ${n==="dark"?"text-gray-300":"text-gray-600"}`,children:[e.jsx("strong",{children:"Email:"})," ",(c=s.clientId)==null?void 0:c.email]}),e.jsxs("p",{className:`text-sm ${n==="dark"?"text-gray-300":"text-gray-600"}`,children:[e.jsx("strong",{children:"Contact:"})," ",(d=(o=s.clientId)==null?void 0:o.contactPerson)==null?void 0:d.name]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:`font-medium mb-3 ${n==="dark"?"text-white":"text-gray-900"}`,children:"Invoice Items"}),e.jsx("div",{className:`border rounded-lg ${n==="dark"?"border-gray-600":"border-gray-200"}`,children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:`${n==="dark"?"bg-gray-700":"bg-gray-50"}`,children:e.jsxs("tr",{children:[e.jsx("th",{className:`px-4 py-2 text-left text-sm font-medium ${n==="dark"?"text-gray-300":"text-gray-500"}`,children:"Description"}),e.jsx("th",{className:`px-4 py-2 text-right text-sm font-medium ${n==="dark"?"text-gray-300":"text-gray-500"}`,children:"Amount"})]})}),e.jsx("tbody",{children:(x=s.itemDetails)==null?void 0:x.map((p,u)=>e.jsxs("tr",{className:`border-t ${n==="dark"?"border-gray-600":"border-gray-200"}`,children:[e.jsx("td",{className:`px-4 py-2 text-sm ${n==="dark"?"text-gray-300":"text-gray-600"}`,children:p.description}),e.jsx("td",{className:`px-4 py-2 text-sm text-right ${n==="dark"?"text-gray-300":"text-gray-600"}`,children:r(p.total,s.currency)})]},u))})]})})]}),e.jsx("div",{className:`border-t pt-4 ${n==="dark"?"border-gray-600":"border-gray-200"}`,children:e.jsx("div",{className:"flex justify-end",children:e.jsxs("div",{className:"w-64",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:`text-sm ${n==="dark"?"text-gray-300":"text-gray-600"}`,children:"Subtotal:"}),e.jsx("span",{className:`text-sm ${n==="dark"?"text-gray-300":"text-gray-600"}`,children:r(((m=s.amount)==null?void 0:m.subtotal)||0,s.currency)})]}),((h=s.amount)==null?void 0:h.discount)>0&&e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:`text-sm ${n==="dark"?"text-gray-300":"text-gray-600"}`,children:"Discount:"}),e.jsxs("span",{className:"text-sm text-green-600",children:["-",r(s.amount.discount,s.currency)]})]}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:`text-sm ${n==="dark"?"text-gray-300":"text-gray-600"}`,children:"Tax:"}),e.jsx("span",{className:`text-sm ${n==="dark"?"text-gray-300":"text-gray-600"}`,children:r(((f=s.amount)==null?void 0:f.tax)||0,s.currency)})]}),e.jsxs("div",{className:`flex justify-between border-t pt-2 ${n==="dark"?"border-gray-600":"border-gray-200"}`,children:[e.jsx("span",{className:`font-medium ${n==="dark"?"text-white":"text-gray-900"}`,children:"Total:"}),e.jsx("span",{className:`font-medium ${n==="dark"?"text-white":"text-gray-900"}`,children:r(((g=s.amount)==null?void 0:g.total)||0,s.currency)})]})]})})})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx("button",{onClick:a,className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700",children:"Close"})})]})})},x2=({isOpen:t,onClose:a,onSubmit:s,invoice:n,theme:r})=>{var x;const[i,l]=v.useState({amount:((x=n==null?void 0:n.amount)==null?void 0:x.total)||0,paymentMethod:"card",paymentDate:new Date().toISOString().split("T")[0],transactionId:"",notes:""}),[c,o]=v.useState(!1),d=async m=>{m.preventDefault(),o(!0),await s(i),o(!1)};return!t||!n?null:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:`${r==="dark"?"bg-gray-800":"bg-white"} rounded-lg p-6 w-full max-w-md`,children:[e.jsx("h3",{className:`text-lg font-medium mb-4 ${r==="dark"?"text-white":"text-gray-900"}`,children:"Mark Invoice as Paid"}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${r==="dark"?"text-gray-300":"text-gray-700"}`,children:"Payment Amount"}),e.jsx("input",{type:"number",step:"0.01",value:i.amount,onChange:m=>l({...i,amount:parseFloat(m.target.value)}),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${r==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${r==="dark"?"text-gray-300":"text-gray-700"}`,children:"Payment Method"}),e.jsxs("select",{value:i.paymentMethod,onChange:m=>l({...i,paymentMethod:m.target.value}),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${r==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0,children:[e.jsx("option",{value:"card",children:"Credit Card"}),e.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),e.jsx("option",{value:"digital_wallet",children:"Digital Wallet"}),e.jsx("option",{value:"check",children:"Check"}),e.jsx("option",{value:"cash",children:"Cash"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${r==="dark"?"text-gray-300":"text-gray-700"}`,children:"Payment Date"}),e.jsx("input",{type:"date",value:i.paymentDate,onChange:m=>l({...i,paymentDate:m.target.value}),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${r==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${r==="dark"?"text-gray-300":"text-gray-700"}`,children:"Transaction ID"}),e.jsx("input",{type:"text",value:i.transactionId,onChange:m=>l({...i,transactionId:m.target.value}),placeholder:"Optional transaction reference",className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${r==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${r==="dark"?"text-gray-300":"text-gray-700"}`,children:"Notes"}),e.jsx("textarea",{value:i.notes,onChange:m=>l({...i,notes:m.target.value}),rows:3,placeholder:"Optional payment notes",className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${r==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"}`})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:a,className:`px-4 py-2 border rounded-md text-sm font-medium ${r==="dark"?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:c,className:"px-4 py-2 bg-green-600 text-white rounded-md text-sm font-medium hover:bg-green-700 disabled:opacity-50",children:c?"Processing...":"Mark as Paid"})]})]})]})})},m2=({isOpen:t,onClose:a,onUpdate:s,invoice:n,theme:r})=>{var h;const[i,l]=v.useState((n==null?void 0:n.status)||""),[c,o]=v.useState(!1),x=[{value:"draft",label:"Draft",description:"Invoice is being prepared"},{value:"sent",label:"Sent",description:"Invoice sent to client"},{value:"overdue",label:"Overdue",description:"Invoice is past due date"},{value:"cancelled",label:"Cancelled",description:"Invoice has been cancelled"}].filter(f=>f.value!==(n==null?void 0:n.status)&&f.value!=="paid"),m=async f=>{f.preventDefault(),!(!i||i===(n==null?void 0:n.status))&&(o(!0),await s(i),o(!1))};return!t||!n?null:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:`${r==="dark"?"bg-gray-800":"bg-white"} rounded-lg p-6 w-full max-w-md`,children:[e.jsx("h3",{className:`text-lg font-medium mb-4 ${r==="dark"?"text-white":"text-gray-900"}`,children:"Update Invoice Status"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:`text-sm ${r==="dark"?"text-gray-300":"text-gray-600"} mb-2`,children:[e.jsx("strong",{children:"Invoice:"})," ",n.invoiceNumber]}),e.jsxs("div",{className:`text-sm ${r==="dark"?"text-gray-300":"text-gray-600"} mb-4`,children:[e.jsx("strong",{children:"Current Status:"})," ",e.jsx("span",{className:"capitalize",children:n.status})]})]}),e.jsxs("form",{onSubmit:m,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${r==="dark"?"text-gray-300":"text-gray-700"}`,children:"New Status"}),e.jsxs("select",{value:i,onChange:f=>l(f.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${r==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,required:!0,children:[e.jsx("option",{value:"",children:"Select new status"}),x.map(f=>e.jsx("option",{value:f.value,children:f.label},f.value))]}),i&&e.jsx("div",{className:`text-xs mt-1 ${r==="dark"?"text-gray-400":"text-gray-500"}`,children:(h=x.find(f=>f.value===i))==null?void 0:h.description})]}),e.jsxs("div",{className:`mb-4 p-3 rounded-md ${r==="dark"?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("h4",{className:`text-sm font-medium mb-2 ${r==="dark"?"text-white":"text-gray-900"}`,children:"Status Change Effects:"}),e.jsxs("ul",{className:`text-xs space-y-1 ${r==="dark"?"text-gray-300":"text-gray-600"}`,children:[i==="sent"&&e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"â€¢ Invoice will be marked as sent to client"}),e.jsx("li",{children:"â€¢ Client will receive email notification"}),e.jsx("li",{children:"â€¢ Payment reminders can be sent"})]}),i==="cancelled"&&e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"â€¢ Invoice will be cancelled and cannot be paid"}),e.jsx("li",{children:"â€¢ This action cannot be undone"}),e.jsx("li",{children:"â€¢ Client will be notified of cancellation"})]}),i==="overdue"&&e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"â€¢ Invoice will be marked as overdue"}),e.jsx("li",{children:"â€¢ Late fees may apply"}),e.jsx("li",{children:"â€¢ Escalated reminders will be sent"})]}),i==="draft"&&e.jsxs(e.Fragment,{children:[e.jsx("li",{children:"â€¢ Invoice will be moved back to draft"}),e.jsx("li",{children:"â€¢ Can be edited before sending"}),e.jsx("li",{children:"â€¢ Client notifications will stop"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:a,className:`px-4 py-2 border rounded-md text-sm font-medium ${r==="dark"?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:c||!i||i===(n==null?void 0:n.status),className:"px-4 py-2 bg-indigo-600 text-white rounded-md text-sm font-medium hover:bg-indigo-700 disabled:opacity-50",children:c?"Updating...":"Update Status"})]})]})]})})},h2=()=>{const{theme:t}=ot(),[a,s]=v.useState(!0),[n,r]=v.useState("month"),[i,l]=v.useState({overview:{totalRevenue:0,revenueGrowth:0,totalInvoices:0,invoiceGrowth:0,averageInvoiceValue:0,activeSubscriptions:0,pendingRevenue:0,pendingInvoices:0},trends:[],packagePerformance:[],clientRevenue:[],paymentMethodStats:[],upcomingRenewals:{renewals:[],summary:{totalValue:0,count:0}},overdueInvoices:{summary:{totalOverdue:0,count:0},byAge:[]}});v.useEffect(()=>{c()},[n]);const c=async()=>{try{s(!0);const f=await(await fetch(`/api/super-admin/revenue/dashboard?period=${n}`)).json();f.success&&l(f.data)}catch(h){console.error("Error fetching dashboard data:",h),E.error("Failed to fetch dashboard data")}finally{s(!1)}},o=(h,f="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:f,minimumFractionDigits:0,maximumFractionDigits:0}).format(h),d=h=>`${h>=0?"+":""}${h.toFixed(1)}%`,x=h=>h>=0?Ss:C0,m=h=>h>=0?"text-green-600":"text-red-600";return e.jsx("div",{className:`min-h-screen ${t==="dark"?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:`text-3xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Revenue Dashboard"}),e.jsx("p",{className:`mt-2 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Comprehensive revenue analytics and financial insights"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("select",{value:n,onChange:h=>r(h.target.value),className:`px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"week",children:"This Week"}),e.jsx("option",{value:"month",children:"This Month"}),e.jsx("option",{value:"quarter",children:"This Quarter"}),e.jsx("option",{value:"year",children:"This Year"})]}),e.jsxs("button",{onClick:c,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(Lt,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]})}),a?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} overflow-hidden shadow rounded-lg`,children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(tt,{className:"h-6 w-6 text-green-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"} truncate`,children:"Total Revenue"}),e.jsx("dd",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:o(i.overview.totalRevenue)}),e.jsxs("dd",{className:`flex items-center text-sm ${m(i.overview.revenueGrowth)}`,children:[Hs.createElement(x(i.overview.revenueGrowth),{className:"h-4 w-4 mr-1"}),d(i.overview.revenueGrowth)]})]})})]})})}),e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} overflow-hidden shadow rounded-lg`,children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ha,{className:"h-6 w-6 text-blue-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"} truncate`,children:"Total Invoices"}),e.jsx("dd",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:i.overview.totalInvoices}),e.jsxs("dd",{className:`flex items-center text-sm ${m(i.overview.invoiceGrowth)}`,children:[Hs.createElement(x(i.overview.invoiceGrowth),{className:"h-4 w-4 mr-1"}),d(i.overview.invoiceGrowth)]})]})})]})})}),e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} overflow-hidden shadow rounded-lg`,children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Re,{className:"h-6 w-6 text-purple-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"} truncate`,children:"Active Subscriptions"}),e.jsx("dd",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:i.overview.activeSubscriptions}),e.jsxs("dd",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["Avg: ",o(i.overview.averageInvoiceValue)]})]})})]})})}),e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} overflow-hidden shadow rounded-lg`,children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Te,{className:"h-6 w-6 text-yellow-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"} truncate`,children:"Pending Revenue"}),e.jsx("dd",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:o(i.overview.pendingRevenue)}),e.jsxs("dd",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:[i.overview.pendingInvoices," invoices"]})]})})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} shadow rounded-lg p-6`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:"Revenue Trends"}),e.jsx(Zs,{className:"h-5 w-5 text-gray-400"})]}),e.jsx("div",{className:"h-64 flex items-center justify-center",children:e.jsxs("div",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["Chart visualization would go here",e.jsx("br",{}),"(Revenue trends over time)"]})})]}),e.jsxs("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} shadow rounded-lg p-6`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:"Package Performance"}),e.jsx(uo,{className:"h-5 w-5 text-gray-400"})]}),e.jsx("div",{className:"space-y-3",children:i.packagePerformance.slice(0,5).map((h,f)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Tt,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-white":"text-gray-900"}`,children:h.packageName})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:o(h.totalRevenue)}),e.jsxs("div",{className:`text-xs ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:[h.totalInvoices," invoices"]})]})]},h._id))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} shadow rounded-lg p-6`,children:[e.jsx("h3",{className:`text-lg font-medium mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Top Clients by Revenue"}),e.jsx("div",{className:"space-y-3",children:i.clientRevenue.slice(0,5).map((h,f)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium ${t==="dark"?"bg-gray-600 text-white":"bg-gray-200 text-gray-900"}`,children:f+1}),e.jsxs("div",{className:"ml-3",children:[e.jsx("div",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:h.clientName}),e.jsxs("div",{className:`text-xs ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:[h.totalInvoices," invoices"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:o(h.totalRevenue)}),e.jsxs("div",{className:`text-xs ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["Avg: ",o(h.averageInvoiceValue)]})]})]},h._id))})]}),e.jsxs("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} shadow rounded-lg p-6`,children:[e.jsx("h3",{className:`text-lg font-medium mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Payment Methods"}),e.jsx("div",{className:"space-y-3",children:i.paymentMethodStats.map((h,f)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ha,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-white":"text-gray-900"}`,children:h._id.replace("_"," ").toUpperCase()})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:o(h.totalAmount)}),e.jsxs("div",{className:`text-xs ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:[h.count," payments"]})]})]},h._id))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} shadow rounded-lg p-6`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:"Upcoming Renewals"}),e.jsxs("div",{className:"flex items-center text-sm text-green-600",children:[e.jsx(Fe,{className:"h-4 w-4 mr-1"}),o(i.upcomingRenewals.summary.totalValue)]})]}),e.jsx("div",{className:"space-y-3",children:i.upcomingRenewals.renewals.slice(0,5).map(h=>{var f,g;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:(f=h.clientId)==null?void 0:f.companyName}),e.jsx("div",{className:`text-xs ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:(g=h.packageId)==null?void 0:g.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:o(h.basePrice)}),e.jsx("div",{className:"text-xs text-yellow-600",children:new Date(h.endDate).toLocaleDateString()})]})]},h._id)})}),i.upcomingRenewals.summary.count>5&&e.jsxs("div",{className:`mt-3 text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["+",i.upcomingRenewals.summary.count-5," more renewals"]})]}),e.jsxs("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} shadow rounded-lg p-6`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:"Overdue Invoices"}),e.jsxs("div",{className:"flex items-center text-sm text-red-600",children:[e.jsx(Ct,{className:"h-4 w-4 mr-1"}),o(i.overdueInvoices.summary.totalOverdue)]})]}),i.overdueInvoices.summary.count>0?e.jsx("div",{className:"space-y-3",children:i.overdueInvoices.byAge.map((h,f)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ct,{className:"h-4 w-4 text-red-400 mr-2"}),e.jsx("span",{className:`text-sm ${t==="dark"?"text-white":"text-gray-900"}`,children:h._id==="365+"?"365+ days":`${h._id}-${h._id+29} days`})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:o(h.totalAmount)}),e.jsxs("div",{className:`text-xs ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:[h.count," invoices"]})]})]},f))}):e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(we,{className:"h-12 w-12 text-green-400 mx-auto mb-2"}),e.jsx("div",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"No overdue invoices"})]})})]})]})]})]})})},u2=()=>{const{theme:t}=ot(),[a,s]=v.useState([]),[n,r]=v.useState(!0),[i,l]=v.useState("all"),[c,o]=v.useState("all"),[d,x]=v.useState(!1),[m,h]=v.useState({renewalDays:10,overdueEnabled:!0,paymentFailureEnabled:!0,emailNotifications:!0,dashboardNotifications:!0}),[f,g]=v.useState({total:0,critical:0,warning:0,info:0,resolved:0});v.useEffect(()=>{p(),u()},[i,c]);const p=async()=>{try{r(!0);let F=[{id:"1",type:"subscription_expiring",priority:"high",title:"Subscription Expiring Soon",message:"TechCorp subscription expires in 3 days",clientName:"TechCorp Solutions",subscriptionCode:"SUB0001",daysRemaining:3,amount:299,createdAt:new Date(Date.now()-2*60*60*1e3),status:"active",actionRequired:!0},{id:"2",type:"invoice_overdue",priority:"critical",title:"Invoice Overdue",message:"Invoice INV-2024-0156 is 5 days overdue",clientName:"Manufacturing Co",invoiceNumber:"INV-2024-0156",daysOverdue:5,amount:1250,createdAt:new Date(Date.now()-5*24*60*60*1e3),status:"active",actionRequired:!0},{id:"3",type:"payment_failed",priority:"high",title:"Payment Failed",message:"Automatic payment failed for HealthCare Plus",clientName:"HealthCare Plus",paymentId:"PAY-2024-00234",amount:599,createdAt:new Date(Date.now()-1*60*60*1e3),status:"active",actionRequired:!0},{id:"4",type:"renewal_success",priority:"info",title:"Subscription Renewed",message:"Green Energy Corp subscription renewed successfully",clientName:"Green Energy Corp",subscriptionCode:"SUB0045",amount:799,createdAt:new Date(Date.now()-30*60*1e3),status:"resolved",actionRequired:!1},{id:"5",type:"subscription_expiring",priority:"medium",title:"Subscription Expiring",message:"StartupHub subscription expires in 7 days",clientName:"StartupHub",subscriptionCode:"SUB0023",daysRemaining:7,amount:149,createdAt:new Date(Date.now()-4*60*60*1e3),status:"active",actionRequired:!0}];i!=="all"&&(F=F.filter(R=>R.status===i)),c!=="all"&&(F=F.filter(R=>R.priority===c)),s(F)}catch(k){console.error("Error fetching alerts:",k),E.error("Failed to fetch alerts")}finally{r(!1)}},u=async()=>{try{g({total:12,critical:2,warning:4,info:3,resolved:3})}catch(k){console.error("Error fetching stats:",k)}},j=async k=>{try{s(F=>F.map(R=>R.id===k?{...R,status:"resolved"}:R)),E.success("Alert resolved successfully")}catch{E.error("Failed to resolve alert")}},y=async k=>{try{s(F=>F.filter(R=>R.id!==k)),E.success("Alert dismissed")}catch{E.error("Failed to dismiss alert")}},N=async k=>{try{E.success(`Reminder sent to ${k.clientName}`)}catch{E.error("Failed to send reminder")}},w=k=>({subscription_expiring:Fe,invoice_overdue:Ct,payment_failed:ze,renewal_success:we,payment_success:we,subscription_cancelled:ze})[k]||Ps,D=k=>{const F={critical:"text-red-500 bg-red-100",high:"text-orange-500 bg-orange-100",medium:"text-yellow-500 bg-yellow-100",low:"text-blue-500 bg-blue-100",info:"text-green-500 bg-green-100"};return F[k]||F.info},b=k=>{const F={critical:"bg-red-100 text-red-800",high:"bg-orange-100 text-orange-800",medium:"bg-yellow-100 text-yellow-800",low:"bg-blue-100 text-blue-800",info:"bg-green-100 text-green-800"};return e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${F[k]}`,children:k.toUpperCase()})},C=k=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(k),S=k=>{const R=new Date-new Date(k),T=Math.floor(R/6e4),M=Math.floor(R/36e5),X=Math.floor(R/864e5);return X>0?`${X} day${X>1?"s":""} ago`:M>0?`${M} hour${M>1?"s":""} ago`:`${T} minute${T>1?"s":""} ago`};return e.jsx("div",{className:`min-h-screen ${t==="dark"?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:`text-3xl font-bold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Billing Alerts"}),e.jsx("p",{className:`mt-2 ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Monitor subscription renewals, overdue invoices, and payment notifications"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:()=>x(!0),className:`inline-flex items-center px-4 py-2 border rounded-md text-sm font-medium ${t==="dark"?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(Rs,{className:"w-4 h-4 mr-2"}),"Settings"]}),e.jsxs("button",{onClick:p,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700",children:[e.jsx(Lt,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6 mb-8",children:[e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} overflow-hidden shadow rounded-lg`,children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Ps,{className:"h-6 w-6 text-gray-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"} truncate`,children:"Total Alerts"}),e.jsx("dd",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:f.total})]})})]})})}),e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} overflow-hidden shadow rounded-lg`,children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Qr,{className:"h-6 w-6 text-red-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"} truncate`,children:"Critical"}),e.jsx("dd",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:f.critical})]})})]})})}),e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} overflow-hidden shadow rounded-lg`,children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Ct,{className:"h-6 w-6 text-orange-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"} truncate`,children:"Warning"}),e.jsx("dd",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:f.warning})]})})]})})}),e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} overflow-hidden shadow rounded-lg`,children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(Te,{className:"h-6 w-6 text-blue-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"} truncate`,children:"Info"}),e.jsx("dd",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:f.info})]})})]})})}),e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} overflow-hidden shadow rounded-lg`,children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(we,{className:"h-6 w-6 text-green-400"})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:`text-sm font-medium ${t==="dark"?"text-gray-400":"text-gray-500"} truncate`,children:"Resolved"}),e.jsx("dd",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:f.resolved})]})})]})})})]}),e.jsx("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} shadow rounded-lg mb-6`,children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t==="dark"?"text-gray-300":"text-gray-700"} mb-2`,children:"Status Filter"}),e.jsxs("select",{value:i,onChange:k=>l(k.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"all",children:"All Alerts"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"resolved",children:"Resolved"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium ${t==="dark"?"text-gray-300":"text-gray-700"} mb-2`,children:"Priority Filter"}),e.jsxs("select",{value:c,onChange:k=>o(k.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"}`,children:[e.jsx("option",{value:"all",children:"All Priorities"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"info",children:"Info"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:()=>{l("all"),o("all")},className:`px-4 py-2 border rounded-md text-sm font-medium ${t==="dark"?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Clear Filters"})})]})})}),e.jsxs("div",{className:`${t==="dark"?"bg-gray-800":"bg-white"} shadow rounded-lg overflow-hidden`,children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:"Recent Alerts"})}),n?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):a.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(we,{className:"h-12 w-12 text-green-400 mb-4"}),e.jsx("h3",{className:`text-lg font-medium ${t==="dark"?"text-white":"text-gray-900"} mb-2`,children:"No alerts found"}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"All systems are running smoothly"})]}):e.jsx("div",{className:"divide-y divide-gray-200",children:a.map(k=>{const F=w(k.type),R=D(k.priority);return e.jsx("div",{className:`p-6 ${t==="dark"?"hover:bg-gray-700":"hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:`flex-shrink-0 p-2 rounded-full ${R}`,children:e.jsx(F,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h4",{className:`text-sm font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:k.title}),b(k.priority)]}),e.jsx("p",{className:`text-sm ${t==="dark"?"text-gray-300":"text-gray-600"} mb-2`,children:k.message}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(Re,{className:"h-3 w-3 mr-1"}),k.clientName]}),k.amount&&e.jsxs("span",{className:"flex items-center",children:[e.jsx(tt,{className:"h-3 w-3 mr-1"}),C(k.amount)]}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(Te,{className:"h-3 w-3 mr-1"}),S(k.createdAt)]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[k.actionRequired&&k.status==="active"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>N(k),className:"text-blue-600 hover:text-blue-900",title:"Send Reminder",children:e.jsx(ut,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>j(k.id),className:"text-green-600 hover:text-green-900",title:"Mark as Resolved",children:e.jsx(we,{className:"h-4 w-4"})})]}),e.jsx("button",{onClick:()=>y(k.id),className:"text-gray-400 hover:text-gray-600",title:"Dismiss",children:e.jsx(ze,{className:"h-4 w-4"})})]})]})},k.id)})})]})]})})},Yc=()=>{Ke();const{user:t}=kt(),[a,s]=v.useState(!0),[n,r]=v.useState([]),[i,l]=v.useState(!1),[c,o]=v.useState(null),[d,x]=v.useState({name:"",code:"",startTime:"09:00",endTime:"18:00",breakDuration:60,breakStartTime:"13:00",isNightShift:!1,applicableDays:[1,2,3,4,5],location:"",department:"",description:""}),m=[{value:0,label:"Sunday"},{value:1,label:"Monday"},{value:2,label:"Tuesday"},{value:3,label:"Wednesday"},{value:4,label:"Thursday"},{value:5,label:"Friday"},{value:6,label:"Saturday"}];v.useEffect(()=>{h()},[]);const h=async()=>{try{s(!0);const y=await Y.get("/work-schedule/shifts");r(y.data.data||[])}catch{E.error("Failed to fetch shift templates")}finally{s(!1)}},f=y=>{const{name:N,value:w,type:D,checked:b}=y.target;x(C=>({...C,[N]:D==="checkbox"?b:w}))},g=y=>{x(N=>{const w=[...N.applicableDays];return w.includes(y)?{...N,applicableDays:w.filter(D=>D!==y)}:{...N,applicableDays:[...w,y]}})},p=async y=>{var N,w;y.preventDefault();try{c?(await Y.put(`/work-schedule/shifts/${c._id}`,d),E.success("Shift template updated successfully")):(await Y.post("/work-schedule/shifts",d),E.success("Shift template created successfully")),l(!1),o(null),x({name:"",code:"",startTime:"09:00",endTime:"18:00",breakDuration:60,breakStartTime:"13:00",isNightShift:!1,applicableDays:[1,2,3,4,5],location:"",department:"",description:""}),h()}catch(D){E.error(((w=(N=D.response)==null?void 0:N.data)==null?void 0:w.message)||"Failed to save shift template")}},u=y=>{var N;o(y),x({name:y.name,code:y.code,startTime:y.startTime,endTime:y.endTime,breakDuration:y.breakDuration||60,breakStartTime:y.breakStartTime||"13:00",isNightShift:y.isNightShift||!1,applicableDays:y.applicableDays||[1,2,3,4,5],location:y.location||"",department:((N=y.department)==null?void 0:N._id)||"",description:y.description||""}),l(!0)},j=async y=>{var N,w;if(window.confirm("Are you sure you want to delete this shift template?"))try{await Y.delete(`/work-schedule/shifts/${y}`),E.success("Shift template deleted successfully"),h()}catch(D){E.error(((w=(N=D.response)==null?void 0:N.data)==null?void 0:w.message)||"Failed to delete shift template")}};return a?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-primary-600 border-t-transparent rounded-full animate-spin mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-400",children:"Loading shift templates..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Shift Templates"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage work shift patterns"})]}),(t.role==="admin"||t.role==="hr")&&e.jsxs("button",{onClick:()=>{o(null),l(!0)},className:"btn-primary flex items-center space-x-2",children:[e.jsx(Pe,{size:20}),e.jsx("span",{children:"Add Shift Template"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(y=>e.jsxs("div",{className:"card p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:y.name}),e.jsxs("p",{className:"text-sm text-gray-400",children:["Code: ",y.code]})]}),(t.role==="admin"||t.role==="hr")&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>u(y),className:"p-1 hover:bg-dark-800 rounded",children:e.jsx(fs,{size:16,className:"text-blue-400"})}),e.jsx("button",{onClick:()=>j(y._id),className:"p-1 hover:bg-dark-800 rounded",children:e.jsx(ct,{size:16,className:"text-red-400"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx(Te,{size:16,className:"text-gray-400"}),e.jsxs("span",{className:"text-gray-300",children:[y.startTime," - ",y.endTime]})]}),y.location&&e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx(ea,{size:16,className:"text-gray-400"}),e.jsx("span",{className:"text-gray-300",children:y.location})]}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Break: ",y.breakDuration," min"]}),y.isNightShift&&e.jsx("span",{className:"inline-block px-2 py-1 text-xs bg-purple-500/20 text-purple-400 rounded",children:"Night Shift"})]})]},y._id))}),i&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-800 rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b border-dark-700",children:e.jsx("h2",{className:"text-xl font-bold text-white",children:c?"Edit Shift Template":"Add Shift Template"})}),e.jsxs("form",{onSubmit:p,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Name *"}),e.jsx("input",{type:"text",name:"name",value:d.name,onChange:f,className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Code *"}),e.jsx("input",{type:"text",name:"code",value:d.code,onChange:f,className:"input-field",required:!0,style:{textTransform:"uppercase"}})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Time *"}),e.jsx("input",{type:"time",name:"startTime",value:d.startTime,onChange:f,className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"End Time *"}),e.jsx("input",{type:"time",name:"endTime",value:d.endTime,onChange:f,className:"input-field",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Break Duration (minutes)"}),e.jsx("input",{type:"number",name:"breakDuration",value:d.breakDuration,onChange:f,className:"input-field",min:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Break Start Time"}),e.jsx("input",{type:"time",name:"breakStartTime",value:d.breakStartTime,onChange:f,className:"input-field"})]})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",name:"isNightShift",checked:d.isNightShift,onChange:f,className:"rounded"}),e.jsx("span",{className:"text-sm text-gray-300",children:"Night Shift"})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Applicable Days"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:m.map(y=>e.jsx("button",{type:"button",onClick:()=>g(y.value),className:`px-3 py-1 rounded text-sm ${d.applicableDays.includes(y.value)?"bg-primary-600 text-white":"bg-dark-700 text-gray-300 hover:bg-dark-600"}`,children:y.label},y.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Location"}),e.jsx("input",{type:"text",name:"location",value:d.location,onChange:f,className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Description"}),e.jsx("textarea",{name:"description",value:d.description,onChange:f,className:"input-field",rows:"3"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-dark-700",children:[e.jsx("button",{type:"button",onClick:()=>{l(!1),o(null)},className:"btn-secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn-primary",children:c?"Update":"Create"})]})]})]})})]})},p2=({onClose:t,onSuccess:a})=>{const[s,n]=v.useState(null),[r,i]=v.useState(!1),[l,c]=v.useState(null),o=x=>{const m=x.target.files[0];if(m){if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"].includes(m.type)){E.error("Please select an Excel (.xlsx, .xls) or CSV file");return}n(m)}},d=async()=>{var x,m;if(!s){E.error("Please select a file");return}try{i(!0);const h=new FormData;h.append("file",s);const f=await Y.post("/work-schedule/rosters/upload",h,{headers:{"Content-Type":"multipart/form-data"}});c(f.data.data),E.success(f.data.message),a&&a()}catch(h){E.error(((m=(x=h.response)==null?void 0:x.data)==null?void 0:m.message)||"Failed to upload file")}finally{i(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-dark-800 rounded-lg max-w-2xl w-full",children:[e.jsxs("div",{className:"p-6 border-b border-dark-700 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Bulk Upload Roster"}),e.jsx("button",{onClick:t,className:"p-1 hover:bg-dark-700 rounded",children:e.jsx(Ee,{size:20,className:"text-gray-400"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select Excel/CSV File"}),e.jsxs("div",{className:"border-2 border-dashed border-dark-700 rounded-lg p-6 text-center",children:[e.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:o,className:"hidden",id:"file-upload"}),e.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer flex flex-col items-center space-y-2",children:[e.jsx(la,{size:48,className:"text-gray-400"}),e.jsx("span",{className:"text-gray-300",children:s?s.name:"Click to select file"}),e.jsx("span",{className:"text-sm text-gray-400",children:"Excel (.xlsx, .xls) or CSV files only"})]})]})]}),e.jsxs("div",{className:"bg-dark-900 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-400 mb-2",children:"Expected columns:"}),e.jsxs("ul",{className:"text-xs text-gray-500 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Employee Email (required)"}),e.jsx("li",{children:"Shift Code (required)"}),e.jsx("li",{children:"Effective Date (required)"}),e.jsx("li",{children:"Location (required)"}),e.jsx("li",{children:"End Date (optional)"})]})]}),l&&e.jsxs("div",{className:"bg-dark-900 p-4 rounded-lg",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-300 mb-2",children:["Upload Results: ",l.success.length," successful, ",l.errors.length," errors"]}),l.errors.length>0&&e.jsx("div",{className:"mt-2 max-h-40 overflow-y-auto",children:l.errors.map((x,m)=>e.jsxs("div",{className:"text-xs text-red-400",children:["Row ",x.row,": ",x.error]},m))})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{onClick:t,className:"btn-secondary",children:"Cancel"}),e.jsxs("button",{onClick:d,disabled:!s||r,className:"btn-primary flex items-center space-x-2",children:[e.jsx(es,{size:20}),e.jsx("span",{children:r?"Uploading...":"Upload"})]})]})]})]})})},Xc=()=>{const{user:t}=kt(),[a,s]=v.useState(!0),[n,r]=v.useState([]),[i,l]=v.useState(!1),[c,o]=v.useState({startDate:"",endDate:"",location:"",status:"active"});v.useEffect(()=>{d()},[c]);const d=async()=>{try{s(!0);const x=new URLSearchParams;c.startDate&&x.append("startDate",c.startDate),c.endDate&&x.append("endDate",c.endDate),c.location&&x.append("location",c.location),c.status&&x.append("status",c.status);const m=await Y.get(`/work-schedule/rosters?${x.toString()}`);r(m.data.data||[])}catch{E.error("Failed to fetch roster assignments")}finally{s(!1)}};return a?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-primary-600 border-t-transparent rounded-full animate-spin mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-400",children:"Loading roster assignments..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Roster Management"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Manage employee work schedules"})]}),(t.role==="admin"||t.role==="hr")&&e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:()=>l(!0),className:"btn-secondary flex items-center space-x-2",children:[e.jsx(es,{size:20}),e.jsx("span",{children:"Bulk Upload"})]}),e.jsxs("button",{className:"btn-primary flex items-center space-x-2",children:[e.jsx(Pe,{size:20}),e.jsx("span",{children:"Add Assignment"})]})]})]}),e.jsx("div",{className:"card p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:c.startDate,onChange:x=>o({...c,startDate:x.target.value}),className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:c.endDate,onChange:x=>o({...c,endDate:x.target.value}),className:"input-field"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Location"}),e.jsx("input",{type:"text",value:c.location,onChange:x=>o({...c,location:x.target.value}),className:"input-field",placeholder:"Filter by location"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status"}),e.jsxs("select",{value:c.status,onChange:x=>o({...c,status:x.target.value}),className:"input-field",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})]})}),e.jsxs("div",{className:"card overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-dark-700",children:[e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-300",children:"Employee"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-300",children:"Shift"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-300",children:"Location"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-300",children:"Effective Date"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-300",children:"End Date"}),e.jsx("th",{className:"text-left p-4 text-sm font-medium text-gray-300",children:"Status"})]})}),e.jsx("tbody",{children:n.map(x=>{var m,h;return e.jsxs("tr",{className:"border-b border-dark-700 hover:bg-dark-800",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ft,{size:16,className:"text-gray-400"}),e.jsx("span",{className:"text-white",children:x.employeeName||`${(m=x.employeeId)==null?void 0:m.firstName} ${(h=x.employeeId)==null?void 0:h.lastName}`})]})}),e.jsx("td",{className:"p-4",children:x.shiftTemplateId?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Te,{size:16,className:"text-gray-400"}),e.jsxs("span",{className:"text-gray-300",children:[x.shiftTemplateId.name," (",x.shiftTemplateId.code,")"]})]}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"p-4 text-gray-300",children:x.location}),e.jsx("td",{className:"p-4 text-gray-300",children:new Date(x.effectiveDate).toLocaleDateString()}),e.jsx("td",{className:"p-4 text-gray-300",children:x.endDate?new Date(x.endDate).toLocaleDateString():"-"}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded ${x.status==="active"?"bg-green-500/20 text-green-400":x.status==="inactive"?"bg-gray-500/20 text-gray-400":"bg-red-500/20 text-red-400"}`,children:x.status})})]},x._id)})})]}),n.length===0&&e.jsx("div",{className:"p-8 text-center text-gray-400",children:"No roster assignments found"})]}),i&&e.jsx(p2,{onClose:()=>l(!1),onSuccess:()=>{l(!1),d()}})]})},Kc=()=>{const[t,a]=v.useState(new Date),[s,n]=v.useState([]),[r,i]=v.useState(!0),[l,c]=v.useState(null);v.useEffect(()=>{o()},[t]);const o=async()=>{try{i(!0);const p=new Date(t.getFullYear(),t.getMonth(),1),u=new Date(t.getFullYear(),t.getMonth()+1,0),j=await Y.get(`/work-schedule/calendar?startDate=${p.toISOString()}&endDate=${u.toISOString()}`);n(j.data.data||[])}catch{E.error("Failed to fetch roster calendar")}finally{i(!1)}},d=()=>{const p=t.getFullYear(),u=t.getMonth(),j=new Date(p,u,1),N=new Date(p,u+1,0).getDate(),w=j.getDay(),D=[];for(let b=0;b<w;b++)D.push(null);for(let b=1;b<=N;b++)D.push(new Date(p,u,b));return D},x=p=>p?s.filter(u=>{const j=new Date(u.effectiveDate),y=u.endDate?new Date(u.endDate):new Date("2099-12-31");return p>=j&&p<=y}):[],m=p=>{a(u=>{const j=new Date(u);return j.setMonth(u.getMonth()+p),j})},h=d(),f=["January","February","March","April","May","June","July","August","September","October","November","December"],g=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Roster Calendar"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"View work schedules by date"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>m(-1),className:"p-2 hover:bg-dark-800 rounded-lg",children:e.jsx(vi,{size:20,className:"text-gray-400"})}),e.jsxs("h2",{className:"text-lg font-semibold text-white min-w-[200px] text-center",children:[f[t.getMonth()]," ",t.getFullYear()]}),e.jsx("button",{onClick:()=>m(1),className:"p-2 hover:bg-dark-800 rounded-lg",children:e.jsx(jr,{size:20,className:"text-gray-400"})})]})]}),e.jsx("div",{className:"card overflow-x-auto",children:e.jsxs("div",{className:"min-w-full",children:[e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:g.map(p=>e.jsx("div",{className:"p-2 text-center text-sm font-medium text-gray-400",children:p},p))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:h.map((p,u)=>{const j=x(p),y=p&&p.toDateString()===new Date().toDateString(),N=p&&l&&p.toDateString()===l.toDateString();return e.jsx("div",{onClick:()=>p&&c(p),className:`min-h-[100px] p-2 border border-dark-700 rounded ${p?y?"bg-primary-500/10 border-primary-500":N?"bg-blue-500/10 border-blue-500":"bg-dark-800 hover:bg-dark-700 cursor-pointer":"bg-dark-900"}`,children:p&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`text-sm font-medium mb-1 ${y?"text-primary-400":"text-gray-300"}`,children:p.getDate()}),e.jsxs("div",{className:"space-y-1",children:[j.slice(0,2).map(w=>{var D,b,C;return e.jsxs("div",{className:"text-xs bg-dark-700 p-1 rounded truncate",title:`${w.employeeName} - ${(D=w.shiftTemplateId)==null?void 0:D.name}`,children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ft,{size:10,className:"text-gray-400"}),e.jsx("span",{className:"text-gray-300 truncate",children:(b=w.employeeName)==null?void 0:b.split(" ")[0]})]}),e.jsxs("div",{className:"flex items-center space-x-1 mt-0.5",children:[e.jsx(Te,{size:10,className:"text-gray-400"}),e.jsx("span",{className:"text-gray-400 text-[10px]",children:(C=w.shiftTemplateId)==null?void 0:C.code})]})]},w._id)}),j.length>2&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",j.length-2," more"]})]})]})},u)})})]})}),l&&e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4",children:["Assignments for ",l.toLocaleDateString()]}),e.jsx("div",{className:"space-y-2",children:x(l).map(p=>{var u,j,y,N;return e.jsx("div",{className:"p-3 bg-dark-900 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:p.employeeName}),e.jsxs("p",{className:"text-sm text-gray-400",children:[(u=p.shiftTemplateId)==null?void 0:u.name," (",(j=p.shiftTemplateId)==null?void 0:j.code,")"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-300",children:p.location}),e.jsxs("p",{className:"text-xs text-gray-400",children:[(y=p.shiftTemplateId)==null?void 0:y.startTime," - ",(N=p.shiftTemplateId)==null?void 0:N.endTime]})]})]})},p._id)})})]})]})},Jc=()=>{const t=Ke(),{user:a}=kt(),[s,n]=v.useState(!1),[r,i]=v.useState([]),[l,c]=v.useState({requestedShiftTemplateId:"",requestedDate:"",reason:""});v.useEffect(()=>{o()},[]);const o=async()=>{try{const m=await Y.get("/work-schedule/shifts?isActive=true");i(m.data.data||[])}catch{E.error("Failed to fetch shift templates")}},d=m=>{c({...l,[m.target.name]:m.target.value})},x=async m=>{var h,f;if(m.preventDefault(),!l.requestedShiftTemplateId||!l.requestedDate||!l.reason){E.error("Please fill all required fields");return}try{n(!0),await Y.post("/work-schedule/change-requests",l),E.success("Roster change request submitted successfully"),t("/work-schedule/change-requests")}catch(g){E.error(((f=(h=g.response)==null?void 0:h.data)==null?void 0:f.message)||"Failed to submit request")}finally{n(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>t("/work-schedule"),className:"p-2 hover:bg-dark-800 rounded-lg",children:e.jsx(wt,{size:20,className:"text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Request Roster Change"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Submit a request to change your work schedule"})]})]}),e.jsx("form",{onSubmit:x,className:"max-w-2xl",children:e.jsxs("div",{className:"card space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Requested Shift Template *"}),e.jsxs("select",{name:"requestedShiftTemplateId",value:l.requestedShiftTemplateId,onChange:d,className:"input-field",required:!0,children:[e.jsx("option",{value:"",children:"Select shift template"}),r.map(m=>e.jsxs("option",{value:m._id,children:[m.name," (",m.code,") - ",m.startTime," to ",m.endTime]},m._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Requested Date *"}),e.jsx("input",{type:"date",name:"requestedDate",value:l.requestedDate,onChange:d,className:"input-field",min:new Date().toISOString().split("T")[0],required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Reason *"}),e.jsx("textarea",{name:"reason",value:l.reason,onChange:d,className:"input-field",rows:"4",placeholder:"Please provide a reason for the roster change request...",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-dark-700",children:[e.jsx("button",{type:"button",onClick:()=>t("/work-schedule"),className:"btn-secondary",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:s,className:"btn-primary flex items-center space-x-2",children:[e.jsx(Te,{size:20}),e.jsx("span",{children:s?"Submitting...":"Submit Request"})]})]})]})})]})},Qc=()=>{const[t,a]=v.useState(!0),[s,n]=v.useState([]),[r,i]=v.useState(!1),[l,c]=v.useState(null),[o,d]=v.useState({leaveType:"",minBalance:0,maxDaysPerRequest:0,maxDaysPerYear:0,calculationMethod:"daily_rate",calculationRate:0,isActive:!0,eligibilityCriteria:{minServiceMonths:0,allowedDepartments:[],allowedDesignations:[]}});v.useEffect(()=>{x()},[]);const x=async()=>{try{a(!0);const u=await Y.get("/leave-encashment/rules");n(u.data.data||[])}catch{E.error("Failed to fetch encashment rules")}finally{a(!1)}},m=u=>{const{name:j,value:y,type:N,checked:w}=u.target;if(j.startsWith("eligibilityCriteria.")){const D=j.split(".")[1];d(b=>({...b,eligibilityCriteria:{...b.eligibilityCriteria,[D]:N==="number"?parseFloat(y)||0:y}}))}else d(D=>({...D,[j]:N==="checkbox"?w:N==="number"?parseFloat(y)||0:y}))},h=async u=>{var j,y;u.preventDefault();try{l?(await Y.put(`/leave-encashment/rules/${l._id}`,o),E.success("Encashment rule updated successfully")):(await Y.post("/leave-encashment/rules",o),E.success("Encashment rule created successfully")),i(!1),c(null),p(),x()}catch(N){E.error(((y=(j=N.response)==null?void 0:j.data)==null?void 0:y.message)||"Failed to save encashment rule")}},f=u=>{c(u),d({leaveType:u.leaveType||"",minBalance:u.minBalance||0,maxDaysPerRequest:u.maxDaysPerRequest||0,maxDaysPerYear:u.maxDaysPerYear||0,calculationMethod:u.calculationMethod||"daily_rate",calculationRate:u.calculationRate||0,isActive:u.isActive!==void 0?u.isActive:!0,eligibilityCriteria:u.eligibilityCriteria||{minServiceMonths:0,allowedDepartments:[],allowedDesignations:[]}}),i(!0)},g=async u=>{if(window.confirm("Are you sure you want to delete this rule?"))try{await Y.delete(`/leave-encashment/rules/${u}`),E.success("Encashment rule deleted successfully"),x()}catch{E.error("Failed to delete encashment rule")}},p=()=>{d({leaveType:"",minBalance:0,maxDaysPerRequest:0,maxDaysPerYear:0,calculationMethod:"daily_rate",calculationRate:0,isActive:!0,eligibilityCriteria:{minServiceMonths:0,allowedDepartments:[],allowedDesignations:[]}})};return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-400",children:"Loading..."})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Leave Encashment Rules"}),e.jsxs("button",{onClick:()=>{p(),c(null),i(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(Pe,{size:20}),"Add Rule"]})]}),e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Leave Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Min Balance"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Max Days/Request"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Calculation Method"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:s.map(u=>e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:u.leaveType}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:u.minBalance}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:u.maxDaysPerRequest}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:u.calculationMethod}),e.jsx("td",{className:"px-4 py-3",children:u.isActive?e.jsxs("span",{className:"flex items-center gap-1 text-green-400",children:[e.jsx(we,{size:16}),"Active"]}):e.jsxs("span",{className:"flex items-center gap-1 text-red-400",children:[e.jsx(ze,{size:16}),"Inactive"]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>f(u),className:"p-1 text-blue-400 hover:text-blue-300",children:e.jsx(fs,{size:16})}),e.jsx("button",{onClick:()=>g(u._id),className:"p-1 text-red-400 hover:text-red-300",children:e.jsx(ct,{size:16})})]})})]},u._id))})]})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:l?"Edit Encashment Rule":"Create Encashment Rule"}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Leave Type"}),e.jsx("input",{type:"text",name:"leaveType",value:o.leaveType,onChange:m,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Min Balance"}),e.jsx("input",{type:"number",name:"minBalance",value:o.minBalance,onChange:m,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Max Days/Request"}),e.jsx("input",{type:"number",name:"maxDaysPerRequest",value:o.maxDaysPerRequest,onChange:m,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Max Days/Year"}),e.jsx("input",{type:"number",name:"maxDaysPerYear",value:o.maxDaysPerYear,onChange:m,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Calculation Method"}),e.jsxs("select",{name:"calculationMethod",value:o.calculationMethod,onChange:m,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"daily_rate",children:"Daily Rate"}),e.jsx("option",{value:"monthly_salary",children:"Monthly Salary"}),e.jsx("option",{value:"fixed_amount",children:"Fixed Amount"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Calculation Rate"}),e.jsx("input",{type:"number",name:"calculationRate",value:o.calculationRate,onChange:m,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Min Service Months"}),e.jsx("input",{type:"number",name:"eligibilityCriteria.minServiceMonths",value:o.eligibilityCriteria.minServiceMonths,onChange:m,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"isActive",checked:o.isActive,onChange:m,className:"w-4 h-4"}),e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Active"})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>{i(!1),c(null),p()},className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:l?"Update":"Create"})]})]})]})})]})},Zc=()=>{var j;const[t,a]=v.useState(!0),[s,n]=v.useState([]),[r,i]=v.useState(!1),[l,c]=v.useState(null),[o,d]=v.useState(!1),[x,m]=v.useState({leaveType:"",numberOfDays:0,reason:""});v.useEffect(()=>{h()},[]);const h=async()=>{try{a(!0);const y=await Y.get("/leave-encashment/requests");n(y.data.data||[])}catch{E.error("Failed to fetch encashment requests")}finally{a(!1)}},f=y=>{const{name:N,value:w,type:D}=y.target;m(b=>({...b,[N]:D==="number"?parseFloat(w)||0:w}))},g=async()=>{var y,N;if(!x.leaveType||!x.numberOfDays){E.error("Please select leave type and enter number of days");return}try{d(!0);const w=await Y.post("/leave-encashment/check-eligibility",{leaveType:x.leaveType,numberOfDays:x.numberOfDays});c(w.data.data),E.success("Eligibility checked successfully")}catch(w){E.error(((N=(y=w.response)==null?void 0:y.data)==null?void 0:N.message)||"Failed to check eligibility"),c(null)}finally{d(!1)}},p=async y=>{var N,w;if(y.preventDefault(),!l||!l.isEligible){E.error("Please check eligibility first");return}try{await Y.post("/leave-encashment/requests",x),E.success("Encashment request created successfully"),i(!1),c(null),m({leaveType:"",numberOfDays:0,reason:""}),h()}catch(D){E.error(((w=(N=D.response)==null?void 0:N.data)==null?void 0:w.message)||"Failed to create encashment request")}},u=y=>{const N={pending:{color:"yellow",icon:Te},approved:{color:"green",icon:we},rejected:{color:"red",icon:ze},processed:{color:"blue",icon:tt}},w=N[y]||N.pending,D=w.icon;return e.jsxs("span",{className:`flex items-center gap-1 text-${w.color}-400`,children:[e.jsx(D,{size:16}),y.charAt(0).toUpperCase()+y.slice(1)]})};return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-400",children:"Loading..."})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Leave Encashment Requests"}),e.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(Pe,{size:20}),"New Request"]})]}),e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Leave Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Days"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Request Date"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:s.map(y=>{var N;return e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:y.leaveType}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:y.numberOfDays}),e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-300",children:["â‚¹",((N=y.encashmentAmount)==null?void 0:N.toLocaleString())||"0"]}),e.jsx("td",{className:"px-4 py-3",children:u(y.status)}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:new Date(y.createdAt).toLocaleDateString()})]},y._id)})})]})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Create Encashment Request"}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Leave Type"}),e.jsx("input",{type:"text",name:"leaveType",value:x.leaveType,onChange:f,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",placeholder:"e.g., Personal Leave"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Number of Days"}),e.jsx("input",{type:"number",name:"numberOfDays",value:x.numberOfDays,onChange:f,required:!0,min:"1",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsx("div",{children:e.jsx("button",{type:"button",onClick:g,disabled:o,className:"w-full px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 disabled:opacity-50",children:o?"Checking...":"Check Eligibility"})}),l&&e.jsxs("div",{className:`p-4 rounded-lg ${l.isEligible?"bg-green-900/30":"bg-red-900/30"}`,children:[e.jsx("div",{className:"text-sm font-medium text-white mb-2",children:l.isEligible?"âœ“ Eligible":"âœ— Not Eligible"}),l.isEligible&&e.jsxs("div",{className:"space-y-1 text-sm text-gray-300",children:[e.jsxs("div",{children:["Estimated Amount: â‚¹",((j=l.estimatedAmount)==null?void 0:j.toLocaleString())||"0"]}),e.jsxs("div",{children:["Available Balance: ",l.availableBalance||0," days"]})]}),l.reason&&e.jsx("div",{className:"text-sm text-gray-400 mt-2",children:l.reason})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Reason"}),e.jsx("textarea",{name:"reason",value:x.reason,onChange:f,required:!0,rows:3,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>{i(!1),c(null),m({leaveType:"",numberOfDays:0,reason:""})},className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!l||!l.isEligible,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:"Submit Request"})]})]})]})})]})},eo=()=>{const[t,a]=v.useState(!0),[s,n]=v.useState([]),[r,i]=v.useState({status:"",leaveType:"",startDate:"",endDate:""});v.useEffect(()=>{l()},[r]);const l=async()=>{try{a(!0);const x={};r.status&&(x.status=r.status),r.leaveType&&(x.leaveType=r.leaveType),r.startDate&&(x.startDate=r.startDate),r.endDate&&(x.endDate=r.endDate);const m=await Y.get("/leave-encashment/requests",{params:x});n(m.data.data||[])}catch{E.error("Failed to fetch encashment history")}finally{a(!1)}},c=x=>{const{name:m,value:h}=x.target;i(f=>({...f,[m]:h}))},o=x=>{const m={pending:{color:"yellow",icon:Te},approved:{color:"green",icon:we},rejected:{color:"red",icon:ze},processed:{color:"blue",icon:tt}},h=m[x]||m.pending,f=h.icon;return e.jsxs("span",{className:`flex items-center gap-1 text-${h.color}-400`,children:[e.jsx(f,{size:16}),x.charAt(0).toUpperCase()+x.slice(1)]})},d=s.filter(x=>x.status==="processed").reduce((x,m)=>x+(m.encashmentAmount||0),0);return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-400",children:"Loading..."})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Encashment History"}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[e.jsx(tt,{size:20}),e.jsxs("span",{className:"text-lg font-semibold",children:["Total Processed: â‚¹",d.toLocaleString()]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(xs,{size:20,className:"text-gray-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Filters"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Status"}),e.jsxs("select",{name:"status",value:r.status,onChange:c,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"processed",children:"Processed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Leave Type"}),e.jsx("input",{type:"text",name:"leaveType",value:r.leaveType,onChange:c,placeholder:"Filter by leave type",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",name:"startDate",value:r.startDate,onChange:c,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"End Date"}),e.jsx("input",{type:"date",name:"endDate",value:r.endDate,onChange:c,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Leave Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Days"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Amount"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Request Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Processed Date"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:s.map(x=>{var m;return e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:x.leaveType}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:x.numberOfDays}),e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-300",children:["â‚¹",((m=x.encashmentAmount)==null?void 0:m.toLocaleString())||"0"]}),e.jsx("td",{className:"px-4 py-3",children:o(x.status)}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:new Date(x.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:x.processedDate?new Date(x.processedDate).toLocaleDateString():"-"})]},x._id)})})]}),s.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-400",children:"No encashment requests found"})]})]})},f2=()=>{const[t,a]=v.useState(!1),[s,n]=v.useState("entitlement"),[r,i]=v.useState({year:new Date().getFullYear(),department:"",employee:"",leaveType:""}),[l,c]=v.useState(null),o=m=>{const{name:h,value:f}=m.target;i(g=>({...g,[h]:f}))},d=async()=>{try{a(!0);const m={...r};let h="";switch(s){case"entitlement":h="/reports/leave/entitlement";break;case"balance":h="/reports/leave/balance";break;case"utilization":h="/reports/leave/utilization";break;default:h="/reports/leave/entitlement"}const f=await Y.get(h,{params:m});c(f.data),E.success("Report generated successfully")}catch{E.error("Failed to generate report")}finally{a(!1)}},x=async m=>{try{const h={...r,export:m};let f="";switch(s){case"entitlement":f="/reports/leave/entitlement";break;case"balance":f="/reports/leave/balance";break;case"utilization":f="/reports/leave/utilization";break;default:f="/reports/leave/entitlement"}const g=await Y.get(f,{params:h,responseType:"blob"}),p=window.URL.createObjectURL(new Blob([g.data])),u=document.createElement("a");u.href=p,u.setAttribute("download",`leave-report-${s}-${Date.now()}.${m}`),document.body.appendChild(u),u.click(),u.remove(),E.success(`Report exported as ${m.toUpperCase()}`)}catch{E.error("Failed to export report")}};return v.useEffect(()=>{l===null&&d()},[s]),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Leave Reports"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>x("excel"),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[e.jsx(_t,{size:20}),"Export Excel"]}),e.jsxs("button",{onClick:()=>x("pdf"),className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:[e.jsx(_t,{size:20}),"Export PDF"]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(xs,{size:20,className:"text-gray-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Report Configuration"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Report Type"}),e.jsxs("select",{value:s,onChange:m=>{n(m.target.value),c(null)},className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"entitlement",children:"Leave Entitlement"}),e.jsx("option",{value:"balance",children:"Leave Balance"}),e.jsx("option",{value:"utilization",children:"Leave Utilization"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Year"}),e.jsx("input",{type:"number",name:"year",value:r.year,onChange:o,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Department"}),e.jsx("input",{type:"text",name:"department",value:r.department,onChange:o,placeholder:"Filter by department",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Leave Type"}),e.jsx("input",{type:"text",name:"leaveType",value:r.leaveType,onChange:o,placeholder:"Filter by leave type",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]})]}),e.jsx("button",{onClick:d,disabled:t,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:t?"Generating...":"Generate Report"})]}),l&&e.jsxs("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ue,{size:20,className:"text-gray-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Report Results"})]})}),e.jsx("div",{className:"p-4",children:l.data&&Array.isArray(l.data)?e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Employee"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Leave Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Entitled"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Used"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Balance"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:l.data.map((m,h)=>{var f;return e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:m.employeeName||((f=m.employee)==null?void 0:f.name)||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:m.leaveType||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:m.entitled||m.total||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:m.used||m.consumed||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:m.balance||m.available||"-"})]},h)})})]}):e.jsx("div",{className:"text-center py-8 text-gray-400",children:"No data available"})})]})]})},to=()=>{const[t,a]=v.useState(!1),[s,n]=v.useState("summary"),[r,i]=v.useState({startDate:new Date(new Date().getFullYear(),0,1).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0],department:"",employee:""}),[l,c]=v.useState(null),o=m=>{const{name:h,value:f}=m.target;i(g=>({...g,[h]:f}))},d=async()=>{try{a(!0);const m={...r};let h="";switch(s){case"summary":h="/reports/attendance/summary";break;case"exception":h="/reports/attendance/exception";break;default:h="/reports/attendance/summary"}const f=await Y.get(h,{params:m});c(f.data),E.success("Report generated successfully")}catch{E.error("Failed to generate report")}finally{a(!1)}},x=async m=>{try{const h={...r,export:m};let f="";switch(s){case"summary":f="/reports/attendance/summary";break;case"exception":f="/reports/attendance/exception";break;default:f="/reports/attendance/summary"}const g=await Y.get(f,{params:h,responseType:"blob"}),p=window.URL.createObjectURL(new Blob([g.data])),u=document.createElement("a");u.href=p,u.setAttribute("download",`attendance-report-${s}-${Date.now()}.${m}`),document.body.appendChild(u),u.click(),u.remove(),E.success(`Report exported as ${m.toUpperCase()}`)}catch{E.error("Failed to export report")}};return v.useEffect(()=>{l===null&&d()},[s]),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Attendance Reports"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>x("excel"),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[e.jsx(_t,{size:20}),"Export Excel"]}),e.jsxs("button",{onClick:()=>x("pdf"),className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:[e.jsx(_t,{size:20}),"Export PDF"]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(xs,{size:20,className:"text-gray-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Report Configuration"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Report Type"}),e.jsxs("select",{value:s,onChange:m=>{n(m.target.value),c(null)},className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"summary",children:"Attendance Summary"}),e.jsx("option",{value:"exception",children:"Exception Report"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",name:"startDate",value:r.startDate,onChange:o,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"End Date"}),e.jsx("input",{type:"date",name:"endDate",value:r.endDate,onChange:o,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Department"}),e.jsx("input",{type:"text",name:"department",value:r.department,onChange:o,placeholder:"Filter by department",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]})]}),e.jsx("button",{onClick:d,disabled:t,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:t?"Generating...":"Generate Report"})]}),l&&e.jsxs("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ue,{size:20,className:"text-gray-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Report Results"})]})}),e.jsx("div",{className:"p-4",children:l.data&&Array.isArray(l.data)?e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Employee"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Check In"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Check Out"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Hours"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:l.data.map((m,h)=>{var f;return e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:m.employeeName||((f=m.employee)==null?void 0:f.name)||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:m.date?new Date(m.date).toLocaleDateString():"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:m.checkIn||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:m.checkOut||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:m.hours||m.workingHours||"-"}),e.jsx("td",{className:"px-4 py-3",children:m.status==="exception"?e.jsxs("span",{className:"flex items-center gap-1 text-yellow-400",children:[e.jsx(st,{size:16}),"Exception"]}):e.jsx("span",{className:"text-green-400",children:"Normal"})})]},h)})})]}):e.jsx("div",{className:"text-center py-8 text-gray-400",children:"No data available"})})]})]})},g2=()=>{const[t,a]=v.useState(!1),[s,n]=v.useState({year:new Date().getFullYear(),department:"",complianceType:""}),[r,i]=v.useState(null),l=d=>{const{name:x,value:m}=d.target;n(h=>({...h,[x]:m}))},c=async()=>{try{a(!0);const d=await Y.get("/reports/compliance/status",{params:s});i(d.data),E.success("Report generated successfully")}catch{E.error("Failed to generate report")}finally{a(!1)}},o=async d=>{try{const x={...s,export:d},m=await Y.get("/reports/compliance/status",{params:x,responseType:"blob"}),h=window.URL.createObjectURL(new Blob([m.data])),f=document.createElement("a");f.href=h,f.setAttribute("download",`compliance-report-${Date.now()}.${d}`),document.body.appendChild(f),f.click(),f.remove(),E.success(`Report exported as ${d.toUpperCase()}`)}catch{E.error("Failed to export report")}};return v.useEffect(()=>{c()},[]),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Compliance Reports"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>o("excel"),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[e.jsx(_t,{size:20}),"Export Excel"]}),e.jsxs("button",{onClick:()=>o("pdf"),className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:[e.jsx(_t,{size:20}),"Export PDF"]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(xs,{size:20,className:"text-gray-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Report Configuration"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Year"}),e.jsx("input",{type:"number",name:"year",value:s.year,onChange:l,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Department"}),e.jsx("input",{type:"text",name:"department",value:s.department,onChange:l,placeholder:"Filter by department",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Compliance Type"}),e.jsx("input",{type:"text",name:"complianceType",value:s.complianceType,onChange:l,placeholder:"Filter by type",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]})]}),e.jsx("button",{onClick:c,disabled:t,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:t?"Generating...":"Generate Report"})]}),r&&e.jsxs("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-700",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bt,{size:20,className:"text-gray-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Compliance Status"})]})}),e.jsx("div",{className:"p-4",children:r.data&&Array.isArray(r.data)?e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Employee"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Compliance Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Due Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Completion Date"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:r.data.map((d,x)=>{var m;return e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:d.employeeName||((m=d.employee)==null?void 0:m.name)||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:d.complianceType||"-"}),e.jsx("td",{className:"px-4 py-3",children:d.status==="compliant"?e.jsx("span",{className:"text-green-400",children:"Compliant"}):e.jsx("span",{className:"text-red-400",children:"Non-Compliant"})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:d.dueDate?new Date(d.dueDate).toLocaleDateString():"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:d.completionDate?new Date(d.completionDate).toLocaleDateString():"-"})]},x)})})]}):e.jsx("div",{className:"text-center py-8 text-gray-400",children:"No data available"})})]})]})},y2=()=>{const[t,a]=v.useState(!0),[s,n]=v.useState([]),[r,i]=v.useState(!1),[l,c]=v.useState(null),[o,d]=v.useState({reportType:"",frequency:"daily",recipients:[],format:"excel",isActive:!0});v.useEffect(()=>{x()},[]);const x=async()=>{try{a(!0);const p=await Y.get("/reports/scheduled");n(p.data.data||[])}catch{E.error("Failed to fetch scheduled reports")}finally{a(!1)}},m=p=>{const{name:u,value:j,type:y,checked:N}=p.target;d(w=>({...w,[u]:y==="checkbox"?N:j}))},h=async p=>{var u,j;p.preventDefault();try{l?(await Y.put(`/reports/scheduled/${l._id}`,o),E.success("Scheduled report updated successfully")):(await Y.post("/reports/scheduled",o),E.success("Scheduled report created successfully")),i(!1),c(null),g(),x()}catch(y){E.error(((j=(u=y.response)==null?void 0:u.data)==null?void 0:j.message)||"Failed to save scheduled report")}},f=async p=>{if(window.confirm("Are you sure you want to delete this scheduled report?"))try{await Y.delete(`/reports/scheduled/${p}`),E.success("Scheduled report deleted successfully"),x()}catch{E.error("Failed to delete scheduled report")}},g=()=>{d({reportType:"",frequency:"daily",recipients:[],format:"excel",isActive:!0})};return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-400",children:"Loading..."})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Scheduled Reports"}),e.jsxs("button",{onClick:()=>{g(),c(null),i(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(Pe,{size:20}),"Schedule Report"]})]}),e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Report Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Frequency"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Format"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Recipients"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:s.map(p=>{var u;return e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:p.reportType}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Te,{size:16}),p.frequency]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:p.format}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ut,{size:16}),((u=p.recipients)==null?void 0:u.length)||0," recipients"]})}),e.jsx("td",{className:"px-4 py-3",children:p.isActive?e.jsx("span",{className:"text-green-400",children:"Active"}):e.jsx("span",{className:"text-red-400",children:"Inactive"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{c(p),d({reportType:p.reportType||"",frequency:p.frequency||"daily",recipients:p.recipients||[],format:p.format||"excel",isActive:p.isActive!==void 0?p.isActive:!0}),i(!0)},className:"p-1 text-blue-400 hover:text-blue-300",children:e.jsx(fs,{size:16})}),e.jsx("button",{onClick:()=>f(p._id),className:"p-1 text-red-400 hover:text-red-300",children:e.jsx(ct,{size:16})})]})})]},p._id)})})]})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:l?"Edit Scheduled Report":"Schedule Report"}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Report Type"}),e.jsxs("select",{name:"reportType",value:o.reportType,onChange:m,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"Select report type"}),e.jsx("option",{value:"leave_entitlement",children:"Leave Entitlement"}),e.jsx("option",{value:"leave_balance",children:"Leave Balance"}),e.jsx("option",{value:"attendance_summary",children:"Attendance Summary"}),e.jsx("option",{value:"compliance_status",children:"Compliance Status"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Frequency"}),e.jsxs("select",{name:"frequency",value:o.frequency,onChange:m,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Format"}),e.jsxs("select",{name:"format",value:o.format,onChange:m,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"excel",children:"Excel"}),e.jsx("option",{value:"pdf",children:"PDF"}),e.jsx("option",{value:"csv",children:"CSV"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"isActive",checked:o.isActive,onChange:m,className:"w-4 h-4"}),e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Active"})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>{i(!1),c(null),g()},className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:l?"Update":"Create"})]})]})]})})]})},so=()=>{var x,m,h,f;const[t,a]=v.useState(!0),[s,n]=v.useState("attendance"),[r,i]=v.useState({startDate:new Date(new Date().getFullYear(),0,1).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0],groupBy:"month"}),[l,c]=v.useState(null),o=g=>{const{name:p,value:u}=g.target;i(j=>({...j,[p]:u}))},d=v.useCallback(async()=>{try{a(!0);const g={...r};let p="";switch(s){case"attendance":p="/reports/analytics/attendance";break;case"leave":p="/reports/analytics/leave";break;case"compliance":p="/reports/analytics/compliance";break;default:p="/reports/analytics/attendance"}const u=await Y.get(p,{params:g});c(u.data)}catch{E.error("Failed to fetch analytics")}finally{a(!1)}},[s,r]);return v.useEffect(()=>{d()},[d]),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Analytics Dashboard"}),e.jsx("div",{className:"flex items-center gap-2 text-gray-400",children:e.jsx(Zs,{size:24})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Analytics Type"}),e.jsxs("select",{value:s,onChange:g=>n(g.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"attendance",children:"Attendance Trends"}),e.jsx("option",{value:"leave",children:"Leave Patterns"}),e.jsx("option",{value:"compliance",children:"Compliance Metrics"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",name:"startDate",value:r.startDate,onChange:o,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"End Date"}),e.jsx("input",{type:"date",name:"endDate",value:r.endDate,onChange:o,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Group By"}),e.jsxs("select",{name:"groupBy",value:r.groupBy,onChange:o,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"day",children:"Day"}),e.jsx("option",{value:"week",children:"Week"}),e.jsx("option",{value:"month",children:"Month"}),e.jsx("option",{value:"year",children:"Year"})]})]})]}),l&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Total Records"}),e.jsx(Ss,{size:20,className:"text-blue-400"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:((x=l.summary)==null?void 0:x.totalRecords)||0})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Average"}),e.jsx(Zs,{size:20,className:"text-green-400"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:((m=l.summary)==null?void 0:m.average)||0})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Maximum"}),e.jsx(Fe,{size:20,className:"text-yellow-400"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:((h=l.summary)==null?void 0:h.maximum)||0})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Minimum"}),e.jsx(Re,{size:20,className:"text-red-400"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:((f=l.summary)==null?void 0:f.minimum)||0})]})]}),l&&Array.isArray(l.trends)&&l.trends.length>0&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Trend Analysis"}),e.jsx("div",{className:"space-y-4",children:l.trends.map((g,p)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-700 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:g.period||g.label}),e.jsx("div",{className:"text-gray-400 text-sm",children:g.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold text-white",children:g.value}),g.change&&e.jsxs("div",{className:`text-sm ${g.change>0?"text-green-400":"text-red-400"}`,children:[g.change>0?"+":"",g.change,"%"]})]})]},p))})]}),t&&e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-400",children:"Loading analytics..."})})]})},ao=()=>{const[t,a]=v.useState(!0),[s,n]=v.useState([]),[r,i]=v.useState(!1),[l,c]=v.useState(null),[o,d]=v.useState({leaveType:"",accrualFrequency:"monthly",accrualAmount:0,yearlyAllocation:0,maxAccumulation:0,carryForwardEnabled:!1,maxCarryForward:0,proRataEnabled:!0,proRataCalculation:"calendar-days",isActive:!0});v.useEffect(()=>{x()},[]);const x=async()=>{try{a(!0);const p=await Y.get("/leave-accrual/policies");n(p.data.data||[])}catch{E.error("Failed to fetch accrual policies")}finally{a(!1)}},m=p=>{const{name:u,value:j,type:y,checked:N}=p.target;d(w=>({...w,[u]:y==="checkbox"?N:y==="number"?parseFloat(j)||0:j}))},h=async p=>{var u,j;p.preventDefault();try{l?(await Y.put(`/leave-accrual/policies/${l._id}`,o),E.success("Accrual policy updated successfully")):(await Y.post("/leave-accrual/policies",o),E.success("Accrual policy created successfully")),i(!1),c(null),g(),x()}catch(y){E.error(((j=(u=y.response)==null?void 0:u.data)==null?void 0:j.message)||"Failed to save accrual policy")}},f=async p=>{if(window.confirm("Are you sure you want to delete this policy?"))try{await Y.delete(`/leave-accrual/policies/${p}`),E.success("Accrual policy deleted successfully"),x()}catch{E.error("Failed to delete accrual policy")}},g=()=>{d({leaveType:"",accrualFrequency:"monthly",accrualAmount:0,yearlyAllocation:0,maxAccumulation:0,carryForwardEnabled:!1,maxCarryForward:0,proRataEnabled:!0,proRataCalculation:"calendar-days",isActive:!0})};return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-400",children:"Loading..."})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Leave Accrual Policies"}),e.jsxs("button",{onClick:()=>{g(),c(null),i(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(Pe,{size:20}),"Add Policy"]})]}),e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Leave Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Frequency"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Accrual Rate"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Max Accrual"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Carry Forward"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:s.map(p=>e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:p.leaveType}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300 capitalize",children:p.accrualFrequency}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:p.accrualAmount||0}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:p.maxAccumulation||"Unlimited"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:p.carryForwardEnabled?`Yes (Max: ${p.maxCarryForward||0})`:"No"}),e.jsx("td",{className:"px-4 py-3",children:p.isActive?e.jsxs("span",{className:"flex items-center gap-1 text-green-400",children:[e.jsx(we,{size:16}),"Active"]}):e.jsxs("span",{className:"flex items-center gap-1 text-red-400",children:[e.jsx(ze,{size:16}),"Inactive"]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{c(p),d({leaveType:p.leaveType||"",accrualFrequency:p.accrualFrequency||"monthly",accrualAmount:p.accrualAmount||0,yearlyAllocation:p.yearlyAllocation||0,maxAccumulation:p.maxAccumulation||0,carryForwardEnabled:p.carryForwardEnabled||!1,maxCarryForward:p.maxCarryForward||0,proRataEnabled:p.proRataEnabled!==void 0?p.proRataEnabled:!0,proRataCalculation:p.proRataCalculation||"calendar-days",isActive:p.isActive!==void 0?p.isActive:!0}),i(!0)},className:"p-1 text-blue-400 hover:text-blue-300",children:e.jsx(fs,{size:16})}),e.jsx("button",{onClick:()=>f(p._id),className:"p-1 text-red-400 hover:text-red-300",children:e.jsx(ct,{size:16})})]})})]},p._id))})]})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:l?"Edit Accrual Policy":"Create Accrual Policy"}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Leave Type"}),e.jsxs("select",{name:"leaveType",value:o.leaveType,onChange:m,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"Select Leave Type"}),e.jsx("option",{value:"Personal Leave",children:"Personal Leave"}),e.jsx("option",{value:"Sick Leave",children:"Sick Leave"}),e.jsx("option",{value:"Casual Leave",children:"Casual Leave"}),e.jsx("option",{value:"Comp Offs",children:"Comp Offs"}),e.jsx("option",{value:"Floater Leave",children:"Floater Leave"}),e.jsx("option",{value:"Marriage Leave",children:"Marriage Leave"}),e.jsx("option",{value:"Maternity Leave",children:"Maternity Leave"}),e.jsx("option",{value:"Paternity Leave",children:"Paternity Leave"}),e.jsx("option",{value:"Unpaid Leave",children:"Unpaid Leave"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Accrual Frequency"}),e.jsxs("select",{name:"accrualFrequency",value:o.accrualFrequency,onChange:m,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"}),e.jsx("option",{value:"quarterly",children:"Quarterly"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Accrual Amount (days)"}),e.jsx("input",{type:"number",name:"accrualAmount",value:o.accrualAmount,onChange:m,required:!0,step:"0.1",min:"0",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Yearly Allocation (optional)"}),e.jsx("input",{type:"number",name:"yearlyAllocation",value:o.yearlyAllocation,onChange:m,step:"0.1",min:"0",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Max Accumulation (0 = unlimited)"}),e.jsx("input",{type:"number",name:"maxAccumulation",value:o.maxAccumulation,onChange:m,min:"0",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Max Carry Forward"}),e.jsx("input",{type:"number",name:"maxCarryForward",value:o.maxCarryForward,onChange:m,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"carryForwardEnabled",checked:o.carryForwardEnabled,onChange:m,className:"w-4 h-4"}),e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Enable Carry Forward"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"proRataEnabled",checked:o.proRataEnabled,onChange:m,className:"w-4 h-4"}),e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Enable Pro-Rata Calculation"})]}),o.proRataEnabled&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Pro-Rata Calculation Method"}),e.jsxs("select",{name:"proRataCalculation",value:o.proRataCalculation,onChange:m,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"calendar-days",children:"Calendar Days"}),e.jsx("option",{value:"working-days",children:"Working Days"}),e.jsx("option",{value:"months",children:"Months"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"isActive",checked:o.isActive,onChange:m,className:"w-4 h-4"}),e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Active"})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>{i(!1),c(null),g()},className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:l?"Update":"Create"})]})]})]})})]})},b2=()=>{const[t,a]=v.useState(!0),[s,n]=v.useState([]),[r,i]=v.useState({leaveType:"",year:new Date().getFullYear(),employee:""});v.useEffect(()=>{l()},[r]);const l=async()=>{try{a(!0);const o={};r.leaveType&&(o.leaveType=r.leaveType),r.year&&(o.year=r.year),r.employee&&(o.employee=r.employee);const d=await Y.get("/leave-accrual/history",{params:o});n(d.data.data||[])}catch{E.error("Failed to fetch accrual history")}finally{a(!1)}},c=o=>{const{name:d,value:x}=o.target;i(m=>({...m,[d]:x}))};return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-400",children:"Loading..."})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Accrual History"}),e.jsx("div",{className:"flex items-center gap-2 text-gray-400",children:e.jsx(Te,{size:24})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(xs,{size:20,className:"text-gray-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Filters"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Leave Type"}),e.jsx("input",{type:"text",name:"leaveType",value:r.leaveType,onChange:c,placeholder:"Filter by leave type",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Year"}),e.jsx("input",{type:"number",name:"year",value:r.year,onChange:c,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Employee"}),e.jsx("input",{type:"text",name:"employee",value:r.employee,onChange:c,placeholder:"Filter by employee",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Employee"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Leave Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Accrued"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Carried Forward"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Accrual Date"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:s.map((o,d)=>{var x;return e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.employeeName||((x=o.employee)==null?void 0:x.name)||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.leaveType||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.accrued||0}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.carriedForward||0}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.total||0}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Fe,{size:16}),o.accrualDate?new Date(o.accrualDate).toLocaleDateString():"-"]})})]},d)})})]}),s.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-400",children:"No accrual history found"})]})]})},j2=()=>{const[t,a]=v.useState(!1),[s,n]=v.useState({accrualType:"monthly",year:new Date().getFullYear(),month:new Date().getMonth()+1}),r=o=>{const{name:d,value:x}=o.target;n(m=>({...m,[d]:x}))},i=async()=>{var o,d;try{a(!0);const x=await Y.post("/leave-accrual/trigger/monthly",{year:s.year,month:s.month});E.success(x.data.message||"Monthly accrual triggered successfully")}catch(x){E.error(((d=(o=x.response)==null?void 0:o.data)==null?void 0:d.message)||"Failed to trigger monthly accrual")}finally{a(!1)}},l=async()=>{var o,d;try{a(!0);const x=await Y.post("/leave-accrual/trigger/yearly",{year:s.year});E.success(x.data.message||"Yearly accrual triggered successfully")}catch(x){E.error(((d=(o=x.response)==null?void 0:o.data)==null?void 0:d.message)||"Failed to trigger yearly accrual")}finally{a(!1)}},c=async()=>{var o,d;try{a(!0);const x=s.year-1,m=s.year,h=await Y.post("/leave-accrual/trigger/carry-forward",{fromYear:x,toYear:m});E.success(h.data.message||"Carry forward processed successfully")}catch(x){E.error(((d=(o=x.response)==null?void 0:o.data)==null?void 0:d.message)||"Failed to process carry forward")}finally{a(!1)}};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Manual Accrual Processing"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Trigger leave accrual processes manually"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Accrual Type"}),e.jsxs("select",{name:"accrualType",value:s.accrualType,onChange:r,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"monthly",children:"Monthly Accrual"}),e.jsx("option",{value:"yearly",children:"Yearly Accrual"}),e.jsx("option",{value:"carry-forward",children:"Carry Forward"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Year"}),e.jsx("input",{type:"number",name:"year",value:s.year,onChange:r,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),s.accrualType==="monthly"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Month"}),e.jsx("input",{type:"number",name:"month",value:s.month,onChange:r,min:"1",max:"12",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]})]}),e.jsxs("div",{className:"flex gap-4",children:[s.accrualType==="monthly"&&e.jsxs("button",{onClick:i,disabled:t,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(po,{size:20}),"Trigger Monthly Accrual"]}),s.accrualType==="yearly"&&e.jsxs("button",{onClick:l,disabled:t,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(Fe,{size:20}),"Trigger Yearly Accrual"]}),s.accrualType==="carry-forward"&&e.jsxs("button",{onClick:c,disabled:t,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(Lt,{size:20}),"Process Carry Forward"]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Instructions"}),e.jsxs("ul",{className:"space-y-2 text-gray-300",children:[e.jsx("li",{children:"â€¢ Monthly Accrual: Processes accrual for a specific month and year"}),e.jsx("li",{children:"â€¢ Yearly Accrual: Processes accrual for the entire year"}),e.jsx("li",{children:"â€¢ Carry Forward: Transfers unused leave balance from previous year to current year"}),e.jsx("li",{children:"â€¢ Ensure all accrual policies are configured before triggering"}),e.jsx("li",{children:"â€¢ Processing may take a few minutes depending on the number of employees"})]})]})]})},ro=()=>{const[t,a]=v.useState(!0),[s,n]=v.useState([]),[r,i]=v.useState(!1),[l,c]=v.useState(null),[o,d]=v.useState({workflowName:"",entityType:"leave_request",levels:[{level:1,approverType:"reporting_manager",slaHours:24}],isActive:!0});v.useEffect(()=>{x()},[]);const x=async()=>{try{a(!0);const y=await Y.get("/approval-workflow/workflows");n(y.data.data||[])}catch{E.error("Failed to fetch workflows")}finally{a(!1)}},m=y=>{const{name:N,value:w,type:D,checked:b}=y.target;d(C=>({...C,[N]:D==="checkbox"?b:w}))},h=()=>{d(y=>({...y,levels:[...y.levels,{level:y.levels.length+1,approverType:"reporting_manager",slaHours:24}]}))},f=y=>{d(N=>({...N,levels:N.levels.filter((w,D)=>D!==y).map((w,D)=>({...w,level:D+1}))}))},g=(y,N,w)=>{d(D=>({...D,levels:D.levels.map((b,C)=>C===y?{...b,[N]:w}:b)}))},p=async y=>{var N,w;y.preventDefault();try{l?(await Y.put(`/approval-workflow/workflows/${l._id}`,o),E.success("Workflow updated successfully")):(await Y.post("/approval-workflow/workflows",o),E.success("Workflow created successfully")),i(!1),c(null),j(),x()}catch(D){E.error(((w=(N=D.response)==null?void 0:N.data)==null?void 0:w.message)||"Failed to save workflow")}},u=async y=>{if(window.confirm("Are you sure you want to delete this workflow?"))try{await Y.delete(`/approval-workflow/workflows/${y}`),E.success("Workflow deleted successfully"),x()}catch{E.error("Failed to delete workflow")}},j=()=>{d({workflowName:"",entityType:"leave_request",levels:[{level:1,approverType:"reporting_manager",slaHours:24}],isActive:!0})};return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-400",children:"Loading..."})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Approval Workflows"}),e.jsxs("button",{onClick:()=>{j(),c(null),i(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(Pe,{size:20}),"Add Workflow"]})]}),e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Workflow Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Entity Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Levels"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:s.map(y=>{var N;return e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:y.workflowName}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:y.entityType}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:((N=y.levels)==null?void 0:N.length)||0}),e.jsx("td",{className:"px-4 py-3",children:y.isActive?e.jsxs("span",{className:"flex items-center gap-1 text-green-400",children:[e.jsx(we,{size:16}),"Active"]}):e.jsxs("span",{className:"flex items-center gap-1 text-red-400",children:[e.jsx(ze,{size:16}),"Inactive"]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{c(y),d({workflowName:y.workflowName||"",entityType:y.entityType||"leave_request",levels:y.levels||[{level:1,approverType:"reporting_manager",slaHours:24}],isActive:y.isActive!==void 0?y.isActive:!0}),i(!0)},className:"p-1 text-blue-400 hover:text-blue-300",children:e.jsx(fs,{size:16})}),e.jsx("button",{onClick:()=>u(y._id),className:"p-1 text-red-400 hover:text-red-300",children:e.jsx(ct,{size:16})})]})})]},y._id)})})]})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:l?"Edit Workflow":"Create Workflow"}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Workflow Name"}),e.jsx("input",{type:"text",name:"workflowName",value:o.workflowName,onChange:m,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Entity Type"}),e.jsxs("select",{name:"entityType",value:o.entityType,onChange:m,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"leave_request",children:"Leave Request"}),e.jsx("option",{value:"leave_encashment",children:"Leave Encashment"}),e.jsx("option",{value:"overtime",children:"Overtime"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Approval Levels"}),e.jsx("button",{type:"button",onClick:h,className:"text-sm text-blue-400 hover:text-blue-300",children:"+ Add Level"})]}),o.levels.map((y,N)=>e.jsxs("div",{className:"bg-gray-700 p-3 rounded-lg mb-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"text-white font-medium",children:["Level ",y.level]}),o.levels.length>1&&e.jsx("button",{type:"button",onClick:()=>f(N),className:"text-red-400 hover:text-red-300",children:"Remove"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Approver Type"}),e.jsxs("select",{value:y.approverType,onChange:w=>g(N,"approverType",w.target.value),className:"w-full px-2 py-1 bg-gray-600 border border-gray-500 rounded text-white text-sm",children:[e.jsx("option",{value:"reporting_manager",children:"Reporting Manager"}),e.jsx("option",{value:"role_based",children:"Role Based"}),e.jsx("option",{value:"specific_user",children:"Specific User"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"SLA (Hours)"}),e.jsx("input",{type:"number",value:y.slaHours,onChange:w=>g(N,"slaHours",parseInt(w.target.value)),className:"w-full px-2 py-1 bg-gray-600 border border-gray-500 rounded text-white text-sm"})]})]})]},N))]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"isActive",checked:o.isActive,onChange:m,className:"w-4 h-4"}),e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Active"})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>{i(!1),c(null),j()},className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:l?"Update":"Create"})]})]})]})})]})},v2=()=>{const[t,a]=v.useState(!0),[s,n]=v.useState([]),[r,i]=v.useState(!1),[l,c]=v.useState(null),[o,d]=v.useState({name:"",entityType:"leave_request",conditions:[],approvers:[]});v.useEffect(()=>{x()},[]);const x=async()=>{try{a(!0);const g=await Y.get("/approval-workflow/matrices");n(g.data.data||[])}catch{E.error("Failed to fetch approval matrices")}finally{a(!1)}},m=async g=>{var p,u;g.preventDefault();try{l?(await Y.put(`/approval-workflow/matrices/${l._id}`,o),E.success("Approval matrix updated successfully")):(await Y.post("/approval-workflow/matrices",o),E.success("Approval matrix created successfully")),i(!1),c(null),f(),x()}catch(j){E.error(((u=(p=j.response)==null?void 0:p.data)==null?void 0:u.message)||"Failed to save approval matrix")}},h=async g=>{if(window.confirm("Are you sure you want to delete this matrix?"))try{await Y.delete(`/approval-workflow/matrices/${g}`),E.success("Approval matrix deleted successfully"),x()}catch{E.error("Failed to delete approval matrix")}},f=()=>{d({name:"",entityType:"leave_request",conditions:[],approvers:[]})};return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-400",children:"Loading..."})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Approval Matrix"}),e.jsxs("button",{onClick:()=>{f(),c(null),i(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(Pe,{size:20}),"Add Matrix"]})]}),e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Entity Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Conditions"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:s.map(g=>{var p;return e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:g.name}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:g.entityType}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:((p=g.conditions)==null?void 0:p.length)||0}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{c(g),d({name:g.name||"",entityType:g.entityType||"leave_request",conditions:g.conditions||[],approvers:g.approvers||[]}),i(!0)},className:"p-1 text-blue-400 hover:text-blue-300",children:e.jsx(fs,{size:16})}),e.jsx("button",{onClick:()=>h(g._id),className:"p-1 text-red-400 hover:text-red-300",children:e.jsx(ct,{size:16})})]})})]},g._id)})})]})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:l?"Edit Approval Matrix":"Create Approval Matrix"}),e.jsxs("form",{onSubmit:m,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Name"}),e.jsx("input",{type:"text",name:"name",value:o.name,onChange:g=>d(p=>({...p,name:g.target.value})),required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Entity Type"}),e.jsxs("select",{name:"entityType",value:o.entityType,onChange:g=>d(p=>({...p,entityType:g.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"leave_request",children:"Leave Request"}),e.jsx("option",{value:"leave_encashment",children:"Leave Encashment"})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>{i(!1),c(null),f()},className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:l?"Update":"Create"})]})]})]})})]})},N2=()=>{const[t,a]=v.useState(!0),[s,n]=v.useState([]),[r,i]=v.useState(!1),[l,c]=v.useState(null),[o,d]=v.useState({delegatorId:"",delegateId:"",entityType:"leave_request",startDate:"",endDate:"",isActive:!0});v.useEffect(()=>{x()},[]);const x=async()=>{try{a(!0);const p=await Y.get("/approval-workflow/delegations");n(p.data.data||[])}catch{E.error("Failed to fetch delegations")}finally{a(!1)}},m=p=>{const{name:u,value:j,type:y,checked:N}=p.target;d(w=>({...w,[u]:y==="checkbox"?N:j}))},h=async p=>{var u,j;p.preventDefault();try{l?(await Y.put(`/approval-workflow/delegations/${l._id}`,o),E.success("Delegation updated successfully")):(await Y.post("/approval-workflow/delegations",o),E.success("Delegation created successfully")),i(!1),c(null),g(),x()}catch(y){E.error(((j=(u=y.response)==null?void 0:u.data)==null?void 0:j.message)||"Failed to save delegation")}},f=async p=>{if(window.confirm("Are you sure you want to delete this delegation?"))try{await Y.delete(`/approval-workflow/delegations/${p}`),E.success("Delegation deleted successfully"),x()}catch{E.error("Failed to delete delegation")}},g=()=>{d({delegatorId:"",delegateId:"",entityType:"leave_request",startDate:"",endDate:"",isActive:!0})};return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-400",children:"Loading..."})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Approval Delegations"}),e.jsxs("button",{onClick:()=>{g(),c(null),i(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(Pe,{size:20}),"Add Delegation"]})]}),e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Delegator"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Delegate"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Entity Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Start Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"End Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:s.map(p=>{var u,j;return e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:p.delegatorName||((u=p.delegator)==null?void 0:u.name)||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:p.delegateName||((j=p.delegate)==null?void 0:j.name)||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:p.entityType}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:p.startDate?new Date(p.startDate).toLocaleDateString():"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:p.endDate?new Date(p.endDate).toLocaleDateString():"-"}),e.jsx("td",{className:"px-4 py-3",children:p.isActive?e.jsx("span",{className:"text-green-400",children:"Active"}):e.jsx("span",{className:"text-red-400",children:"Inactive"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{c(p),d({delegatorId:p.delegatorId||"",delegateId:p.delegateId||"",entityType:p.entityType||"leave_request",startDate:p.startDate?new Date(p.startDate).toISOString().split("T")[0]:"",endDate:p.endDate?new Date(p.endDate).toISOString().split("T")[0]:"",isActive:p.isActive!==void 0?p.isActive:!0}),i(!0)},className:"p-1 text-blue-400 hover:text-blue-300",children:e.jsx(fs,{size:16})}),e.jsx("button",{onClick:()=>f(p._id),className:"p-1 text-red-400 hover:text-red-300",children:e.jsx(ct,{size:16})})]})})]},p._id)})})]})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:l?"Edit Delegation":"Create Delegation"}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Delegator ID"}),e.jsx("input",{type:"text",name:"delegatorId",value:o.delegatorId,onChange:m,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Delegate ID"}),e.jsx("input",{type:"text",name:"delegateId",value:o.delegateId,onChange:m,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Entity Type"}),e.jsxs("select",{name:"entityType",value:o.entityType,onChange:m,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"leave_request",children:"Leave Request"}),e.jsx("option",{value:"leave_encashment",children:"Leave Encashment"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",name:"startDate",value:o.startDate,onChange:m,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"End Date"}),e.jsx("input",{type:"date",name:"endDate",value:o.endDate,onChange:m,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"isActive",checked:o.isActive,onChange:m,className:"w-4 h-4"}),e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Active"})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>{i(!1),c(null),g()},className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:l?"Update":"Create"})]})]})]})})]})},no=()=>{const[t,a]=v.useState(!0),[s,n]=v.useState([]),[r,i]=v.useState({entityType:"",status:"pending"});v.useEffect(()=>{l()},[r]);const l=async()=>{try{a(!0);const o={};r.entityType&&(o.entityType=r.entityType),r.status&&(o.status=r.status);const d=await Y.get("/approval-workflow/pending",{params:o});n(d.data.data||[])}catch{E.error("Failed to fetch pending approvals")}finally{a(!1)}},c=async(o,d,x,m="")=>{try{await Y.post(`/approval-workflow/${o}/${d}/approve`,{action:x,comments:m}),E.success(`Request ${x==="approve"?"approved":"rejected"} successfully`),l()}catch{E.error(`Failed to ${x} request`)}};return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-400",children:"Loading..."})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Pending Approvals"}),e.jsx("div",{className:"flex items-center gap-2 text-gray-400",children:e.jsx(Te,{size:24})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(xs,{size:20,className:"text-gray-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Filters"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Entity Type"}),e.jsxs("select",{name:"entityType",value:r.entityType,onChange:o=>i(d=>({...d,entityType:o.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"leave_request",children:"Leave Request"}),e.jsx("option",{value:"leave_encashment",children:"Leave Encashment"})]})]})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Employee"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Details"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Request Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"SLA Deadline"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:s.map(o=>{var d;return e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.entityType}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.employeeName||((d=o.employee)==null?void 0:d.name)||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.details||o.description||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:new Date(o.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.slaDeadline?new Date(o.slaDeadline).toLocaleDateString():"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>c(o.entityType,o.entityId,"approve"),className:"flex items-center gap-1 px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700",children:[e.jsx(we,{size:16}),"Approve"]}),e.jsxs("button",{onClick:()=>c(o.entityType,o.entityId,"reject"),className:"flex items-center gap-1 px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700",children:[e.jsx(ze,{size:16}),"Reject"]})]})})]},o._id)})})]}),s.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-400",children:"No pending approvals"})]})]})},w2=()=>{var i,l,c;const[t,a]=v.useState(!0),[s,n]=v.useState(null);v.useEffect(()=>{r()},[]);const r=async()=>{try{a(!0);const o=await Y.get("/approval-workflow/sla");n(o.data)}catch{E.error("Failed to fetch SLA monitoring data")}finally{a(!1)}};return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-400",children:"Loading..."})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"SLA Monitoring"}),e.jsx("div",{className:"flex items-center gap-2 text-gray-400",children:e.jsx(Te,{size:24})})]}),s&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"Total Pending"}),e.jsx(Te,{size:20,className:"text-yellow-400"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:((i=s.summary)==null?void 0:i.totalPending)||0})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"At Risk"}),e.jsx(Ct,{size:20,className:"text-red-400"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:((l=s.summary)==null?void 0:l.atRisk)||0})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-gray-400 text-sm",children:"On Time"}),e.jsx(we,{size:20,className:"text-green-400"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:((c=s.summary)==null?void 0:c.onTime)||0})]})]}),s&&s.items&&e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Entity Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Employee"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Request Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"SLA Deadline"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Time Remaining"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:s.items.map((o,d)=>{var x;return e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.entityType}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.employeeName||((x=o.employee)==null?void 0:x.name)||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:new Date(o.requestDate).toLocaleDateString()}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.slaDeadline?new Date(o.slaDeadline).toLocaleDateString():"-"}),e.jsx("td",{className:"px-4 py-3",children:o.status==="at_risk"?e.jsxs("span",{className:"flex items-center gap-1 text-red-400",children:[e.jsx(Ct,{size:16}),"At Risk"]}):e.jsxs("span",{className:"flex items-center gap-1 text-green-400",children:[e.jsx(we,{size:16}),"On Time"]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.timeRemaining||"-"})]},d)})})]})})]})},k2=()=>{const[t,a]=v.useState(!0),[s,n]=v.useState([]),[r,i]=v.useState(!1),[l,c]=v.useState(null),[o,d]=v.useState({deviceName:"",deviceType:"zkteco",ipAddress:"",port:4370,location:"",serialNumber:"",isActive:!0});v.useEffect(()=>{x()},[]);const x=async()=>{try{a(!0);const u=await Y.get("/biometric/devices");n(u.data.data||[])}catch{E.error("Failed to fetch devices")}finally{a(!1)}},m=u=>{const{name:j,value:y,type:N,checked:w}=u.target;d(D=>({...D,[j]:N==="checkbox"?w:N==="number"?parseInt(y)||0:y}))},h=async u=>{var j,y;u.preventDefault();try{l?(await Y.put(`/biometric/devices/${l._id}`,o),E.success("Device updated successfully")):(await Y.post("/biometric/devices",o),E.success("Device created successfully")),i(!1),c(null),p(),x()}catch(N){E.error(((y=(j=N.response)==null?void 0:j.data)==null?void 0:y.message)||"Failed to save device")}},f=async u=>{if(window.confirm("Are you sure you want to delete this device?"))try{await Y.delete(`/biometric/devices/${u}`),E.success("Device deleted successfully"),x()}catch{E.error("Failed to delete device")}},g=async u=>{try{(await Y.post(`/biometric/devices/${u}/test`)).data.success?E.success("Connection test successful"):E.error("Connection test failed"),x()}catch{E.error("Connection test failed")}},p=()=>{d({deviceName:"",deviceType:"zkteco",ipAddress:"",port:4370,location:"",serialNumber:"",isActive:!0})};return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-400",children:"Loading..."})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Biometric Device Management"}),e.jsxs("button",{onClick:()=>{p(),c(null),i(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(Pe,{size:20}),"Add Device"]})]}),e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Device Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"IP Address"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Location"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:s.map(u=>e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:u.deviceName}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:u.deviceType}),e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-300",children:[u.ipAddress,":",u.port]}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:u.location}),e.jsx("td",{className:"px-4 py-3",children:u.isConnected?e.jsxs("span",{className:"flex items-center gap-1 text-green-400",children:[e.jsx(A0,{size:16}),"Connected"]}):e.jsxs("span",{className:"flex items-center gap-1 text-red-400",children:[e.jsx(E0,{size:16}),"Disconnected"]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>g(u._id),className:"p-1 text-yellow-400 hover:text-yellow-300",title:"Test Connection",children:e.jsx(fo,{size:16})}),e.jsx("button",{onClick:()=>{c(u),d({deviceName:u.deviceName||"",deviceType:u.deviceType||"zkteco",ipAddress:u.ipAddress||"",port:u.port||4370,location:u.location||"",serialNumber:u.serialNumber||"",isActive:u.isActive!==void 0?u.isActive:!0}),i(!0)},className:"p-1 text-blue-400 hover:text-blue-300",children:e.jsx(fs,{size:16})}),e.jsx("button",{onClick:()=>f(u._id),className:"p-1 text-red-400 hover:text-red-300",children:e.jsx(ct,{size:16})})]})})]},u._id))})]})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:l?"Edit Device":"Add Device"}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Device Name"}),e.jsx("input",{type:"text",name:"deviceName",value:o.deviceName,onChange:m,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Device Type"}),e.jsxs("select",{name:"deviceType",value:o.deviceType,onChange:m,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"zkteco",children:"ZKTeco"}),e.jsx("option",{value:"essl",children:"eSSL"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Port"}),e.jsx("input",{type:"number",name:"port",value:o.port,onChange:m,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"IP Address"}),e.jsx("input",{type:"text",name:"ipAddress",value:o.ipAddress,onChange:m,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Location"}),e.jsx("input",{type:"text",name:"location",value:o.location,onChange:m,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Serial Number"}),e.jsx("input",{type:"text",name:"serialNumber",value:o.serialNumber,onChange:m,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"isActive",checked:o.isActive,onChange:m,className:"w-4 h-4"}),e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Active"})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>{i(!1),c(null),p()},className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:l?"Update":"Create"})]})]})]})})]})},S2=()=>{const[t,a]=v.useState(!0),[s,n]=v.useState([]),[r,i]=v.useState(""),[l,c]=v.useState(!1),[o,d]=v.useState(null);v.useEffect(()=>{x()},[]);const x=async()=>{try{a(!0);const h=await Y.get("/biometric/devices");n(h.data.data||[])}catch{E.error("Failed to fetch devices")}finally{a(!1)}},m=async()=>{var h,f;if(!r){E.error("Please select a device");return}try{c(!0);const g=await Y.post(`/biometric/devices/${r}/sync-employees`);d(g.data),E.success("Employee sync initiated successfully")}catch(g){E.error(((f=(h=g.response)==null?void 0:h.data)==null?void 0:f.message)||"Failed to sync employees")}finally{c(!1)}};return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-400",children:"Loading..."})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Employee Sync to Devices"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Sync employees to biometric devices"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select Device"}),e.jsxs("select",{value:r,onChange:h=>i(h.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"Select a device"}),s.map(h=>e.jsxs("option",{value:h._id,children:[h.deviceName," - ",h.location]},h._id))]})]}),e.jsxs("button",{onClick:m,disabled:l||!r,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(Lt,{size:20,className:l?"animate-spin":""}),l?"Syncing...":"Sync Employees"]})]}),o&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Re,{size:20,className:"text-gray-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Sync Status"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[e.jsx(we,{size:16,className:"text-green-400"}),e.jsxs("span",{children:["Total Employees: ",o.totalEmployees||0]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[e.jsx(we,{size:16,className:"text-green-400"}),e.jsxs("span",{children:["Synced: ",o.synced||0]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[e.jsx(we,{size:16,className:"text-yellow-400"}),e.jsxs("span",{children:["Failed: ",o.failed||0]})]})]})]})]})},C2=()=>{const[t,a]=v.useState(!0),[s,n]=v.useState([]),[r,i]=v.useState(""),[l,c]=v.useState(!1),[o,d]=v.useState({startDate:new Date().toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]});v.useEffect(()=>{x()},[]);const x=async()=>{try{a(!0);const h=await Y.get("/biometric/devices");n(h.data.data||[])}catch{E.error("Failed to fetch devices")}finally{a(!1)}},m=async()=>{var h,f;if(!r){E.error("Please select a device");return}try{c(!0);const g=await Y.post(`/biometric/devices/${r}/pull-attendance`,{startDate:o.startDate,endDate:o.endDate});E.success(`Pulled ${g.data.recordsPulled||0} attendance records`)}catch(g){E.error(((f=(h=g.response)==null?void 0:h.data)==null?void 0:f.message)||"Failed to pull attendance")}finally{c(!1)}};return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-400",children:"Loading..."})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Pull Attendance Data"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Pull attendance data from biometric devices"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select Device"}),e.jsxs("select",{value:r,onChange:h=>i(h.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"Select a device"}),s.map(h=>e.jsxs("option",{value:h._id,children:[h.deviceName," - ",h.location]},h._id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:o.startDate,onChange:h=>d(f=>({...f,startDate:h.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:o.endDate,onChange:h=>d(f=>({...f,endDate:h.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]})]}),e.jsxs("button",{onClick:m,disabled:l||!r,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(_t,{size:20,className:l?"animate-spin":""}),l?"Pulling...":"Pull Attendance"]})]})]})},A2=()=>{const[t,a]=v.useState(!0),[s,n]=v.useState([]),[r,i]=v.useState({deviceId:"",syncType:"",status:""});v.useEffect(()=>{l()},[r]);const l=async()=>{try{a(!0);const o={};r.deviceId&&(o.deviceId=r.deviceId),r.syncType&&(o.syncType=r.syncType),r.status&&(o.status=r.status);const d=await Y.get("/biometric/sync-logs",{params:o});n(d.data.data||[])}catch{E.error("Failed to fetch sync logs")}finally{a(!1)}},c=o=>{switch(o){case"success":return e.jsx(we,{size:16,className:"text-green-400"});case"failed":return e.jsx(ze,{size:16,className:"text-red-400"});default:return e.jsx(Te,{size:16,className:"text-yellow-400"})}};return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-400",children:"Loading..."})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Sync Logs"}),e.jsx("div",{className:"flex items-center gap-2 text-gray-400",children:e.jsx(Ue,{size:24})})]}),e.jsx("div",{className:"bg-gray-800 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Device"}),e.jsx("input",{type:"text",name:"deviceId",value:r.deviceId,onChange:o=>i(d=>({...d,deviceId:o.target.value})),placeholder:"Filter by device",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Sync Type"}),e.jsxs("select",{name:"syncType",value:r.syncType,onChange:o=>i(d=>({...d,syncType:o.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"employee",children:"Employee Sync"}),e.jsx("option",{value:"attendance",children:"Attendance Pull"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Status"}),e.jsxs("select",{name:"status",value:r.status,onChange:o=>i(d=>({...d,status:o.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"failed",children:"Failed"}),e.jsx("option",{value:"pending",children:"Pending"})]})]})]})}),e.jsxs("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Device"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Sync Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Records"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Sync Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Message"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:s.map(o=>{var d;return e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.deviceName||((d=o.device)==null?void 0:d.deviceName)||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.syncType}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-1",children:[c(o.status),e.jsx("span",{className:"text-sm text-gray-300",children:o.status})]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.recordsProcessed||0}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:new Date(o.syncDate).toLocaleString()}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.message||"-"})]},o._id)})})]}),s.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-400",children:"No sync logs found"})]})]})},E2=()=>{const[t,a]=v.useState(!0),[s,n]=v.useState([]),[r,i]=v.useState(!1),[l,c]=v.useState(null),[o,d]=v.useState({connectionName:"",host:"",port:8e3,client:"",username:"",password:"",systemNumber:"",isActive:!0});v.useEffect(()=>{x()},[]);const x=async()=>{try{a(!0);const u=await Y.get("/sap/connections");n(u.data.data||[])}catch{E.error("Failed to fetch SAP connections")}finally{a(!1)}},m=u=>{const{name:j,value:y,type:N,checked:w}=u.target;d(D=>({...D,[j]:N==="checkbox"?w:N==="number"?parseInt(y)||0:y}))},h=async u=>{var j,y;u.preventDefault();try{l?(await Y.put(`/sap/connections/${l._id}`,o),E.success("SAP connection updated successfully")):(await Y.post("/sap/connections",o),E.success("SAP connection created successfully")),i(!1),c(null),p(),x()}catch(N){E.error(((y=(j=N.response)==null?void 0:j.data)==null?void 0:y.message)||"Failed to save SAP connection")}},f=async u=>{if(window.confirm("Are you sure you want to delete this connection?"))try{await Y.delete(`/sap/connections/${u}`),E.success("SAP connection deleted successfully"),x()}catch{E.error("Failed to delete SAP connection")}},g=async u=>{try{(await Y.post(`/sap/connections/${u}/test`)).data.success?E.success("Connection test successful"):E.error("Connection test failed"),x()}catch{E.error("Connection test failed")}},p=()=>{d({connectionName:"",host:"",port:8e3,client:"",username:"",password:"",systemNumber:"",isActive:!0})};return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-400",children:"Loading..."})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"SAP Connection Configuration"}),e.jsxs("button",{onClick:()=>{p(),c(null),i(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[e.jsx(Pe,{size:20}),"Add Connection"]})]}),e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Connection Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Host"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Client"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:s.map(u=>e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:u.connectionName}),e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-300",children:[u.host,":",u.port]}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:u.client}),e.jsx("td",{className:"px-4 py-3",children:u.status==="connected"?e.jsxs("span",{className:"flex items-center gap-1 text-green-400",children:[e.jsx(we,{size:16}),"Connected"]}):e.jsxs("span",{className:"flex items-center gap-1 text-red-400",children:[e.jsx(ze,{size:16}),"Disconnected"]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>g(u._id),className:"p-1 text-yellow-400 hover:text-yellow-300",title:"Test Connection",children:e.jsx(fo,{size:16})}),e.jsx("button",{onClick:()=>{c(u),d({connectionName:u.connectionName||"",host:u.host||"",port:u.port||8e3,client:u.client||"",username:u.username||"",password:"",systemNumber:u.systemNumber||"",isActive:u.isActive!==void 0?u.isActive:!0}),i(!0)},className:"p-1 text-blue-400 hover:text-blue-300",children:e.jsx(fs,{size:16})}),e.jsx("button",{onClick:()=>f(u._id),className:"p-1 text-red-400 hover:text-red-300",children:e.jsx(ct,{size:16})})]})})]},u._id))})]})}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:l?"Edit SAP Connection":"Add SAP Connection"}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Connection Name"}),e.jsx("input",{type:"text",name:"connectionName",value:o.connectionName,onChange:m,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Host"}),e.jsx("input",{type:"text",name:"host",value:o.host,onChange:m,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Port"}),e.jsx("input",{type:"number",name:"port",value:o.port,onChange:m,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Client"}),e.jsx("input",{type:"text",name:"client",value:o.client,onChange:m,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"System Number"}),e.jsx("input",{type:"text",name:"systemNumber",value:o.systemNumber,onChange:m,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Username"}),e.jsx("input",{type:"text",name:"username",value:o.username,onChange:m,required:!0,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Password"}),e.jsx("input",{type:"password",name:"password",value:o.password,onChange:m,required:!l,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"isActive",checked:o.isActive,onChange:m,className:"w-4 h-4"}),e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Active"})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{type:"button",onClick:()=>{i(!1),c(null),p()},className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:l?"Update":"Create"})]})]})]})})]})},F2=()=>{const[t,a]=v.useState(!1),[s,n]=v.useState(null),[r,i]=v.useState(""),l=async()=>{var c,o;if(!r){E.error("Please select a connection");return}try{a(!0);const d=await Y.post(`/sap/connections/${r}/sync-employees`);n(d.data),E.success("Employee sync initiated successfully")}catch(d){E.error(((o=(c=d.response)==null?void 0:c.data)==null?void 0:o.message)||"Failed to sync employees")}finally{a(!1)}};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Sync Employee Master Data"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Sync employee master data from SAP"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Connection ID"}),e.jsx("input",{type:"text",value:r,onChange:c=>i(c.target.value),placeholder:"Enter SAP connection ID",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("button",{onClick:l,disabled:t||!r,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(Lt,{size:20,className:t?"animate-spin":""}),t?"Syncing...":"Sync Employees"]})]}),s&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Re,{size:20,className:"text-gray-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Sync Status"})]}),e.jsxs("div",{className:"space-y-2 text-gray-300",children:[e.jsxs("div",{children:["Total Records: ",s.totalRecords||0]}),e.jsxs("div",{children:["Synced: ",s.synced||0]}),e.jsxs("div",{children:["Failed: ",s.failed||0]})]})]})]})},T2=()=>{const[t,a]=v.useState(!1),[s,n]=v.useState(null),[r,i]=v.useState(""),l=async()=>{var c,o;if(!r){E.error("Please select a connection");return}try{a(!0);const d=await Y.post(`/sap/connections/${r}/sync-leave-balance`);n(d.data),E.success("Leave balance sync initiated successfully")}catch(d){E.error(((o=(c=d.response)==null?void 0:c.data)==null?void 0:o.message)||"Failed to sync leave balances")}finally{a(!1)}};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Sync Leave Balances"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Sync leave balances from SAP"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Connection ID"}),e.jsx("input",{type:"text",value:r,onChange:c=>i(c.target.value),placeholder:"Enter SAP connection ID",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("button",{onClick:l,disabled:t||!r,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(Lt,{size:20,className:t?"animate-spin":""}),t?"Syncing...":"Sync Leave Balances"]})]}),s&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Fe,{size:20,className:"text-gray-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Sync Status"})]}),e.jsxs("div",{className:"space-y-2 text-gray-300",children:[e.jsxs("div",{children:["Total Records: ",s.totalRecords||0]}),e.jsxs("div",{children:["Synced: ",s.synced||0]}),e.jsxs("div",{children:["Failed: ",s.failed||0]})]})]})]})},D2=()=>{const[t,a]=v.useState(!1),[s,n]=v.useState(null),[r,i]=v.useState(""),[l,c]=v.useState({startDate:new Date().toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]}),o=async()=>{var d,x;if(!r){E.error("Please select a connection");return}try{a(!0);const m=await Y.post(`/sap/connections/${r}/sync-attendance`,{startDate:l.startDate,endDate:l.endDate});n(m.data),E.success("Attendance sync initiated successfully")}catch(m){E.error(((x=(d=m.response)==null?void 0:d.data)==null?void 0:x.message)||"Failed to sync attendance")}finally{a(!1)}};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Sync Attendance Data"}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Sync attendance data from SAP"})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Connection ID"}),e.jsx("input",{type:"text",value:r,onChange:d=>i(d.target.value),placeholder:"Enter SAP connection ID",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Start Date"}),e.jsx("input",{type:"date",value:l.startDate,onChange:d=>c(x=>({...x,startDate:d.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"End Date"}),e.jsx("input",{type:"date",value:l.endDate,onChange:d=>c(x=>({...x,endDate:d.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]})]}),e.jsxs("button",{onClick:o,disabled:t||!r,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(Lt,{size:20,className:t?"animate-spin":""}),t?"Syncing...":"Sync Attendance"]})]}),s&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Te,{size:20,className:"text-gray-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Sync Status"})]}),e.jsxs("div",{className:"space-y-2 text-gray-300",children:[e.jsxs("div",{children:["Total Records: ",s.totalRecords||0]}),e.jsxs("div",{children:["Synced: ",s.synced||0]}),e.jsxs("div",{children:["Failed: ",s.failed||0]})]})]})]})},_2=()=>{const[t,a]=v.useState(!0),[s,n]=v.useState([]),[r,i]=v.useState({connectionId:"",syncType:"",status:""});v.useEffect(()=>{l()},[r]);const l=async()=>{try{a(!0);const o={};r.connectionId&&(o.connectionId=r.connectionId),r.syncType&&(o.syncType=r.syncType),r.status&&(o.status=r.status);const d=await Y.get("/sap/sync-logs",{params:o});n(d.data.data||[])}catch{E.error("Failed to fetch sync logs")}finally{a(!1)}},c=o=>{switch(o){case"success":return e.jsx(we,{size:16,className:"text-green-400"});case"failed":return e.jsx(ze,{size:16,className:"text-red-400"});default:return e.jsx(Te,{size:16,className:"text-yellow-400"})}};return t?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-400",children:"Loading..."})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"SAP Sync Logs"}),e.jsx("div",{className:"flex items-center gap-2 text-gray-400",children:e.jsx(Ue,{size:24})})]}),e.jsx("div",{className:"bg-gray-800 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Connection"}),e.jsx("input",{type:"text",name:"connectionId",value:r.connectionId,onChange:o=>i(d=>({...d,connectionId:o.target.value})),placeholder:"Filter by connection",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Sync Type"}),e.jsxs("select",{name:"syncType",value:r.syncType,onChange:o=>i(d=>({...d,syncType:o.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"employee",children:"Employee Sync"}),e.jsx("option",{value:"leave",children:"Leave Balance Sync"}),e.jsx("option",{value:"attendance",children:"Attendance Sync"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Status"}),e.jsxs("select",{name:"status",value:r.status,onChange:o=>i(d=>({...d,status:o.target.value})),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"failed",children:"Failed"}),e.jsx("option",{value:"pending",children:"Pending"})]})]})]})}),e.jsxs("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Connection"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Sync Type"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Records"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Sync Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-300",children:"Message"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700",children:s.map(o=>{var d;return e.jsxs("tr",{className:"hover:bg-gray-750",children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.connectionName||((d=o.connection)==null?void 0:d.connectionName)||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.syncType}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-1",children:[c(o.status),e.jsx("span",{className:"text-sm text-gray-300",children:o.status})]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.recordsProcessed||0}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:new Date(o.syncDate).toLocaleString()}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:o.message||"-"})]},o._id)})})]}),s.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-400",children:"No sync logs found"})]})]})};function R2(){return e.jsx(gh,{children:e.jsx(uh,{children:e.jsxs(r0,{children:[e.jsx(F0,{position:"top-right",toastOptions:{duration:5e3,style:{background:"#1e293b",color:"#f1f5f9",border:"1px solid #334155"},success:{iconTheme:{primary:"#10b981",secondary:"#f1f5f9"}},error:{iconTheme:{primary:"#ef4444",secondary:"#f1f5f9"}}}}),e.jsxs(n0,{children:[e.jsx(pe,{path:"/login",element:e.jsx(Vh,{})}),e.jsx(pe,{path:"/login/company-select",element:e.jsx(Gh,{})}),e.jsx(pe,{path:"/login/super-admin",element:e.jsx(Xh,{})}),e.jsx(pe,{path:"/login/old",element:e.jsx(Wh,{})}),e.jsx(pe,{path:"/login/:companySlug",element:e.jsx(Yh,{})}),e.jsx(pe,{path:"/careers",element:e.jsx(El,{})}),e.jsx(pe,{path:"/jobs",element:e.jsx(El,{})}),e.jsx(pe,{path:"/candidate-documents",element:e.jsx(Qh,{})}),e.jsx(pe,{path:"/public/upload-documents/:token",element:e.jsx(ou,{})}),e.jsx(pe,{path:"/",element:e.jsx(yh,{})}),e.jsxs(pe,{path:"/*",element:e.jsx(Dn,{children:e.jsx(vh,{})}),children:[e.jsx(pe,{path:"dashboard",element:e.jsx(du,{})}),e.jsx(pe,{path:"job-desk",element:e.jsx(Fl,{})}),e.jsx(pe,{path:"job-desk/:jobId/applicants",element:e.jsx(Dl,{})}),e.jsx(pe,{path:"candidates/:candidateId/timeline",element:e.jsx(_l,{})}),e.jsx(pe,{path:"employees",element:e.jsx(Qo,{})}),e.jsx(pe,{path:"employees/add",element:e.jsx(pu,{})}),e.jsx(pe,{path:"employees/bulk-upload",element:e.jsx($w,{})}),e.jsx(pe,{path:"employees/:id/edit",element:e.jsx(fu,{})}),e.jsx(pe,{path:"employees/:id",element:e.jsx(gu,{})}),e.jsx(pe,{path:"employees/onboarding",element:e.jsx(yu,{})}),e.jsx(pe,{path:"employees/offboarding",element:e.jsx(Su,{})}),e.jsx(pe,{path:"leave",element:e.jsx(Bw,{})}),e.jsx(pe,{path:"leave/apply",element:e.jsx(Uw,{})}),e.jsx(pe,{path:"leave/balance",element:e.jsx(zw,{})}),e.jsx(pe,{path:"leave/calendar",element:e.jsx(Hw,{})}),e.jsx(pe,{path:"attendance",element:e.jsx(Mc,{})}),e.jsx(pe,{path:"attendance/mark",element:e.jsx(qw,{})}),e.jsx(pe,{path:"attendance/reports",element:e.jsx(Ww,{})}),e.jsx(pe,{path:"work-schedule/shift-templates",element:e.jsx(Yc,{})}),e.jsx(pe,{path:"work-schedule/rosters",element:e.jsx(Xc,{})}),e.jsx(pe,{path:"work-schedule/roster-calendar",element:e.jsx(Kc,{})}),e.jsx(pe,{path:"work-schedule/roster-change-requests",element:e.jsx(Jc,{})}),e.jsx(pe,{path:"payroll",element:e.jsx($c,{})}),e.jsx(pe,{path:"payroll/generate",element:e.jsx(Vw,{})}),e.jsx(pe,{path:"payroll/slips",element:e.jsx(Gw,{})}),e.jsx(pe,{path:"administration/departments",element:e.jsx(Yw,{})}),e.jsx(pe,{path:"administration/roles",element:e.jsx(Xw,{})}),e.jsx(pe,{path:"administration/policies",element:e.jsx(Kw,{})}),e.jsx(pe,{path:"administration/users",element:e.jsx(Jw,{})}),e.jsx(pe,{path:"administration/leave-management",element:e.jsx(Qw,{})}),e.jsx(pe,{path:"assets",element:e.jsx(s1,{})}),e.jsx(pe,{path:"clients",element:e.jsx(i1,{})}),e.jsx(pe,{path:"projects",element:e.jsx(l1,{})}),e.jsx(pe,{path:"timesheets",element:e.jsx(o1,{})}),e.jsx(pe,{path:"documents",element:e.jsx(x1,{})}),e.jsx(pe,{path:"compliance",element:e.jsx(m1,{})}),e.jsx(pe,{path:"candidates",element:e.jsx(h1,{})}),e.jsx(pe,{path:"document-verification",element:e.jsx(V1,{})}),e.jsx(pe,{path:"talent-pool",element:e.jsx(u1,{})}),e.jsx(pe,{path:"feedback",element:e.jsx(Hc,{})}),e.jsx(pe,{path:"exit-process",element:e.jsx(p1,{})}),e.jsx(pe,{path:"reports/export",element:e.jsx(f1,{})}),e.jsx(pe,{path:"reports/compliance",element:e.jsx(g1,{})}),e.jsx(pe,{path:"reports/leave",element:e.jsx(f2,{})}),e.jsx(pe,{path:"reports/attendance",element:e.jsx(to,{})}),e.jsx(pe,{path:"reports/compliance-reports",element:e.jsx(g2,{})}),e.jsx(pe,{path:"reports/scheduled",element:e.jsx(y2,{})}),e.jsx(pe,{path:"reports/analytics",element:e.jsx(so,{})}),e.jsx(pe,{path:"leave-encashment/rules",element:e.jsx(Qc,{})}),e.jsx(pe,{path:"leave-encashment/requests",element:e.jsx(Zc,{})}),e.jsx(pe,{path:"leave-encashment/history",element:e.jsx(eo,{})}),e.jsx(pe,{path:"leave-accrual/policies",element:e.jsx(ao,{})}),e.jsx(pe,{path:"leave-accrual/history",element:e.jsx(b2,{})}),e.jsx(pe,{path:"leave-accrual/manual",element:e.jsx(j2,{})}),e.jsx(pe,{path:"approval-workflow/workflows",element:e.jsx(ro,{})}),e.jsx(pe,{path:"approval-workflow/matrix",element:e.jsx(v2,{})}),e.jsx(pe,{path:"approval-workflow/delegations",element:e.jsx(N2,{})}),e.jsx(pe,{path:"approval-workflow/pending",element:e.jsx(no,{})}),e.jsx(pe,{path:"approval-workflow/sla",element:e.jsx(w2,{})}),e.jsx(pe,{path:"biometric/devices",element:e.jsx(k2,{})}),e.jsx(pe,{path:"biometric/employee-sync",element:e.jsx(S2,{})}),e.jsx(pe,{path:"biometric/attendance-pull",element:e.jsx(C2,{})}),e.jsx(pe,{path:"biometric/sync-logs",element:e.jsx(A2,{})}),e.jsx(pe,{path:"sap/connections",element:e.jsx(E2,{})}),e.jsx(pe,{path:"sap/employee-sync",element:e.jsx(F2,{})}),e.jsx(pe,{path:"sap/leave-sync",element:e.jsx(T2,{})}),e.jsx(pe,{path:"sap/attendance-sync",element:e.jsx(D2,{})}),e.jsx(pe,{path:"sap/sync-logs",element:e.jsx(_2,{})}),e.jsx(pe,{path:"settings/profile",element:e.jsx(a1,{})}),e.jsx(pe,{path:"settings/security",element:e.jsx(r1,{})}),e.jsx(pe,{path:"settings/preferences",element:e.jsx(n1,{})}),e.jsx(pe,{path:"settings/theme",element:e.jsx(Bc,{})})]}),e.jsxs(pe,{path:"/employee/*",element:e.jsx(Dn,{roles:["employee","manager","hr"],children:e.jsx(Nh,{})}),children:[e.jsx(pe,{path:"dashboard",element:e.jsx(qc,{})}),e.jsx(pe,{path:"home",element:e.jsx(qc,{})}),e.jsx(pe,{path:"leave",element:e.jsx(w1,{})}),e.jsx(pe,{path:"leave/balance",element:e.jsx(S1,{})}),e.jsx(pe,{path:"leave/apply",element:e.jsx(C1,{})}),e.jsx(pe,{path:"attendance",element:e.jsx(A1,{})}),e.jsx(pe,{path:"team",element:e.jsx(E1,{})}),e.jsx(pe,{path:"payslips",element:e.jsx(F1,{})}),e.jsx(pe,{path:"projects",element:e.jsx(T1,{})}),e.jsx(pe,{path:"requests",element:e.jsx(k1,{})}),e.jsx(pe,{path:"profile",element:e.jsx(L1,{})}),e.jsx(pe,{path:"settings/theme",element:e.jsx(Bc,{})}),e.jsx(pe,{path:"work-schedule/shift-templates",element:e.jsx(Yc,{})}),e.jsx(pe,{path:"work-schedule/rosters",element:e.jsx(Xc,{})}),e.jsx(pe,{path:"work-schedule/roster-calendar",element:e.jsx(Kc,{})}),e.jsx(pe,{path:"work-schedule/roster-change-requests",element:e.jsx(Jc,{})}),e.jsx(pe,{path:"manager/home",element:e.jsx(I1,{})}),e.jsx(pe,{path:"manager/leave-approvals",element:e.jsx(O1,{})}),e.jsx(pe,{path:"manager/assign-project",element:e.jsx(M1,{})}),e.jsx(pe,{path:"manager/schedule-meeting",element:e.jsx($1,{})}),e.jsx(pe,{path:"manager/announcements",element:e.jsx(B1,{})}),e.jsx(pe,{path:"hr/dashboard",element:e.jsx(z1,{})}),e.jsx(pe,{path:"hr/employees",element:e.jsx(H1,{})}),e.jsx(pe,{path:"hr/attendance",element:e.jsx(Mc,{})}),e.jsx(pe,{path:"hr/payroll",element:e.jsx($c,{})}),e.jsx(pe,{path:"hr/recruitment",element:e.jsx(Fl,{})}),e.jsx(pe,{path:"hr/recruitment/:jobId/applicants",element:e.jsx(Dl,{})}),e.jsx(pe,{path:"hr/recruitment/candidates/:candidateId/timeline",element:e.jsx(_l,{})}),e.jsx(pe,{path:"hr/resume-search",element:e.jsx(q1,{})}),e.jsx(pe,{path:"hr/candidate-pool",element:e.jsx(W1,{})}),e.jsx(pe,{path:"hr/performance",element:e.jsx(Hc,{})}),e.jsx(pe,{path:"leave-encashment/requests",element:e.jsx(Zc,{})}),e.jsx(pe,{path:"leave-encashment/history",element:e.jsx(eo,{})}),e.jsx(pe,{path:"hr/leave-encashment-rules",element:e.jsx(Qc,{})}),e.jsx(pe,{path:"hr/leave-accrual-policies",element:e.jsx(ao,{})}),e.jsx(pe,{path:"hr/approval-workflows",element:e.jsx(ro,{})}),e.jsx(pe,{path:"hr/pending-approvals",element:e.jsx(no,{})}),e.jsx(pe,{path:"hr/reports-analytics",element:e.jsx(so,{})}),e.jsx(pe,{path:"hr/attendance-reports",element:e.jsx(to,{})})]}),e.jsxs(pe,{path:"/super-admin/*",element:e.jsx(Dn,{roles:["superadmin"],children:e.jsx(Bh,{})}),children:[e.jsx(pe,{path:"dashboard",element:e.jsx(G1,{})}),e.jsx(pe,{path:"clients",element:e.jsx(X1,{})}),e.jsx(pe,{path:"packages",element:e.jsx(J1,{})}),e.jsx(pe,{path:"subscriptions",element:e.jsx(l2,{})}),e.jsx(pe,{path:"invoices",element:e.jsx(c2,{})}),e.jsx(pe,{path:"revenue",element:e.jsx(h2,{})}),e.jsx(pe,{path:"billing-alerts",element:e.jsx(u2,{})}),e.jsx(pe,{path:"roles",element:e.jsx(Q1,{})}),e.jsx(pe,{path:"audit",element:e.jsx(Z1,{})}),e.jsx(pe,{path:"analytics",element:e.jsx(e2,{})}),e.jsx(pe,{path:"config",element:e.jsx(t2,{})}),e.jsx(pe,{path:"data",element:e.jsx(s2,{})}),e.jsx(pe,{index:!0,element:e.jsx(Ys,{to:"dashboard",replace:!0})})]})]})]})})})}Yn.createRoot(document.getElementById("root")).render(e.jsx(Hs.StrictMode,{children:e.jsx(R2,{})}));export{Y as a};
